<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-09-09 Thu 16:25 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>org-special-block-extras</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Musa Al-hassy" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link href="https://alhassy.github.io/next-700-module-systems/prototype/org-notes-style.css" rel="stylesheet" type="text/css" />

        <style>
        /* From: https://endlessparentheses.com/public/css/endless.css */
        /* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */
        kbd
        {
          -moz-border-radius: 6px;
          -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
          -webkit-border-radius: 6px;
          -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
          background-color: #f7f7f7;
          border: 1px solid #ccc;
          border-radius: 6px;
          box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
          color: #333;
          display: inline-block;
          font-family: 'Droid Sans Mono', monospace;
          font-size: 80%;
          font-weight: normal;
          line-height: inherit;
          margin: 0 .1em;
          padding: .08em .4em;
          text-shadow: 0 1px 0 #fff;
          word-spacing: -4px;

          box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */
        }
        </style>
        <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css"/>

        <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css" />

        <script type="text/javascript">
            if (typeof jQuery == 'undefined') {
                document.write(unescape('%3Cscript src="https://code.jquery.com/jquery-1.10.0.min.js"%3E%3C/script%3E'));
            }
        </script>

         <script type="text/javascript"            src="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js"></script>

          <script>
                 $(document).ready(function() {
                     $('.tooltip').tooltipster({
                         theme: 'tooltipster-punk',
                         contentAsHTML: true,
                         animation: 'grow',
                         delay: [100,500],
                         // trigger: 'click'
                         trigger: 'custom',
                         triggerOpen: {
                             mouseenter: true
                         },
                         triggerClose: {
                             originClick: true,
                             scroll: true
                         }
         });
                 });
             </script>

        <style>
           abbr {color: red;}

           .tooltip { border-bottom: 1px dotted #000;
                      color:red;
                      text-decoration: none;}
        </style>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">org-special-block-extras
<br />
<span class="subtitle">A unified interface for special blocks and links: defblock</span>
</h1>

<style>
/* Using source blocks “C” as alias for Org */
pre.src-C:before { content: 'Org-mode Example!'; }
/* Execute this for alias: (add-to-list 'org-src-lang-modes '("org" . C)) */
</style>
<div class="org-center">
<p>

</p>

<p>
<a href="https://www.gnu.org/software/emacs"><img src="https://img.shields.io/badge/Emacs-27-green?logo=gnu-emacs"></a>
<a href="https://orgmode.org"><img src="https://img.shields.io/badge/Org-9.4-blue?logo=gnu"></a>
</p>

<span>
<p>
<a href="https://github.com/alhassy/org-special-block-extras"><img src="https://img.shields.io/badge/org--special--block--extras-3.0-informational?logo=Gnu-Emacs"></a>
</p>

<a href="https://melpa.org/#/org-special-block-extras"><img alt="MELPA" src="https://melpa.org/packages/org-special-block-extras-badge.svg"/></a>
</span>

<p>
<a href="https://www.gnu.org/licenses/gpl-3.0.en.html"><img src="https://img.shields.io/badge/license-GNU_3-informational?logo=read-the-docs"></a>
<a href="https://github.com/alhassy/emacs.d#what-does-literate-programming-look-like"><img src="https://img.shields.io/badge/docs-literate-success?logo=read-the-docs"></a>
<a href="https://twitter.com/intent/tweet?text=This looks super neat (•̀ᴗ•́)و::&url=https://github.com/alhassy/org-special-block-extras"><img src="https://img.shields.io/twitter/url?url=https://github.com/alhassy/org-special-block-extras"></a>
<a href="https://github.com/alhassy/org-special-block-extras/issues"><img src="https://img.shields.io/badge/contributions-welcome-green?logo=nil"></a>
</p>

<p>
<a href="https://alhassy.github.io/"><img src="https://img.shields.io/badge/author-musa_al--hassy-purple?logo=nintendo-3ds"></a>
<a href="https://www.buymeacoffee.com/alhassy"><img src="https://img.shields.io/badge/-buy_me_a%C2%A0coffee-gray?logo=buy-me-a-coffee"></a>
</p>

<p>
<a href="https://youtu.be/BQdNhtJSbqk"><img src="https://img.shields.io/badge/EmacsConf-2020-informational?logo=youtube"></a>
</p>
</div>

<div class="org-center">
<p>
<b>Abstract</b>
</p>
</div>
<blockquote>
<p>
The aim is to write something once using Org-mode markup
then generate the markup for multiple backends.
That is, <i><b>write once, generate many!</b></i>
</p>

<p>
In particular, we are concerned with <i>‘custom’, or ‘special’, blocks</i> which
delimit how a particular region of text is supposed to be formatted according to
the possible export backends.  In some sense, special blocks are meta-blocks.
Rather than writing text in, say, LaTeX environments using LaTeX commands or in
HTML <code>div</code>'s using HTML tags, we promote using Org-mode markup in special blocks
&#x2014;Org markup cannot be used explicitly within HTML or LaTeX environments.
</p>


<p>
<i>Special blocks</i>, like <code>centre</code> and <code>quote</code>, allow us to use Org-mode as the primary
interface regardless of whether the final result is an HTML or PDF article;
sometime we need to make our own special blocks to avoid a duplication of
effort.  However, this can be difficult and may require familiarity with
relatively advanced ELisp concepts, such as macros and hooks; as such, users may
not be willing to put in the time and instead use ad-hoc solutions.
</p>

<p>
We present a new macro, <abbr class="tooltip" title="Declare a new special block, and link, in the style of DEFUN.<br><br>A full featured example is at the end of this documentation string.<br><br>This is an anaphoric macro that provides export support for<br>special blocks <strong>and</strong> links named NAME. Just as an Org-mode<br>src-block consumes as main argument the language for the src<br>block, our special blocks too consume a MAIN-ARG; it may be a<br>symbol or a cons-list consisting of a symbolic name (with which<br>to refer to the main argument in the definition of the block)<br>followed by a default value, then, optionally, any information<br>for a one-time setup of the associated link type.<br><br>The main arg may be a sequence of symbols separated by spaces,<br>and a few punctuation with the exception of comma ‘,’ since it is<br>a special Lisp operator. In doubt, enclose the main arg in<br>quotes.<br><br>Then, just as Org-mode src blocks consume key-value pairs, our<br>special blocks consume a number of KWDS, which is a list of the<br>form (key₀ value₀ … keyₙ valueₙ).<br><br>After that is an optional DOCSTRING, a familar feature of DEFUN.<br>The docstring is displayed as part of the tooltip for the<br>produced link type.<br><br>Finally, the BODY is a (sequence of) Lisp forms ---no progn<br>needed--- that may refer to the names BACKEND and CONTENTS which<br>refer to the current export backend and the contents of the<br>special block ---or the description clause of a link.<br><br>CONTENTS refers to an Org-mode parsed string; i.e., Org-markup is<br>acknowledged.<br><br>In, hopefully, rare circumstances, one may refer to RAW-CONTENTS<br>to look at the fully unparsed contents.<br><br>Finally, this macro exposes two functions:<br>+ ORG-EXPORT: Wrap the argument in an export block for the current backend.<br>+ ORG-PARSE: This should ONLY be called within an ORG-EXPORT call,<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; to escape text to Org, and out of the export block.<br><br><hr><br><br>TLDR for EXPERIMENTAL and DOCSTRING and BODY, the first two parts are<br>optional; they’re a symbol, a string, then the main body.&emsp;The<br>symbol, O-RESPECT-NEWLINES?, when present enables a highly<br>experimental [i.e., do <strong>not</strong> use it!] feature: No new lines for<br>blocks in HTML export.&emsp;Its need rose from developing the MARGIN<br>block type.<br><br><hr><br><br>The relationship between links and special blocks:<br><br>&emsp;[ [type:label][description]]<br>≈<br>&emsp; #+begin_type label<br>&emsp;&emsp;description<br>&emsp; #+end_type<br><br><hr><br><br>Example declaration, with all possible features shown:<br><br>&emsp; ;; We can use variable values when defining new blocks<br>&emsp; (setq angry-red ’(:foreground ''red'' :weight bold))<br><br>&emsp; (defblock remark<br>&emsp;&emsp; (editor ''Editor Remark'' :face angry-red) (color ''red'' signoff '''')<br>&emsp;&emsp; ''Top level (HTML & LaTeX)O-RESPECT-NEWLINES? editorial remarks; in Emacs they’re angry red.''<br>&emsp;&emsp; (format (if (equal backend ’html)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''<strong style=\''color: %s;\''>⟦%s:&emsp;%s%s⟧</strong>''<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''{\color{%s}\bfseries %s:&emsp;%s%s}'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; color editor contents signoff))<br><br>&emsp; ;; I don’t want to change the definition, but I’d like to have<br>&emsp; ;; the following as personalised defaults for the “remark” block.<br>&emsp; ;; OR, I’d like to set this for links, which do not have argument options.<br>&emsp; (defblock-header-args remark :main-arg ''Jasim Jameson'' :signoff ''( Aim for success! )'')<br><br>Three example uses:<br><br>&emsp;&emsp;;; ⟨0⟩ As a special blocks with arguments given.<br>&emsp;&emsp;#+begin_remark Bobbert Barakallah :signoff ''Thank-you for pointing this out!'' :color green<br>&emsp;&emsp;I was trying to explain that <em>{large (n × (n + 1) over 2}</em> is always an integer.<br>&emsp;&emsp;#+end_remark<br><br>&emsp;&emsp;;; ⟨1⟩ As a terse link, using default values for the args.<br>&emsp;&emsp;;;&emsp;&emsp; Notice that Org-mode formatting is recoqgnised even in links.<br>&emsp;&emsp;[ [remark:Jasim Jameson][Why are you taking about “<em>mathsf{even}</em>” here?]]<br><br>&emsp;&emsp;;; ⟨2⟩ So terse that no editor name is provided.<br>&emsp;&emsp;[ [remark:][Please improve your transition sentences.]]<br><br>&emsp;&emsp;;; ⟨★⟩ Unlike 0, examples 1 and 2 will have the default SIGNOFF<br>&emsp;&emsp;;; catenated as well as the default red color.<br><br>(fn NAME MAIN-ARG KWDS &optional EXPERIMENTAL DOCSTRING &rest BODY)">defblock</abbr>, which is similar in-spirit to Lisp's standard
<abbr class="tooltip" title="Define NAME as a function.<br>The definition is (lambda ARGLIST [DOCSTRING] BODY...).<br>See also the function ‘interactive’.<br>DECL is a declaration, optional, of the form (declare DECLS...) where<br>DECLS is a list of elements of the form (PROP . VALUES).&emsp;These are<br>interpreted according to ‘defun-declarations-alist’.<br>The return value is undefined.<br><br>(fn NAME ARGLIST &optional DOCSTRING DECL &rest BODY)">defun</abbr> except that where the latter defines functions, ours defines new
special blocks for Emacs' Org-mode &#x2014;as well as, simultaneously, defining new
Org link types. Besides the macro, the primary contribution of this effort is an
interface for special blocks that <i>admits</i> arguments and is familar to Org users
&#x2014;namely, we ‘try to reuse’ the familiar <code>src</code>-block interface, including
header-args, but for special blocks.
</p>

<p>
It is hoped that the ease of creating custom special blocks will be a gateway
for many Emacs users to start using Lisp.
</p>
<p>
<b><span style="color:green;">A 5-page PDF covering ELisp fundamentals</span></b> can be found <b><a href="https://alhassy.github.io/ElispCheatSheet/CheatSheet.pdf">here</a></b>.
</p>

<p>
This article is featured in EmacsConf2020, with slides <a href="https://alhassy.github.io/org-special-block-extras/emacs-conf-2020">here</a>:
No pictures, instead we use this system to make the  slides
have a variety of styling information; i.e., we write Org
and the result looks nice. “Look ma, no HTML required!”
</p>
</blockquote>


<div id="org618614f" class="figure">
<p><img src="images/minimal-working-example-multiforms.png" alt="minimal-working-example-multiforms.png" width="1000px" />
</p>
<p><span class="figure-number">Figure 1: </span>Write in Emacs using Org-mode, export beautifully to HTML or LaTeX</p>
</div>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Super Simple Intro to Emacs’ Org-mode
                      </font>
                    </strong>
                  </summary>
<p>
<a class="anchor" aria-hidden="true" id="Super-Simple-Intro-to-Emacs-Org-mode" href="#Super-Simple-Intro-to-Emacs-Org-mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16
   16" width="16" height="16"><path fill-rule="evenodd"
   d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69
   3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10
   5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0
   2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5
   0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55
   13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
Emacs’ Org-mode is an outliner, a rich markup language, spreadsheet tool,
literate programming system, and so much more. It is an impressive reason to
use Emacs (•̀ᴗ•́)و
</p>

<p>
Org-mode syntax is very <i>natural</i>; e.g., the following is Org-mode!
</p>

<div class="org-src-container">
<pre class="src src-org">+ Numbered and bulleted lists are as expected.
  - Do the things:
    1.  This first
    2.  This second
    44. [@44] This forty-fourth
  - =[@&#120003;]= at the beginning of an iterm forces
    list numbering to start at &#120003;
  - =[ ]= or =[X]= at the beginning for checkbox lists
  - Use =Alt &#8593;, &#8595;= to move items up and down lists;
    renumbering happens automatically.

+ Definitions lists:
   ~- term :: def~
+ Use a comment, such as =# separator=, between two lists
  to communicate that these are two lists that /happen/ to be
  one after the other. Or use any /non-indented/ text to split
  a list into two.

* My top heading, section
  words
** Child heading, subsection
  more words
*** Grandchild heading, subsubsection
    even more!
</pre>
</div>


<p>
<b>Export</b> In Emacs, press <kbd style="">C-c C-e h o</kbd> to obtain an HTML webpage ---<i>like this
one!</i>&#x2014; of the Org-mode markup; use <kbd style="">C-c C-e l o</kbd> to obtain a PDF rendition.
</p>

<p>
You can try Org-mode notation and see how it renders live at:
<a href="http://mooz.github.io/org-js/">http://mooz.github.io/org-js/</a>
</p>

<hr />

<p>
You make a heading by writing <code>* heading</code> at the start of a line, then you can
<abbr class="tooltip" style="border: none; text-decoration: none;" title="TAB ∷ org-cycle<br>TAB-action and visibility cycling for Org mode.<br><br>This is the command invoked in Org mode by the ‘TAB’ key.&emsp;Its main<br>purpose is outline visibility cycling, but it also invokes other actions<br>in special contexts.<br><br>When this function is called with a ‘C-u’ prefix, rotate the entire<br>buffer through 3 states (global cycling)<br>&emsp;1. OVERVIEW: Show only top-level headlines.<br>&emsp;2. CONTENTS: Show all headlines of all levels, but no body text.<br>&emsp;3. SHOW ALL: Show everything.<br><br>With a ‘C-u C-u’ prefix argument, switch to the startup visibility,<br>determined by the variable ‘org-startup-folded’, and by any VISIBILITY<br>properties in the buffer.<br><br>With a ‘C-u C-u C-u’ prefix argument, show the entire buffer, including<br>any drawers.<br><br>When inside a table, re-align the table and move to the next field.<br><br>When point is at the beginning of a headline, rotate the subtree started<br>by this line through 3 different states (local cycling)<br>&emsp;1. FOLDED:&emsp; Only the main headline is shown.<br>&emsp;2. CHILDREN: The main headline and the direct children are shown.<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; From this state, you can move to one of the children<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; and zoom in further.<br>&emsp;3. SUBTREE:&emsp;Show the entire subtree, including body text.<br>If there is no subtree, switch directly from CHILDREN to FOLDED.<br><br>When point is at the beginning of an empty headline and the variable<br>‘org-cycle-level-after-item/entry-creation’ is set, cycle the level<br>of the headline by demoting and promoting it to likely levels.&emsp;This<br>speeds up creation document structure by pressing ‘TAB’ once or several<br>times right after creating a new headline.<br><br>When there is a numeric prefix, go up to a heading with level ARG, do<br>a ‘show-subtree’ and return to the previous cursor position.&emsp;If ARG<br>is negative, go up that many levels.<br><br>When point is not at the beginning of a headline, execute the global<br>binding for ‘TAB’, which is re-indenting the line.&emsp;See the option<br>‘org-cycle-emulate-tab’ for details.<br><br>As a special case, if point is at the very beginning of the buffer, if<br>there is no headline there, and if the variable ‘org-cycle-global-at-bob’<br>is non-nil, this function acts as if called with prefix argument (‘C-u TAB’,<br>same as ‘S-TAB’) also when called without prefix argument.<br><br>(fn &optional ARG)"><kbd style="border-color: red">TAB</kbd></abbr> to fold/unfold its contents. A table of contents, figures, tables can be
requested as follows:
</p>
<div class="org-src-container">
<pre class="src src-org"># figures not implemented in the HTML backend
# The &#120003; is optional and denotes headline depth
#+toc: headlines &#120003;
#+toc: figures
#+toc: tables
</pre>
</div>

<hr />

<ul class="org-ul">
<li><p>
<b>Markup</b> elements can be nested.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Syntax</th>
<th scope="col" class="org-left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>/Emphasise/</code>, italics</td>
<td class="org-left"><i>Emphasise</i></td>
</tr>

<tr>
<td class="org-left"><code>*Strong*</code>, bold</td>
<td class="org-left"><b>Strong</b></td>
</tr>

<tr>
<td class="org-left"><code>*/very strongly/*</code>, bold italics</td>
<td class="org-left"><b><i>very strongly</i></b></td>
</tr>

<tr>
<td class="org-left"><code>=verbatim=</code>, monospaced typewriter</td>
<td class="org-left"><code>verbatim</code></td>
</tr>

<tr>
<td class="org-left"><code>+deleted+</code></td>
<td class="org-left"><del>deleted</del></td>
</tr>

<tr>
<td class="org-left"><code>_inserted_</code></td>
<td class="org-left"><span class="underline">inserted</span></td>
</tr>

<tr>
<td class="org-left"><code>super^{script}ed</code></td>
<td class="org-left">super<sup>script</sup>ed</td>
</tr>

<tr>
<td class="org-left"><code>sub_{scripted}ed</code></td>
<td class="org-left">sub<sub>scripted</sub>ed</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>Markup can span across multiple lines, by default no more than 2.</li>
<li>In general, markup cannot be ‘in the middle’ of a word.</li>
</ul></li>
<li>New lines demarcate paragraphs</li>
<li>Use <code>\\</code> to force line breaks without starting a new paragraph</li>
<li>Use <i>at least</i> 5 dashes, <code>-----</code>, to form a horizontal rule</li>
</ul>

<p>
<a href="https://github.com/alhassy/org-special-block-extras"><img src="https://img.shields.io/badge/org--special--block--extras-2.0-informational?logo=Gnu-Emacs"></a>
provides support for numerous other kinds of markup elements, such as <code>red:hello</code>
which becomes “ <span style="color:red;">hello</span> ”.
</p>

<hr />

<p>
<b>Working with tables</b>
</p>
<div class="org-src-container">
<pre class="src src-org">#+ATTR_HTML: :width 100%
#+name: my-tbl
#+caption: Example table
| Who? | What? |
|------+-------|
| me   | Emacs |
| you  | Org   |
</pre>
</div>

<p>
Note the horizontal rule makes a header row and is formed by typing <abbr class="tooltip" style="border: none; text-decoration: none;" title="doit ∷ <br>| -"><kbd style="border-color: red">doit</kbd></abbr> then
pressing <abbr class="tooltip" style="border: none; text-decoration: none;" title="TAB ∷ org-cycle<br>TAB-action and visibility cycling for Org mode.<br><br>This is the command invoked in Org mode by the ‘TAB’ key.&emsp;Its main<br>purpose is outline visibility cycling, but it also invokes other actions<br>in special contexts.<br><br>When this function is called with a ‘C-u’ prefix, rotate the entire<br>buffer through 3 states (global cycling)<br>&emsp;1. OVERVIEW: Show only top-level headlines.<br>&emsp;2. CONTENTS: Show all headlines of all levels, but no body text.<br>&emsp;3. SHOW ALL: Show everything.<br><br>With a ‘C-u C-u’ prefix argument, switch to the startup visibility,<br>determined by the variable ‘org-startup-folded’, and by any VISIBILITY<br>properties in the buffer.<br><br>With a ‘C-u C-u C-u’ prefix argument, show the entire buffer, including<br>any drawers.<br><br>When inside a table, re-align the table and move to the next field.<br><br>When point is at the beginning of a headline, rotate the subtree started<br>by this line through 3 different states (local cycling)<br>&emsp;1. FOLDED:&emsp; Only the main headline is shown.<br>&emsp;2. CHILDREN: The main headline and the direct children are shown.<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; From this state, you can move to one of the children<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; and zoom in further.<br>&emsp;3. SUBTREE:&emsp;Show the entire subtree, including body text.<br>If there is no subtree, switch directly from CHILDREN to FOLDED.<br><br>When point is at the beginning of an empty headline and the variable<br>‘org-cycle-level-after-item/entry-creation’ is set, cycle the level<br>of the headline by demoting and promoting it to likely levels.&emsp;This<br>speeds up creation document structure by pressing ‘TAB’ once or several<br>times right after creating a new headline.<br><br>When there is a numeric prefix, go up to a heading with level ARG, do<br>a ‘show-subtree’ and return to the previous cursor position.&emsp;If ARG<br>is negative, go up that many levels.<br><br>When point is not at the beginning of a headline, execute the global<br>binding for ‘TAB’, which is re-indenting the line.&emsp;See the option<br>‘org-cycle-emulate-tab’ for details.<br><br>As a special case, if point is at the very beginning of the buffer, if<br>there is no headline there, and if the variable ‘org-cycle-global-at-bob’<br>is non-nil, this function acts as if called with prefix argument (‘C-u TAB’,<br>same as ‘S-TAB’) also when called without prefix argument.<br><br>(fn &optional ARG)"><kbd style="border-color: red">TAB</kbd></abbr>. You can <abbr class="tooltip" style="border: none; text-decoration: none;" title="TAB ∷ org-cycle<br>TAB-action and visibility cycling for Org mode.<br><br>This is the command invoked in Org mode by the ‘TAB’ key.&emsp;Its main<br>purpose is outline visibility cycling, but it also invokes other actions<br>in special contexts.<br><br>When this function is called with a ‘C-u’ prefix, rotate the entire<br>buffer through 3 states (global cycling)<br>&emsp;1. OVERVIEW: Show only top-level headlines.<br>&emsp;2. CONTENTS: Show all headlines of all levels, but no body text.<br>&emsp;3. SHOW ALL: Show everything.<br><br>With a ‘C-u C-u’ prefix argument, switch to the startup visibility,<br>determined by the variable ‘org-startup-folded’, and by any VISIBILITY<br>properties in the buffer.<br><br>With a ‘C-u C-u C-u’ prefix argument, show the entire buffer, including<br>any drawers.<br><br>When inside a table, re-align the table and move to the next field.<br><br>When point is at the beginning of a headline, rotate the subtree started<br>by this line through 3 different states (local cycling)<br>&emsp;1. FOLDED:&emsp; Only the main headline is shown.<br>&emsp;2. CHILDREN: The main headline and the direct children are shown.<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; From this state, you can move to one of the children<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; and zoom in further.<br>&emsp;3. SUBTREE:&emsp;Show the entire subtree, including body text.<br>If there is no subtree, switch directly from CHILDREN to FOLDED.<br><br>When point is at the beginning of an empty headline and the variable<br>‘org-cycle-level-after-item/entry-creation’ is set, cycle the level<br>of the headline by demoting and promoting it to likely levels.&emsp;This<br>speeds up creation document structure by pressing ‘TAB’ once or several<br>times right after creating a new headline.<br><br>When there is a numeric prefix, go up to a heading with level ARG, do<br>a ‘show-subtree’ and return to the previous cursor position.&emsp;If ARG<br>is negative, go up that many levels.<br><br>When point is not at the beginning of a headline, execute the global<br>binding for ‘TAB’, which is re-indenting the line.&emsp;See the option<br>‘org-cycle-emulate-tab’ for details.<br><br>As a special case, if point is at the very beginning of the buffer, if<br>there is no headline there, and if the variable ‘org-cycle-global-at-bob’<br>is non-nil, this function acts as if called with prefix argument (‘C-u TAB’,<br>same as ‘S-TAB’) also when called without prefix argument.<br><br>(fn &optional ARG)"><kbd style="border-color: red">TAB</kbd></abbr> between cells.
</p>

<hr />

<p>
<b>Working with links</b>
</p>

<p>
Link syntax is <code>[[source url][description]]</code>; e.g., we can refer to the above
table with <code>[[my-tbl][woah]]</code>.
Likewise for images: <code>file:path-to-image.</code>
</p>

<hr />

<p>
<b>Mathematics</b>
</p>

<div style="column-rule-style: none;column-count: 2;">
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>
<div ><pre class="src src-org">\[ \sin^2 x + \cos^2 x = \int_\pi^{\pi + 1} 1 dx = {3 \over 3} \]
</pre></div>
</div>
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
<p>
\[ \sin^2 x + \cos^2 x = \int_\pi^{\pi + 1} 1 dx = {3 \over 3} \]
</p>

</div>
</div>
<ul class="org-ul">
<li>Instead of <code>\[...\]</code>, which displays a formula on its own line, centred, use
<code>$...$</code> to show a formula inline.</li>
<li>Captioned equations are numbered and can be referenced via links,
as shown below.</li>
</ul>

<div style="column-rule-style: none;column-count: 2;">
<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>
<div ><pre class="src src-org">#+name: euler
\begin{equation}
e ^ {i \pi} + 1 = 0
\end{equation}

See equation [[euler]].
</pre></div>
</div>
<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
\begin{equation}
\label{orgbd8d171}
e ^ {i \pi} + 1 = 0
\end{equation}

<p>
See equation \eqref{orgbd8d171}.
</p>

</div>
</div>
<hr />

<p>
<b>Source code</b>
</p>
<div style="column-rule-style: none;column-count: 2;">
<div style="padding: 1em; background-color: #FFFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>
<div ><pre class="src src-org">#+BEGIN_SRC C -n
int tot = 1;                    (ref:start)
for (int i = 0; i != 10; i++)   (ref:loop)
   tot *= i;                    (ref:next)
printf("The factorial of 10 is %d", tot);
#+END_SRC
</pre></div>
</div>
<div style="padding: 1em; background-color: #FFFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
<div class="org-src-container">
<pre class="src src-C"><span id="coderef-start" class="coderef-off"><span class="linenr">1: </span><span style="color: #b58900; font-style: italic;">int</span> <span style="color: #268bd2;">tot</span> = 1; (start)</span>
<span id="coderef-loop" class="coderef-off"><span class="linenr">2: </span><span style="color: #859900; font-weight: bold;">for</span> (<span style="color: #b58900; font-style: italic;">int</span> <span style="color: #268bd2;">i</span> = 0; i != 10; i++) (loop)</span>
<span id="coderef-next" class="coderef-off"><span class="linenr">3: </span>   tot *= i; (next)</span>
<span class="linenr">4: </span>printf(<span style="color: #2aa198;">"The factorial of 10 is %d"</span>, tot);
</pre>
</div>

</div>
</div>
<p>
The labels <code>(ref:name)</code> refer to the lines in the source code and can be
referenced with link syntax: <code>[[(name)]]</code>. Hovering over the link, in the HTML
export, will dynamically highlight the corresponding line of code.  To strip-out
the labels from the displayed block, use <code>-r -n</code> in the header so it becomes
<code>#+begin_src C -r -n</code>, now the references become line numbers.
</p>

<hr />

<p>
Another reason to use Org:
If you use <code>:results raw</code>, you obtain <b>dynamic templates</b> that may use Org-markup:
</p>
<div style="column-rule-style: none;column-count: 2;">
<div style="padding: 1em; background-color: #CCCC99;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>
<div ><pre class="src src-org">#+BEGIN_SRC C
printf("*bold* +%d+ (strikethrough) /slanted/", 12345);
#+END_SRC

♯+RESULTS:
*bold* +12345+ (strikethrough) /slanted/
</pre></div>
</div>
<div style="padding: 1em; background-color: #CCCC99;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
<div class="org-src-container">
<pre class="src src-C">printf(<span style="color: #2aa198;">"*bold* +%d+ (strikethrough) /slanted/"</span>, 12345);
</pre>
</div>

<p>
♯+RESULTS:
<b>bold</b> <del>12345</del> (strikethrough) <i>slanted</i>
</p>

</div>
</div>
<p>
The <code>#+RESULTS:</code> is obtained by pressing <abbr class="tooltip" style="border: none; text-decoration: none;" title="C-c C-c ∷ org-ctrl-c-ctrl-c<br>Set tags in headline, or update according to changed information at point.<br><br>This command does many different things, depending on context:<br><br>- If column view is active, in agenda or org buffers, quit it.<br><br>- If there are highlights, remove them.<br><br>- If a function in ‘org-ctrl-c-ctrl-c-hook’ recognizes this location,<br>&emsp;this is what we do.<br><br>- If the cursor is on a statistics cookie, update it.<br><br>- If the cursor is in a headline, in an agenda or an org buffer,<br>&emsp;prompt for tags and insert them into the current line, aligned<br>&emsp;to ‘org-tags-column’.&emsp;When called with prefix arg, realign all<br>&emsp;tags in the current buffer.<br><br>- If the cursor is in one of the special #+KEYWORD lines, this<br>&emsp;triggers scanning the buffer for these lines and updating the<br>&emsp;information.<br><br>- If the cursor is inside a table, realign the table.&emsp;This command<br>&emsp;works even if the automatic table editor has been turned off.<br><br>- If the cursor is on a #+TBLFM line, re-apply the formulas to<br>&emsp;the entire table.<br><br>- If the cursor is at a footnote reference or definition, jump to<br>&emsp;the corresponding definition or references, respectively.<br><br>- If the cursor is a the beginning of a dynamic block, update it.<br><br>- If the current buffer is a capture buffer, close note and file it.<br><br>- If the cursor is on a <<<target>>>, update radio targets and<br>&emsp;corresponding links in this buffer.<br><br>- If the cursor is on a numbered item in a plain list, renumber the<br>&emsp;ordered list.<br><br>- If the cursor is on a checkbox, toggle it.<br><br>- If the cursor is on a code block, evaluate it.&emsp;The variable<br>&emsp;‘org-confirm-babel-evaluate’ can be used to control prompting<br>&emsp;before code block evaluation, by default every code block<br>&emsp;evaluation requires confirmation.&emsp;Code block evaluation can be<br>&emsp;inhibited by setting ‘org-babel-no-eval-on-ctrl-c-ctrl-c’.<br><br>(fn &optional ARG)"><kbd style="border-color: red">C-c C-c</kbd></abbr> on the <code>src</code> block, to execute
it and obtain its result.
</p>

<p>
Also: Notice that a C program can be run without a <code>main</code> ;-)
</p>

<p>
That is, we can write code <i>in between</i> prose that is intended to be read like an
essay:
</p>


<div id="orga89bb74" class="figure">
<p><img src="../.emacs.d/https:/alhassy.github.io/emacs.d/images/literate-programming.png" alt="literate-programming.png" />
</p>
</div>

<hr />

<ul class="org-ul">
<li><a href="https://alhassy.github.io/emacs.d/CheatSheet.pdf"><img src="https://img.shields.io/badge/Lifemacs-CheatSheet-informational?logo=Gnu-Emacs"></a>
⇒ A brief reference of Emacs keybindings; 2 pages</li>
<li><a href="https://alhassy.github.io/ElispCheatSheet/CheatSheet.pdf"><img src="https://img.shields.io/badge/Elisp-CheatSheet-success?logo=Gnu-Emacs"></a> ⇒ A <i>compact</i> Emacs Lisp Reference; 7 pages</li>
</ul>

<hr />

<p>
<b>Single source of truth:</b> This mini-tutorial can be included into other Org files
by declaring
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>#+include: ~/.emacs.d/init.org::#Mini-tutorial-on-Org-mode</code></td>
</tr>
</tbody>
</table>

<hr />

<p>
For more, see <a href="https://orgmode.org/features.html">https://orgmode.org/features.html</a>.
</p>


</details>

<!--
<blockquote>
<p>
The full article may be read as a <a href="https://alhassy.github.io/org-special-block-extras/index.pdf">PDF</a> or as <a href="https://alhassy.github.io/org-special-block-extras">HTML</a> &#x2014;or visit the <a href="https://github.com/alhassy/org-special-block-extras">repo</a>.
Installation instructions are <a href="#Summary">below</a>.
</p>
</blockquote>
-->

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#A-unified-interface-for-special-blocks-and-links-defblock">1. <a href="#A-unified-interface-for-special-blocks-and-links-defblock">A unified interface for special blocks and links: <code>defblock</code></a></a>
<ul>
<li><a href="#What-is-a-special-block">1.1. <a href="#What-is-a-special-block">  <i>What is a special block?</i></a></a></li>
<li><a href="#Links">1.2. <a href="#Links">  <i>How do I make a new link type?</i></a></a></li>
<li><a href="#The-Core-Utility-defblock-and-friends">1.3. <a href="#The-Core-Utility-defblock-and-friends">The Core Utility: <code>defblock</code> and friends</a></a></li>
<li><a href="#modularity_with_thread-blockcall">1.4. <a href="#modularity_with_thread-blockcall">Modularity with <code>thread-blockcall</code></a></a></li>
<li><a href="#practice_problems">1.5. <a href="#practice_problems">Practice Problems: <i>Now you try!</i></a></a></li>
<li><a href="#Whats_the_rest_of_this_article_about?">1.6. <a href="#Whats_the_rest_of_this_article_about?">What's the rest of this article about?</a></a></li>
</ul>
</li>
<li><a href="#editor-comments">2. <a href="#editor-comments">Editor Comments</a></a></li>
<li><a href="#Folded-Details">3. <a href="#Folded-Details">Folded Details &#x2014;As well as boxed text and subtle colours</a></a>
<ul>
<li><a href="#Example">3.1. <a href="#Example">Example: <i>Here's a nifty puzzle, can you figure it out?</i></a></a></li>
<li><a href="#Boxed-Text">3.2. <a href="#Boxed-Text">Boxed Text</a></a></li>
</ul>
</li>
<li><a href="#Parallel">4. <a href="#Parallel">Parallel</a></a></li>
<li><a href="#Colours">5. <a href="#Colours">Colours</a></a>
<ul>
<li><a href="#latex-definitions-for-hiding-LaTeX-declarations-in-HTML">5.1. <a href="#latex-definitions-for-hiding-LaTeX-declarations-in-HTML">  <code>latex-definitions</code> for hiding LaTeX declarations in HTML</a></a></li>
</ul>
</li>
<li><a href="#kbd:nice-keystroke-renditions">6. <a href="#kbd:nice-keystroke-renditions">Nice Keystroke Renditions: kbd:C-h_h</a></a></li>
<li><a href="#Link-Here-OctoIcons">7. <a href="#Link-Here-OctoIcons">  <i>“Link Here!”</i> &amp; OctoIcons</a></a></li>
<li><a href="#Badge-Links">8. <a href="#Badge-Links">Badge Links</a></a>
<ul>
<li><a href="#Example-Badges">8.1. <a href="#Example-Badges">Example Badges</a></a></li>
<li><a href="#Example-Colours">8.2. <a href="#Example-Colours">Example Colours</a></a></li>
<li><a href="#Example-Badge-Icons">8.3. <a href="#Example-Badge-Icons">Example Badge Icons</a></a></li>
<li><a href="#Common-Project-Badges">8.4. <a href="#Common-Project-Badges">Common Project Badges &#x2014;with copyable source</a></a></li>
<li><a href="#Next-Steps-badges">8.5. <a href="#Next-Steps-badges">Next Steps</a></a></li>
</ul>
</li>
<li><a href="#Tooltips-for-Glossaries-Dictionaries-and-Documentation">9. <a href="#Tooltips-for-Glossaries-Dictionaries-and-Documentation">Tooltips for Glossaries, Dictionaries, and Documentation</a></a>
<ul>
<li><a href="#The-doc-link-type">9.1. <a href="#The-doc-link-type">Implementation Details: <code>doc</code> link, <code>documentation</code> block, and tooltipster</a></a></li>
<li><a href="#hola">9.2. <a href="#hola">Wait, what about the LaTeX?</a></a></li>
<li><a href="#Next-Steps-tooltips">9.3. <a href="#Next-Steps-tooltips">Next Steps</a></a></li>
</ul>
</li>
<li><a href="#Marginal-one-off-remarks">10. <a href="#Marginal-one-off-remarks">Marginal, “one-off”, remarks</a></a></li>
<li><a href="#Equational-Proofs">11. <a href="#Equational-Proofs">Equational Proofs</a></a></li>
<li><a href="#Summary">12. <a href="#Summary">Summary</a></a>
<ul>
<li><a href="#Installation-Instructions">12.1. <a href="#Installation-Instructions">Installation Instructions</a></a></li>
<li><a href="#Minimal-working-example">12.2. <a href="#Minimal-working-example">Minimal working example</a></a></li>
<li><a href="#Bye">12.3. <a href="#Bye">Bye!</a></a></li>
</ul>
</li>
</ul>
</div>
</div>
<blockquote>
<p>
The full article may be read as a <a href="https://alhassy.github.io/org-special-block-extras/index.pdf">PDF</a> or as <a href="https://alhassy.github.io/org-special-block-extras">HTML</a> &#x2014;or visit the <a href="https://github.com/alhassy/org-special-block-extras">repo</a>.
Installation instructions are <a href="#Summary">below</a>.
</p>
</blockquote>

<div id="outline-container-A-unified-interface-for-special-blocks-and-links-defblock" class="outline-2">
<h2 id="A-unified-interface-for-special-blocks-and-links-defblock"><span class="section-number-2">1</span> <a href="#A-unified-interface-for-special-blocks-and-links-defblock">A unified interface for special blocks and links: <code>defblock</code></a></h2>
<div class="outline-text-2" id="text-A-unified-interface-for-special-blocks-and-links-defblock">
<p>
An Org-mode block of type 𝒳 is a bunch of text enclosed in <code>#+begin_𝒳</code> and
<code>#+end_𝒳</code>, upon export it modifies the text &#x2014;e.g., to center it, or to display
it as code. We show how to make <i>new</i> blocks using a simple interface
---<abbr class="tooltip" title="Declare a new special block, and link, in the style of DEFUN.<br><br>A full featured example is at the end of this documentation string.<br><br>This is an anaphoric macro that provides export support for<br>special blocks <strong>and</strong> links named NAME. Just as an Org-mode<br>src-block consumes as main argument the language for the src<br>block, our special blocks too consume a MAIN-ARG; it may be a<br>symbol or a cons-list consisting of a symbolic name (with which<br>to refer to the main argument in the definition of the block)<br>followed by a default value, then, optionally, any information<br>for a one-time setup of the associated link type.<br><br>The main arg may be a sequence of symbols separated by spaces,<br>and a few punctuation with the exception of comma ‘,’ since it is<br>a special Lisp operator. In doubt, enclose the main arg in<br>quotes.<br><br>Then, just as Org-mode src blocks consume key-value pairs, our<br>special blocks consume a number of KWDS, which is a list of the<br>form (key₀ value₀ … keyₙ valueₙ).<br><br>After that is an optional DOCSTRING, a familar feature of DEFUN.<br>The docstring is displayed as part of the tooltip for the<br>produced link type.<br><br>Finally, the BODY is a (sequence of) Lisp forms ---no progn<br>needed--- that may refer to the names BACKEND and CONTENTS which<br>refer to the current export backend and the contents of the<br>special block ---or the description clause of a link.<br><br>CONTENTS refers to an Org-mode parsed string; i.e., Org-markup is<br>acknowledged.<br><br>In, hopefully, rare circumstances, one may refer to RAW-CONTENTS<br>to look at the fully unparsed contents.<br><br>Finally, this macro exposes two functions:<br>+ ORG-EXPORT: Wrap the argument in an export block for the current backend.<br>+ ORG-PARSE: This should ONLY be called within an ORG-EXPORT call,<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; to escape text to Org, and out of the export block.<br><br><hr><br><br>TLDR for EXPERIMENTAL and DOCSTRING and BODY, the first two parts are<br>optional; they’re a symbol, a string, then the main body.&emsp;The<br>symbol, O-RESPECT-NEWLINES?, when present enables a highly<br>experimental [i.e., do <strong>not</strong> use it!] feature: No new lines for<br>blocks in HTML export.&emsp;Its need rose from developing the MARGIN<br>block type.<br><br><hr><br><br>The relationship between links and special blocks:<br><br>&emsp;[ [type:label][description]]<br>≈<br>&emsp; #+begin_type label<br>&emsp;&emsp;description<br>&emsp; #+end_type<br><br><hr><br><br>Example declaration, with all possible features shown:<br><br>&emsp; ;; We can use variable values when defining new blocks<br>&emsp; (setq angry-red ’(:foreground ''red'' :weight bold))<br><br>&emsp; (defblock remark<br>&emsp;&emsp; (editor ''Editor Remark'' :face angry-red) (color ''red'' signoff '''')<br>&emsp;&emsp; ''Top level (HTML & LaTeX)O-RESPECT-NEWLINES? editorial remarks; in Emacs they’re angry red.''<br>&emsp;&emsp; (format (if (equal backend ’html)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''<strong style=\''color: %s;\''>⟦%s:&emsp;%s%s⟧</strong>''<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''{\color{%s}\bfseries %s:&emsp;%s%s}'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; color editor contents signoff))<br><br>&emsp; ;; I don’t want to change the definition, but I’d like to have<br>&emsp; ;; the following as personalised defaults for the “remark” block.<br>&emsp; ;; OR, I’d like to set this for links, which do not have argument options.<br>&emsp; (defblock-header-args remark :main-arg ''Jasim Jameson'' :signoff ''( Aim for success! )'')<br><br>Three example uses:<br><br>&emsp;&emsp;;; ⟨0⟩ As a special blocks with arguments given.<br>&emsp;&emsp;#+begin_remark Bobbert Barakallah :signoff ''Thank-you for pointing this out!'' :color green<br>&emsp;&emsp;I was trying to explain that <em>{large (n × (n + 1) over 2}</em> is always an integer.<br>&emsp;&emsp;#+end_remark<br><br>&emsp;&emsp;;; ⟨1⟩ As a terse link, using default values for the args.<br>&emsp;&emsp;;;&emsp;&emsp; Notice that Org-mode formatting is recoqgnised even in links.<br>&emsp;&emsp;[ [remark:Jasim Jameson][Why are you taking about “<em>mathsf{even}</em>” here?]]<br><br>&emsp;&emsp;;; ⟨2⟩ So terse that no editor name is provided.<br>&emsp;&emsp;[ [remark:][Please improve your transition sentences.]]<br><br>&emsp;&emsp;;; ⟨★⟩ Unlike 0, examples 1 and 2 will have the default SIGNOFF<br>&emsp;&emsp;;; catenated as well as the default red color.<br><br>(fn NAME MAIN-ARG KWDS &optional EXPERIMENTAL DOCSTRING &rest BODY)">defblock</abbr>&#x2014; that lets users treat 𝒳 as a string-valued function in the style
of <abbr class="tooltip" title="Define NAME as a function.<br>The definition is (lambda ARGLIST [DOCSTRING] BODY...).<br>See also the function ‘interactive’.<br>DECL is a declaration, optional, of the form (declare DECLS...) where<br>DECLS is a list of elements of the form (PROP . VALUES).&emsp;These are<br>interpreted according to ‘defun-declarations-alist’.<br>The return value is undefined.<br><br>(fn NAME ARGLIST &optional DOCSTRING DECL &rest BODY)">defun</abbr>.
</p>

<p>
The notable features of the system are as follows.
</p>

<ul class="org-ul">
<li>Familiar <code>defun</code> syntax for making block ---<code>defblock</code></li>
<li>Familiar <code>src</code> syntax for passing arguments &#x2014;e.g., <code>:key value</code></li>
<li>Modular: New blocks can be made out of existing blocks really quickly using
<code>blockcall</code> &#x2014;similar to Lisp's <code>funcall</code>.</li>
</ul>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         EmacsConf 2020 Abstract
                      </font>
                    </strong>
                  </summary>

<p>
Users will generally only make use of a few predefined <i>special blocks</i>, such as
<code>example, centre, quote</code>, and will not bother with the effort required to make new
ones. When new encapsulating notions are required, users will either fallback on
HTML or LaTeX specific solutions, usually littered with <code>#+ATTR</code> clauses to pass
around configurations or parameters.
</p>

<p>
Efforts have been exerted to mitigate the trouble of producing new special
blocks. However, the issue of passing parameters is still handled in a clumsy
fashion; e.g., by having parameters be expressed in a special block's content
using specific keywords.
</p>

<p>
We present a novel approach to making special blocks in a familiar fashion and
their use also in a familiar fashion. We achieve the former by presenting
<code>defblock</code>, an anaphoric macro exceedingly similar to <code>defun</code>, and for the latter we
mimic the usual <code>src</code>-block syntax for argument passing to support special blocks.
</p>

<p>
For instance, here is a sample declaration.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defblock stutter () (reps 2)
  <span style="color: #2aa198;">"Output the CONTENTS of the block REPS many times"</span>
  (org-parse (<span style="color: #b58900;">s-repeat</span> reps contents)))
</pre>
</div>

<p>
Here is an invocation that passes an optional argument; which defaults to 2 when
not given.
</p>

<pre class="example" id="orgb6c6f56">
#+begin_stutter 5
Emacs for the win :-)
#+end_stutter 5
</pre>

<p>
Upon export, to HTML or LaTeX for instance, the contents of this block are
repeated (<i>stuttered</i>) 5 times. The use of <code>src</code>-like invocation may lead to a
decrease in <code>#+ATTR</code> clauses.
</p>

<p>
In the presentation, we aim to show a few <b>practical</b> special blocks that users
may want: A block that …
</p>

<ul class="org-ul">
<li>translates <i>some selected</i> text &#x2014;useful for multilingual blogs</li>
<li>hides <i>some selected</i> text &#x2014;useful for learning, quizzes</li>
<li>folds/boxes text &#x2014;useful in blogs for folding away details</li>
</ul>

<p>
In particular, all of these examples will be around ~5 lines long!
</p>

<p>
We also have a larger collection of more useful block types, already implemented.
</p>

<p>
The notable features of the system are as follows.
</p>

<ul class="org-ul">
<li>Familiar <code>defun</code> syntax for making block ---<code>defblock</code></li>
<li>Familiar <code>src</code> syntax for passing arguments —e.g., <code>:key value</code></li>
<li>Fine-grained control over export translation phases &#x2014;c.f., <code>org-parse</code> above</li>
<li>Modular: New blocks can be made out of existing blocks really quickly using
<code>blockcall</code> &#x2014;similar to Lisp's <code>funcall</code>. We will show how to fuse two blocks to
make a new one, also within ~5 lines.</li>
</ul>

<p>
<b><span style="color:blue;">It is hoped that the ease of creating custom special blocks will be a gateway for many Emacs users to start using Lisp.</span></b>
</p>

</details>
</div>

<div id="outline-container-What-is-a-special-block" class="outline-3">
<h3 id="What-is-a-special-block"><span class="section-number-3">1.1</span> <a href="#What-is-a-special-block">  <i>What is a special block?</i></a></h3>
<div class="outline-text-3" id="text-What-is-a-special-block">
<p>
An Org mode block is a region of text surrounded by <code>#+BEGIN_𝒳 … #+END_𝒳</code>; they
serve various purposes as summarised in the table below.  However, we shall
<b>use such blocks to execute arbitrary code on their contents</b>.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">𝒳</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>example</code></td>
<td class="org-left">Format text verbatim, leaving markup as is</td>
</tr>

<tr>
<td class="org-left"><code>src</code></td>
<td class="org-left">Format source code</td>
</tr>

<tr>
<td class="org-left"><code>center</code></td>
<td class="org-left">Centre text</td>
</tr>

<tr>
<td class="org-left"><code>quote</code></td>
<td class="org-left">Format text as a quotation &#x2014;ignore line breaks</td>
</tr>

<tr>
<td class="org-left"><code>verse</code></td>
<td class="org-left">Every line is appended with a line break</td>
</tr>

<tr>
<td class="org-left"><code>tiny</code></td>
<td class="org-left">Render text in a small font; likewise <code>footnotesize</code></td>
</tr>

<tr>
<td class="org-left"><code>comment</code></td>
<td class="org-left">Completely omit the text from export</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>They can be folded and unfolded in Emacs by pressing TAB in the <code>#+BEGIN</code> line.</li>
<li>The contents of blocks can be highlighted as if they were of language ℒ such
as <code>org, html, latex, haskell, lisp, python, …</code> by writing <code>#+BEGIN_𝒳 ℒ</code> on the
starting line, where <code>𝒳</code> is the name of the block type.</li>
<li>Verbatim environments <code>src</code> and <code>example</code> may be followed by switch <code>-n</code> to
display line numbers for their contents.</li>
</ul>

<p>
I use <a href="https://github.com/alhassy/emacs.d#org-mode-templates-a-reason-i-generate-templates-">snippets in my init</a> to quickly insert special blocks (•̀ᴗ•́)و
</p>

<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3></h3>
<p>
You can ‘zoom in temporarily’, <i>narrowing</i> your focus to only on a particular
block, with <abbr class="tooltip" title="Narrow buffer to current element.">org-narrow-to-element</abbr>, <code>C-x n e</code>, to make your window only show
the block.  Then use <code>C-x n w</code> to <i>widen</i> your vision of the buffer's contents.
</p>

</div>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Warning! Special blocks of the same kind do not nest!
                      </font>
                    </strong>
                  </summary>
<p>
By their very nature, special blocks of <i>the same name</i> cannot be nested &#x2014;e.g.,
try to put one <code>quote</code> block within another and see what (does not) happen.
</p>

<p>
Moreover, special blocks cannot contain unicode in their names and no
underscore, ‘_’, in their names; e.g., a special block named <code>quote₀</code> will
actually refer to <code>quote</code>.
</p>


</details>

<p>
Our goal is to turn Org blocks into LaTeX environments and HTML divs.
</p>

<p>
Why not use LaTeX or HTML environments directly?
</p>
<ul class="org-ul">
<li>Can no longer use Org markup in such settings.</li>
<li>Committed to one specific export type.</li>
</ul>

<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Aside:</strong></span>
<p>
The export syntax <code>@@backend: 𝒳@@</code> inserts text 𝒳 literally as-is precisely when
the current backend being exported to is <code>backend</code>. This is useful for inserting
<code>html</code> snippets or <code>latex</code> commands. We can use <code>@@comment: 𝒳@@</code> to mimic inline
comments ;-)  &#x2014;Since there is [hopefully] no backend named <code>comment</code>.
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>

<div style="padding: 1em; background-color: #CCFFFF;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3></h3>
<div style="column-rule-style: none;column-count: 3;">
<p>
In general, a “special block” such as
</p>
<pre class="example" id="org4fae9df">
   #+begin_𝒳
   I /love/ Emacs!
   #+end_𝒳
</pre>

<p>
<p><br>
</p>

<p>
Exports to LaTeX as:
</p>
<div class="org-src-container">
<pre class="src src-latex">   <span style="color: #859900; font-weight: bold;">\begin</span>{<span style="color: #b58900;">&#119987;</span>}
   I <span style="color: #859900; font-weight: bold;">\emph</span>{<span style="font-style: italic;">love</span>} Emacs!
   <span style="color: #859900; font-weight: bold;">\end</span>{<span style="color: #b58900;">&#119987;</span>}
</pre>
</div>

<p>
<p><br>
</p>

<p>
Exports to HTML as:
</p>
<div class="org-src-container">
<pre class="src src-html">   &lt;<span style="color: #b58900;">div</span> <span style="color: #268bd2;">class</span>=<span style="color: #2aa198;">"&#119987;"</span>&gt;
   I &lt;<span style="color: #b58900;">em</span>&gt;<span style="font-style: italic;">love</span>&lt;/<span style="color: #b58900;">em</span>&gt; Emacs!
   &lt;/<span style="color: #b58900;">div</span>&gt;
</pre>
</div>

</div>

</div>

<div class="org-center">
<p>
<i>Notice that the standard org markup is also translated according to the export
type.</i>
</p>
</div>

<p>
If the <code>𝒳</code> environment exists in a backend &#x2014;e.g., by some <code>\usepackage{⋯}</code> or
manually with
<code>\newenvironment{𝒳}{⋯}{⋯}</code> in LaTeX&#x2014; then the file will compile
without error.  Otherwise, you need to ensure it exists &#x2014;e.g., by defining the
backend formatting manually yourself.
</p>

<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Aside:</strong></span>
<p>
LaTeX packages that a user needs consistently are declared in the
 list <code>org-latex-packages-alist</code>. See its documentation, with <code>C-h o</code>,
to learn more.  To export to your own LaTeX classes, <code>C-h o org-latex-classes</code>.
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
<div style="padding: 1em; background-color: #FFCCFF;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>What is an HTML ‘div’?</h3>
<p>
A <code>div</code> tag defines a division or a section in an HTML document that is styled in
a particular fashion or has JavaScript code applied to it.  For example
&#x2014;placing the following in an <code>#+begin_export html ⋯ #+end_export</code>&#x2014; results in
a section of text that is editable by the user &#x2014;i.e., one can just alter text
in-place&#x2014; and its foreground colour is red, while its background colour is
light blue, and it has an uninformative tooltip.
</p>
<div style="column-rule-style: none;column-count: 2;">
<p>
<span class="underline">Source</span>
</p>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #b58900;">div</span> <span style="color: #268bd2;">contenteditable</span>=<span style="color: #2aa198;">"true"</span>
     <span style="color: #268bd2;">title</span>=<span style="color: #2aa198;">"woah, a tool tip!"</span>
     <span style="color: #268bd2;">style</span>=<span style="color: #2aa198;">"color:red; background-color:lightblue"</span>&gt;
This is <span style="text-decoration: underline;">some</span> editable text! Click me &amp; type!
&lt;/<span style="color: #b58900;">div</span>&gt;
</pre>
</div>

<br>
<p>
<span class="underline">Result</span>
</p>
<br><br>

<div contenteditable="true"
     title="woah, a tool tip!"
     style="color:red; background-color:lightblue">
This is some editable text! Click me & type!
</div>

</div>

</div>

<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>What is a CSS ‘class’?</h3>
<p>
To use a collection of style settings repeatedly, we may declare them in a <code>class</code>
&#x2014;which is just an alias for the ;-separated list of <code>attribute:value</code>
pairs. Then our <code>div</code>'s refer to that particular <code>class</code> name.
</p>

<div style="column-rule-style: solid;column-count: 2;">
<p>
For example, in an HTML export block, we may declare the following style class
named <code>red</code>.
</p>
<pre class="example" id="orgd24e260">
#+begin_export html
&lt;style&gt;
.red { color:red; }
&lt;/style&gt;
#+end_export
</pre>

<p>
<p><br>
</p>

<p>
Now, the above syntax with <code>𝒳</code> replaced by <code>red</code> works as desired in HTML export:
HTML now knows of a class named <code>red</code>.
</p>

<br><hr>
<p>
For instance, now this
</p>
<div class="org-src-container">
<pre class="src src-C">#+begin_red
I /love/ Emacs<span style="color: #268bd2; font-weight: bold;">!</span>
#+end_red
</pre>
</div>
<p>
Results in:
</p>
<span style="color:red;">
<p>
I <i>love</i> Emacs!
</p>

</span>
<hr>

<p>
This approach, however, will not work if we want to produce LaTeX and so
requires a duplication of efforts. We would need to declare such formatting once
for each backend.
</p>


</div>

</div>
</div>
</div>
<div id="outline-container-Links" class="outline-3">
<h3 id="Links"><span class="section-number-3">1.2</span> <a href="#Links">  <i>How do I make a new link type?</i></a></h3>
<div class="outline-text-3" id="text-Links">
<div class="org-center">
<p>
<i>Sometimes using a block is too verbose and it'd be better to ‘inline’ it; for
this, we use Org's link mechanism.</i>
</p>
</div>

<div style="padding: 1em; background-color: #FFFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>What would I use links for?</h3>
<dl class="org-dl">
<dt>Buttons</dt><dd><p>
<code>[[elisp:(find-file user-init-file)][Go to my init!]]</code> is a nice
clickable-<i>actionable</i> button within Emacs. The <code>elisp</code> link is part of Emacs.
</p>

<br></dd>

<dt>Textual expansions</dt><dd><p>
<code>show:user-full-name</code> expands, upon export, to <i>Musa
Al-hassy</i> on my machine. Or maybe we want a splash of colour in our lives:
<code>*&lt;pink: super neato stuff&gt;*</code> becomes <b><span style="color:pink;"> super neato stuff</span></b>.
</p>

<p>
Similarly, <code>link-here:usefulness-of-links</code> becomes:
<a class="anchor" aria-hidden="true" id="usefulness-of-links" href="#usefulness-of-links"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16
   16" width="16" height="16"><path fill-rule="evenodd"
   d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69
   3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10
   5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0
   2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5
   0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55
   13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>. When you click on it, the URL of the webpage
changes: It is a local anchor to a possibly interesting location in your
article. Similarly, <code>octoicon:home</code> becomes <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M16 9l-3-3V2h-2v2L8 1 0 9h2l1 5c0 .55.45 1 1 1h8c.55 0 1-.45 1-1l1-5h2zm-4 5H9v-4H7v4H4L2.81 7.69 8 2.5l5.19 5.19L12 14z"></path></svg>; <abbr class="tooltip" title="Show an OctoIcon: home, link, mail, report, tag, clock">o-link/octoicon</abbr>.
</p>

<p>
More aesthetically, <code>&lt;badge: Emacs | is awesome | blue |
  https://www.google.com/search?q=hello%20world | gnu-emacs&gt;</code> exports to <a href="https://www.google.com/search?q=hello%20world"><img src="https://img.shields.io/badge/Emacs-is%20awesome-blue?logo=gnu-emacs"></a>.
</p>

<p>
These link types are all defined below.
</p>

<br></dd>

<dt>Definitions / Personal Glossary</dt><dd><p>
<code>doc:thread-first, doc:family, doc:Hussain</code>
export as the link labels but with tooltips for the Lisp function
<abbr class="tooltip" title="Thread FORMS elements as the first argument of their successor.<br>Example:<br>&emsp;&emsp;(thread-first<br>&emsp;&emsp;&emsp;5<br>&emsp;&emsp;&emsp;(+ 20)<br>&emsp;&emsp;&emsp;(<em> 25)<br>&emsp;&emsp;&emsp;-<br>&emsp;&emsp;&emsp;(+ 40))<br>Is equivalent to:<br>&emsp;&emsp;(+ (- (</em> (+ 5 20) 25)) 40)<br>Note how the single ‘-’ got converted into a list before<br>threading.<br><br>(fn &rest FORMS)">thread-first</abbr>, for the English definition of <abbr class="tooltip" title="<br>Overview of noun family<br><br>The noun family has 8 senses (first 6 from tagged texts)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; <br>1. (66) family, household, house, home, menage -- (a social unit living together; ''he moved his family to Virginia''; ''It was a good Christian household''; ''I waited until the whole house was asleep''; ''the teacher asked how many people made up his home'')<br>2. (52) family, family unit -- (primary social group; parents and children; ''he wanted to have a good job before starting a family'')<br>3. (8) class, category, family -- (a collection of things sharing a common attribute; ''there are two classes of detergents'')<br>4. (5) family, family line, folk, kinfolk, kinsfolk, sept, phratry -- (people descended from a common ancestor; ''his family has lived in Massachusetts since the Mayflower'')<br>5. (2) kin, kinsperson, family -- (a person having kinship with another or others; ''he's kin''; ''he's family'')<br>6. (2) family -- ((biology) a taxonomic group containing one or more genera; ''sharks belong to the fish family'')<br>7. syndicate, crime syndicate, mob, family -- (a loose affiliation of gangsters in charge of organized criminal activities)<br>8. family, fellowship -- (an association of people who share common beliefs or activities; ''the message was addressed not just to employees but to every member of the company family''; ''the church welcomed new members into its fellowship'')<br><br>Synonyms/Hypernyms (Ordered by Estimated Frequency) of noun family<br><br>8 senses of family&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<br><br>Sense 1<br>family, household, house, home, menage<br>&emsp;&emsp;&emsp; => unit, social unit<br><br>Sense 2<br>family, family unit<br>&emsp;&emsp;&emsp; => kin, kin group, kinship group, kindred, clan, tribe<br><br>Sense 3<br>class, category, family<br>&emsp;&emsp;&emsp; => collection, aggregation, accumulation, assemblage<br><br>Sense 4<br>family, family line, folk, kinfolk, kinsfolk, sept, phratry<br>&emsp;&emsp;&emsp; => lineage, line, line of descent, descent, bloodline, blood line, blood, pedigree, ancestry, origin, parentage, stemma, stock<br><br>Sense 5<br>kin, kinsperson, family<br>&emsp;&emsp;&emsp; => relative, relation<br><br>Sense 6<br>family<br>&emsp;&emsp;&emsp; => taxonomic group, taxonomic category, taxon<br><br>Sense 7<br>syndicate, crime syndicate, mob, family<br>&emsp;&emsp;&emsp; => organized crime, gangland, gangdom<br><br>Sense 8<br>family, fellowship<br>&emsp;&emsp;&emsp; => association<br>">family</abbr>, and my personal
documentation for the phrase <abbr class="tooltip" title="Hussein ibn Ali is the grandson of Prophet Muhammad, who is known to have<br>declared <strong>“Hussain is from me and I am from Hussain; God loves whoever loves Hussain.”</strong><br><br>He is honoured as “The Chief of Martyrs” for his selfless stand for social justice<br>against Yazid, the corrupt 7ᵗʰ caliph. The Karbala Massacre is commemorated annually<br>in the first Islamic month, Muharram, as a reminder to stand against oppression and tyranny;<br>Jesus Christ, son of Mary, makes an indirect appearance in the story.<br><br>A terse summary of the chain of events leading to the massacre may be found at<br>https://www.al-islam.org/articles/karbala-chain-events.<br><br>An elegant English recitation recounting the Karbala Massacre may be found at<br>https://youtu.be/2i9Y3Km6h08 ---“Arbaeen Maqtal - Sheikh Hamam Nassereddine - 1439”.<br><hr><br> <strong>Charles Dickens:</strong> <em>“If Hussain had fought to quench his worldly desires...then I</em><br><em>do not understand why his sister, wife, and children accompanied him. It stands<br>to reason therefore, that he sacrificed purely for Islam.”</em><br><br><strong>Gandhi:</strong> <em>“I learned from Hussain how to achieve victory while being oppressed.”</em><br><br><strong>Thomas Carlyle:</strong> <em>“The victory of Hussein, despite his minority, marvels me.”</em><br><br><strong>Thomas Masaryk:</strong> <em>“Although our clergies also move us while describing the<br>Christ's sufferings, but the zeal and zest that is found in the followers of</em><br><em>Hussain will not be found in the followers of Christ. And it seems that the<br>suffering of Christ against the suffering of Hussain is like a blade of straw</em> <em>in<br>front of a huge mountain.”</em>">Hussain</abbr>.
</p>

<p>
Similarly, <code>[[kbd:M-s h .]]</code> becomes <abbr class="tooltip" style="border: none; text-decoration: none;" title="M-s h . ∷ highlight-symbol-at-point<br>Highlight each instance of the symbol at point.<br>Uses the next face from ‘hi-lock-face-defaults’ without prompting,<br>unless you use a prefix argument.<br>Uses ‘find-tag-default-as-symbol-regexp’ to retrieve the symbol at point.<br><br>This uses Font lock mode if it is enabled; otherwise it uses overlays,<br>in which case the highlighting will not update as you type.&emsp;The Font<br>Lock mode is considered ''enabled'' in a buffer if its ‘major-mode’<br>causes ‘font-lock-specified-p’ to return non-nil, which means<br>the major mode specifies support for Font Lock."><kbd style="border-color: red">M-s h .</kbd></abbr>, which has a tooltip for
the Lisp function associated with the keybinding.
</p></dd>
</dl>

</div>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example Mini-Article Using The Above Link Types
                      </font>
                    </strong>
                  </summary>
<p>
( <a class="anchor" aria-hidden="true" id="example-article-via-links" href="#example-article-via-links"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16
   16" width="16" height="16"><path fill-rule="evenodd"
   d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69
   3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10
   5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0
   2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5
   0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55
   13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> ) <abbr class="tooltip" style="border: none; text-decoration: none;" title="C-x ESC ESC ∷ repeat-complex-command<br>Edit and re-evaluate last complex command, or ARGth from last.<br>A complex command is one that used the minibuffer.<br>The command is placed in the minibuffer as a Lisp form for editing.<br>The result is executed, repeating the command as changed.<br>If the command has been changed or is not the most recent previous<br>command it is added to the front of the command history.<br>You can use the minibuffer history commands M-n and M-p<br>to get different commands to edit and resubmit.<br><br>(fn ARG)"><kbd style="border-color: red">C-x ESC ESC</kbd></abbr> invokes
<abbr class="tooltip" title="Edit and re-evaluate last complex command, or ARGth from last.<br>A complex command is one that used the minibuffer.<br>The command is placed in the minibuffer as a Lisp form for editing.<br>The result is executed, repeating the command as changed.<br>If the command has been changed or is not the most recent previous<br>command it is added to the front of the command history.<br>You can use the minibuffer history commands M-n and M-p<br>to get different commands to edit and resubmit.<br><br>(fn ARG)">repeat-complex-command</abbr>, you will see a Lisp form of the previous <i>interactive</i>
action you performed. You can press <abbr class="tooltip" style="border: none; text-decoration: none;" title="RET ∷ org-return<br>Goto next table row or insert a newline.<br><br>Calls ‘org-table-next-row’ or ‘newline’, depending on context.<br><br>When optional INDENT argument is non-nil, call<br>‘newline-and-indent’ with ARG, otherwise call ‘newline’ with ARG<br>and INTERACTIVE.<br><br>When ‘org-return-follows-link’ is non-nil and point is on<br>a timestamp or a link, call ‘org-open-at-point’.&emsp;However, it<br>will not happen if point is in a table or on a ''dead''<br>object (e.g., within a comment).&emsp;In these case, you need to use<br>‘org-open-at-point’ directly.<br><br>(fn &optional INDENT ARG INTERACTIVE)"><kbd style="border-color: red">RET</kbd></abbr> to repeat that command, or, more
likely, to convert your actions to Lisp code for a personal function.
</p>

<p>
This is a super neato way to get Lisp from your actions.
Conversely, use <abbr class="tooltip" style="border: none; text-decoration: none;" title="M-: ∷ eval-expression<br>Evaluate EXP and print value in the echo area.<br>When called interactively, read an Emacs Lisp expression and<br>evaluate it.&emsp;Value is also consed on to front of the variable<br>‘values’.&emsp;Optional argument INSERT-VALUE non-nil (interactively,<br>with a non ‘-’ prefix argument) means insert the result into the<br>current buffer instead of printing it in the echo area.<br><br>Normally, this function truncates long output according to the<br>value of the variables ‘eval-expression-print-length’ and<br>‘eval-expression-print-level’.&emsp;When NO-TRUNCATE is<br>non-nil (interactively, with a prefix argument of zero), however,<br>there is no such truncation.<br><br>If the resulting value is an integer, and CHAR-PRINT-LIMIT is<br>non-nil (interactively, unless given a non-zero prefix argument)<br>it will be printed in several additional formats (octal,<br>hexadecimal, and character).&emsp;The character format is used only<br>if the value is below CHAR-PRINT-LIMIT (interactively, if the<br>prefix argument is -1 or the value doesn’t exceed<br>‘eval-expression-print-maximum-character’).<br><br>Runs the hook ‘eval-expression-minibuffer-setup-hook’ on entering the<br>minibuffer.<br><br>If ‘eval-expression-debug-on-error’ is non-nil, which is the default,<br>this command arranges for all errors to enter the debugger.<br><br>(fn EXP &optional INSERT-VALUE NO-TRUNCATE CHAR-PRINT-LIMIT)"><kbd style="border-color: red">M-:</kbd></abbr> to evaluate any Lisp you have in-hand 😉
</p>

<p>
<img src="https://img.shields.io/badge/Emacs-is_so_cool-informational?logo=gnu-emacs">.
</p>


</details>

<p>
Just as there is <abbr class="tooltip" title="Define NAME as a function.<br>The definition is (lambda ARGLIST [DOCSTRING] BODY...).<br>See also the function ‘interactive’.<br>DECL is a declaration, optional, of the form (declare DECLS...) where<br>DECLS is a list of elements of the form (PROP . VALUES).&emsp;These are<br>interpreted according to ‘defun-declarations-alist’.<br>The return value is undefined.<br><br>(fn NAME ARGLIST &optional DOCSTRING DECL &rest BODY)">defun</abbr> for “def”ining “fun”ctions and <abbr class="tooltip" title="Define NAME as a macro.<br>When the macro is called, as in (NAME ARGS...),<br>the function (lambda ARGLIST BODY...) is applied to<br>the list ARGS... as it appears in the expression,<br>and the result should be a form to be evaluated instead of the original.<br>DECL is a declaration, optional, of the form (declare DECLS...) where<br>DECLS is a list of elements of the form (PROP . VALUES).&emsp;These are<br>interpreted according to ‘macro-declarations-alist’.<br>The return value is undefined.<br><br>(fn NAME ARGLIST &optional DOCSTRING DECL &rest BODY)">defmacro</abbr> for
“def”ining “mac”ros, there is also <abbr class="tooltip" title="Make a new Org-link NAME that exports using form BODY.<br><br>Since Org links are essentially string-valued functions,<br>a function ‘o-link/NAME’ is created.<br><br>DOCSTRING is optional; it is visible with<br>&emsp; (documentation ’o-link/NAME)<br><br>BODY is a string-valued expression, that may make use of the names<br>o-label, o-description, o-backend. The final one refers to the export<br>backend, such as ’html or ’latex. The first two are obtained from uses:<br><br>&emsp; Y (name:o-label][o-description]]<br><br>In particular, the use case “name:o-label” means that o-description is nil.<br><br>Example use:<br><br>&emsp; ;; In a Lisp buffer, press “C-x C-e” to load this definition<br>&emsp; (o-deflink shout (upcase (or o-description o-label)))<br><br>&emsp; ;; In an Org-buffer, press “C-c C-e h o” to see how this exports<br>&emsp; <shout: hello world!><br><br>&emsp; ;; Or using the bracket format<br>&emsp; [[shout:][hello world!]]<br>&emsp; [[shout: hello world!]]<br><br>&emsp; ;; or using the plain format<br>&emsp; shout:hello_world<br><br>Here is a more complex, involved, example that makes use of<br>‘:let’ for local declarations. For instance, “define:hello”<br>renders as the word “hello” with a tooltip defining the word; the<br>definition is obtained from the command line tool ‘wn’.<br><br>&emsp;(o-deflink define<br>&emsp;&emsp;''Define the given word using WordNet, along with synonyms and coordinate terms.''<br>&emsp;&emsp;[:let (definition (shell-command-to-string (format ''wn %s -over -synsn -coorn'' o-label)))<br>&emsp;&emsp; :help-echo definition]<br>&emsp;&emsp;(--> definition<br>&emsp;&emsp;&emsp;(s-replace-regexp ''\\\'''' ''’’'' it) ;; The presence of ‘\''’ in tooltips breaks things, so omit them.<br>&emsp;&emsp;&emsp;(s-replace-regexp ''\n'' ''<br>'' it)<br>&emsp;&emsp;&emsp;(format ''<abbr class=\''tooltip\'' title=\''%s\''>%s</abbr>'' it o-label)))<br><br>For HTML tooltips, see ‘o-html-export-preserving-whitespace’.<br><br>More generally, org-special-block-extra’s “doc” link type<br>supports, in order of precedence: User definitions, Emacs Lisp<br>documentation of functions & variables, and definitions of<br>English words. For example, “doc:existential_angst” for an entry<br>‘existential_angst’ whose associated documentation-glossary is<br>user-defined in a ‘#+documentation’ Org-block, or<br>“doc:thread-first” for the Emacs Lisp documentation of the<br>function ‘thread-first’, or “doc:user-mail-address” for the Emacs<br>Lisp documentation of the variable ‘user-mail-address’, or<br>“doc:hello” for the definition of the English word ‘hello’.<br><br>DISPLAY is a vector consisting of key-value pairs that affects how the link<br>is displayed in Emacs Org buffers. The keys are as follows.<br><br>+ :help-echo is a string-valued expression of the tooltip that should accompany<br>&emsp;the new link in Org buffers. It has access to o-format being one of ‘plain’,<br>&emsp;‘angle’, ‘bracket’ which indicates the format of the link, as shown above.<br>&emsp;It also has access to o-label and o-description.<br><br>&emsp;By default, the tooltip is the link name followed by the documentation<br>&emsp;of the link, and, finally, the HTML export of the link.<br>&emsp;That way, upon hover, users can visually see the link contents,<br>&emsp;know what/how the link exports, and actually see the HTML export.<br><br>&emsp;That is to say, for the ‘shout’ example aboce, the default display is essentially:<br>&emsp;[:help-echo (o-link/shout o-label o-description ’html)]<br><br>&emsp;You may want to add the following to your Emacs init file:<br><br>&emsp;&emsp;;; Nearly instantaneous display of tooltips.<br>&emsp;&emsp;(setq tooltip-delay 0)<br>&emsp;&emsp;;; Give user 30 seconds before tooltip automatically disappears.<br>&emsp;&emsp;(setq tooltip-hide-delay 300)<br><br>+ :face specifies how should these links be displayed within Emacs.<br>&emsp; It is a list-valued expression.<br>&emsp; As usual, it may make use of O-LABEL (but O-DESCRIPTION has value nil).<br><br>+ [:display full] if you do not want bracket links to be<br>&emsp;folded away in Org buffers; i.e., “[[X)” does not render as just “Y”.<br><br>+ :follow is a form that is executed when you click on such links; e.g., to open<br>&emsp; another buffer, browser, or other action. It makes use of (an implicit argument) ‘o-label’.<br>&emsp; Be aware that ‘o-label’ is a string that may contain spaces; e.g., when the action is to open<br>&emsp; a URL in a browser.<br><br>&emsp; If you are in need of providing similar, related, actions on a single link<br>&emsp; then your :follow can condition on the current prefix argument via ‘o-prefix’<br>&emsp; (which is essentially ‘current-prefix-arg’).<br>&emsp; For instance, a user presses “C-u RET” on your link to do one thing<br>&emsp; but “C-u 72 RET” to do another action.<br><br>+ :keymap is an alternating list of keys and actions to be<br>&emsp;performed when those keys are pressed while point is on the link.<br>&emsp;For example:<br>&emsp;&emsp;&emsp;[:keymap (C-h (message-box ''hola''))]<br><br>&emsp;By default, C-n and C-p are for moving to next and previous occruances of the same link type.<br><br>+ :let is a list of alternating variable symbol name and value, which are then used to form<br>&emsp;a concrete ‘let*’ clause. This is useful for introducing local variables for use in the DISPLAY<br>&emsp;as well as in the CONTENTS. Such local declarations may make use of O-LABEL and O-DESCRIPTION, as usual.<br><br>(fn NAME &optional DOCSTRING DISPLAY &rest BODY)">o-deflink</abbr> for “def”ining “link”s for
“O”rg, and it behaves similar to them.
</p>

<p>
However, there are usually multiple ways to define things &#x2014;e.g., macros are
code-valued functions defined with <abbr class="tooltip" title="Define NAME as a function.<br>Like normal ‘defun’, except ARGLIST allows full Common Lisp conventions,<br>and BODY is implicitly surrounded by (cl-block NAME ...).<br><br>The full form of a Common Lisp function argument list is<br><br>&emsp; (VAR...<br>&emsp;&emsp;[&optional (VAR [INITFORM [SVAR]])...]<br>&emsp;&emsp;[&rest|&body VAR]<br>&emsp;&emsp;[&key (([KEYWORD] VAR) [INITFORM [SVAR]])... [&allow-other-keys]]<br>&emsp;&emsp;[&aux (VAR [INITFORM])...])<br><br>VAR may be replaced recursively with an argument list for<br>destructuring, ‘&whole’ is supported within these sublists.&emsp;If<br>SVAR, INITFORM, and KEYWORD are all omitted, then ‘(VAR)’ may be<br>written simply ‘VAR’.&emsp;See the Info node ‘(cl)Argument Lists’ for<br>more details.<br><br>(fn NAME ARGLIST [DOCSTRING] BODY...)">cl-defun</abbr>. Indeed, Org links are popularly
defined using <abbr class="tooltip" title="Set link TYPE properties to PARAMETERS.<br>PARAMETERS should be keyword value pairs.&emsp;See<br>‘org-link-parameters’ for supported keys.<br><br>(fn TYPE &rest PARAMETERS)">org-link-set-parameters</abbr> &#x2014;which, unlike <abbr class="tooltip" title="Make a new Org-link NAME that exports using form BODY.<br><br>Since Org links are essentially string-valued functions,<br>a function ‘o-link/NAME’ is created.<br><br>DOCSTRING is optional; it is visible with<br>&emsp; (documentation ’o-link/NAME)<br><br>BODY is a string-valued expression, that may make use of the names<br>o-label, o-description, o-backend. The final one refers to the export<br>backend, such as ’html or ’latex. The first two are obtained from uses:<br><br>&emsp; Y (name:o-label][o-description]]<br><br>In particular, the use case “name:o-label” means that o-description is nil.<br><br>Example use:<br><br>&emsp; ;; In a Lisp buffer, press “C-x C-e” to load this definition<br>&emsp; (o-deflink shout (upcase (or o-description o-label)))<br><br>&emsp; ;; In an Org-buffer, press “C-c C-e h o” to see how this exports<br>&emsp; <shout: hello world!><br><br>&emsp; ;; Or using the bracket format<br>&emsp; [[shout:][hello world!]]<br>&emsp; [[shout: hello world!]]<br><br>&emsp; ;; or using the plain format<br>&emsp; shout:hello_world<br><br>Here is a more complex, involved, example that makes use of<br>‘:let’ for local declarations. For instance, “define:hello”<br>renders as the word “hello” with a tooltip defining the word; the<br>definition is obtained from the command line tool ‘wn’.<br><br>&emsp;(o-deflink define<br>&emsp;&emsp;''Define the given word using WordNet, along with synonyms and coordinate terms.''<br>&emsp;&emsp;[:let (definition (shell-command-to-string (format ''wn %s -over -synsn -coorn'' o-label)))<br>&emsp;&emsp; :help-echo definition]<br>&emsp;&emsp;(--> definition<br>&emsp;&emsp;&emsp;(s-replace-regexp ''\\\'''' ''’’'' it) ;; The presence of ‘\''’ in tooltips breaks things, so omit them.<br>&emsp;&emsp;&emsp;(s-replace-regexp ''\n'' ''<br>'' it)<br>&emsp;&emsp;&emsp;(format ''<abbr class=\''tooltip\'' title=\''%s\''>%s</abbr>'' it o-label)))<br><br>For HTML tooltips, see ‘o-html-export-preserving-whitespace’.<br><br>More generally, org-special-block-extra’s “doc” link type<br>supports, in order of precedence: User definitions, Emacs Lisp<br>documentation of functions & variables, and definitions of<br>English words. For example, “doc:existential_angst” for an entry<br>‘existential_angst’ whose associated documentation-glossary is<br>user-defined in a ‘#+documentation’ Org-block, or<br>“doc:thread-first” for the Emacs Lisp documentation of the<br>function ‘thread-first’, or “doc:user-mail-address” for the Emacs<br>Lisp documentation of the variable ‘user-mail-address’, or<br>“doc:hello” for the definition of the English word ‘hello’.<br><br>DISPLAY is a vector consisting of key-value pairs that affects how the link<br>is displayed in Emacs Org buffers. The keys are as follows.<br><br>+ :help-echo is a string-valued expression of the tooltip that should accompany<br>&emsp;the new link in Org buffers. It has access to o-format being one of ‘plain’,<br>&emsp;‘angle’, ‘bracket’ which indicates the format of the link, as shown above.<br>&emsp;It also has access to o-label and o-description.<br><br>&emsp;By default, the tooltip is the link name followed by the documentation<br>&emsp;of the link, and, finally, the HTML export of the link.<br>&emsp;That way, upon hover, users can visually see the link contents,<br>&emsp;know what/how the link exports, and actually see the HTML export.<br><br>&emsp;That is to say, for the ‘shout’ example aboce, the default display is essentially:<br>&emsp;[:help-echo (o-link/shout o-label o-description ’html)]<br><br>&emsp;You may want to add the following to your Emacs init file:<br><br>&emsp;&emsp;;; Nearly instantaneous display of tooltips.<br>&emsp;&emsp;(setq tooltip-delay 0)<br>&emsp;&emsp;;; Give user 30 seconds before tooltip automatically disappears.<br>&emsp;&emsp;(setq tooltip-hide-delay 300)<br><br>+ :face specifies how should these links be displayed within Emacs.<br>&emsp; It is a list-valued expression.<br>&emsp; As usual, it may make use of O-LABEL (but O-DESCRIPTION has value nil).<br><br>+ [:display full] if you do not want bracket links to be<br>&emsp;folded away in Org buffers; i.e., “[[X)” does not render as just “Y”.<br><br>+ :follow is a form that is executed when you click on such links; e.g., to open<br>&emsp; another buffer, browser, or other action. It makes use of (an implicit argument) ‘o-label’.<br>&emsp; Be aware that ‘o-label’ is a string that may contain spaces; e.g., when the action is to open<br>&emsp; a URL in a browser.<br><br>&emsp; If you are in need of providing similar, related, actions on a single link<br>&emsp; then your :follow can condition on the current prefix argument via ‘o-prefix’<br>&emsp; (which is essentially ‘current-prefix-arg’).<br>&emsp; For instance, a user presses “C-u RET” on your link to do one thing<br>&emsp; but “C-u 72 RET” to do another action.<br><br>+ :keymap is an alternating list of keys and actions to be<br>&emsp;performed when those keys are pressed while point is on the link.<br>&emsp;For example:<br>&emsp;&emsp;&emsp;[:keymap (C-h (message-box ''hola''))]<br><br>&emsp;By default, C-n and C-p are for moving to next and previous occruances of the same link type.<br><br>+ :let is a list of alternating variable symbol name and value, which are then used to form<br>&emsp;a concrete ‘let*’ clause. This is useful for introducing local variables for use in the DISPLAY<br>&emsp;as well as in the CONTENTS. Such local declarations may make use of O-LABEL and O-DESCRIPTION, as usual.<br><br>(fn NAME &optional DOCSTRING DISPLAY &rest BODY)">o-deflink</abbr>, is not
consistent with <abbr class="tooltip" title="Define NAME as a function.<br>The definition is (lambda ARGLIST [DOCSTRING] BODY...).<br>See also the function ‘interactive’.<br>DECL is a declaration, optional, of the form (declare DECLS...) where<br>DECLS is a list of elements of the form (PROP . VALUES).&emsp;These are<br>interpreted according to ‘defun-declarations-alist’.<br>The return value is undefined.<br><br>(fn NAME ARGLIST &optional DOCSTRING DECL &rest BODY)">defun</abbr>&#x2014; and so let's take a look at it first.
</p>
</div>

<div id="outline-container-A-comprehensive-example-of-doc-org-link-set-parameters-and-doc-org-link-parameters" class="outline-4">
<h4 id="A-comprehensive-example-of-doc-org-link-set-parameters-and-doc-org-link-parameters"><span class="section-number-4">1.2.1</span> <a href="#A-comprehensive-example-of-doc-org-link-set-parameters-and-doc-org-link-parameters">A comprehensive example of <abbr class="tooltip" title="Set link TYPE properties to PARAMETERS.<br>PARAMETERS should be keyword value pairs.&emsp;See<br>‘org-link-parameters’ for supported keys.<br><br>(fn TYPE &rest PARAMETERS)">org-link-set-parameters</abbr> and <abbr class="tooltip" title="Alist of properties that defines all the links in Org mode.<br><br>The key in each association is a string of the link type.<br>Subsequent optional elements make up a property list for that<br>type.<br><br>All properties are optional.&emsp;However, the most important ones<br>are, in this order, ‘:follow’, ‘:export’, and ‘:store’, described<br>below.<br><br>‘:follow’<br><br>&emsp;Function used to follow the link, when the ‘org-open-at-point’<br>&emsp;command runs on it.&emsp;It is called with two arguments: the path,<br>&emsp;as a string, and a universal prefix argument.<br><br>&emsp;Here, you may use ‘org-link-open-as-file’ helper function for<br>&emsp;types similar to ''file''.<br><br>‘:export’<br><br>&emsp;Function that accepts four arguments:<br>&emsp;- the path, as a string,<br>&emsp;- the description as a string, or nil,<br>&emsp;- the export back-end,<br>&emsp;- the export communication channel, as a plist.<br><br>&emsp;When nil, export for that type of link is delegated to the<br>&emsp;back-end.<br><br>‘:store’<br><br>&emsp;Function responsible for storing the link.&emsp;See the function<br>&emsp;‘org-store-link-functions’ for a description of the expected<br>&emsp;arguments.<br><br>Additional properties provide more specific control over the<br>link.<br><br>‘:activate-func’<br><br>&emsp;Function to run at the end of Font Lock activation.&emsp;It must<br>&emsp;accept four arguments:<br>&emsp;- the buffer position at the start of the link,<br>&emsp;- the buffer position at its end,<br>&emsp;- the path, as a string,<br>&emsp;- a boolean, non-nil when the link has brackets.<br><br>‘:complete’<br><br>&emsp;Function that inserts a link with completion.&emsp;The function<br>&emsp;takes one optional prefix argument.<br><br>‘:display’<br><br>&emsp;Value for ‘invisible’ text property on the hidden parts of the<br>&emsp;link.&emsp;The most useful value is ‘full’, which will not fold the<br>&emsp;link in descriptive display.&emsp;Default is ‘org-link’.<br><br>‘:face’<br><br>&emsp;Face for the link, or a function returning a face.&emsp;The<br>&emsp;function takes one argument, which is the path.<br><br>&emsp;The default face is ‘org-link’.<br><br>‘:help-echo’<br><br>&emsp;String or function used as a value for the ‘help-echo’ text<br>&emsp;property.&emsp;The function is called with one argument, the help<br>&emsp;string to display, and should return a string.<br><br>‘:htmlize-link’<br><br>&emsp;Function or plist for the ‘htmlize-link’ text property.&emsp;The<br>&emsp;function takes no argument.<br><br>&emsp;Default is (:uri ''type:path'')<br><br>‘:keymap’<br><br>&emsp;Active keymap when point is on the link.&emsp;Default is<br>&emsp;‘org-mouse-map’.<br><br>‘:mouse-face’<br><br>&emsp;Face used when hovering over the link.&emsp;Default is<br>&emsp;‘highlight’.">org-link-parameters</abbr></a></h4>
<div class="outline-text-4" id="text-A-comprehensive-example-of-doc-org-link-set-parameters-and-doc-org-link-parameters">
<p>
Use <code class="src src-emacs-lisp">(<span style="color: #b58900;">org-link-set-parameters</span> params)</code> to add a new
link type &#x2014;an older obsolete method is <abbr class="tooltip" title="Add a new TYPE link.<br>FOLLOW and EXPORT are two functions.<br><br>FOLLOW should take the link path as the single argument and do whatever<br>is necessary to follow the link, for example find a file or display<br>a mail message.<br><br>EXPORT should format the link path for export to one of the export formats.<br>It should be a function accepting three arguments:<br><br>&emsp;path&emsp;&emsp;the path of the link, the text after the prefix (like ''http:'')<br>&emsp;desc&emsp;&emsp;the description of the link, if any<br>&emsp;format&emsp;the export format, a symbol like ‘html’ or ‘latex’ or ‘ascii’.<br><br>The function may use the FORMAT information to return different values<br>depending on the format.&emsp;The return value will be put literally into<br>the exported file.&emsp;If the return value is nil, this means Org should<br>do what it normally does with links which do not have EXPORT defined.<br><br>Org mode has a built-in default for exporting links.&emsp;If you are happy with<br>this default, there is no need to define an export function for the link<br>type.&emsp;For a simple example of an export function, see ‘org-bbdb.el’.<br><br>If TYPE already exists, update it with the arguments.<br>See ‘org-link-parameters’ for documentation on the other parameters.<br><br>(fn TYPE &optional FOLLOW EXPORT)">org-add-link-type</abbr>.  The list of all
supported link types is <abbr class="tooltip" title="Alist of properties that defines all the links in Org mode.<br><br>The key in each association is a string of the link type.<br>Subsequent optional elements make up a property list for that<br>type.<br><br>All properties are optional.&emsp;However, the most important ones<br>are, in this order, ‘:follow’, ‘:export’, and ‘:store’, described<br>below.<br><br>‘:follow’<br><br>&emsp;Function used to follow the link, when the ‘org-open-at-point’<br>&emsp;command runs on it.&emsp;It is called with two arguments: the path,<br>&emsp;as a string, and a universal prefix argument.<br><br>&emsp;Here, you may use ‘org-link-open-as-file’ helper function for<br>&emsp;types similar to ''file''.<br><br>‘:export’<br><br>&emsp;Function that accepts four arguments:<br>&emsp;- the path, as a string,<br>&emsp;- the description as a string, or nil,<br>&emsp;- the export back-end,<br>&emsp;- the export communication channel, as a plist.<br><br>&emsp;When nil, export for that type of link is delegated to the<br>&emsp;back-end.<br><br>‘:store’<br><br>&emsp;Function responsible for storing the link.&emsp;See the function<br>&emsp;‘org-store-link-functions’ for a description of the expected<br>&emsp;arguments.<br><br>Additional properties provide more specific control over the<br>link.<br><br>‘:activate-func’<br><br>&emsp;Function to run at the end of Font Lock activation.&emsp;It must<br>&emsp;accept four arguments:<br>&emsp;- the buffer position at the start of the link,<br>&emsp;- the buffer position at its end,<br>&emsp;- the path, as a string,<br>&emsp;- a boolean, non-nil when the link has brackets.<br><br>‘:complete’<br><br>&emsp;Function that inserts a link with completion.&emsp;The function<br>&emsp;takes one optional prefix argument.<br><br>‘:display’<br><br>&emsp;Value for ‘invisible’ text property on the hidden parts of the<br>&emsp;link.&emsp;The most useful value is ‘full’, which will not fold the<br>&emsp;link in descriptive display.&emsp;Default is ‘org-link’.<br><br>‘:face’<br><br>&emsp;Face for the link, or a function returning a face.&emsp;The<br>&emsp;function takes one argument, which is the path.<br><br>&emsp;The default face is ‘org-link’.<br><br>‘:help-echo’<br><br>&emsp;String or function used as a value for the ‘help-echo’ text<br>&emsp;property.&emsp;The function is called with one argument, the help<br>&emsp;string to display, and should return a string.<br><br>‘:htmlize-link’<br><br>&emsp;Function or plist for the ‘htmlize-link’ text property.&emsp;The<br>&emsp;function takes no argument.<br><br>&emsp;Default is (:uri ''type:path'')<br><br>‘:keymap’<br><br>&emsp;Active keymap when point is on the link.&emsp;Default is<br>&emsp;‘org-mouse-map’.<br><br>‘:mouse-face’<br><br>&emsp;Face used when hovering over the link.&emsp;Default is<br>&emsp;‘highlight’.">org-link-parameters</abbr>; its documentation identifies
the possibilities for <code>params</code>.
</p>

<p>
Let's produce an example link type, then discuss its code.
</p>

<p>
Intended usage:
Raw use example:salam and descriptive, ^_^
<img src="images/example_link.png" alt="example_link.png" />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org55b242a"><span class="linenr"> 1: </span>(<span style="color: #b58900;">org-link-set-parameters</span>
<span class="linenr"> 2: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The name of the new link type, usage: &#8220;example:label&#8221;</span>
<span id="coderef-extype" class="coderef-off"><span class="linenr"> 3: </span>  <span style="color: #2aa198;">"example"</span></span>
<span class="linenr"> 4: </span>
<span class="linenr"> 5: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">When you click on such links, &#8220;let me google that for you&#8221; happens</span>
<span id="coderef-exfollow" class="coderef-off"><span class="linenr"> 6: </span>  <span style="color: #d33682; font-style: italic;">:follow</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (label) (<span style="color: #b58900;">browse-url</span> (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"https://lmgtfy.com/?q="</span> label)))</span>
<span class="linenr"> 7: </span>
<span class="linenr"> 8: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Upon export, make it a &#8220;let me google that for you&#8221; link</span>
<span id="coderef-exexport" class="coderef-off"><span class="linenr"> 9: </span>  <span style="color: #d33682; font-style: italic;">:export</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (label description backend)</span>
<span class="linenr">10: </span>            (<span style="color: #b58900;">format</span> (<span style="color: #859900; font-weight: bold;">pcase</span> backend
<span class="linenr">11: </span>                      ('html <span style="color: #2aa198;">"&lt;a href=\"%s\"&gt;%s&lt;/a&gt;"</span>)
<span class="linenr">12: </span>                      ('latex <span style="color: #2aa198;">"\\href{%s}{%s}"</span>)
<span class="linenr">13: </span>                      (_ <span style="color: #2aa198;">"I don&#8217;t know how to export that!"</span>))
<span class="linenr">14: </span>                    (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"https://lmgtfy.com/?q="</span> label)
<span class="linenr">15: </span>                    (<span style="color: #859900; font-weight: bold;">or</span> description label)))
<span class="linenr">16: </span>
<span class="linenr">17: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">These links should *never* be folded in descriptive display;</span>
<span class="linenr">18: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">i.e., &#8220;[[example:lable][description]]&#8221; will always appear verbatim</span>
<span class="linenr">19: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">and not hide the first pair [&#8230;].</span>
<span id="coderef-exdisplay" class="coderef-off"><span class="linenr">20: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">:display 'full</span></span>
<span class="linenr">21: </span>
<span class="linenr">22: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The tooltip alongside a link</span>
<span id="coderef-exhelpecho" class="coderef-off"><span class="linenr">23: </span>  <span style="color: #d33682; font-style: italic;">:help-echo</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (window object <span style="color: #b58900;">position</span>)</span>
<span class="linenr">24: </span>               (<span style="color: #859900; font-weight: bold;">save-excursion</span>
<span class="linenr">25: </span>                 (<span style="color: #b58900;">goto-char</span> <span style="color: #b58900;">position</span>)
<span class="linenr">26: </span>                 (<span style="color: #859900; font-weight: bold;">-let*</span> (((<span style="color: #b58900; font-style: italic;">&amp;plist</span> <span style="color: #d33682; font-style: italic;">:path</span> <span style="color: #d33682; font-style: italic;">:format</span> <span style="color: #d33682; font-style: italic;">:raw-link</span> <span style="color: #d33682; font-style: italic;">:contents-begin</span> <span style="color: #d33682; font-style: italic;">:contents-end</span>)
<span class="linenr">27: </span>                          (<span style="color: #b58900;">cadr</span> (<span style="color: #b58900;">org-element-context</span>)))
<span class="linenr">28: </span>                         <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">(org-element-property :path (org-element-context))</span>
<span class="linenr">29: </span>                         (description
<span class="linenr">30: </span>                          (<span style="color: #859900; font-weight: bold;">when</span> (<span style="color: #b58900;">equal</span> <span style="color: #b58900;">format</span> 'bracket)
<span class="linenr">31: </span>                            (<span style="color: #b58900;">copy-region-as-kill</span> contents-begin contents-end)
<span class="linenr">32: </span>                            (<span style="color: #b58900;">substring-no-properties</span> (<span style="color: #b58900;">car</span> <span style="color: #268bd2;">kill-ring</span>)))))
<span class="linenr">33: </span>                   (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&#8220;%s&#8221; :: Let me google &#8220;%s&#8221; for you -__- %s and %s"</span>
<span class="linenr">34: </span>                          raw-link (<span style="color: #859900; font-weight: bold;">or</span> description raw-link)))))
<span class="linenr">35: </span>
<span class="linenr">36: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">How should these links be displayed</span>
<span id="coderef-exface" class="coderef-off"><span class="linenr">37: </span>  <span style="color: #d33682; font-style: italic;">:face</span> '(<span style="color: #d33682; font-style: italic;">:foreground</span> <span style="color: #2aa198;">"red"</span> <span style="color: #d33682; font-style: italic;">:weight</span> <span style="color: #b58900;">bold</span></span>
<span class="linenr">38: </span>          <span style="color: #d33682; font-style: italic;">:underline</span> <span style="color: #2aa198;">"orange"</span> <span style="color: #d33682; font-style: italic;">:overline</span> <span style="color: #2aa198;">"orange"</span>)
<span class="linenr">39: </span>
<span class="linenr">40: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Any special keybindings when cursour is on this link type?</span>
<span class="linenr">41: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">On &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">example:</span><span style="color: #96A7A9; font-style: italic;">&#8217; links, C-n/p to go to the next/previous such links.</span>
<span class="linenr">42: </span> <span style="color: #d33682; font-style: italic;">:keymap</span> (<span style="color: #859900; font-weight: bold;">let</span> ((<span style="color: #b58900;">map</span> (<span style="color: #b58900;">copy-keymap</span> <span style="color: #268bd2;">org-mouse-map</span>)))
<span class="linenr">43: </span>           <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Populate the keymap</span>
<span class="linenr">44: </span>           (<span style="color: #b58900;">define-key</span> <span style="color: #b58900;">map</span> (<span style="color: #b58900;">kbd</span> <span style="color: #2aa198;">"C-p"</span>)
<span class="linenr">45: </span>             (<span style="color: #859900; font-weight: bold;">lambda</span> () (<span style="color: #859900; font-weight: bold;">interactive</span>) (<span style="color: #b58900;">re-search-backward</span> <span style="color: #2aa198;">"example:"</span> nil <span style="color: #268bd2;">t</span>)))
<span class="linenr">46: </span>           (<span style="color: #b58900;">define-key</span> <span style="color: #b58900;">map</span> (<span style="color: #b58900;">kbd</span> <span style="color: #2aa198;">"C-n"</span>)
<span class="linenr">47: </span>             (<span style="color: #859900; font-weight: bold;">lambda</span> () (<span style="color: #859900; font-weight: bold;">interactive</span>) (<span style="color: #b58900;">re-search-forward</span> <span style="color: #2aa198;">"example:"</span> nil <span style="color: #268bd2;">t</span>)))
<span class="linenr">48: </span>           <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Return the keymap</span>
<span class="linenr">49: </span>           <span style="color: #b58900;">map</span>))
</pre>
</div>





<dl class="org-dl">
<dt>Line <a href="#coderef-extype" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-extype');" onmouseout="CodeHighlightOff(this, 'coderef-extype');">3</a> <code>"example"</code></dt><dd><p>
Add a new <code>example</code> link type.
</p>
<ul class="org-ul">
<li>If the type already exists, update it with the given arguments.</li>
</ul>

<p>
The syntax for a raw link is <code>example:path</code>
and for the bracketed descriptive form <code>[[example:path][description]]</code>.
</p>

<ul class="org-ul">
<li>Some of my intended uses for links including colouring text and doing
nothing else, as such the terminology ‘path’ is not sufficiently generic and
so I use the designation ‘label’ instead.</li>
</ul></dd>

<dt>Line <a href="#coderef-exfollow" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-exfollow');" onmouseout="CodeHighlightOff(this, 'coderef-exfollow');">6</a> <code>:follow</code></dt><dd><p>
What should happen when a user clicks on such links?
</p>

<p>
This is a function taking the link path as the single argument and does
whatever is necessary to “follow the link”, for example find a file or display
a message. In our case, we open the user's browser and go to a particular URL.
</p></dd>

<dt>Line <a href="#coderef-exexport" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-exexport');" onmouseout="CodeHighlightOff(this, 'coderef-exexport');">9</a> <code>:export</code></dt><dd><p>
How should this link type be exported to HTML, LaTeX, etc?
</p>

<p>
This is a three-argument function that formats the link according to the given
backend, the resulting string value os placed literally into the exported
file. Its arguments are:
</p>

<ol class="org-ol">
<li><code>label</code> ⇒ the path of the link, the text after the link type prefix</li>
<li><code>description</code> ⇒ the description of the link, if any</li>
<li><code>backend</code> ⇒ the export format, a symbol like <code>html</code> or <code>latex</code> or <code>ascii</code>.</li>
</ol>

<p>
In our example above, we return different values depending on the <code>backend</code>
value.
</p>

<ul class="org-ul">
<li>If <code>:export</code> is not provided, default Org-link exportation happens.</li>
</ul></dd>

<dt>Line <a href="#coderef-exdisplay" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-exdisplay');" onmouseout="CodeHighlightOff(this, 'coderef-exdisplay');">20</a> <code>:display</code></dt><dd>Should links be prettily folded away when a description
is provided?</dd>

<dt>Line <a href="#coderef-exhelpecho" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-exhelpecho');" onmouseout="CodeHighlightOff(this, 'coderef-exhelpecho');">23</a> <code>:help-echo</code></dt><dd><p>
What should happen when the user's mouse is over
the link?
</p>

<p>
This is <b>either a string or a string-valued function</b> that takes the current
window, the current buffer object, and its position in the current window.
</p>

<p>
In our example link, we go to the position of the object, destructure the Org
link's properties using <code>-let</code>, find the description of the link, if any, then
provide a string based on the link's path and description.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         The general textual property ‘help-echo’
                      </font>
                    </strong>
                  </summary>
<p>
We may use <code>help-echo</code> to attach tooltips to arbitrary text in a file, as
follows. I have found this to be useful in <a href="https://alhassy.github.io/next-700-module-systems/prototype/package-former.html"><b>metaprogramming</b></a> to have
elaborated, generated, code shown as a tooltip attached to its named
specification.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Nearly instantaneous display of tooltips.</span>
(<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #b58900;">tooltip-delay</span> 0)

<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Give user 30 seconds before tooltip automatically disappears.</span>
(<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">tooltip-hide-delay</span> 300)

(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">tooltipify</span> (phrase notification <span style="color: #b58900; font-style: italic;">&amp;optional</span> <span style="color: #556b72; background-color: #FDF6E3;">underline</span>)
  <span style="color: #35a69c; font-style: italic;">"Add a tooltip to every instance of PHRASE to show NOTIFICATION.</span>

<span style="color: #35a69c; font-style: italic;">We only add tooltips to PHRASE as a standalone word, not as a subword.</span>

<span style="color: #35a69c; font-style: italic;">If UNDERLINE is provided, we underline the given PHRASE so as to</span>
<span style="color: #35a69c; font-style: italic;">provide a visual clue that it has a tooltip attched to it.</span>

<span style="color: #35a69c; font-style: italic;">The PHRASE is taken literally; no regexp operators are recognised."</span>
  (<span style="color: #859900; font-weight: bold;">assert</span> (<span style="color: #b58900;">stringp</span> phrase))
  (<span style="color: #859900; font-weight: bold;">assert</span> (<span style="color: #b58900;">stringp</span> notification))
  (<span style="color: #859900; font-weight: bold;">save-excursion</span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Return cursour to current-point afterwards.</span>
    (<span style="color: #b58900;">goto-char</span> 1)
    <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The \b are for empty-string at the start or end of a word.</span>
    (<span style="color: #859900; font-weight: bold;">while</span> (<span style="color: #b58900;">search-forward-regexp</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"\\b%s\\b"</span> (<span style="color: #b58900;">regexp-quote</span> phrase))
                                  (<span style="color: #b58900;">point-max</span>) <span style="color: #268bd2;">t</span>)
      <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">(add-text-properties x y ps)</span>
      <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">&#8658; Override properties ps for all text between x and y.</span>
      (<span style="color: #b58900;">add-text-properties</span> (<span style="color: #b58900;">match-beginning</span> 0)
                           (<span style="color: #b58900;">match-end</span> 0)
                           (<span style="color: #b58900;">list</span> 'help-echo (<span style="color: #b58900;">s-trim</span> notification)))))
 <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Example use</span>
(tooltipify
  <span style="color: #2aa198;">"Line"</span>
  <span style="color: #2aa198;">"A sequential formatation of entities or the trace of a particle in linear motion"</span>)
</pre>
</div>

<p>
We will use the tooltip <abbr class="tooltip" title="Return the documentation string of FUNCTION.<br>Unless a non-nil second argument RAW is given, the<br>string is passed through ‘substitute-command-keys’.<br><br>(fn FUNCTION &optional RAW)">documentation</abbr> later on ^_^
</p></dd>
</dl>

<p>
Useful info on tooltips:
</p>
<ul class="org-ul">
<li><a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Changing-Properties.html">Changing text properties &#x2014;GNU</a></li>
<li><a href="http://kitchingroup.cheme.cmu.edu/blog/2013/04/12/Tool-tips-on-text-in-Emacs/">Tooltips on text in Emacs &#x2014;Kitchin</a></li>
<li><a href="http://kitchingroup.cheme.cmu.edu/blog/2016/03/16/Getting-graphical-feedback-as-tooltips-in-Emacs/">Getting graphical feedback as tooltips in Emacs &#x2014;Kitchin</a></li>
<li><a href="https://stackoverflow.com/questions/293853/defining-new-tooltips-in-emacs">Defining new tooltips in Emacs &#x2014;Stackoverflow</a></li>
</ul>



</details>

<dl class="org-dl">
<dt>Line <a href="#coderef-exface" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-exface');" onmouseout="CodeHighlightOff(this, 'coderef-exface');">37</a> <code>:face</code></dt><dd><p>
What textual properties do these links possess?
</p>

<p>
This is <b>either a face or a face-valued function</b> that takes the current link's
path label as the only argument. That is, we could change the face according
to the link's label &#x2014;which is what we will do for the <code>color</code> link type as in
<code>[[color:brown][hello]]</code> will be rendered in brown text.
</p>

<ul class="org-ul">
<li>If <code>:face</code> is not provided, the default underlined blue face for Org links is used.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Faces.html">Learn more about faces!</a></li>
</ul></dd>

<dt>More</dt><dd>See <code>org-link-parameters</code> for documentation on more parameters.</dd>
</dl>
</div>
</div>

<div id="outline-container-NEW-o-deflink" class="outline-4">
<h4 id="NEW-o-deflink"><span class="section-number-4">1.2.2</span> <a href="#NEW-o-deflink">Define links as you define functions: <abbr class="tooltip" title="Make a new Org-link NAME that exports using form BODY.<br><br>Since Org links are essentially string-valued functions,<br>a function ‘o-link/NAME’ is created.<br><br>DOCSTRING is optional; it is visible with<br>&emsp; (documentation ’o-link/NAME)<br><br>BODY is a string-valued expression, that may make use of the names<br>o-label, o-description, o-backend. The final one refers to the export<br>backend, such as ’html or ’latex. The first two are obtained from uses:<br><br>&emsp; Y (name:o-label][o-description]]<br><br>In particular, the use case “name:o-label” means that o-description is nil.<br><br>Example use:<br><br>&emsp; ;; In a Lisp buffer, press “C-x C-e” to load this definition<br>&emsp; (o-deflink shout (upcase (or o-description o-label)))<br><br>&emsp; ;; In an Org-buffer, press “C-c C-e h o” to see how this exports<br>&emsp; <shout: hello world!><br><br>&emsp; ;; Or using the bracket format<br>&emsp; [[shout:][hello world!]]<br>&emsp; [[shout: hello world!]]<br><br>&emsp; ;; or using the plain format<br>&emsp; shout:hello_world<br><br>Here is a more complex, involved, example that makes use of<br>‘:let’ for local declarations. For instance, “define:hello”<br>renders as the word “hello” with a tooltip defining the word; the<br>definition is obtained from the command line tool ‘wn’.<br><br>&emsp;(o-deflink define<br>&emsp;&emsp;''Define the given word using WordNet, along with synonyms and coordinate terms.''<br>&emsp;&emsp;[:let (definition (shell-command-to-string (format ''wn %s -over -synsn -coorn'' o-label)))<br>&emsp;&emsp; :help-echo definition]<br>&emsp;&emsp;(--> definition<br>&emsp;&emsp;&emsp;(s-replace-regexp ''\\\'''' ''’’'' it) ;; The presence of ‘\''’ in tooltips breaks things, so omit them.<br>&emsp;&emsp;&emsp;(s-replace-regexp ''\n'' ''<br>'' it)<br>&emsp;&emsp;&emsp;(format ''<abbr class=\''tooltip\'' title=\''%s\''>%s</abbr>'' it o-label)))<br><br>For HTML tooltips, see ‘o-html-export-preserving-whitespace’.<br><br>More generally, org-special-block-extra’s “doc” link type<br>supports, in order of precedence: User definitions, Emacs Lisp<br>documentation of functions & variables, and definitions of<br>English words. For example, “doc:existential_angst” for an entry<br>‘existential_angst’ whose associated documentation-glossary is<br>user-defined in a ‘#+documentation’ Org-block, or<br>“doc:thread-first” for the Emacs Lisp documentation of the<br>function ‘thread-first’, or “doc:user-mail-address” for the Emacs<br>Lisp documentation of the variable ‘user-mail-address’, or<br>“doc:hello” for the definition of the English word ‘hello’.<br><br>DISPLAY is a vector consisting of key-value pairs that affects how the link<br>is displayed in Emacs Org buffers. The keys are as follows.<br><br>+ :help-echo is a string-valued expression of the tooltip that should accompany<br>&emsp;the new link in Org buffers. It has access to o-format being one of ‘plain’,<br>&emsp;‘angle’, ‘bracket’ which indicates the format of the link, as shown above.<br>&emsp;It also has access to o-label and o-description.<br><br>&emsp;By default, the tooltip is the link name followed by the documentation<br>&emsp;of the link, and, finally, the HTML export of the link.<br>&emsp;That way, upon hover, users can visually see the link contents,<br>&emsp;know what/how the link exports, and actually see the HTML export.<br><br>&emsp;That is to say, for the ‘shout’ example aboce, the default display is essentially:<br>&emsp;[:help-echo (o-link/shout o-label o-description ’html)]<br><br>&emsp;You may want to add the following to your Emacs init file:<br><br>&emsp;&emsp;;; Nearly instantaneous display of tooltips.<br>&emsp;&emsp;(setq tooltip-delay 0)<br>&emsp;&emsp;;; Give user 30 seconds before tooltip automatically disappears.<br>&emsp;&emsp;(setq tooltip-hide-delay 300)<br><br>+ :face specifies how should these links be displayed within Emacs.<br>&emsp; It is a list-valued expression.<br>&emsp; As usual, it may make use of O-LABEL (but O-DESCRIPTION has value nil).<br><br>+ [:display full] if you do not want bracket links to be<br>&emsp;folded away in Org buffers; i.e., “[[X)” does not render as just “Y”.<br><br>+ :follow is a form that is executed when you click on such links; e.g., to open<br>&emsp; another buffer, browser, or other action. It makes use of (an implicit argument) ‘o-label’.<br>&emsp; Be aware that ‘o-label’ is a string that may contain spaces; e.g., when the action is to open<br>&emsp; a URL in a browser.<br><br>&emsp; If you are in need of providing similar, related, actions on a single link<br>&emsp; then your :follow can condition on the current prefix argument via ‘o-prefix’<br>&emsp; (which is essentially ‘current-prefix-arg’).<br>&emsp; For instance, a user presses “C-u RET” on your link to do one thing<br>&emsp; but “C-u 72 RET” to do another action.<br><br>+ :keymap is an alternating list of keys and actions to be<br>&emsp;performed when those keys are pressed while point is on the link.<br>&emsp;For example:<br>&emsp;&emsp;&emsp;[:keymap (C-h (message-box ''hola''))]<br><br>&emsp;By default, C-n and C-p are for moving to next and previous occruances of the same link type.<br><br>+ :let is a list of alternating variable symbol name and value, which are then used to form<br>&emsp;a concrete ‘let*’ clause. This is useful for introducing local variables for use in the DISPLAY<br>&emsp;as well as in the CONTENTS. Such local declarations may make use of O-LABEL and O-DESCRIPTION, as usual.<br><br>(fn NAME &optional DOCSTRING DISPLAY &rest BODY)">o-deflink</abbr></a></h4>
<div class="outline-text-4" id="text-NEW-o-deflink">
<p>
For export purposes, an Org link can be thought of as a string-valued function
whose inputs are the link's label, description, and the export backend.  Since
the input arguments are fixed, the <code>o-deflink</code> interface is similar to <code>cl-defun</code> in
that it takes a name, (no input arguments), an optional docstring, and a body
which may make use of (the unchanging input) names <code>o-label, o-description,
 o-backend</code>. Moreover, after the documentation string, it may take an optional
vector of display settings: Org links can be declared to look aesthetically
pleasing within Emacs and to behave (via clicks/hovers/key-bindings) in
meaningful ways.
</p>


<div id="org82bdf03" class="figure">
<p><img src="./images/o-deflink.png" alt="o-deflink.png" width="100%" height="100%" />
</p>
</div>

<p>
Here is a minimal working example.  After evaluating this, in an Org buffer,
phrases such as <code>shout:hello</code> will (1) be shown in bold red, (2) have a hover
tooltip that shows the documentation of the link <i>and</i> an HTML export preview, and
(3) the HTML export of the Org buffer will render the label <code>hello</code> as capitalised
red text.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-deflink</span> shout
  <span style="color: #2aa198;">"Capitalise the link description, if any, otherwise capitalise the label.</span>

<span style="color: #2aa198;">The link text appears as red bold in both Emacs and in HTML export."</span>
  [<span style="color: #d33682; font-style: italic;">:face</span> '(<span style="color: #d33682; font-style: italic;">:foreground</span> <span style="color: #2aa198;">"red"</span> <span style="color: #d33682; font-style: italic;">:weight</span> <span style="color: #b58900;">bold</span>)]
  (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;span style=\"color:red\"&gt; %s &lt;/span&gt;"</span>
          (<span style="color: #b58900;">upcase</span> (<span style="color: #859900; font-weight: bold;">or</span> o-description o-label))))
</pre>
</div>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation of o-deflink
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">cl-defmacro</span> <span style="color: #b58900;">o-deflink</span>
    (name <span style="color: #b58900; font-style: italic;">&amp;optional</span> docstring display <span style="color: #b58900; font-style: italic;">&amp;rest</span> body)
  <span style="color: #35a69c; font-style: italic;">"Make a new Org-link NAME that exports using form BODY.</span>

<span style="color: #35a69c; font-style: italic;">Since Org links are essentially string-valued functions,</span>
<span style="color: #35a69c; font-style: italic;">a function &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">o-link/NAME</span><span style="color: #35a69c; font-style: italic;">&#8217; is created.</span>

<span style="color: #35a69c; font-style: italic;">DOCSTRING is optional; it is visible with</span>
<span style="color: #35a69c; font-style: italic;">   (documentation 'o-link/NAME)</span>

<span style="color: #35a69c; font-style: italic;">BODY is a string-valued expression, that may make use of the names</span>
<span style="color: #35a69c; font-style: italic;">o-label, o-description, o-backend. The final one refers to the export</span>
<span style="color: #35a69c; font-style: italic;">backend, such as 'html or 'latex. The first two are obtained from uses:</span>

<span style="color: #35a69c; font-style: italic;">   [[name:o-label][o-description]]</span>

<span style="color: #35a69c; font-style: italic;">In particular, the use case &#8220;name:o-label&#8221; means that o-description is nil.</span>

<span style="color: #35a69c; font-style: italic;">Example use:</span>

<span style="color: #35a69c; font-style: italic;">   ;; In a Lisp buffer, press &#8220;C-x C-e&#8221; to load this definition</span>
<span style="color: #35a69c; font-style: italic;">   (o-deflink shout (upcase (or o-description o-label)))</span>

<span style="color: #35a69c; font-style: italic;">   ;; In an Org-buffer, press &#8220;C-c C-e h o&#8221; to see how this exports</span>
<span style="color: #35a69c; font-style: italic;">   &lt;shout: hello world!&gt;</span>

<span style="color: #35a69c; font-style: italic;">   ;; Or using the bracket format</span>
<span style="color: #35a69c; font-style: italic;">   [[shout:][hello world!]]</span>
<span style="color: #35a69c; font-style: italic;">   [[shout: hello world!]]</span>

<span style="color: #35a69c; font-style: italic;">   ;; or using the plain format</span>
<span style="color: #35a69c; font-style: italic;">   shout:hello_world</span>

<span style="color: #35a69c; font-style: italic;">Here is a more complex, involved, example that makes use of</span>
<span style="color: #35a69c; font-style: italic;">&#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">:let</span><span style="color: #35a69c; font-style: italic;">&#8217; for local declarations. For instance, &#8220;define:hello&#8221;</span>
<span style="color: #35a69c; font-style: italic;">renders as the word &#8220;hello&#8221; with a tooltip defining the word; the</span>
<span style="color: #35a69c; font-style: italic;">definition is obtained from the command line tool &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">wn</span><span style="color: #35a69c; font-style: italic;">&#8217;.</span>

<span style="color: #35a69c; font-style: italic;">  (o-deflink define</span>
<span style="color: #35a69c; font-style: italic;">    \"Define the given word using WordNet, along with synonyms and coordinate terms.\"</span>
<span style="color: #35a69c; font-style: italic;">    [:let (definition (shell-command-to-string (format \"wn %s -over -synsn -coorn\" o-label)))</span>
<span style="color: #35a69c; font-style: italic;">     :help-echo definition]</span>
<span style="color: #35a69c; font-style: italic;">    (--&gt; definition</span>
<span style="color: #35a69c; font-style: italic;">      (s-replace-regexp \"\\\\\\\"\" \"''\" it) ;; The presence of &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">\\\"</span><span style="color: #35a69c; font-style: italic;">&#8217; in tooltips breaks things, so omit them.</span>
<span style="color: #35a69c; font-style: italic;">      (s-replace-regexp \"\\n\" \"&lt;br&gt;\" it)</span>
<span style="color: #35a69c; font-style: italic;">      (format \"&lt;abbr class=\\\"tooltip\\\" title=\\\"%s\\\"&gt;%s&lt;/abbr&gt;\" it o-label)))</span>

<span style="color: #35a69c; font-style: italic;">For HTML tooltips, see `</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">o-html-export-preserving-whitespace</span><span style="color: #35a69c; font-style: italic;">'.</span>

<span style="color: #35a69c; font-style: italic;">More generally, org-special-block-extra's &#8220;doc&#8221; link type</span>
<span style="color: #35a69c; font-style: italic;">supports, in order of precedence: User definitions, Emacs Lisp</span>
<span style="color: #35a69c; font-style: italic;">documentation of functions &amp; variables, and definitions of</span>
<span style="color: #35a69c; font-style: italic;">English words. For example, &#8220;doc:existential_angst&#8221; for an entry</span>
<span style="color: #35a69c; font-style: italic;">&#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">existential_angst</span><span style="color: #35a69c; font-style: italic;">&#8217; whose associated documentation-glossary is</span>
<span style="color: #35a69c; font-style: italic;">user-defined in a &#8216;#+documentation&#8217; Org-block, or</span>
<span style="color: #35a69c; font-style: italic;">&#8220;doc:thread-first&#8221; for the Emacs Lisp documentation of the</span>
<span style="color: #35a69c; font-style: italic;">function `</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">thread-first</span><span style="color: #35a69c; font-style: italic;">', or &#8220;doc:user-mail-address&#8221; for the Emacs</span>
<span style="color: #35a69c; font-style: italic;">Lisp documentation of the variable `</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">user-mail-address</span><span style="color: #35a69c; font-style: italic;">', or</span>
<span style="color: #35a69c; font-style: italic;">&#8220;doc:hello&#8221; for the definition of the English word &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">hello</span><span style="color: #35a69c; font-style: italic;">&#8217;.</span>

<span style="color: #35a69c; font-style: italic;">DISPLAY is a vector consisting of key-value pairs that affects how the link</span>
<span style="color: #35a69c; font-style: italic;">is displayed in Emacs Org buffers. The keys are as follows.</span>

<span style="color: #35a69c; font-style: italic;">+ :help-echo is a string-valued expression of the tooltip that should accompany</span>
<span style="color: #35a69c; font-style: italic;">  the new link in Org buffers. It has access to o-format being one of &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">plain</span><span style="color: #35a69c; font-style: italic;">&#8217;,</span>
<span style="color: #35a69c; font-style: italic;">  &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">angle</span><span style="color: #35a69c; font-style: italic;">&#8217;, &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">bracket</span><span style="color: #35a69c; font-style: italic;">&#8217; which indicates the format of the link, as shown above.</span>
<span style="color: #35a69c; font-style: italic;">  It also has access to o-label and o-description.</span>

<span style="color: #35a69c; font-style: italic;">  By default, the tooltip is the link name followed by the documentation</span>
<span style="color: #35a69c; font-style: italic;">  of the link, and, finally, the HTML export of the link.</span>
<span style="color: #35a69c; font-style: italic;">  That way, upon hover, users can visually see the link contents,</span>
<span style="color: #35a69c; font-style: italic;">  know what/how the link exports, and actually see the HTML export.</span>

<span style="color: #35a69c; font-style: italic;">  That is to say, for the &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">shout</span><span style="color: #35a69c; font-style: italic;">&#8217; example aboce, the default display is essentially:</span>
<span style="color: #35a69c; font-style: italic;">  [:help-echo (o-link/shout o-label o-description 'html)]</span>

<span style="color: #35a69c; font-style: italic;">  You may want to add the following to your Emacs init file:</span>

<span style="color: #35a69c; font-style: italic;">    ;; Nearly instantaneous display of tooltips.</span>
<span style="color: #35a69c; font-style: italic;">    (setq tooltip-delay 0)</span>
<span style="color: #35a69c; font-style: italic;">    ;; Give user 30 seconds before tooltip automatically disappears.</span>
<span style="color: #35a69c; font-style: italic;">    (setq tooltip-hide-delay 300)</span>

<span style="color: #35a69c; font-style: italic;">+ :face specifies how should these links be displayed within Emacs.</span>
<span style="color: #35a69c; font-style: italic;">   It is a list-valued expression.</span>
<span style="color: #35a69c; font-style: italic;">   As usual, it may make use of O-LABEL (but O-DESCRIPTION has value nil).</span>

<span style="color: #35a69c; font-style: italic;">+ [:display full] if you do not want bracket links to be</span>
<span style="color: #35a69c; font-style: italic;">  folded away in Org buffers; i.e., &#8220;[[X][Y]]&#8221; does not render as just &#8220;Y&#8221;.</span>

<span style="color: #35a69c; font-style: italic;">+ :follow is a form that is executed when you click on such links; e.g., to open</span>
<span style="color: #35a69c; font-style: italic;">   another buffer, browser, or other action. It makes use of (an implicit argument) &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">o-label</span><span style="color: #35a69c; font-style: italic;">&#8217;.</span>
<span style="color: #35a69c; font-style: italic;">   Be aware that &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">o-label</span><span style="color: #35a69c; font-style: italic;">&#8217; is a string that may contain spaces; e.g., when the action is to open</span>
<span style="color: #35a69c; font-style: italic;">   a URL in a browser.</span>

<span style="color: #35a69c; font-style: italic;">   If you are in need of providing similar, related, actions on a single link</span>
<span style="color: #35a69c; font-style: italic;">   then your :follow can condition on the current prefix argument via &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">o-prefix</span><span style="color: #35a69c; font-style: italic;">&#8217;</span>
<span style="color: #35a69c; font-style: italic;">   (which is essentially `</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">current-prefix-arg</span><span style="color: #35a69c; font-style: italic;">').</span>
<span style="color: #35a69c; font-style: italic;">   For instance, a user presses &#8220;C-u RET&#8221; on your link to do one thing</span>
<span style="color: #35a69c; font-style: italic;">   but &#8220;C-u 72 RET&#8221; to do another action.</span>

<span style="color: #35a69c; font-style: italic;">+ :keymap is an alternating list of keys and actions to be</span>
<span style="color: #35a69c; font-style: italic;">  performed when those keys are pressed while point is on the link.</span>
<span style="color: #35a69c; font-style: italic;">  For example:</span>
<span style="color: #35a69c; font-style: italic;">      [:keymap (C-h (message-box \"hola\"))]</span>

<span style="color: #35a69c; font-style: italic;">  By default, C-n and C-p are for moving to next and previous occruances of the same link type.</span>

<span style="color: #35a69c; font-style: italic;">+ :let is a list of alternating variable symbol name and value, which are then used to form</span>
<span style="color: #35a69c; font-style: italic;">  a concrete `</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">let*</span><span style="color: #35a69c; font-style: italic;">' clause. This is useful for introducing local variables for use in the DISPLAY</span>
<span style="color: #35a69c; font-style: italic;">  as well as in the CONTENTS. Such local declarations may make use of O-LABEL and O-DESCRIPTION, as usual."</span>
  (<span style="color: #859900; font-weight: bold;">cl-destructuring-bind</span> (docstring display body)
      (<span style="color: #b58900;">lf-extract-optionals-from-rest</span> docstring #'<span style="color: #b58900;">stringp</span>
                                      display   #'<span style="color: #b58900;">vectorp</span>
                                      body)
    (<span style="color: #859900; font-weight: bold;">setq</span> display (<span style="color: #b58900;">seq--into-list</span> display))
    (<span style="color: #859900; font-weight: bold;">let</span> ((o-link/NAME (<span style="color: #b58900;">intern</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"o-link/%s"</span> name)))
          (navigation <span style="color: #2aa198;">"Press &#8220;C-h&#8221; to see possible actions on this link type."</span>)
          (lets (<span style="color: #859900; font-weight: bold;">cl-loop</span> for (variable value)
                      on (<span style="color: #b58900;">cl-getf</span> display <span style="color: #d33682; font-style: italic;">:let</span>)
                      by #'<span style="color: #b58900;">cddr</span>
                      collect (<span style="color: #b58900;">list</span> variable value))))
      `(<span style="color: #859900; font-weight: bold;">progn</span>
       <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Declare the underlying function and documentation</span>
       (<span style="color: #859900; font-weight: bold;">cl-defun</span> ,o-link/NAME <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">function name</span>
           (o-label o-description o-backend)         <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">function args</span>
           <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">new function documentation</span>
           ,docstring
           <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">function body</span>
           (<span style="color: #859900; font-weight: bold;">let*</span> ,lets ,@body))
       <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Construct the Org-link</span>
       (<span style="color: #b58900;">org-link-set-parameters</span>
        ,(<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s"</span> name)
        <span style="color: #d33682; font-style: italic;">:export</span> (<span style="color: #859900; font-weight: bold;">quote</span> ,o-link/NAME)
        <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">How should these links be displayed?</span>
        <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">(We augment the namespace with the missing o-description that local variables may be using.)</span>
        <span style="color: #d33682; font-style: italic;">:face</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (o-label)  (<span style="color: #859900; font-weight: bold;">let</span> (o-description) (<span style="color: #859900; font-weight: bold;">let*</span> ,lets ,(<span style="color: #b58900;">cl-getf</span> display <span style="color: #d33682; font-style: italic;">:face</span>))))
        <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">When you click on such links, what should happen?</span>
        <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">(We augment the namespace with the missing o-description that local variables may be using.)</span>
        <span style="color: #d33682; font-style: italic;">:follow</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (o-label o-prefix) (<span style="color: #859900; font-weight: bold;">let</span> (o-description) (<span style="color: #859900; font-weight: bold;">let*</span> ,lets ,(<span style="color: #b58900;">cl-getf</span> display <span style="color: #d33682; font-style: italic;">:follow</span>))))
         <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">These links should *never* be folded in descriptive display;</span>
        <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">i.e., &#8220;[[example:lable][description]]&#8221; will always appear verbatim</span>
        <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">and not hide the first pair [&#8230;].</span>
        <span style="color: #d33682; font-style: italic;">:display</span> (<span style="color: #859900; font-weight: bold;">quote</span> ,(<span style="color: #b58900;">cl-getf</span> display <span style="color: #d33682; font-style: italic;">:display</span>)) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">e.g.,: 'full</span>
        <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Any special keybindings when cursour is on this link type?</span>
        <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">On &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">NAME:</span><span style="color: #96A7A9; font-style: italic;">&#8217; links, C-n/p to go to the next/previous such links.</span>
        <span style="color: #d33682; font-style: italic;">:keymap</span> (<span style="color: #859900; font-weight: bold;">let</span> ((o-keymap (<span style="color: #b58900;">copy-keymap</span> <span style="color: #268bd2;">org-mouse-map</span>))
                      (pattern (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s:"</span> (<span style="color: #859900; font-weight: bold;">quote</span> ,name)))
                      (msg  (<span style="color: #b58900;">concat</span>
                             (<span style="color: #b58900;">documentation</span> (<span style="color: #859900; font-weight: bold;">quote</span> ,o-link/NAME))
                             <span style="color: #2aa198;">"\nKEY BINDINGS:\n"</span>
                             <span style="color: #2aa198;">"\nUnless indicated below otherwise..."</span>
                             <span style="color: #2aa198;">"\n\tC-h: Shows this helpful message buffer"</span>
                             <span style="color: #2aa198;">"\n\tC-n/C-p on the link to jump to next/previous links of this type;"</span>
                             <span style="color: #2aa198;">"\n\tC-c C-x C-n/p for moving between arbitrary link types.\n\n"</span>
                             (<span style="color: #b58900;">pp-to-string</span> (<span style="color: #859900; font-weight: bold;">quote</span> ,(<span style="color: #b58900;">cl-getf</span> display <span style="color: #d33682; font-style: italic;">:keymap</span>))))))
                  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Populate the keymap</span>
                  (<span style="color: #859900; font-weight: bold;">cl-loop</span> for (key action)
                        on (<span style="color: #b58900;">-cons*</span> 'C-p `(<span style="color: #b58900;">re-search-backward</span> ,pattern nil <span style="color: #268bd2;">t</span>)
                                   'C-n `(<span style="color: #b58900;">re-search-forward</span> ,pattern nil <span style="color: #268bd2;">t</span>)
                                   'C-h `(<span style="color: #859900; font-weight: bold;">-let</span> [<span style="color: #268bd2;">max-mini-window-height</span> 0] <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">i.e., insist on displaying in a dedicated buffer</span>
                                           (<span style="color: #b58900;">display-message-or-buffer</span> ,msg))
                                   (<span style="color: #859900; font-weight: bold;">quote</span> ,(<span style="color: #b58900;">cl-getf</span> display <span style="color: #d33682; font-style: italic;">:keymap</span>)))
                        by #'<span style="color: #b58900;">cddr</span>
                        <span style="color: #b58900;">do</span> (<span style="color: #b58900;">define-key</span> o-keymap (<span style="color: #b58900;">kbd</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s"</span> key))
                             `(<span style="color: #859900; font-weight: bold;">lambda</span> () (<span style="color: #859900; font-weight: bold;">interactive</span>) ,action)))
                  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Return the keymap</span>
                  o-keymap)
        <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The tooltip alongside a link</span>
        <span style="color: #d33682; font-style: italic;">:help-echo</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (window object <span style="color: #b58900;">position</span>)
                     (<span style="color: #859900; font-weight: bold;">save-excursion</span>
                       (<span style="color: #b58900;">goto-char</span> <span style="color: #b58900;">position</span>)
                       (<span style="color: #859900; font-weight: bold;">-let*</span> (((<span style="color: #b58900; font-style: italic;">&amp;plist</span> <span style="color: #d33682; font-style: italic;">:path</span> <span style="color: #d33682; font-style: italic;">:format</span> <span style="color: #d33682; font-style: italic;">:contents-begin</span> <span style="color: #d33682; font-style: italic;">:contents-end</span>)
                                (<span style="color: #b58900;">cadr</span> (<span style="color: #b58900;">org-element-context</span>)))
                               (o-format <span style="color: #b58900;">format</span>)
                               (o-label path)
                               (o-description
                                (<span style="color: #859900; font-weight: bold;">when</span> (<span style="color: #b58900;">equal</span> <span style="color: #b58900;">format</span> 'bracket)
                                  (<span style="color: #b58900;">copy-region-as-kill</span> contents-begin contents-end)
                                  (<span style="color: #b58900;">substring-no-properties</span> (<span style="color: #b58900;">car</span> <span style="color: #268bd2;">kill-ring</span>)))))
                         (<span style="color: #859900; font-weight: bold;">or</span> (<span style="color: #859900; font-weight: bold;">let*</span> ,lets ,(<span style="color: #b58900;">cl-getf</span> display <span style="color: #d33682; font-style: italic;">:help-echo</span>))
                             (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s:%s\n\n%s\nHTML Export:\n\n%s"</span>
                                     (<span style="color: #859900; font-weight: bold;">quote</span> ,name)
                                     (<span style="color: #859900; font-weight: bold;">or</span> o-description o-label)
                                     ,(<span style="color: #b58900;">concat</span> (<span style="color: #859900; font-weight: bold;">or</span> docstring <span style="color: #2aa198;">""</span>) <span style="color: #2aa198;">"\n\n"</span> navigation <span style="color: #2aa198;">"\n"</span>)
                                     (,o-link/NAME o-label o-description 'html)))))))
        <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Return value is the name of the underlying function.</span>
        <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">We do this to be consistent with `</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">defun</span><span style="color: #96A7A9; font-style: italic;">'.</span>
        (<span style="color: #859900; font-weight: bold;">quote</span> ,o-link/NAME)))))
</pre>
</div>

<p>
Let's have some sanity tests&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-deflink</span> shout
  <span style="color: #2aa198;">"Capitalise the link description, if any, otherwise capitalise the label.</span>

<span style="color: #2aa198;">The link text appears as red bold in both Emacs and in HTML export."</span>
  [<span style="color: #d33682; font-style: italic;">:face</span> '(<span style="color: #d33682; font-style: italic;">:foreground</span> <span style="color: #2aa198;">"red"</span> <span style="color: #d33682; font-style: italic;">:weight</span> <span style="color: #b58900;">bold</span>)
   <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">:help-echo (o-link/shout o-label o-description 'html)</span>
   <span style="color: #d33682; font-style: italic;">:display</span> full
   <span style="color: #d33682; font-style: italic;">:keymap</span> (C-m (<span style="color: #b58900;">message-box</span> <span style="color: #2aa198;">"hola"</span>))
   <span style="color: #d33682; font-style: italic;">:follow</span> (<span style="color: #b58900;">message-box</span> <span style="color: #2aa198;">"%s and %s"</span> pre <span style="color: #268bd2;">current-prefix-arg</span>)
   ]
  (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;span style=\"color:red\"&gt; %s &lt;/span&gt;"</span>
          (<span style="color: #b58900;">upcase</span> (<span style="color: #859900; font-weight: bold;">or</span> o-description o-label))))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"o-deflink makes documented functions"</span>
  [<span style="color: #b58900;">o-deflink</span>]
  (&#8669; (<span style="color: #b58900;">documentation</span> #'<span style="color: #b58900;">o-link/shout</span>)
     <span style="color: #2aa198;">"Capitalise the link description, if any, otherwise capitalise the label.</span>

<span style="color: #2aa198;">     The link text appears as red bold in both Emacs and in HTML export."</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"o-deflink works as expected, plain links"</span>
  [<span style="color: #b58900;">o-deflink</span>]
  (<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">not</span> (<span style="color: #b58900;">null</span> (<span style="color: #b58900;">symbol-function</span> '<span style="color: #b58900;">o-link/shout</span>))))
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"shout:hello"</span>)
     <span style="color: #2aa198;">"&lt;p&gt; &lt;span style=\"color:red\"&gt; HELLO &lt;/span&gt;&lt;/p&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"o-deflink works as expected, bracket links"</span>
  [<span style="color: #b58900;">o-deflink</span>]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"[[shout:hello]]"</span>)
     <span style="color: #2aa198;">"&lt;p&gt; &lt;span style=\"color:red\"&gt; HELLO &lt;/span&gt;&lt;/p&gt;"</span>)
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"[[shout:hello][world!]]"</span>)
     <span style="color: #2aa198;">"&lt;p&gt; &lt;span style=\"color:red\"&gt; WORLD! &lt;/span&gt;&lt;/p&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"o-deflink works as expected, angle links"</span>
  [<span style="color: #b58900;">o-deflink</span>]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"&lt;shout: hello world!&gt;"</span>)
     <span style="color: #2aa198;">"&lt;p&gt; &lt;span style=\"color:red\"&gt; HELLO WORLD! &lt;/span&gt;&lt;/p&gt;"</span>))
</pre>
</div>



</details>
</div>
</div>
</div>

<div id="outline-container-The-Core-Utility-defblock-and-friends" class="outline-3">
<h3 id="The-Core-Utility-defblock-and-friends"><span class="section-number-3">1.3</span> <a href="#The-Core-Utility-defblock-and-friends">The Core Utility: <code>defblock</code> and friends</a></h3>
<div class="outline-text-3" id="text-The-Core-Utility-defblock-and-friends">
<p>
To have a unified, and pleasant, interface for declaring new blocks and links,
we take the following approach:
</p>

<ol class="org-ol">
<li value="0">( <i>Fuse</i> the process of link generation and special block support into
one macro,  <abbr class="tooltip" title="Declare a new special block, and link, in the style of DEFUN.<br><br>A full featured example is at the end of this documentation string.<br><br>This is an anaphoric macro that provides export support for<br>special blocks <strong>and</strong> links named NAME. Just as an Org-mode<br>src-block consumes as main argument the language for the src<br>block, our special blocks too consume a MAIN-ARG; it may be a<br>symbol or a cons-list consisting of a symbolic name (with which<br>to refer to the main argument in the definition of the block)<br>followed by a default value, then, optionally, any information<br>for a one-time setup of the associated link type.<br><br>The main arg may be a sequence of symbols separated by spaces,<br>and a few punctuation with the exception of comma ‘,’ since it is<br>a special Lisp operator. In doubt, enclose the main arg in<br>quotes.<br><br>Then, just as Org-mode src blocks consume key-value pairs, our<br>special blocks consume a number of KWDS, which is a list of the<br>form (key₀ value₀ … keyₙ valueₙ).<br><br>After that is an optional DOCSTRING, a familar feature of DEFUN.<br>The docstring is displayed as part of the tooltip for the<br>produced link type.<br><br>Finally, the BODY is a (sequence of) Lisp forms ---no progn<br>needed--- that may refer to the names BACKEND and CONTENTS which<br>refer to the current export backend and the contents of the<br>special block ---or the description clause of a link.<br><br>CONTENTS refers to an Org-mode parsed string; i.e., Org-markup is<br>acknowledged.<br><br>In, hopefully, rare circumstances, one may refer to RAW-CONTENTS<br>to look at the fully unparsed contents.<br><br>Finally, this macro exposes two functions:<br>+ ORG-EXPORT: Wrap the argument in an export block for the current backend.<br>+ ORG-PARSE: This should ONLY be called within an ORG-EXPORT call,<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; to escape text to Org, and out of the export block.<br><br><hr><br><br>TLDR for EXPERIMENTAL and DOCSTRING and BODY, the first two parts are<br>optional; they’re a symbol, a string, then the main body.&emsp;The<br>symbol, O-RESPECT-NEWLINES?, when present enables a highly<br>experimental [i.e., do <strong>not</strong> use it!] feature: No new lines for<br>blocks in HTML export.&emsp;Its need rose from developing the MARGIN<br>block type.<br><br><hr><br><br>The relationship between links and special blocks:<br><br>&emsp;[ [type:label][description]]<br>≈<br>&emsp; #+begin_type label<br>&emsp;&emsp;description<br>&emsp; #+end_type<br><br><hr><br><br>Example declaration, with all possible features shown:<br><br>&emsp; ;; We can use variable values when defining new blocks<br>&emsp; (setq angry-red ’(:foreground ''red'' :weight bold))<br><br>&emsp; (defblock remark<br>&emsp;&emsp; (editor ''Editor Remark'' :face angry-red) (color ''red'' signoff '''')<br>&emsp;&emsp; ''Top level (HTML & LaTeX)O-RESPECT-NEWLINES? editorial remarks; in Emacs they’re angry red.''<br>&emsp;&emsp; (format (if (equal backend ’html)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''<strong style=\''color: %s;\''>⟦%s:&emsp;%s%s⟧</strong>''<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''{\color{%s}\bfseries %s:&emsp;%s%s}'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; color editor contents signoff))<br><br>&emsp; ;; I don’t want to change the definition, but I’d like to have<br>&emsp; ;; the following as personalised defaults for the “remark” block.<br>&emsp; ;; OR, I’d like to set this for links, which do not have argument options.<br>&emsp; (defblock-header-args remark :main-arg ''Jasim Jameson'' :signoff ''( Aim for success! )'')<br><br>Three example uses:<br><br>&emsp;&emsp;;; ⟨0⟩ As a special blocks with arguments given.<br>&emsp;&emsp;#+begin_remark Bobbert Barakallah :signoff ''Thank-you for pointing this out!'' :color green<br>&emsp;&emsp;I was trying to explain that <em>{large (n × (n + 1) over 2}</em> is always an integer.<br>&emsp;&emsp;#+end_remark<br><br>&emsp;&emsp;;; ⟨1⟩ As a terse link, using default values for the args.<br>&emsp;&emsp;;;&emsp;&emsp; Notice that Org-mode formatting is recoqgnised even in links.<br>&emsp;&emsp;[ [remark:Jasim Jameson][Why are you taking about “<em>mathsf{even}</em>” here?]]<br><br>&emsp;&emsp;;; ⟨2⟩ So terse that no editor name is provided.<br>&emsp;&emsp;[ [remark:][Please improve your transition sentences.]]<br><br>&emsp;&emsp;;; ⟨★⟩ Unlike 0, examples 1 and 2 will have the default SIGNOFF<br>&emsp;&emsp;;; catenated as well as the default red color.<br><br>(fn NAME MAIN-ARG KWDS &optional EXPERIMENTAL DOCSTRING &rest BODY)">defblock</abbr> which is like <abbr class="tooltip" title="Define NAME as a function.<br>The definition is (lambda ARGLIST [DOCSTRING] BODY...).<br>See also the function ‘interactive’.<br>DECL is a declaration, optional, of the form (declare DECLS...) where<br>DECLS is a list of elements of the form (PROP . VALUES).&emsp;These are<br>interpreted according to ‘defun-declarations-alist’.<br>The return value is undefined.<br><br>(fn NAME ARGLIST &optional DOCSTRING DECL &rest BODY)">defun</abbr>. )</li>

<li><p>
The user writes as string-valued function named 𝒳, possibly with arguments,
that has access to a <code>contents</code> and <code>backend</code> variables.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         ‘defblock’ Implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">o--supported-blocks</span> nil
  <span style="color: #35a69c; font-style: italic;">"Which special blocks, defined with DEFBLOCK, are supported."</span>)

(<span style="color: #859900; font-weight: bold;">cl-defmacro</span> <span style="color: #b58900;">o-defblock</span>
  (name main-arg kwds <span style="color: #b58900; font-style: italic;">&amp;optional</span> experimental docstring <span style="color: #b58900; font-style: italic;">&amp;rest</span> body)
  <span style="color: #35a69c; font-style: italic;">"Declare a new special block, and link, in the style of DEFUN.</span>

<span style="color: #35a69c; font-style: italic;">A full featured example is at the end of this documentation string.</span>

<span style="color: #35a69c; font-style: italic;">This is an anaphoric macro that provides export support for</span>
<span style="color: #35a69c; font-style: italic;">special blocks *and* links named NAME. Just as an Org-mode</span>
<span style="color: #35a69c; font-style: italic;">src-block consumes as main argument the language for the src</span>
<span style="color: #35a69c; font-style: italic;">block, our special blocks too consume a MAIN-ARG; it may be a</span>
<span style="color: #35a69c; font-style: italic;">symbol or a cons-list consisting of a symbolic name (with which</span>
<span style="color: #35a69c; font-style: italic;">to refer to the main argument in the definition of the block)</span>
<span style="color: #35a69c; font-style: italic;">followed by a default value, then, optionally, any information</span>
<span style="color: #35a69c; font-style: italic;">for a one-time setup of the associated link type.</span>

<span style="color: #35a69c; font-style: italic;">The main arg may be a sequence of symbols separated by spaces,</span>
<span style="color: #35a69c; font-style: italic;">and a few punctuation with the exception of comma &#8216;,&#8217; since it is</span>
<span style="color: #35a69c; font-style: italic;">a special Lisp operator. In doubt, enclose the main arg in</span>
<span style="color: #35a69c; font-style: italic;">quotes.</span>

<span style="color: #35a69c; font-style: italic;">Then, just as Org-mode src blocks consume key-value pairs, our</span>
<span style="color: #35a69c; font-style: italic;">special blocks consume a number of KWDS, which is a list of the</span>
<span style="color: #35a69c; font-style: italic;">form (key&#8320; value&#8320; &#8230; key&#8345; value&#8345;).</span>

<span style="color: #35a69c; font-style: italic;">After that is an optional DOCSTRING, a familar feature of DEFUN.</span>
<span style="color: #35a69c; font-style: italic;">The docstring is displayed as part of the tooltip for the</span>
<span style="color: #35a69c; font-style: italic;">produced link type.</span>

<span style="color: #35a69c; font-style: italic;">Finally, the BODY is a (sequence of) Lisp forms ---no progn</span>
<span style="color: #35a69c; font-style: italic;">needed--- that may refer to the names BACKEND and CONTENTS which</span>
<span style="color: #35a69c; font-style: italic;">refer to the current export backend and the contents of the</span>
<span style="color: #35a69c; font-style: italic;">special block ---or the description clause of a link.</span>

<span style="color: #35a69c; font-style: italic;">CONTENTS refers to an Org-mode parsed string; i.e., Org-markup is</span>
<span style="color: #35a69c; font-style: italic;">acknowledged.</span>

<span style="color: #35a69c; font-style: italic;">In, hopefully, rare circumstances, one may refer to RAW-CONTENTS</span>
<span style="color: #35a69c; font-style: italic;">to look at the fully unparsed contents.</span>

<span style="color: #35a69c; font-style: italic;">Finally, this macro exposes two functions:</span>
<span style="color: #35a69c; font-style: italic;">+ ORG-EXPORT: Wrap the argument in an export block for the current backend.</span>
<span style="color: #35a69c; font-style: italic;">+ ORG-PARSE: This should ONLY be called within an ORG-EXPORT call,</span>
<span style="color: #35a69c; font-style: italic;">             to escape text to Org, and out of the export block.</span>

<span style="color: #35a69c; font-style: italic;">----------------------------------------------------------------------</span>

<span style="color: #35a69c; font-style: italic;">TLDR for EXPERIMENTAL and DOCSTRING and BODY, the first two parts are</span>
<span style="color: #35a69c; font-style: italic;">optional; they're a symbol, a string, then the main body.  The</span>
<span style="color: #35a69c; font-style: italic;">symbol, O-RESPECT-NEWLINES?, when present enables a highly</span>
<span style="color: #35a69c; font-style: italic;">experimental [i.e., do *not* use it!] feature: No new lines for</span>
<span style="color: #35a69c; font-style: italic;">blocks in HTML export.  Its need rose from developing the MARGIN</span>
<span style="color: #35a69c; font-style: italic;">block type.</span>

<span style="color: #35a69c; font-style: italic;">----------------------------------------------------------------------</span>

<span style="color: #35a69c; font-style: italic;">The relationship between links and special blocks:</span>

<span style="color: #35a69c; font-style: italic;">  [ [type:label][description]]</span>
<span style="color: #35a69c; font-style: italic;">&#8776;</span>
<span style="color: #35a69c; font-style: italic;">   #+begin_type label</span>
<span style="color: #35a69c; font-style: italic;">    description</span>
<span style="color: #35a69c; font-style: italic;">   #+end_type</span>

<span style="color: #35a69c; font-style: italic;">----------------------------------------------------------------------</span>

<span style="color: #35a69c; font-style: italic;">Example declaration, with all possible features shown:</span>

<span style="color: #35a69c; font-style: italic;">   ;; We can use variable values when defining new blocks</span>
<span style="color: #35a69c; font-style: italic;">   (setq angry-red '(:foreground \"red\" :weight bold))</span>

<span style="color: #35a69c; font-style: italic;">   (defblock remark</span>
<span style="color: #35a69c; font-style: italic;">     (editor \"Editor Remark\" :face angry-red) (color \"red\" signoff \"\")</span>
<span style="color: #35a69c; font-style: italic;">     \"Top level (HTML &amp; LaTeX)O-RESPECT-NEWLINES? editorial remarks; in Emacs they're angry red.\"</span>
<span style="color: #35a69c; font-style: italic;">     (format (if (equal backend 'html)</span>
<span style="color: #35a69c; font-style: italic;">               \"&lt;strong style=\\\"color: %s;\\\"&gt;&#10214;%s:  %s%s&#10215;&lt;/strong&gt;\"</span>
<span style="color: #35a69c; font-style: italic;">               \"{\\color{%s}\\bfseries %s:  %s%s}\")</span>
<span style="color: #35a69c; font-style: italic;">             color editor contents signoff))</span>

<span style="color: #35a69c; font-style: italic;">   ;; I don't want to change the definition, but I'd like to have</span>
<span style="color: #35a69c; font-style: italic;">   ;; the following as personalised defaults for the &#8220;remark&#8221; block.</span>
<span style="color: #35a69c; font-style: italic;">   ;; OR, I'd like to set this for links, which do not have argument options.</span>
<span style="color: #35a69c; font-style: italic;">   (defblock-header-args remark :main-arg \"Jasim Jameson\" :signoff \"( Aim for success! )\")</span>

<span style="color: #35a69c; font-style: italic;">Three example uses:</span>

<span style="color: #35a69c; font-style: italic;">    ;; &#10216;0&#10217; As a special blocks with arguments given.</span>
<span style="color: #35a69c; font-style: italic;">    #+begin_remark Bobbert Barakallah :signoff \"Thank-you for pointing this out!\" :color green</span>
<span style="color: #35a69c; font-style: italic;">    I was trying to explain that ${</span><span style="color: #b58900; font-style: italic;">\</span><span style="color: #35a69c; font-style: italic;">large (n &#215; (n + 1) </span><span style="color: #b58900; font-style: italic;">\</span><span style="color: #35a69c; font-style: italic;">over 2}$ is always an integer.</span>
<span style="color: #35a69c; font-style: italic;">    #+end_remark</span>

<span style="color: #35a69c; font-style: italic;">    ;; &#10216;1&#10217; As a terse link, using default values for the args.</span>
<span style="color: #35a69c; font-style: italic;">    ;;     Notice that Org-mode formatting is recoqgnised even in links.</span>
<span style="color: #35a69c; font-style: italic;">    [ [remark:Jasim Jameson][Why are you taking about &#8220;$</span><span style="color: #b58900; font-style: italic;">\</span><span style="color: #35a69c; font-style: italic;">mathsf{even}$&#8221; here?]]</span>

<span style="color: #35a69c; font-style: italic;">    ;; &#10216;2&#10217; So terse that no editor name is provided.</span>
<span style="color: #35a69c; font-style: italic;">    [ [remark:][Please improve your transition sentences.]]</span>

<span style="color: #35a69c; font-style: italic;">    ;; &#10216;&#9733;&#10217; Unlike 0, examples 1 and 2 will have the default SIGNOFF</span>
<span style="color: #35a69c; font-style: italic;">    ;; catenated as well as the default red color."</span>
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">&#8680; The special block support</span>
  <span style="color: #96A7A9; font-style: italic;">;;</span>
  (<span style="color: #b58900;">add-to-list</span> '<span style="color: #268bd2;">o--supported-blocks</span> name) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">global var</span>

  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Identify which of the optional features is present...</span>
  (<span style="color: #859900; font-weight: bold;">cl-destructuring-bind</span> (o-respect-newlines? docstring body)
      (<span style="color: #b58900;">lf-extract-optionals-from-rest</span> experimental #'<span style="color: #b58900;">keywordp</span>
                                      docstring    #'<span style="color: #b58900;">stringp</span>
                                      body)
    `(<span style="color: #859900; font-weight: bold;">progn</span>
       <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Produce an associated Lisp function</span>
       ,(<span style="color: #b58900;">o-defblock---support-block-type</span>
         name
         docstring
         (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">consp</span> `,main-arg) (<span style="color: #b58900;">car</span> main-arg) 'main-arg) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">main argument's name</span>
         (<span style="color: #b58900;">cadr</span> main-arg) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">main argument's value</span>
         kwds
         body
         <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">MA: I'd like it to be always &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">true</span><span style="color: #96A7A9; font-style: italic;">&#8217;, but it's experimental and breaks so much stuff.</span>
         o-respect-newlines?
         )

       <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">&#8680; The link type support</span>
       <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">main-arg</span><span style="color: #96A7A9; font-style: italic;">&#8217; may contain a special key &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">:link-type</span><span style="color: #96A7A9; font-style: italic;">&#8217; whose contents</span>
       <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">are dumped here verbatim.</span>
       <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">&#8216;(main-arg-name main-arg-val :face &#8230; :follow &#8230;)&#8217;</span>
           (<span style="color: #859900; font-weight: bold;">o-deflink</span> ,name
             [<span style="color: #d33682; font-style: italic;">:help-echo</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s:%s\n\n%s"</span> (<span style="color: #859900; font-weight: bold;">quote</span> ,name) o-label ,docstring)
             ,@(<span style="color: #b58900;">cddr</span> main-arg) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">verbatim link extras</span>
             ]
             <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">s-replace-all `(("#+end_export" . "") (,(format "#+begin_export %s" backend) . ""))</span>
             (<span style="color: #b58900;">s-replace-all</span> `((<span style="color: #2aa198;">"</span><span style="color: #b58900;">@@" . "")) ;; (,(format "@@%s</span><span style="color: #96A7A9; font-style: italic;">:" backend) . "")</span>
                            (,(<span style="color: #b58900;">intern</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"o--%s"</span> name))
                             o-backend (<span style="color: #859900; font-weight: bold;">or</span> o-description o-label) o-label <span style="color: #d33682; font-style: italic;">:o-link?</span> <span style="color: #268bd2;">t</span>))))))

<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">WHERE ...</span>

(<span style="color: #859900; font-weight: bold;">cl-defmethod</span> <span style="color: #b58900;">o-defblock---support-block-type</span>
    (name docstring main-arg-name main-arg-value kwds body o-respect-newlines?)
  <span style="color: #35a69c; font-style: italic;">"Helper method for o-defblock.</span>

<span style="color: #35a69c; font-style: italic;">This method creates an Org block type's associated Lisp function.</span>

<span style="color: #35a69c; font-style: italic;">NAME, string: The name of the block type.</span>
<span style="color: #35a69c; font-style: italic;">DOCSTRING, string: Documentation of block.</span>
<span style="color: #35a69c; font-style: italic;">MAIN-ARG-NAME: Essentially main-arg's name</span>
<span style="color: #35a69c; font-style: italic;">MAIN-ARG-VALUE: Essentially main-arg's value</span>
<span style="color: #35a69c; font-style: italic;">KWDS, plist: Keyword-value pairs</span>
<span style="color: #35a69c; font-style: italic;">BODY, list: Code to be executed"</span>
  `(<span style="color: #859900; font-weight: bold;">cl-defun</span> ,(<span style="color: #b58900;">intern</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"o--%s"</span> name))
       (backend raw-contents
                <span style="color: #b58900; font-style: italic;">&amp;optional</span> <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">,(car main-arg)</span>
                ,main-arg-name
                <span style="color: #b58900; font-style: italic;">&amp;rest</span> _
                <span style="color: #b58900; font-style: italic;">&amp;key</span> (o-link? nil) ,@(<span style="color: #b58900;">-partition</span> 2 kwds))
     ,docstring
     <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Use default for main argument</span>
     (<span style="color: #859900; font-weight: bold;">when</span> (<span style="color: #859900; font-weight: bold;">and</span> ',main-arg-name (<span style="color: #b58900;">s-blank-p</span> ,main-arg-name))
       (<span style="color: #859900; font-weight: bold;">--if-let</span> (<span style="color: #b58900;">plist-get</span> (<span style="color: #b58900;">cdr</span> (<span style="color: #b58900;">assoc</span> ',name <span style="color: #268bd2;">o--header-args</span>)) <span style="color: #d33682; font-style: italic;">:main-arg</span>)
           (<span style="color: #859900; font-weight: bold;">setq</span> ,main-arg-name it)
         (<span style="color: #859900; font-weight: bold;">setq</span> ,main-arg-name ,main-arg-value)))

     (<span style="color: #859900; font-weight: bold;">cl-letf</span> (((<span style="color: #b58900;">symbol-function</span> 'org-export)
                 (<span style="color: #859900; font-weight: bold;">lambda</span> (x)
            <span style="color: #35a69c; font-style: italic;">"Wrap the given X in an export block for the current backend.</span>

<span style="color: #35a69c; font-style: italic;">          One can think of this function as replacing the #+begin_&#119987;&#8943;#+end_&#119987;</span>
<span style="color: #35a69c; font-style: italic;">          in-place in your Org document; but really that's done by the</span>
<span style="color: #35a69c; font-style: italic;">          &#8943;-support-blocks function.</span>
<span style="color: #35a69c; font-style: italic;">          "</span>
            (<span style="color: #859900; font-weight: bold;">if</span> o-link?
                x
            <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">o-respect-newlines? is super experimental: It's a bit ugly on the LaTeX side.</span>
            (<span style="color: #859900; font-weight: bold;">cond</span> ((<span style="color: #859900; font-weight: bold;">and</span> ,o-respect-newlines? (<span style="color: #b58900;">member</span> backend '(html reveal)))
                   (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"</span><span style="color: #b58900;">@@%s:%s@@" backend (s-replace "\n" (format "@@\n@@%s</span><span style="color: #2aa198;">:"</span> backend) x) backend))
                  (<span style="color: #d33682; font-style: italic;">:else</span>
                   (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"#+begin_export %s \n%s\n#+end_export"</span>
                           backend x))))))

               ((<span style="color: #b58900;">symbol-function</span> 'org-parse)
                (<span style="color: #859900; font-weight: bold;">lambda</span> (x)
                  <span style="color: #35a69c; font-style: italic;">"This should ONLY be called within an ORG-EXPORT call."</span>
                  (<span style="color: #859900; font-weight: bold;">if</span> o-link?
                      x
                    (<span style="color: #859900; font-weight: bold;">cond</span> ((<span style="color: #859900; font-weight: bold;">and</span> ,o-respect-newlines? (<span style="color: #b58900;">member</span> backend '(html reveal)))
                           (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"</span><span style="color: #b58900;">@@%s@@%s</span><span style="color: #2aa198;">:"</span> x backend))
                          (<span style="color: #d33682; font-style: italic;">:else</span>
                           (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"\n#+end_export\n%s\n#+begin_export %s\n"</span> x
                                   backend)))))))

       <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Use any headers for this block type, if no local value is passed</span>
       ,@(<span style="color: #859900; font-weight: bold;">cl-loop</span> for k in (<span style="color: #b58900;">mapcar</span> #'<span style="color: #b58900;">car</span> (<span style="color: #b58900;">-partition</span> 2 kwds))
                  collect `(<span style="color: #859900; font-weight: bold;">--when-let</span> (<span style="color: #b58900;">plist-get</span> (<span style="color: #b58900;">cdr</span> (<span style="color: #b58900;">assoc</span> ',name <span style="color: #268bd2;">o--header-args</span>))
                                                  ,(<span style="color: #b58900;">intern</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">":%s"</span> k)))
                             (<span style="color: #859900; font-weight: bold;">when</span> (<span style="color: #b58900;">s-blank-p</span> ,k)
                               (<span style="color: #859900; font-weight: bold;">setq</span> ,k it))))

       (org-export
        (<span style="color: #859900; font-weight: bold;">let</span> ((contents (org-parse raw-contents))) ,@body)))))
</pre>
</div></li>
</ol>

<p>
Going forward, it would be nice to have a set of switches that apply to all
special blocks. For instance, <code>:ignore</code> to simply bypass the user-defined
behaviour of a block type, and <code>:noexport</code> to zero-out a block upon export.  These
are super easy to do &#x2014;just need a few minutes to breath.  It may also be
desirable to provide support for <a href="https://github.com/alhassy/emacs.d#html-folded-drawers">drawers</a> &#x2014;just as we did to ‘fuse’ the
block-type and link-type approaches used here into one macro.
</p>



</details>

<ol class="org-ol">
<li value="2"><p>
We tell Org to please look at all special blocks
</p>
<div class="org-src-container">
<pre class="src src-org">#+begin_&#119987; main-arg :key&#8320; value&#8320; &#8230; :key&#8345; value&#8345;
contents
#+end_&#119987;
</pre>
</div>
<p>
Then, before export happens, to replace all such blocks
with the <i>result</i> of calling the user's 𝒳 function; i.e.,
replace them by, essentially,
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(&#119987; main-arg <span style="color: #d33682; font-style: italic;">:key&#8320;</span> value&#8320; &#8230; <span style="color: #d33682; font-style: italic;">:key&#8345;</span> value&#8345; <span style="color: #d33682; font-style: italic;">:o-contents</span> contents)
</pre>
</div>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementing the hooking mechanism
                      </font>
                    </strong>
                  </summary></li>
</ol>

<p>
The mechanism that rewrites your source&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">o--pp-list</span> (xs)
  <span style="color: #35a69c; font-style: italic;">"Given XS as (x&#8321; x&#8322; &#8230; x&#8345;), yield the string &#8220;x&#8321; x&#8322; &#8230; x&#8345;&#8221;, no parens.</span>
<span style="color: #35a69c; font-style: italic;">  When n = 0, yield the empty string &#8220;&#8221;."</span>
  (<span style="color: #b58900;">s-chop-suffix</span> <span style="color: #2aa198;">")"</span> (<span style="color: #b58900;">s-chop-prefix</span> <span style="color: #2aa198;">"("</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s"</span> (<span style="color: #859900; font-weight: bold;">or</span> xs <span style="color: #2aa198;">""</span>)))))

(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">o--current-backend</span> nil
  <span style="color: #35a69c; font-style: italic;">"A message-passing channel updated by</span>
<span style="color: #35a69c; font-style: italic;">o--support-special-blocks-with-args</span>
<span style="color: #35a69c; font-style: italic;">and used by DEFBLOCK."</span>)

(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">o--support-special-blocks-with-args</span> (backend)
  <span style="color: #35a69c; font-style: italic;">"Remove all headlines in the current buffer.</span>
<span style="color: #35a69c; font-style: italic;">BACKEND is the export back-end being used, as a symbol."</span>
  (<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">o--current-backend</span> backend)
  (<span style="color: #859900; font-weight: bold;">let</span> (blk-start        <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The point at which the user's block begins.</span>
        header-start <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The point at which the user's block header &amp; args begin.</span>
        kwdargs          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The actual key-value arguments for the header.</span>
        main-arg         <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The first (non-keyed) value to the block.</span>
        blk-column       <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The column at which the user's block begins.</span>
        body-start       <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The starting line of the user's block.</span>
        blk-contents         <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The actual body string.</span>
        <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">&#10216;blk-start/column&#10217;#+begin_&#10216;header-start&#10217;blk main-arg :key&#8320; val &#8320; &#8230; :key&#8345; val&#8345;  ;; &#10229; &#10216;kwdargs&#10217;</span>
        <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">&#10216;body-start&#10217; body</span>
        <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">#+end_blk</span>
        )
  (<span style="color: #859900; font-weight: bold;">cl-loop</span> for blk in <span style="color: #268bd2;">o--supported-blocks</span>
        <span style="color: #b58900;">do</span> (<span style="color: #b58900;">goto-char</span> (<span style="color: #b58900;">point-min</span>))
        (<span style="color: #859900; font-weight: bold;">while</span> (<span style="color: #859900; font-weight: bold;">ignore-errors</span> (<span style="color: #b58900;">re-search-forward</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"^\s*\\#\\+begin_%s"</span> blk)))
          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">MA: </span><span style="color: #b1951d;">HACK</span><span style="color: #96A7A9; font-style: italic;">: Instead of a space, it should be any non-whitespace, optionally;</span>
          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">otherwise it may accidentlly rewrite blocks with one being a prefix of the other!</span>
          (<span style="color: #859900; font-weight: bold;">setq</span> header-start (<span style="color: #b58900;">point</span>))
          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Save indentation</span>
          (<span style="color: #b58900;">re-search-backward</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"\\#\\+begin_%s"</span> blk))
          (<span style="color: #859900; font-weight: bold;">setq</span> blk-start (<span style="color: #b58900;">point</span>))
          (<span style="color: #859900; font-weight: bold;">setq</span> blk-column (<span style="color: #b58900;">current-column</span>))
          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">actually process body</span>
          (<span style="color: #b58900;">goto-char</span> header-start)
          (<span style="color: #859900; font-weight: bold;">setq</span> body-start (<span style="color: #b58900;">1+</span> (<span style="color: #b58900;">line-end-position</span>)))
          (<span style="color: #859900; font-weight: bold;">thread-last</span>
              (<span style="color: #b58900;">buffer-substring-no-properties</span> header-start (<span style="color: #b58900;">line-end-position</span>))
            (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"(%s)"</span>)
            <span style="color: #b58900;">read</span>
            (<span style="color: #859900; font-weight: bold;">--split-with</span> (<span style="color: #b58900;">not</span> (<span style="color: #b58900;">keywordp</span> it)))
            (<span style="color: #859900; font-weight: bold;">setq</span> kwdargs))
          (<span style="color: #859900; font-weight: bold;">setq</span> main-arg (<span style="color: #b58900;">o--pp-list</span> (<span style="color: #b58900;">car</span> kwdargs)))
          (<span style="color: #859900; font-weight: bold;">setq</span> kwdargs (<span style="color: #b58900;">cadr</span> kwdargs))
          (<span style="color: #b58900;">forward-line</span> -1)
          (<span style="color: #b58900;">re-search-forward</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"^\s*\\#\\+end_%s"</span> blk))
          (<span style="color: #859900; font-weight: bold;">setq</span> blk-contents (<span style="color: #b58900;">buffer-substring-no-properties</span> body-start (<span style="color: #b58900;">line-beginning-position</span>)))
          (<span style="color: #b58900;">kill-region</span> blk-start (<span style="color: #b58900;">point</span>))
          (<span style="color: #b58900;">insert</span> (<span style="color: #b58900;">eval</span> `(,(<span style="color: #b58900;">intern</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"o--%s"</span> blk))
                          (<span style="color: #859900; font-weight: bold;">quote</span> ,backend)
                          ,blk-contents
                          ,main-arg
                          ,@(<span style="color: #859900; font-weight: bold;">--map</span> (<span style="color: #b58900;">list</span> '<span style="color: #b58900;">quote</span> it) kwdargs))))
          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">See: https://github.com/alhassy/org-special-block-extras/issues/8</span>
          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">(indent-region blk-start (point) blk-column) ;; Actually, this may be needed...</span>
          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">(indent-line-to blk-column) ;; #+end...</span>
          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">(goto-char blk-start) (indent-line-to blk-column) ;; #+begin...</span>
          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">the --map is so that arguments may be passed</span>
          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">as "this" or just &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">this</span><span style="color: #96A7A9; font-style: italic;">&#8217; (raw symbols)</span>
      ))))
</pre>
</div>

<p>
Let's have some sanity tests&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"pp-list works as desired"</span>
  (<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">equal</span> <span style="color: #2aa198;">"1 2 3 4 5"</span>
                 (<span style="color: #b58900;">o--pp-list</span> '(1 2 3 4 5))))
  (<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">equal</span> <span style="color: #2aa198;">"1"</span>
                 (<span style="color: #b58900;">o--pp-list</span> '(1))))
  (<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">equal</span> <span style="color: #2aa198;">""</span>
                 (<span style="color: #b58900;">o--pp-list</span> nil))))

<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Using propcheck, we run this test on /arbitrary/ buffer contents.</span>
(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"No supported blocks means buffer is unchanged"</span>
  <span style="color: #d33682; font-style: italic;">:tags</span> '(core)
  (<span style="color: #859900; font-weight: bold;">let*</span> (<span style="color: #268bd2;">o--supported-blocks</span>
         (propcheck-seed (propcheck-seed))
         (buf (propcheck-generate-string nil)))
    (<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">equal</span> buf
                   (<span style="color: #859900; font-weight: bold;">with-temp-buffer</span>
                     (<span style="color: #b58900;">insert</span> buf)
                     (<span style="color: #b58900;">o--support-special-blocks-with-args</span> 'html)
                     (<span style="color: #b58900;">buffer-string</span>))))))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"Constant blocks preserve indentation/enumeration"</span>
  <span style="color: #d33682; font-style: italic;">:expected-result</span> <span style="color: #d33682; font-style: italic;">:failed</span>
  <span style="color: #d33682; font-style: italic;">:tags</span> '(core)
  (defblock go nil nil <span style="color: #2aa198;">"doc"</span> <span style="color: #2aa198;">"hello"</span>) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Constantly &#8220;hello&#8221;</span>
  (<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">equal</span>
<span style="color: #2aa198;">"</span>
<span style="color: #2aa198;">  1. item one</span>
<span style="color: #2aa198;">  2. item two</span>
<span style="color: #2aa198;">     #+begin_export html</span>
<span style="color: #2aa198;">hello</span>
<span style="color: #2aa198;">#+end_export</span>
<span style="color: #2aa198;">  3. item three"</span>
    (<span style="color: #859900; font-weight: bold;">with-temp-buffer</span>
      (<span style="color: #b58900;">insert</span>
  <span style="color: #2aa198;">"</span>
<span style="color: #2aa198;">  1. item one</span>
<span style="color: #2aa198;">  2. item two</span>
<span style="color: #2aa198;">     #+begin_go</span>
<span style="color: #2aa198;">  world</span>
<span style="color: #2aa198;">  #+end_go</span>
<span style="color: #2aa198;">  3. item three"</span>)
      (<span style="color: #b58900;">o--support-special-blocks-with-args</span> 'html)
      (<span style="color: #b58900;">buffer-string</span>)))))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"Constant blocks export to LaTex preserves indentation/enumeration"</span>
(<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">equal</span>
<span style="color: #2aa198;">"\\begin{enumerate}</span>
<span style="color: #2aa198;">\\item item one</span>
<span style="color: #2aa198;">\\item item two</span>
<span style="color: #2aa198;">hello</span>
<span style="color: #2aa198;">\\item item three</span>
<span style="color: #2aa198;">\\end{enumerate}</span>
<span style="color: #2aa198;">"</span>
(<span style="color: #b58900;">org-export-string-as</span>
  <span style="color: #2aa198;">"</span>
<span style="color: #2aa198;">  1. item one</span>
<span style="color: #2aa198;">  2. item two</span>
<span style="color: #2aa198;">     #+begin_go</span>
<span style="color: #2aa198;">  world</span>
<span style="color: #2aa198;">  #+end_go</span>
<span style="color: #2aa198;">  3. item three"</span>
  'latex <span style="color: #d33682; font-style: italic;">:body-only-please</span>))))


(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"Constant blocks export to HTML preserves indentation/enumeration"</span>
(<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">equal</span>
<span style="color: #2aa198;">"&lt;ol class=\"org-ol\"&gt;</span>
<span style="color: #2aa198;">&lt;li&gt;item one&lt;/li&gt;</span>
<span style="color: #2aa198;">&lt;li&gt;&lt;p&gt;</span>
<span style="color: #2aa198;">item two</span>
<span style="color: #2aa198;">&lt;/p&gt;</span>
<span style="color: #2aa198;">hello&lt;/li&gt;</span>
<span style="color: #2aa198;">&lt;li&gt;item three&lt;/li&gt;</span>
<span style="color: #2aa198;">&lt;/ol&gt;</span>
<span style="color: #2aa198;">"</span>
(<span style="color: #b58900;">org-export-string-as</span>
  <span style="color: #2aa198;">"</span>
<span style="color: #2aa198;">  1. item one</span>
<span style="color: #2aa198;">  2. item two</span>
<span style="color: #2aa198;">     #+begin_go</span>
<span style="color: #2aa198;">  world</span>
<span style="color: #2aa198;">  #+end_go</span>
<span style="color: #2aa198;">  3. item three"</span>
  'html <span style="color: #d33682; font-style: italic;">:body-only-please</span>))))


(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"Identity blocks preserve indentation/enumeration"</span>
    <span style="color: #d33682; font-style: italic;">:expected-result</span> <span style="color: #d33682; font-style: italic;">:failed</span>
  <span style="color: #d33682; font-style: italic;">:tags</span> '(core)
  (defblock id nil nil <span style="color: #2aa198;">"doc"</span> contents)
  (<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">equal</span>
<span style="color: #2aa198;">"</span>
<span style="color: #2aa198;">  1. item one</span>
<span style="color: #2aa198;">  2. item two</span>
<span style="color: #2aa198;">     #+begin_export html</span>

<span style="color: #2aa198;">     #+end_export</span>
<span style="color: #2aa198;">     world</span>

<span style="color: #2aa198;">     #+begin_export html</span>

<span style="color: #2aa198;">     #+end_export</span>
<span style="color: #2aa198;">  3. item three"</span>
    (<span style="color: #859900; font-weight: bold;">with-temp-buffer</span>
      (<span style="color: #b58900;">insert</span>
  <span style="color: #2aa198;">"</span>
<span style="color: #2aa198;">  1. item one</span>
<span style="color: #2aa198;">  2. item two</span>
<span style="color: #2aa198;">     #+begin_id</span>
<span style="color: #2aa198;">  world</span>
<span style="color: #2aa198;">  #+end_id</span>
<span style="color: #2aa198;">  3. item three"</span>)
      (<span style="color: #b58900;">o--support-special-blocks-with-args</span> 'html)
      (<span style="color: #b58900;">buffer-string</span>)))))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"Identity blocks export to LaTex preserves indentation/enumeration"</span>
    <span style="color: #d33682; font-style: italic;">:expected-result</span> <span style="color: #d33682; font-style: italic;">:failed</span>
(defblock id nil nil <span style="color: #2aa198;">"doc"</span> contents)
(<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">equal</span>
<span style="color: #2aa198;">"\\begin{enumerate}</span>
<span style="color: #2aa198;">\\item item one</span>
<span style="color: #2aa198;">\\item item two</span>

<span style="color: #2aa198;">world</span>
<span style="color: #2aa198;">\\item item three</span>
<span style="color: #2aa198;">\\end{enumerate}</span>
<span style="color: #2aa198;">"</span>
(<span style="color: #b58900;">org-export-string-as</span>
  <span style="color: #2aa198;">"</span>
<span style="color: #2aa198;">  1. item one</span>
<span style="color: #2aa198;">  2. item two</span>
<span style="color: #2aa198;">     #+begin_id</span>
<span style="color: #2aa198;">  world</span>
<span style="color: #2aa198;">  #+end_id</span>
<span style="color: #2aa198;">  3. item three"</span>
 'latex <span style="color: #d33682; font-style: italic;">:body-only-please</span>))))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"Identity blocks export to HTML preserves indentation/enumeration"</span>
    <span style="color: #d33682; font-style: italic;">:expected-result</span> <span style="color: #d33682; font-style: italic;">:failed</span>
(defblock id nil nil <span style="color: #2aa198;">"doc"</span> contents)
(<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">equal</span>

<span style="color: #2aa198;">"&lt;ol class=\"org-ol\"&gt;</span>
<span style="color: #2aa198;">&lt;li&gt;item one&lt;/li&gt;</span>
<span style="color: #2aa198;">&lt;li&gt;&lt;p&gt;</span>
<span style="color: #2aa198;">item two</span>
<span style="color: #2aa198;">&lt;/p&gt;</span>

<span style="color: #2aa198;">&lt;p&gt;</span>
<span style="color: #2aa198;">world</span>
<span style="color: #2aa198;">&lt;/p&gt;&lt;/li&gt;</span>
<span style="color: #2aa198;">&lt;li&gt;item three&lt;/li&gt;</span>
<span style="color: #2aa198;">&lt;/ol&gt;</span>
<span style="color: #2aa198;">"</span>
(<span style="color: #b58900;">org-export-string-as</span>
  <span style="color: #2aa198;">"</span>
<span style="color: #2aa198;">  1. item one</span>
<span style="color: #2aa198;">  2. item two</span>
<span style="color: #2aa198;">     #+begin_id</span>
<span style="color: #2aa198;">  world</span>
<span style="color: #2aa198;">  #+end_id</span>
<span style="color: #2aa198;">  3. item three"</span>
 'html <span style="color: #d33682; font-style: italic;">:body-only-please</span>))))
</pre>
</div>

<p>
When you enable the <code>org-special-block-extras</code> mode, it is activated&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">https://orgmode.org/manual/Advanced-Export-Configuration.html</span>
(<span style="color: #b58900;">add-hook</span> '<span style="color: #268bd2;">org-export-before-parsing-hook</span> '<span style="color: #b58900;">o--support-special-blocks-with-args</span>)
</pre>
</div>

<p>
When you disable the <code>org-special-block-extras</code> mode, it is deactivated&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #b58900;">remove-hook</span> '<span style="color: #268bd2;">org-export-before-parsing-hook</span> '<span style="color: #b58900;">o--support-special-blocks-with-args</span>)
</pre>
</div>



</details>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         ‘header-args’ Implementation
                      </font>
                    </strong>
                  </summary>
<p>
Then:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">o--header-args</span> nil
  <span style="color: #35a69c; font-style: italic;">"Alist (name plist) where &#8220;:main-arg&#8221; is a special plist key.</span>

<span style="color: #35a69c; font-style: italic;">  It serves a similar role to that of Org's src &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">header-args</span><span style="color: #35a69c; font-style: italic;">&#8217;.</span>

<span style="color: #35a69c; font-style: italic;">  See doc of SET-BLOCK-HEADER-ARGS for more information."</span>)

(<span style="color: #859900; font-weight: bold;">defmacro</span> <span style="color: #b58900;">o-set-block-header-args</span> (blk <span style="color: #b58900; font-style: italic;">&amp;rest</span> kvs)
  <span style="color: #35a69c; font-style: italic;">"Set default valuts for special block arguments.</span>

<span style="color: #35a69c; font-style: italic;">This is similar to, and inspired by, Org-src block header-args.</span>

<span style="color: #35a69c; font-style: italic;">Example src use:</span>
<span style="color: #35a69c; font-style: italic;">    #+PROPERTY: header-args:Language :key value</span>

<span style="color: #35a69c; font-style: italic;">Example block use:</span>
<span style="color: #35a69c; font-style: italic;">    (set-block-header-args Block :main-arg mainvalue :key value)</span>

<span style="color: #35a69c; font-style: italic;">A full, working, example can be seen by &#8220;C-h o RET defblock&#8221;.</span>
<span style="color: #35a69c; font-style: italic;">"</span>
  `(<span style="color: #b58900;">add-to-list</span> '<span style="color: #268bd2;">o--header-args</span> (<span style="color: #b58900;">list</span> (<span style="color: #859900; font-weight: bold;">quote</span> ,blk) ,@kvs)))
</pre>
</div>



</details>

<p>
This interface is essentially that of Org's <code>src</code> blocks, with the <code>main-arg</code>
being the first argument to 𝒳 and the only argument not needing to be
preceded by a key name &#x2014;it is done this way to remain somewhat consistent
with the Org <code>src</code> interface. The user definition of 𝒳 decides on <i>how optional</i>
the arguments actually are.
</p>

<p>
Perhaps an example will clarify things &#x2026;
</p>
</div>

<div id="outline-container-Example-Jasim-providing-in-place-feedback-to-Bobbert" class="outline-4">
<h4 id="Example-Jasim-providing-in-place-feedback-to-Bobbert"><span class="section-number-4">1.3.1</span> <a href="#Example-Jasim-providing-in-place-feedback-to-Bobbert">Example: Jasim providing in-place feedback to Bobbert</a></h4>
<div class="outline-text-4" id="text-Example-Jasim-providing-in-place-feedback-to-Bobbert">
<p>
Suppose we want to devise a simple special block for editors to provide
constructive feedback to authors so that the feedback appears as top-level
elements of the resulting exported file &#x2014;instead of comments that may
accidentally not be handled by the author.
</p>

<p>
In order to showcase the multiple bells and whistles of the system, the snippet
below is twice as long than it needs to be, but it is still reasonably small and
accessible.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">We can use variable values when defining new blocks</span>
(<span style="color: #859900; font-weight: bold;">setq</span> angry-red '(<span style="color: #d33682; font-style: italic;">:foreground</span> <span style="color: #2aa198;">"red"</span> <span style="color: #d33682; font-style: italic;">:weight</span> <span style="color: #b58900;">bold</span>))

<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">This is our &#119987;, &#8220;remark&#8221;.</span>
<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">As a link, it should be shown angry-red;</span>
<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">it takes two arguments: &#8220;color&#8221; and &#8220;signoff&#8221;</span>
<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">with default values being "red" and "".</span>
(<span style="color: #859900; font-weight: bold;">o-defblock</span> rremark
  (editor <span style="color: #2aa198;">"Editor Remark"</span> <span style="color: #d33682; font-style: italic;">:face</span> angry-red) (color <span style="color: #2aa198;">"red"</span> signoff <span style="color: #2aa198;">""</span>)
  <span style="color: #2aa198;">"Top level (HTML &amp; LaTeX) editorial remarks; in Emacs they're angry red."</span>
  (<span style="color: #b58900;">format</span> (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">equal</span> backend 'html)
            <span style="color: #2aa198;">"&lt;strong style=\"color: %s;\"&gt;&#10214;%s:  %s%s&#10215;&lt;/strong&gt;"</span>
            <span style="color: #2aa198;">"{\\color{%s}\\bfseries %s:  %s%s}"</span>)
          color editor contents signoff))

<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">I don't want to change the definition, but I'd like to have</span>
<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">the following as personalised defaults for the &#8220;remark&#8221; block.</span>
<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">OR, I'd like to set this for links, which do not have argument options.</span>
(<span style="color: #859900; font-weight: bold;">o-set-block-header-args</span> rremark <span style="color: #d33682; font-style: italic;">:main-arg</span> <span style="color: #2aa198;">"Jasim Jameson"</span> <span style="color: #d33682; font-style: italic;">:signoff</span> <span style="color: #2aa198;">"( Aim for success! )"</span>)
</pre>
</div>

<p>
<span class="underline">Example use</span>
</p>
<pre class="example" id="orgbdf51a2">
The sum of the first $n$ natural numbers is $\sum_{i = 0}^n i = {n × (n + 1)
\over 2}$. Note that $n × (n + 1)$ is even.
[[rremark:Jasim Jameson][Why are you taking about “$\mathsf{even}$” here?]]
#+begin_rremark Bobbert Barakallah :signoff "Thank-you for pointing this out!" :color green
I was trying, uh ...

Yeah, to explain that ${\large n × (n + 1) \over 2}$ is always an integer.
#+end_rremark

Hence, we only need to speak about whole numbers.
[[rremark:][Then please improve your transition sentences.]]
</pre>

<p>
<span class="underline">Resulting rendition</span>
</p>
<blockquote>
<p>
The sum of the first \(n\) natural numbers is \(\sum_{i = 0}^n i = {n × (n + 1)
 \over 2}\). Note that \(n × (n + 1)\) is even.
<strong style="color: red;">⟦Jasim Jameson: Why are you taking about “\(\mathsf{even}\)” here?( Aim for success! )⟧</strong>
</p>
<strong style="color: green;">⟦Bobbert Barakallah:
<p>
I was trying, uh &#x2026;
</p>

<p>
Yeah, to explain that \({\large n × (n + 1) \over 2}\) is always an integer.
</p>

Thank-you for pointing this out!⟧</strong>
<p>
Hence, we only need to speak about whole numbers.
<strong style="color: red;">⟦Jasim Jameson:  Then please improve your transition sentences.( Aim for success! )⟧</strong>
</p>
</blockquote>

<p>
Notice that the result contains text &#x2014;the signoff message&#x2014; that the user
Jasim did not write explicitly.
</p>

<p>
… Why the <i>stuttered</i> <code>rremark</code>? Because this package comes with a <code>remark</code> block that
has more bells and whistles … keep reading ;-)
</p>
</div>
</div>
</div>
<div id="outline-container-modularity_with_thread-blockcall" class="outline-3">
<h3 id="modularity_with_thread-blockcall"><span class="section-number-3">1.4</span> <a href="#modularity_with_thread-blockcall">Modularity with <code>thread-blockcall</code></a></h3>
<div class="outline-text-3" id="text-modularity_with_thread-blockcall">
<p>
Since <abbr class="tooltip" title="Declare a new special block, and link, in the style of DEFUN.<br><br>A full featured example is at the end of this documentation string.<br><br>This is an anaphoric macro that provides export support for<br>special blocks <strong>and</strong> links named NAME. Just as an Org-mode<br>src-block consumes as main argument the language for the src<br>block, our special blocks too consume a MAIN-ARG; it may be a<br>symbol or a cons-list consisting of a symbolic name (with which<br>to refer to the main argument in the definition of the block)<br>followed by a default value, then, optionally, any information<br>for a one-time setup of the associated link type.<br><br>The main arg may be a sequence of symbols separated by spaces,<br>and a few punctuation with the exception of comma ‘,’ since it is<br>a special Lisp operator. In doubt, enclose the main arg in<br>quotes.<br><br>Then, just as Org-mode src blocks consume key-value pairs, our<br>special blocks consume a number of KWDS, which is a list of the<br>form (key₀ value₀ … keyₙ valueₙ).<br><br>After that is an optional DOCSTRING, a familar feature of DEFUN.<br>The docstring is displayed as part of the tooltip for the<br>produced link type.<br><br>Finally, the BODY is a (sequence of) Lisp forms ---no progn<br>needed--- that may refer to the names BACKEND and CONTENTS which<br>refer to the current export backend and the contents of the<br>special block ---or the description clause of a link.<br><br>CONTENTS refers to an Org-mode parsed string; i.e., Org-markup is<br>acknowledged.<br><br>In, hopefully, rare circumstances, one may refer to RAW-CONTENTS<br>to look at the fully unparsed contents.<br><br>Finally, this macro exposes two functions:<br>+ ORG-EXPORT: Wrap the argument in an export block for the current backend.<br>+ ORG-PARSE: This should ONLY be called within an ORG-EXPORT call,<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; to escape text to Org, and out of the export block.<br><br><hr><br><br>TLDR for EXPERIMENTAL and DOCSTRING and BODY, the first two parts are<br>optional; they’re a symbol, a string, then the main body.&emsp;The<br>symbol, O-RESPECT-NEWLINES?, when present enables a highly<br>experimental [i.e., do <strong>not</strong> use it!] feature: No new lines for<br>blocks in HTML export.&emsp;Its need rose from developing the MARGIN<br>block type.<br><br><hr><br><br>The relationship between links and special blocks:<br><br>&emsp;[ [type:label][description]]<br>≈<br>&emsp; #+begin_type label<br>&emsp;&emsp;description<br>&emsp; #+end_type<br><br><hr><br><br>Example declaration, with all possible features shown:<br><br>&emsp; ;; We can use variable values when defining new blocks<br>&emsp; (setq angry-red ’(:foreground ''red'' :weight bold))<br><br>&emsp; (defblock remark<br>&emsp;&emsp; (editor ''Editor Remark'' :face angry-red) (color ''red'' signoff '''')<br>&emsp;&emsp; ''Top level (HTML & LaTeX)O-RESPECT-NEWLINES? editorial remarks; in Emacs they’re angry red.''<br>&emsp;&emsp; (format (if (equal backend ’html)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''<strong style=\''color: %s;\''>⟦%s:&emsp;%s%s⟧</strong>''<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''{\color{%s}\bfseries %s:&emsp;%s%s}'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; color editor contents signoff))<br><br>&emsp; ;; I don’t want to change the definition, but I’d like to have<br>&emsp; ;; the following as personalised defaults for the “remark” block.<br>&emsp; ;; OR, I’d like to set this for links, which do not have argument options.<br>&emsp; (defblock-header-args remark :main-arg ''Jasim Jameson'' :signoff ''( Aim for success! )'')<br><br>Three example uses:<br><br>&emsp;&emsp;;; ⟨0⟩ As a special blocks with arguments given.<br>&emsp;&emsp;#+begin_remark Bobbert Barakallah :signoff ''Thank-you for pointing this out!'' :color green<br>&emsp;&emsp;I was trying to explain that <em>{large (n × (n + 1) over 2}</em> is always an integer.<br>&emsp;&emsp;#+end_remark<br><br>&emsp;&emsp;;; ⟨1⟩ As a terse link, using default values for the args.<br>&emsp;&emsp;;;&emsp;&emsp; Notice that Org-mode formatting is recoqgnised even in links.<br>&emsp;&emsp;[ [remark:Jasim Jameson][Why are you taking about “<em>mathsf{even}</em>” here?]]<br><br>&emsp;&emsp;;; ⟨2⟩ So terse that no editor name is provided.<br>&emsp;&emsp;[ [remark:][Please improve your transition sentences.]]<br><br>&emsp;&emsp;;; ⟨★⟩ Unlike 0, examples 1 and 2 will have the default SIGNOFF<br>&emsp;&emsp;;; catenated as well as the default red color.<br><br>(fn NAME MAIN-ARG KWDS &optional EXPERIMENTAL DOCSTRING &rest BODY)">defblock</abbr> let's us pretend block &#x2014;and link&#x2014; types are string-valued
functions, then one would expect that we can compose blocks <i>modularly</i> as
functions compose. Somewhat analogously to <abbr class="tooltip" title="Call first argument as a function, passing remaining arguments to it.<br>Return the value that function returns.<br>Thus, (funcall 'cons 'x 'y) returns (x . y).<br><br>(fn FUNCTION &rest ARGUMENTS)">funcall</abbr> and <abbr class="tooltip" title="Thread FORMS elements as the last argument of their successor.<br>Example:<br>&emsp;&emsp;(thread-last<br>&emsp;&emsp;&emsp;5<br>&emsp;&emsp;&emsp;(+ 20)<br>&emsp;&emsp;&emsp;(<em> 25)<br>&emsp;&emsp;&emsp;-<br>&emsp;&emsp;&emsp;(+ 40))<br>Is equivalent to:<br>&emsp;&emsp;(+ 40 (- (</em> 25 (+ 20 5))))<br>Note how the single ‘-’ got converted into a list before<br>threading.<br><br>(fn &rest FORMS)">thread-last</abbr>, we
provide a macro <abbr class="tooltip" title="Thread text through a number of blocks.<br><br>BODY is likely to be ‘raw-contents’, possibly with user manipulations.<br><br>Each FORMS is of the shape “(block-name main-argument<br>:key-value-pairs)”<br><br>(thread-blockcall x)&emsp;&emsp;&emsp; = x<br>(thread-blockcall x (f a)) = (blockcall f a x)<br>(thread-blockcall x f₁ f₂) ≈ (f₂ (f₁ x))<br><br>The third is a ‘≈’, and not ‘=’, because the RHS contains<br>‘blockcall’s as well as massages the export matter<br>between conseqeuctive blockcalls.<br><br>A full example:<br><br>&emsp;&emsp;(o-defblock nesting (name) nil<br>&emsp;&emsp;&emsp;''Show text in a box, within details, which contains a box.''<br><br>&emsp;&emsp;&emsp;(o-thread-blockcall raw-contents<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;(box name)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;(details (upcase name) :title-color ''green'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;(box (format ''⇨ %s ⇦'' name) :background-color ''blue'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;))<br>">thread-blockcall</abbr>.
</p>

<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Example</h3>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(thread-blockcall raw-contents
                  (box name)
                  (details (<span style="color: #b58900;">upcase</span> name) <span style="color: #d33682; font-style: italic;">:title-color</span> <span style="color: #2aa198;">"green"</span>)
</pre>
</div>
<p>
=
</p>
<div class="org-src-container">
<pre class="src src-C">#+begin_details NAME :title-color <span style="color: #2aa198;">"green"</span>
#+begin_box name
contents
#+end_box
#+end_details
</pre>
</div>

</div>

<br>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation
                      </font>
                    </strong>
                  </summary>
<p>
First, we need to handle the case of one block…
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">cl-defmacro</span> <span style="color: #b58900;">o--blockcall</span> (blk <span style="color: #b58900; font-style: italic;">&amp;optional</span> main-arg <span style="color: #b58900; font-style: italic;">&amp;rest</span> keyword-args-then-contents)
  <span style="color: #35a69c; font-style: italic;">"An anaologue to `funcall` but for blocks.</span>

<span style="color: #35a69c; font-style: italic;">Usage: (blockcall blk-name main-arg even-many:key-values raw-contents)</span>

<span style="color: #35a69c; font-style: italic;">One should rarely use this directly; instead use</span>
<span style="color: #35a69c; font-style: italic;">o-thread-blockcall.</span>
<span style="color: #35a69c; font-style: italic;">"</span>
  `(<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"#+end_export\n"</span> (,(<span style="color: #b58900;">intern</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"o--%s"</span> blk))
    backend <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">defblock internal</span>
    <span style="color: #96A7A9; font-style: italic;">; </span><span style="color: #96A7A9; font-style: italic;">(format "\n#+begin_export html\n\n%s\n#+end_export\n" ,(car (last keyword-args-then-contents))) ;; contents</span>
    ,@(<span style="color: #b58900;">last</span> keyword-args-then-contents) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">contents</span>
    ,main-arg
    ,@(<span style="color: #b58900;">-drop-last</span> 1 keyword-args-then-contents)) <span style="color: #2aa198;">"\n#+begin_export"</span>))
</pre>
</div>

<p>
Using the above sequentially does not work due to the plumbing of
<code>defblock</code>, so we handle that plumbing below …
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defmacro</span> <span style="color: #b58900;">o-thread-blockcall</span> (body <span style="color: #b58900; font-style: italic;">&amp;rest</span> forms)
  <span style="color: #35a69c; font-style: italic;">"Thread text through a number of blocks.</span>

<span style="color: #35a69c; font-style: italic;">BODY is likely to be &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">raw-contents</span><span style="color: #35a69c; font-style: italic;">&#8217;, possibly with user manipulations.</span>

<span style="color: #35a69c; font-style: italic;">Each FORMS is of the shape &#8220;(block-name main-argument</span>
<span style="color: #35a69c; font-style: italic;">:key-value-pairs)&#8221;</span>

<span style="color: #35a69c; font-style: italic;">(thread-blockcall x)       = x</span>
<span style="color: #35a69c; font-style: italic;">(thread-blockcall x (f a)) = (blockcall f a x)</span>
<span style="color: #35a69c; font-style: italic;">(thread-blockcall x f&#8321; f&#8322;) &#8776; (f&#8322; (f&#8321; x))</span>

<span style="color: #35a69c; font-style: italic;">The third is a &#8216;&#8776;&#8217;, and not &#8216;=&#8217;, because the RHS contains</span>
<span style="color: #35a69c; font-style: italic;">&#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">blockcall</span><span style="color: #35a69c; font-style: italic;">&#8217;s as well as massages the export matter</span>
<span style="color: #35a69c; font-style: italic;">between conseqeuctive blockcalls.</span>

<span style="color: #35a69c; font-style: italic;">A full example:</span>

<span style="color: #35a69c; font-style: italic;">    (o-defblock nesting (name) nil</span>
<span style="color: #35a69c; font-style: italic;">      \"Show text in a box, within details, which contains a box.\"</span>

<span style="color: #35a69c; font-style: italic;">      (o-thread-blockcall raw-contents</span>
<span style="color: #35a69c; font-style: italic;">                        (box name)</span>
<span style="color: #35a69c; font-style: italic;">                        (details (upcase name) :title-color \"green\")</span>
<span style="color: #35a69c; font-style: italic;">                        (box (format \"&#8680; %s &#8678;\" name) :background-color \"blue\")</span>
<span style="color: #35a69c; font-style: italic;">                        ))</span>
<span style="color: #35a69c; font-style: italic;">"</span>
  (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">not</span> forms) body
     `(<span style="color: #859900; font-weight: bold;">-let</span> [result (<span style="color: #859900; font-weight: bold;">o--blockcall</span> ,@(<span style="color: #b58900;">car</span> forms) ,body)]
    ,@(<span style="color: #859900; font-weight: bold;">cl-loop</span> for b in (<span style="color: #b58900;">cdr</span> forms)
          collect `(<span style="color: #859900; font-weight: bold;">setq</span> result (<span style="color: #859900; font-weight: bold;">o--blockcall</span> ,@b
                                     (<span style="color: #b58900;">concat</span>
                                   <span style="color: #2aa198;">"#+begin_export\n"</span>
                                   result
                                   <span style="color: #2aa198;">"\n#+end_export"</span>
                                   )))) <span style="color: #b58900;">result)))</span>
</pre>
</div>



</details>
</div>

<div id="outline-container-Short_Example_An_opportunity_to_learn" class="outline-4">
<h4 id="Short_Example_An_opportunity_to_learn"><span class="section-number-4">1.4.1</span> <a href="#Short_Example_An_opportunity_to_learn">Short Example: <i>An opportunity to learn!</i></a></h4>
<div class="outline-text-4" id="text-Short_Example_An_opportunity_to_learn">
<p>
The following tiny block is composed from two <abbr class="tooltip" title="Enclose contents in a folded up box, for HTML.<br><br>For LaTeX, this is just a boring, but centered, box.<br><br>By default, the TITLE of such blocks is “Details”<br>and its TITLE-COLOR is green.<br><br>In HTML, we show folded, details, regions with a nice greenish colour.<br><br>In the future ---i.e., when I have time---<br>it may be prudent to expose more aspects as arguments,<br>such as ‘background-color’.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (O-LINK\? nil) (TITLE-COLOR ''green''))">details</abbr> blocks and a <abbr class="tooltip" title="Enclose text in a box, possibly with a title.<br><br>By default, the box’s COLOR is green for HTML and red for LaTeX,<br>and it has no TITLE.<br><br>The HTML export uses a padded div, whereas the LaTeX export<br>requires the tcolorbox pacakge.<br><br>In the future, I will likely expose more arguments.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (O-LINK\? nil) (BACKGROUND-COLOR nil))">box</abbr> block
&#x2014;defined elsewhere in this article. It is intended to give the reader another
opportunity to make sure they have tried to solve the puzzle posed in the main
text before seeing the answer -&#x2014;this works well in HTML, not so in LaTeX.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-defblock</span> solution
  (title <span style="color: #2aa198;">"Solution"</span>)
  (reprimand <span style="color: #2aa198;">"Did you actually try? Maybe see the &#8216;</span><span style="color: #6c71c4; font-weight: bold;">hints</span><span style="color: #2aa198;">&#8217; above!"</span>
   really <span style="color: #2aa198;">"Solution, for real"</span>)
  <span style="color: #2aa198;">"Show the answers to a problem, but with a reprimand in case no attempt was made."</span>
  (<span style="color: #859900; font-weight: bold;">o-thread-blockcall</span> raw-contents
                    (details really <span style="color: #d33682; font-style: italic;">:title-color</span> <span style="color: #2aa198;">"red"</span>)
                    (box reprimand <span style="color: #d33682; font-style: italic;">:background-color</span> <span style="color: #2aa198;">"blue"</span>)
                    (details title)))
</pre>
</div>

<p>
E.g., what is 1 + 1?
</p>

<style> #g243 {color: grey; background-color:grey;}
       #g243:hover {color: black; background-color:white;} </style>
<p>
<span id="g243"> Useless </span> Hint: <span id="g243"> What is a number? </span>
</p>



<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Solution
                      </font>
                    </strong>
                  </summary>
<div style="padding: 1em; background-color: #CCFFFF;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Did you actually try? Maybe see the ‘hints’ above!</h3>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="red">
                         Solution, for real
                      </font>
                    </strong>
                  </summary>
<p>
The answer is 2.
</p>

<p>
If you're interested in such ‘fundamental’ questions, consider reading
  Russel and Whitehead's <i>Principa Mathematica</i> ;-)
</p>


</details>
</div>

</details>
<p>
The above box was created from:
</p>
<div class="org-src-container">
<pre class="src src-C">#+begin_solution
The answer is 2.

If you<span style="color: #b58900;">'</span>re interested in such &#8216;fundamental&#8217; questions, consider reading
  Russel <span style="color: #b58900; font-style: italic;">and</span> <span style="color: #268bd2;">Whitehead</span><span style="color: #b58900;">'</span>s /Principa Mathematica/ ;-)
#+end_solution
</pre>
</div>
<p>
We will make use of this block below when we get to guided problems ;-)
</p>
</div>
</div>

<div id="outline-container-Longer_Example_Demonstrating_Org-markup_with_org-demo" class="outline-4">
<h4 id="Longer_Example_Demonstrating_Org-markup_with_org-demo"><span class="section-number-4">1.4.2</span> <a href="#Longer_Example_Demonstrating_Org-markup_with_org-demo">Longer Example: Demonstrating Org-markup with <code>org-demo</code></a></h4>
<div class="outline-text-4" id="text-Longer_Example_Demonstrating_Org-markup_with_org-demo">
<p>
Sometimes, we want to show verbatim source and its resulting rendition &#x2014;which
is a major part of this article! So, let's make a block to mitigate such an
error-prone tedium.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-defblock</span> org-demo nil (source <span style="color: #2aa198;">"Source"</span> result <span style="color: #2aa198;">"Result"</span>
                        source-color <span style="color: #2aa198;">"cyan"</span> result-color <span style="color: #2aa198;">"cyan"</span>
                        style <span style="color: #2aa198;">"parallel"</span>
                        sep (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">equal</span> backend 'html) <span style="color: #2aa198;">"</span><span style="color: #b58900;">@@html</span><span style="color: #2aa198;">:&lt;p&gt;&lt;br&gt;@@"</span> <span style="color: #2aa198;">"\n\n\n\n"</span>)
                        )
  <span style="color: #2aa198;">"Output the CONTENTS of the block as both parsed Org and unparsed.</span>

<span style="color: #2aa198;">Label the source text by SOURCE and the result text by RESULT</span>

<span style="color: #2aa198;">finally, the source-result fragments can be shown in a STYLE</span>
<span style="color: #2aa198;">that is either &#8220;parallel&#8221; (default) or &#8220;sequential&#8221;.</span>

<span style="color: #2aa198;">SEP is the separator; e.g., a rule &#8216;</span><span style="color: #6c71c4; font-weight: bold;">&lt;hr&gt;</span><span style="color: #2aa198;">'.</span>
<span style="color: #2aa198;">"</span>
  (<span style="color: #859900; font-weight: bold;">-let</span> [text (<span style="color: #b58900;">concat</span>
               <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Source</span>
               (<span style="color: #859900; font-weight: bold;">thread-last</span> raw-contents
                 (<span style="color: #b58900;">format</span> (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">equal</span> backend 'html)
                             <span style="color: #2aa198;">"&lt;div &gt;&lt;pre class=\"src src-org\"&gt;%s&lt;/pre&gt;&lt;/div&gt;"</span>
                           <span style="color: #2aa198;">"\n\\begin{verbatim}\n%s\n\\end{verbatim}"</span>))
                 org-export
                 (<span style="color: #859900; font-weight: bold;">o--blockcall</span> box source <span style="color: #d33682; font-style: italic;">:background-color</span> source-color)
                 org-export)
               <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Separator</span>
               sep
               <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Result</span>
               (<span style="color: #859900; font-weight: bold;">thread-last</span> raw-contents
                 (<span style="color: #859900; font-weight: bold;">o--blockcall</span> box result <span style="color: #d33682; font-style: italic;">:background-color</span> result-color)
                 org-export))]

   (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">equal</span> style <span style="color: #2aa198;">"parallel"</span>)
       (<span style="color: #859900; font-weight: bold;">o--blockcall</span> parallel <span style="color: #2aa198;">"2"</span> <span style="color: #d33682; font-style: italic;">:bar</span> nil text)
       (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"#+end_export\n"</span> text <span style="color: #2aa198;">"\n#+begin_export"</span>))))
</pre>
</div>






</details>
<br>

<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Example</h3>
<div style="column-rule-style: solid;column-count: 2;">
<p>
<span class="underline">This</span>
</p>
<pre class="example" id="org08c37d5">
#+begin_org-demo
/italics/ and _underline_

$e^{i \times \pi} + 1 = 0$
#+end_org-demo
</pre>

<hr><br>

<p>
<span class="underline">Yields</span>
</p>
<div style="column-rule-style: none;column-count: 2;">
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>
<div ><pre class="src src-org"> /italics/ and _underline_

 $e^{i \times \pi} + 1 = 0$
</pre></div>
</div>
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
<p>
<i>italics</i> and <span class="underline">underline</span>
</p>

<p>
\(e^{i \times \pi} + 1 = 0\)
</p>

</div>
</div>
</div>

</div>

<br>

<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>(Sequential) Example</h3>
<div style="column-rule-style: solid;column-count: 2;">
<p>
<span class="underline">This</span>
</p>
<pre class="example" id="orge9f93d0">
#+begin_org-demo :style seq
/italics/ and _underline_

$e^{i \times \pi} + 1 = 0$
#+end_org-demo
</pre>
<br><br><br><p><br><p><br><p><hr><p><br><p>

<p>
<span class="underline">Yields</span>
</p>
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>
<div ><pre class="src src-org"> /italics/ and _underline_

 $e^{i \times \pi} + 1 = 0$
</pre></div>
</div>
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
<p>
<i>italics</i> and <span class="underline">underline</span>
</p>

<p>
\(e^{i \times \pi} + 1 = 0\)
</p>

</div>
</div>

</div>

<p>
However, since our implementation scheme relies on a preprocessing step before
export, we cannot use <code>org-demo</code> to show the results of special blocks: They
disappear in the preprocessing step!
</p>
<div style="column-rule-style: solid;column-count: 2;">
<p>
E.g., this
</p>
<pre class="example" id="org94c408e">
#+begin_org-demo
#+begin_box
There is no special block ‘box’ to touch!
#+end_box
#+end_org-demo
</pre>

<br><p><hr><br>
<p>
yields the <i>mess</i>
</p>
<div style="column-rule-style: none;column-count: 2;">
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>
<div ><pre class="src src-org"> #+begin_export html
<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3></h3>
<p>
There is no special block ‘box’ to touch!
</p>

</div>
<p>
&lt;/pre&gt;&lt;/div&gt;
#+end<sub>export</sub>
</p>
</div>
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3></h3>
<p>
There is no special block ‘box’ to touch!
</p>

</div>

</div>
</div>
</div>

<p>
However, it does work with links!
</p>
<div style="column-rule-style: none;column-count: 2;">
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>
<div ><pre class="src src-org"> [[box:][Box-as-link! Boxception!]]
</pre></div>
</div>
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
<p>
<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3></h3>Box-as-link! Boxception!</div>
</p>

</div>
</div>
</div>
</div>
</div>
<div id="outline-container-practice_problems" class="outline-3">
<h3 id="practice_problems"><span class="section-number-3">1.5</span> <a href="#practice_problems">Practice Problems: <i>Now you try!</i></a></h3>
<div class="outline-text-3" id="text-practice_problems">
<p>
<b><span style="color:green;">A 5-page PDF covering ELisp fundamentals</span></b> can be found <b><a href="https://alhassy.github.io/ElispCheatSheet/CheatSheet.pdf">here</a></b>.
</p>

<p>
The first problem is to <i>get you going with Lisp</i>, the next two are actually
useful blocks.  The <abbr class="tooltip" title="Perform the given LIST of substitutions on the text.<br>The LIST is a comma separated list of ‘to’ separated symbols.<br>In a link, no quotes are needed.<br><br>(fn BACKEND RAW-CONTENTS &optional LIST &rest ## &key (O-LINK\? nil))">rename</abbr> is useful for when you want to change some names or
translate some words; <abbr class="tooltip" title="Hide text enclosed in double parens ((like this)) as if it were spoilers.<br>&emsp; LEFT and RIGHT may be other kinds of delimiters.<br>&emsp; The main argument, COLOR, indicates which color to use.<br><br>For LaTeX, this becomes “fill in the blanks”, with the answers<br>in the footnotes.<br><br>(fn BACKEND RAW-CONTENTS &optional COLOR &rest ## &key (O-LINK\? nil) (LEFT ''(('') (RIGHT ''))''))">spoiler</abbr> is useful when we want to test a student's
understanding, or to subtly hide the answer to a puzzle so the reader has the
opportunity to attempt solving it.
</p>
</div>

<div id="outline-container-Sttutttterrr" class="outline-4">
<h4 id="Sttutttterrr"><span class="section-number-4">1.5.1</span> <a href="#Sttutttterrr">Sttutttterrr</a></h4>
<div class="outline-text-4" id="text-Sttutttterrr">
<p>
Define a block <abbr class="tooltip" title="Output the CONTENTS of the block REPS many times<br><br>(fn BACKEND RAW-CONTENTS &optional REPS &rest ## &key (O-LINK\? nil))">stutter</abbr> so that the following examples behave as shown.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Hints
                      </font>
                    </strong>
                  </summary>
<ol class="org-ol">
<li>You need at-most 5 lines of Lisp.</li>
<li>These functions <i>may</i> be useful: <abbr class="tooltip" title="Make a string of S repeated NUM times.">s-repeat</abbr>, <abbr class="tooltip" title="Return t if OBJECT is a number (floating point or integer).<br><br>(fn OBJECT)">numberp</abbr>,
<abbr class="tooltip" title="Parse STRING as a decimal number and return the number.<br>Ignore leading spaces and tabs, and all trailing chars.&emsp;Return 0 if<br>STRING cannot be parsed as an integer or floating point number.<br><br>If BASE, interpret STRING as a number in that base.&emsp;If BASE isn’t<br>present, base 10 is used.&emsp;BASE must be between 2 and 16 (inclusive).<br>If the base used is not 10, STRING is always parsed as an integer.<br><br>(fn STRING &optional BASE)">string-to-number</abbr></li>
</ol>


</details>

<br>
<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Examples</h3>

<div style="column-rule-style: solid;column-count: 2;">
<p>
The following outputs, well, nothing, since we asked for zero repetitions.
</p>
<div class="org-src-container">
<pre class="src src-org">#+begin_stutter 0

words

more words
#+end_stutter
</pre>
</div>



<p>
<p><br>
</p>

<p>
In contrast …
</p>
<div style="column-rule-style: none;column-count: 2;">
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>
<div ><pre class="src src-org">[[stutter:5][woah, I'm repeated 5 times!]]
</pre></div>
</div>
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
<p>
woah, I'm repeated 5 times!woah, I'm repeated 5 times!woah, I'm repeated 5 times!woah, I'm repeated 5 times!woah, I'm repeated 5 times!
</p>

</div>
</div>
</div>

</div>

<br>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Solution
                      </font>
                    </strong>
                  </summary>
<div style="padding: 1em; background-color: #CCFFFF;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Did you actually try? Maybe see the ‘hints’ above!</h3>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="red">
                         Solution, for real
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-defblock</span> stutter (reps 2) nil
  <span style="color: #2aa198;">"Output the CONTENTS of the block REPS many times"</span>
  (<span style="color: #859900; font-weight: bold;">-let</span> [num (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">numberp</span> reps) reps (<span style="color: #b58900;">string-to-number</span> reps))]
    (<span style="color: #b58900;">s-repeat</span> num contents)))
</pre>
</div>




</details>
</div>

</details>
</div>
</div>
<div id="outline-container-Textual_Substitution" class="outline-4">
<h4 id="Textual_Substitution"><span class="section-number-4">1.5.2</span> <a href="#Textual_Substitution">Textual Substitution &#x2014;A translation tool</a></h4>
<div class="outline-text-4" id="text-Textual_Substitution">
<p>
Define a block
<abbr class="tooltip" title="Perform the given LIST of substitutions on the text.<br>The LIST is a comma separated list of ‘to’ separated symbols.<br>In a link, no quotes are needed.<br><br>(fn BACKEND RAW-CONTENTS &optional LIST &rest ## &key (O-LINK\? nil))">rename</abbr> so that the following examples behave as shown.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Hints
                      </font>
                    </strong>
                  </summary>
<ol class="org-ol">
<li>It can be done in less than 10 lines of Lisp.</li>
<li>First, try to <abbr class="tooltip" title="REPLACEMENTS is a list of cons-cells. Each ‘car‘ is replaced with ‘cdr‘ in S.">s-replace-all</abbr> the substitution
<code>'(("Allah" . "God") ("Yacoub". "Jacob") ("Yusuf" . "Joseph"))</code>
only.</li>
<li>Then take out such hard-coded substitutions … these functions <i>may</i> be helpful:
<abbr class="tooltip" title="Eval FORM for each item in LIST and return the list of results.<br>Each element of LIST in turn is bound to ‘it’ before evaluating<br>FORM.<br>This is the anaphoric counterpart to ‘-map’.<br><br>(fn FORM LIST)">--map</abbr> / <abbr class="tooltip" title="Apply FN to each item in LIST and return the list of results.<br><br>This function’s anaphoric counterpart is ‘--map’.<br><br>(fn FN LIST)">-map</abbr>, <abbr class="tooltip" title="Split S into substrings bounded by matches for regexp SEPARATOR.<br>If OMIT-NULLS is non-nil, zero-length substrings are omitted.<br><br>This is a simple wrapper around the built-in ‘split-string’.">s-split</abbr>, <abbr class="tooltip" title="Remove whitespace at the beginning and end of S.">s-trim</abbr></li>
</ol>


</details>

<br>
<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Examples</h3>

<pre class="example" id="org6a0ca7b">
#+begin_rename "Allah to God, Yacoub to Jacob, Yusuf to Joseph"
Quran 12-4: *_Yusuf_* said to his father ( _*Yacoub*_ ), /“O my father, indeed I have seen (in a dream) eleven
stars and the sun and the moon; I saw them prostrating to me.”/
#+end_rename
</pre>
<p>
Yields…
</p>

<p>
Quran 12-4: <b><span class="underline">Joseph</span></b> said to his father ( <span class="underline"><b>Jacob</b></span> ), <i>“O my father, indeed I have seen (in a dream) eleven
stars and the sun and the moon; I saw them prostrating to me.”</i>
</p>



<hr />
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>
<div ><pre class="src src-org">
[[rename:Pharaoh to Firaun, Joseph to Yusuf][Genesis 41-17: Pharaoh said unto Joseph, /In my dream, behold, I stood upon the
bank of the river/ …]]

</pre></div>
</div>
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>

<p>
Genesis 41-17: Firaun said unto Yusuf, <i>In my dream, behold, I stood upon the
bank of the river</i> …
</p>


</div>
</div>

<br>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Solution
                      </font>
                    </strong>
                  </summary>
<div style="padding: 1em; background-color: #CCFFFF;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Did you actually try? Maybe see the ‘hints’ above!</h3>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="red">
                         Solution, for real
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-defblock</span> rename (<span style="color: #b58900;">list</span> <span style="color: #2aa198;">""</span>) nil
  <span style="color: #2aa198;">"Perform the given LIST of substitutions on the text.</span>
<span style="color: #2aa198;">The LIST is a comma separated list of &#8216;</span><span style="color: #6c71c4; font-weight: bold;">to</span><span style="color: #2aa198;">&#8217; separated symbols.</span>
<span style="color: #2aa198;">In a link, no quotes are needed."</span>
  (<span style="color: #b58900;">s-replace-all</span>
   (<span style="color: #859900; font-weight: bold;">--map</span> (<span style="color: #b58900;">cons</span> (<span style="color: #b58900;">car</span> it) (<span style="color: #b58900;">cadr</span> it))
          (<span style="color: #859900; font-weight: bold;">--map</span> (<span style="color: #b58900;">s-split</span> <span style="color: #2aa198;">" to "</span> (<span style="color: #b58900;">s-trim</span> it))
                 (<span style="color: #b58900;">s-split</span> <span style="color: #2aa198;">","</span> <span style="color: #b58900;">list</span>)))
   contents))
</pre>
</div>





</details>
</div>

</details>
</div>
</div>
<div id="outline-container-spoilers" class="outline-4">
<h4 id="spoilers"><span class="section-number-4">1.5.3</span> <a href="#spoilers">Spoilers! &#x2014;“fill in the blanks”</a></h4>
<div class="outline-text-4" id="text-spoilers">
<p>
Define a block <abbr class="tooltip" title="Hide text enclosed in double parens ((like this)) as if it were spoilers.<br>&emsp; LEFT and RIGHT may be other kinds of delimiters.<br>&emsp; The main argument, COLOR, indicates which color to use.<br><br>For LaTeX, this becomes “fill in the blanks”, with the answers<br>in the footnotes.<br><br>(fn BACKEND RAW-CONTENTS &optional COLOR &rest ## &key (O-LINK\? nil) (LEFT ''(('') (RIGHT ''))''))">spoiler</abbr> so that the following examples behave as shown.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Hints
                      </font>
                    </strong>
                  </summary>
<ol class="org-ol">
<li>It can be done in less than 10 lines of Lisp.</li>
<li><p>
You will need the following style setup …
</p>
<pre class="example" id="org7f29bc8">
#+html_head: &lt;style&gt;
#+html_head: .spoiler {color: grey; background-color:grey;}
#+html_head: .spoiler:hover {color: black; background-color:white;}
#+html_head: &lt;style&gt;
# Example use: &lt;span class="spoiler"&gt; test &lt;/span&gt;
</pre></li>
<li><i>Escape</i> HTML snippets by enclosing them in <code>@@html: … @@</code> &#x2014;as discussed above
in the introduction to special blocks.</li>
<li>The functions  <abbr class="tooltip" title="Replace all matches for REGEXP with REP in STRING.<br><br>Return a new string containing the replacements.<br><br>Optional arguments FIXEDCASE, LITERAL and SUBEXP are like the<br>arguments with the same names of function ‘replace-match’.&emsp;If START<br>is non-nil, start replacements at that index in STRING, and omit<br>the first START characters of STRING from the return value.<br><br>REP is either a string used as the NEWTEXT arg of ‘replace-match’ or a<br>function.&emsp;If it is a function, it is called with the actual text of each<br>match, and its value is used as the replacement text.&emsp;When REP is called,<br>the match data are the result of matching REGEXP against a substring<br>of STRING, the same substring that is the actual text of the match which<br>is passed to REP as its argument.<br><br>To replace only the first match (if any), make REGEXP match up to \'<br>and replace a sub-expression, e.g.<br>&emsp;(replace-regexp-in-string ''\\(foo\\).*\\''' ''bar'' '' foo foo'' nil nil 1)<br>&emsp;&emsp;=> '' bar foo''<br><br>(fn REGEXP REP STRING &optional FIXEDCASE LITERAL SUBEXP START)">s-replace-regexp</abbr> and <abbr class="tooltip" title="Return a regexp string which matches exactly STRING and nothing else.<br><br>(fn STRING)">regexp-quote</abbr> <i>may</i> be useful.</li>
</ol>


</details>

<br>
<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Examples</h3>
<div style="column-rule-style: solid;column-count: 2;">
<pre class="example" id="orgb68ab19">
#+begin_spoiler
((Yusuf)) said to his father ((Yacoub)), /“O my father, indeed I have seen
((eleven stars)) and ((the sun and the moon)); I saw them prostrating to me.”/
#+end_spoiler
</pre>

<style> #g244 {color: grey; background-color:grey;}
       #g244:hover {color: black; background-color:white;} </style>
<p>
<span id="g244"> Yusuf </span> said to his father <span id="g244"> Yacoub </span>, <i>“O my father, indeed I have seen
<span id="g244"> eleven stars </span> and <span id="g244"> the sun and the moon </span>; I saw them prostrating to me.”</i>
</p>



<p>
<p><br>
</p>
<br>

<pre class="example" id="org8370c40">
#+begin_spoiler :left "[" :right "]"
[Yusuf] said to his father [Yacoub], /“O my father, indeed I have seen
[eleven stars] and [the sun and the moon]; I saw them prostrating to me.”/
#+end_spoiler
</pre>

<style> #g245 {color: grey; background-color:grey;}
       #g245:hover {color: black; background-color:white;} </style>
<p>
<span id="g245"> Yusuf </span> said to his father <span id="g245"> Yacoub </span>, <i>“O my father, indeed I have seen
<span id="g245"> eleven stars </span> and <span id="g245"> the sun and the moon </span>; I saw them prostrating to me.”</i>
</p>




</div>

</div>

<br>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Solution
                      </font>
                    </strong>
                  </summary>
<div style="padding: 1em; background-color: #CCFFFF;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Did you actually try? Maybe see the ‘hints’ above!</h3>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="red">
                         Solution, for real
                      </font>
                    </strong>
                  </summary>
<p>
Rather than having auxiliary <code>#+html_head:</code> styling settings, we have moved the
styling information to the <code>defblock</code> declaration <i>and</i> are using the main argument
to colour the spoiler &#x2014;which defaults to grey ;-)
</p>

<hr />

<p>
For example, the next segment of text is in a block <code>#+begin_spoiler pink</code> &#x2026;
</p>
<style> #g246 {color: pink; background-color:pink;}
       #g246:hover {color: black; background-color:white;} </style>
<p>
<span id="g246"> Yusuf </span> said to his father <span id="g246"> Yacoub </span>, <i>“O my father, indeed I have seen
<span id="g246"> eleven stars </span> and <span id="g246"> the sun and the moon </span>; I saw them prostrating to me.”</i>
</p>



<p>
Whereas, the following begins with <code>#+begin_spoiler orange</code> &#x2026;
</p>
<style> #g247 {color: orange; background-color:orange;}
       #g247:hover {color: black; background-color:white;} </style>
<p>
<span id="g247"> Yusuf </span> said to his father <span id="g247"> Yacoub </span>, <i>“O my father, indeed I have seen
<span id="g247"> eleven stars </span> and <span id="g247"> the sun and the moon </span>; I saw them prostrating to me.”</i>
</p>



<hr />

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-defblock</span> spoiler (color <span style="color: #2aa198;">"grey"</span>) (left <span style="color: #2aa198;">"(("</span> right <span style="color: #2aa198;">"))"</span>)
  <span style="color: #2aa198;">"Hide text enclosed in double parens ((like this)) as if it were spoilers.</span>
<span style="color: #2aa198;">   LEFT and RIGHT may be other kinds of delimiters.</span>
<span style="color: #2aa198;">   The main argument, COLOR, indicates which color to use.</span>

<span style="color: #2aa198;">For LaTeX, this becomes &#8220;fill in the blanks&#8221;, with the answers</span>
<span style="color: #2aa198;">in the footnotes."</span>
  (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">equal</span> backend 'latex)
      (<span style="color: #b58900;">s-replace-regexp</span>
       (<span style="color: #b58900;">concat</span> (<span style="color: #b58900;">regexp-quote</span> left) <span style="color: #2aa198;">"</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">(</span><span style="color: #2aa198;">.*?</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">)</span><span style="color: #2aa198;">"</span> (<span style="color: #b58900;">regexp-quote</span> right))
       <span style="color: #2aa198;">"</span><span style="color: #b58900;">@@latex</span><span style="color: #2aa198;">:\\\\fbox{\\\\phantom{\\1}}\\\\footnote{\\1}@@"</span>
       contents)
  (<span style="color: #859900; font-weight: bold;">-let</span> [id (<span style="color: #b58900;">gensym</span>)]
    (<span style="color: #b58900;">concat</span>
     <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">In HTML, a &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">style</span><span style="color: #96A7A9; font-style: italic;">&#8217; can be, technically, almost anywhere...</span>
     (<span style="color: #b58900;">format</span>
      <span style="color: #2aa198;">"&lt;style&gt; #%s {color: %s; background-color:%s;}</span>
<span style="color: #2aa198;">       #%s:hover {color: black; background-color:white;} &lt;/style&gt;</span>
<span style="color: #2aa198;">       "</span> id color color id)
     (<span style="color: #b58900;">s-replace-regexp</span>
      (<span style="color: #b58900;">concat</span> (<span style="color: #b58900;">regexp-quote</span> left) <span style="color: #2aa198;">"</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">(</span><span style="color: #2aa198;">.*?</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">)</span><span style="color: #2aa198;">"</span> (<span style="color: #b58900;">regexp-quote</span> right))
      (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"</span><span style="color: #b58900;">@@html</span><span style="color: #2aa198;">:&lt;span id=\"%s\"&gt; \\1 &lt;/span&gt;@@"</span> id)
      contents)))))
</pre>
</div>


<p>
There's actually a problem with this ‘solution’; can you find it?
</p>
<style> #g248 {color: grey; background-color:grey;}
       #g248:hover {color: black; background-color:white;} </style>
<p>
Hint: <span id="g248"> Try the link form and see how it breaks! </span>
</p>




</details>
</div>

</details>
</div>
</div>

<div id="outline-container-Judgements-Inference-rules-and-proof-trees" class="outline-4">
<h4 id="Judgements-Inference-rules-and-proof-trees"><span class="section-number-4">1.5.4</span> <a href="#Judgements-Inference-rules-and-proof-trees">Judgements: Inference rules and proof trees</a></h4>
<div class="outline-text-4" id="text-Judgements-Inference-rules-and-proof-trees">
<p>
Using a mixture of <code>\frac</code> and <code>\displaystyle</code>, define a block <abbr class="tooltip" title="Write a proof tree using Org-lists.<br><br>To get<br><br>&emsp;&emsp;&emsp;&emsp; premises₀&emsp;…&emsp; premisesₙ<br>&emsp;&emsp;&emsp; ────────────────────────────[ reason ]<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; conclusion<br><br>You type<br><br>&emsp;&emsp;&emsp; #+begin_tree<br>&emsp;&emsp;&emsp; + reason :: conclusion<br>&emsp;&emsp;&emsp;&emsp; - premises₀<br>&emsp;&emsp;&emsp;&emsp; - premises₁<br>&emsp;&emsp;&emsp;&emsp; ⋮<br>&emsp;&emsp;&emsp;&emsp; - premisesₙ<br>&emsp;&emsp;&emsp; #+end_tree<br><br>Where each premisesᵢ may, recursively, also have named reasons<br>and (indented) child premises of its own.<br><br>If there are multiple trees, they are shown one after the other.<br><br>The text in this block should be considered LaTeX;<br>as such, Org markup is not recognised.<br><br>A proof tree, derivation, is then just a deeply nested<br>itemisation.&emsp;For instance, assuming P = Q(X), X = Y, Q(Y) = R,<br>the following proves P = R.<br><br>&emsp;#+begin_tree<br>&emsp;+ Trans :: P = R<br>&emsp;&emsp;- P = Q(X)<br>&emsp;&emsp;&emsp;+ ✓<br>&emsp;&emsp;- Trans :: Q(X) = R<br>&emsp;&emsp;&emsp;+ Trans :: Q(X) = Q(Y)<br>&emsp;&emsp;&emsp;&emsp;- Refl :: Q(X) = Q(X)<br>&emsp;&emsp;&emsp;&emsp;&emsp;+ ✓<br>&emsp;&emsp;&emsp;&emsp;- Leibniz :: Q(X) = Q(Y)<br>&emsp;&emsp;&emsp;&emsp;&emsp;+ X = Y<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;- ✓<br>&emsp;&emsp;&emsp;+ Sym :: Q(Y) = R<br>&emsp;&emsp;&emsp;&emsp;- R = Q(Y)<br>&emsp;&emsp;&emsp;&emsp;&emsp;- ✓<br>&emsp;#+end_tree<br><br>(fn BACKEND RAW-CONTENTS &optional MAIN-ARG &rest ## &key (O-LINK\? nil))">tree</abbr> so that the
following examples behave as shown. Hint: <abbr class="tooltip" title="Parse the list at point and maybe DELETE it.<br><br>Return a list whose car is a symbol of list type, among<br>‘ordered’, ‘unordered’ and ‘descriptive’.&emsp;Then, each item is<br>a list of strings and other sub-lists.<br><br>For example, the following list:<br><br>&emsp;1. first item<br>&emsp;&emsp; + sub-item one<br>&emsp;&emsp; + [X] sub-item two<br>&emsp;&emsp; more text in first item<br>&emsp;2. [@3] last item<br><br>is parsed as<br><br> (ordered<br>&emsp;(''first item''<br>&emsp; (unordered<br>&emsp;&emsp;(''sub-item one'')<br>&emsp;&emsp;(''[X] sub-item two''))<br>&emsp; ''more text in first item'')<br>&emsp;(''[@3] last item''))<br><br>Point is left at list’s end.<br><br>(fn &optional DELETE)">org-list-to-lisp</abbr> and
<abbr class="tooltip" title="Create a temporary buffer, and evaluate BODY there like ‘progn’.<br>See also ‘with-temp-file’ and ‘with-output-to-string’.<br><br>(fn &rest BODY)">with-temp-buffer</abbr> may be useful ;-)
</p>

<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Programming ≈ Proving</h3>
<div style="column-rule-style: none;column-count: 2;">
<p>
<b>Source</b>
</p>
<div class="org-src-container">
<pre class="src src-org">#+begin_tree
  + Function Application :: f(a) : B
    - a : A
    - f : A &#8594; B

  + Modus Ponens :: q
    - p
    - p &#8658; q
#+end_tree
</pre>
</div>

<p>

<p>
<b>Result</b>
</p>
\[\frac{\displaystyle  \qquad a : A \qquad f : A → B
}{f(a) : B}[\text{Function Application}]\]\[\frac{\displaystyle  \qquad p \qquad p ⇒ q}{q}[\text{Modus Ponens}]\]

</div>

</div>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Solution
                      </font>
                    </strong>
                  </summary>
<div style="padding: 1em; background-color: #CCFFFF;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Did you actually try? Maybe see the ‘hints’ above!</h3>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="red">
                         Solution, for real
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">o--list-to-math</span> (lst)
  <span style="color: #35a69c; font-style: italic;">"Get a result LST from ORG-LIST-TO-LISP and render it as a proof tree."</span>
  (<span style="color: #859900; font-weight: bold;">cond</span>
   ((<span style="color: #b58900;">symbolp</span> lst) <span style="color: #2aa198;">""</span>)
   ((<span style="color: #b58900;">symbolp</span> (<span style="color: #b58900;">car</span> lst)) (<span style="color: #b58900;">o--list-to-math</span> (<span style="color: #b58900;">cadr</span> lst)))
   (<span style="color: #268bd2;">t</span>
    (<span style="color: #859900; font-weight: bold;">-let*</span> (((conclusion&#8320; children) lst)
            ((name named?) (<span style="color: #b58900;">s-split</span> <span style="color: #2aa198;">" :: "</span> conclusion&#8320;))
            (conclusion (<span style="color: #859900; font-weight: bold;">or</span> named? conclusion&#8320;)))
      (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">not</span> children)
          (<span style="color: #859900; font-weight: bold;">if</span> named? (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"\\frac{}{%s}[%s]"</span> conclusion name) conclusion)
        (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"\\frac{\\displaystyle %s}{%s}%s"</span>
                (<span style="color: #b58900;">s-join</span> <span style="color: #2aa198;">" \\qquad "</span>
                        (<span style="color: #b58900;">mapcar</span> #'<span style="color: #b58900;">o--list-to-math</span> children))
                conclusion
                (<span style="color: #859900; font-weight: bold;">if</span> named? (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"[\\text{%s}]"</span> name) <span style="color: #2aa198;">""</span>)))))))

(<span style="color: #859900; font-weight: bold;">o-defblock</span> tree (main-arg) nil
  <span style="color: #2aa198;">"Write a proof tree using Org-lists.</span>

<span style="color: #2aa198;">To get</span>

<span style="color: #2aa198;">         premises&#8320;  &#8230;   premises&#8345;</span>
<span style="color: #2aa198;">       &#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;[ reason ]</span>
<span style="color: #2aa198;">               conclusion</span>

<span style="color: #2aa198;">You type</span>

<span style="color: #2aa198;">       #+begin_tree</span>
<span style="color: #2aa198;">       + reason :: conclusion</span>
<span style="color: #2aa198;">         - premises&#8320;</span>
<span style="color: #2aa198;">         - premises&#8321;</span>
<span style="color: #2aa198;">         &#8942;</span>
<span style="color: #2aa198;">         - premises&#8345;</span>
<span style="color: #2aa198;">       #+end_tree</span>

<span style="color: #2aa198;">Where each premises&#7522; may, recursively, also have named reasons</span>
<span style="color: #2aa198;">and (indented) child premises of its own.</span>

<span style="color: #2aa198;">If there are multiple trees, they are shown one after the other.</span>

<span style="color: #2aa198;">The text in this block should be considered LaTeX;</span>
<span style="color: #2aa198;">as such, Org markup is not recognised.</span>

<span style="color: #2aa198;">A proof tree, derivation, is then just a deeply nested</span>
<span style="color: #2aa198;">itemisation.  For instance, assuming P = Q(X), X = Y, Q(Y) = R,</span>
<span style="color: #2aa198;">the following proves P = R.</span>

<span style="color: #2aa198;">  #+begin_tree</span>
<span style="color: #2aa198;">  + Trans :: P = R</span>
<span style="color: #2aa198;">    - P = Q(X)</span>
<span style="color: #2aa198;">      + &#10003;</span>
<span style="color: #2aa198;">    - Trans :: Q(X) = R</span>
<span style="color: #2aa198;">      + Trans :: Q(X) = Q(Y)</span>
<span style="color: #2aa198;">        - Refl :: Q(X) = Q(X)</span>
<span style="color: #2aa198;">          + &#10003;</span>
<span style="color: #2aa198;">        - Leibniz :: Q(X) = Q(Y)</span>
<span style="color: #2aa198;">          + X = Y</span>
<span style="color: #2aa198;">            - &#10003;</span>
<span style="color: #2aa198;">      + Sym :: Q(Y) = R</span>
<span style="color: #2aa198;">        - R = Q(Y)</span>
<span style="color: #2aa198;">          - &#10003;</span>
<span style="color: #2aa198;">  #+end_tree"</span>
  (<span style="color: #b58900;">s-join</span> <span style="color: #2aa198;">""</span> (<span style="color: #859900; font-weight: bold;">--map</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"\\[</span><span style="color: #6c71c4; font-weight: bold;">%s\\</span><span style="color: #2aa198;">]"</span>
                                (<span style="color: #b58900;">o--list-to-math</span> it))
                        (<span style="color: #b58900;">cdr</span> (<span style="color: #859900; font-weight: bold;">with-temp-buffer</span>
                               (<span style="color: #b58900;">insert</span> raw-contents)
                               (<span style="color: #b58900;">goto-char</span> (<span style="color: #b58900;">point-min</span>))
                               (<span style="color: #b58900;">org-list-to-lisp</span>))))))
</pre>
</div>




</details>
</div>

</details>
<p>
For more on these ‘proof trees’, see <a href="https://cpb-us-w2.wpmucdn.com/u.osu.edu/dist/a/4597/files/2014/08/Natural_Logic-2epb48e.pdf">‘Natural Logic’ by Neil Tennant</a>.
</p>

<p>
\[\] (<b><i>Warning!</i></b> For MathJax to activate, you should have some math <code>$...$</code>
somewhere <i>besides</i> the <code>tree</code> blocks; just <code>\[\]</code> suffices. )
</p>
</div>
</div>
</div>

<div id="outline-container-Whats_the_rest_of_this_article_about?" class="outline-3">
<h3 id="Whats_the_rest_of_this_article_about?"><span class="section-number-3">1.6</span> <a href="#Whats_the_rest_of_this_article_about?">What's the rest of this article about?</a></h3>
<div class="outline-text-3" id="text-Whats_the_rest_of_this_article_about?">
<p>
The rest of the article showcases the special blocks declared with <code>defblock</code> to
allow the above presentation &#x2014;with folded regions, coloured boxes, tooltips,
parallel columns of text, etc.
</p>

<p>
Enjoy ;-)
</p>
</div>
</div>
</div>

<div id="outline-container-editor-comments" class="outline-2">
<h2 id="editor-comments"><span class="section-number-2">2</span> <a href="#editor-comments">Editor Comments</a></h2>
<div class="outline-text-2" id="text-editor-comments">
<p>
“Editor Comments” are intended to be top-level first-class comments in an
article that are inline with the surrounding text and are delimited in such a
way that they are visible but drawing attention.  I first learned about this
idea from Wolfram Kahl &#x2014;who introduced me to Emacs many years ago.  We
</p>

<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Example</h3>

<div style="column-rule-style: none;column-count: 2;">
<p>
<span class="underline">This</span>
</p>

<div class="org-src-container">
<pre class="src src-org"> In LaTeX, a =remark= appears inline with the text surrounding it.
 #+begin_remark Bobert
 org-mode is dope, yo!
 #+replacewith:
 Org-mode is essentially a path toward enlightenment.
 #+end_remark
 Unfortunately, in the HTML rendition, the =remark= is its own paragraph and thus
 separated by new lines from its surrounding text.
</pre>
</div>

<p><hr><p>

<p>
<span class="underline">Yields</span>
</p>

<p>
In LaTeX, an <code>remark</code> appears inline with the text surrounding it.
</p>
<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Bobert:&nbsp;<u>Replace:</u></strong></span>
<p>
org-mode is dope, yo!
</p>
<span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>
<p>
Org-mode is essentially a path toward enlightenment.
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
<p>
Unfortunately, in the HTML rendition, the <code>remark</code> is its own paragraph and thus
separated by new lines from its surrounding text.
</p>

</div>

</div>

<hr />

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="pink">
                         Implementing ‘remark’, from §ection 1, with more bells and whistles
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">o-hide-editor-comments</span> nil
  <span style="color: #35a69c; font-style: italic;">"Should editor comments be shown in the output or not."</span>)

(<span style="color: #859900; font-weight: bold;">o-defblock</span> remark
      (editor <span style="color: #2aa198;">"Editor Remark"</span> <span style="color: #d33682; font-style: italic;">:face</span> '(<span style="color: #d33682; font-style: italic;">:foreground</span> <span style="color: #2aa198;">"red"</span> <span style="color: #d33682; font-style: italic;">:weight</span> <span style="color: #b58900;">bold</span>)) (color <span style="color: #2aa198;">"black"</span> signoff <span style="color: #2aa198;">""</span> strong nil)
<span style="color: #96A7A9; font-style: italic;">; </span><span style="color: #96A7A9; font-style: italic;">:inline-please__see_margin_block_for_a_similar_incantation ; &#8658; crashes!</span>
<span style="color: #2aa198;">"Format CONTENTS as an first-class editor comment according to BACKEND.</span>

<span style="color: #2aa198;">The CONTENTS string has an optional switch: If it contains a line</span>
<span style="color: #2aa198;">with having only &#8216;#+replacewith:&#8217;, then the text preceding this</span>
<span style="color: #2aa198;">clause should be replaced by the text after it; i.e., this is</span>
<span style="color: #2aa198;">what the EDITOR (the person editing) intends and so we fromat the</span>
<span style="color: #2aa198;">replacement instruction (to the authour) as such.</span>

<span style="color: #2aa198;">In Emacs, as links, editor remarks are shown with a bold red; but</span>
<span style="color: #2aa198;">the exported COLOR of a remark is black by default and it is not</span>
<span style="color: #2aa198;">STRONG ---i.e., bold---. There is an optional SIGNOFF message</span>
<span style="color: #2aa198;">that is appended to the remark.</span>
<span style="color: #2aa198;">"</span>
  (<span style="color: #859900; font-weight: bold;">-let*</span> (<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Are we in the html backend?</span>
          (tex? (<span style="color: #b58900;">equal</span> backend 'latex))

          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">fancy display style</span>
          (boxed (<span style="color: #859900; font-weight: bold;">lambda</span> (x)
                   (<span style="color: #859900; font-weight: bold;">if</span> tex?
                       (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"\\fbox{\\bf "</span> x <span style="color: #2aa198;">"}"</span>)
                     (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"&lt;span style=\"border-width:1px"</span>
                             <span style="color: #2aa198;">";border-style:solid;padding:5px\"&gt;"</span>
                             <span style="color: #2aa198;">"&lt;strong&gt;"</span> x <span style="color: #2aa198;">"&lt;/strong&gt;&lt;/span&gt;"</span>))))

          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Is this a replacement clause?</span>
          ((this that) (<span style="color: #b58900;">s-split</span> <span style="color: #2aa198;">"\\#\\+replacewith:"</span> contents))
          (replacement-clause? that) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">There is a &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">that</span><span style="color: #96A7A9; font-style: italic;">&#8217;</span>
          (replace-keyword (<span style="color: #859900; font-weight: bold;">if</span> tex?
                             <span style="color: #2aa198;">"\\underline{Replace:}"</span> <span style="color: #2aa198;">"&amp;nbsp;&lt;u&gt;Replace:&lt;/u&gt;"</span>))
          (with-keyword    (<span style="color: #859900; font-weight: bold;">if</span> tex? <span style="color: #2aa198;">"\\underline{With:}"</span> <span style="color: #2aa198;">"&lt;u&gt;With:&lt;/u&gt;"</span>
                             ))
          (editor (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"[%s:%s"</span> editor
                          (<span style="color: #859900; font-weight: bold;">if</span> replacement-clause?
                              replace-keyword
                            <span style="color: #2aa198;">""</span>)))
          (contents&#8242; (<span style="color: #859900; font-weight: bold;">if</span> replacement-clause?
                         (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s %s %s"</span> this
                                 (org-export (<span style="color: #b58900;">funcall</span> boxed with-keyword))
                                 that)
                       contents))

          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">&#8220;[Editor Comment:&#8221;</span>
          (edcomm-begin (<span style="color: #b58900;">funcall</span> boxed editor))
          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">&#8220;]&#8221;</span>
          (edcomm-end (<span style="color: #b58900;">funcall</span> boxed <span style="color: #2aa198;">"]"</span>)))

    (<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">org-export-allow-bind-keywords</span> <span style="color: #268bd2;">t</span>) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">So users can use &#8220;#+bind&#8221; immediately</span>
    (<span style="color: #859900; font-weight: bold;">if</span> <span style="color: #268bd2;">o-hide-editor-comments</span>
        <span style="color: #2aa198;">""</span>
      (<span style="color: #b58900;">format</span> (<span style="color: #859900; font-weight: bold;">pcase</span> backend
                ('latex (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"{\\color{%%s}%s %%s %%s %%s %%s}"</span> (<span style="color: #859900; font-weight: bold;">if</span> strong <span style="color: #2aa198;">"\\bfseries"</span> <span style="color: #2aa198;">""</span>)))
                (_ (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;%s style=\"color: %%s;\"&gt;%%s %%s %%s %%s&lt;/%s&gt;"</span> (<span style="color: #859900; font-weight: bold;">if</span> strong <span style="color: #2aa198;">"strong"</span> <span style="color: #2aa198;">"p"</span>) (<span style="color: #859900; font-weight: bold;">if</span> strong <span style="color: #2aa198;">"strong"</span> <span style="color: #2aa198;">"p"</span>))))
              color edcomm-begin contents&#8242; signoff edcomm-end))))
</pre>
</div>



<p>
In the HTML export, the <code>edcomm</code> special block is <i>not</i> in-line with the text
surrounding it &#x2014;ideally, it would be inline so that existing paragraphs are
not split into multiple paragraphs but instead have an editor's comment
indicating suggested alterations.
</p>



<p>
Let's have some sanity tests&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"The user's remark is enclosed in the default delimiters"</span>
  [remark]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"#+begin_remark</span>
<span style="color: #2aa198;">                   Here is some meta-commentary...</span>
<span style="color: #2aa198;">                  #+end_remark"</span>)
     (<span style="color: #b58900;">*</span> anything) <span style="color: #2aa198;">"[Editor Remark:"</span>
     (<span style="color: #b58900;">*</span> anything) <span style="color: #2aa198;">"Here is some meta-commentary"</span>
     (<span style="color: #b58900;">*</span> anything)  <span style="color: #2aa198;">"]"</span>))

<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The other features of remark blocks should be tested;</span>
<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">but this is not a pressing, nor interesting, concern.</span>
</pre>
</div>



</details>

<hr />

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: No optional arguments
                      </font>
                    </strong>
                  </summary>
<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Remark:</strong></span>
<p>
<i>Please</i> <b>change</b> <span class="underline">this</span> section to be more, ya know, professional.
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>

<hr />
<p>
<b>Source:</b>
</p>
<div class="org-src-container">
<pre class="src src-org"> #+begin_remark
 /Please/ *change* _this_ section to be more, ya know, professional.
 #+end_remark
</pre>
</div>


</details>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: Only providing a main argument ---i.e., the remark author, the editor
                      </font>
                    </strong>
                  </summary>
<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Bobert:</strong></span>
<p>
<i>Please</i> <b>change</b> <span class="underline">this</span> section to be more, ya know, professional.
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>

<hr />
<p>
<b>Source:</b>
</p>
<div class="org-src-container">
<pre class="src src-org"> #+begin_remark Bobert
 /Please/ *change* _this_ section to be more, ya know, professional.
 #+end_remark
</pre>
</div>



</details>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: Possibly with no contents:
                      </font>
                    </strong>
                  </summary>
<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Bobert:</strong></span>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
<hr />
<p>
<b>Source:</b>
</p>
<div class="org-src-container">
<pre class="src src-org"> #+begin_remark Bobert
 #+end_remark
</pre>
</div>


</details>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: Empty contents, no authour, nothing
                      </font>
                    </strong>
                  </summary>
<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Remark:</strong></span>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
<hr />
<p>
<b>Source:</b>
</p>
<div class="org-src-container">
<pre class="src src-org"> #+begin_remark
 #+end_remark
</pre>
</div>


</details>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: Possibly with an empty new line
                      </font>
                    </strong>
                  </summary>
<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Remark:</strong></span>


<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
<hr />
<p>
<b>Source:</b>
</p>
<div class="org-src-container">
<pre class="src src-org"> #+begin_remark

 #+end_remark
</pre>
</div>


</details>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: With a “#+replacewith:” clause
                      </font>
                    </strong>
                  </summary>
<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Remark:&nbsp;<u>Replace:</u></strong></span>
<p>
The two-dimensional notation; e.g., \(\sum_{i = 0}^n i^2\)
</p>
<span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>
<p>
A linear one-dimensional notation; e.g.,
\((\Sigma i : 0..n \;\bullet\; i^2)\)
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
<hr />
<p>
<b>Source:</b>
</p>
<div class="org-src-container">
<pre class="src src-org"> #+begin_remark
 The two-dimensional notation; e.g., $\sum_{i = 0}^n i^2$
 #+replacewith:
 A linear one-dimensional notation; e.g.,
 $(\Sigma i : 0..n \;\bullet\; i^2)$
 #+end_remark
</pre>
</div>


</details>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: Possibly “malformed” replacement clauses
                      </font>
                    </strong>
                  </summary>

<p>
Forgot the thing to be replaced…
</p>

<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Remark:&nbsp;<u>Replace:</u></strong></span>
<span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>
<p>
A linear one-dimensional notation; e.g.,
\((\Sigma i : 0..n \;\bullet\; i^2)\)
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>

<hr />

<p>
Forgot the new replacement thing…
</p>

<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Remark:&nbsp;<u>Replace:</u></strong></span>
<p>
The two-dimensional notation; e.g., \(\sum_{i = 0}^n i^2\)
</p>
<span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>

<hr />

<p>
Completely lost one's train of thought…
</p>
<div style="column-rule-style: none;column-count: 2;">
<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Remark:&nbsp;<u>Replace:</u></strong></span>
<span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>

<p>
<p><br>
<b>Source:</b>
</p>

<div class="org-src-container">
<pre class="src src-org"> #+begin_remark
 #+replacewith:
 #+end_remark
</pre>
</div>

</div>



</details>

<hr />

<p>
A block to make an editorial comment could be overkill in some cases; luckily
<abbr class="tooltip" title="Declare a new special block, and link, in the style of DEFUN.<br><br>A full featured example is at the end of this documentation string.<br><br>This is an anaphoric macro that provides export support for<br>special blocks <strong>and</strong> links named NAME. Just as an Org-mode<br>src-block consumes as main argument the language for the src<br>block, our special blocks too consume a MAIN-ARG; it may be a<br>symbol or a cons-list consisting of a symbolic name (with which<br>to refer to the main argument in the definition of the block)<br>followed by a default value, then, optionally, any information<br>for a one-time setup of the associated link type.<br><br>The main arg may be a sequence of symbols separated by spaces,<br>and a few punctuation with the exception of comma ‘,’ since it is<br>a special Lisp operator. In doubt, enclose the main arg in<br>quotes.<br><br>Then, just as Org-mode src blocks consume key-value pairs, our<br>special blocks consume a number of KWDS, which is a list of the<br>form (key₀ value₀ … keyₙ valueₙ).<br><br>After that is an optional DOCSTRING, a familar feature of DEFUN.<br>The docstring is displayed as part of the tooltip for the<br>produced link type.<br><br>Finally, the BODY is a (sequence of) Lisp forms ---no progn<br>needed--- that may refer to the names BACKEND and CONTENTS which<br>refer to the current export backend and the contents of the<br>special block ---or the description clause of a link.<br><br>CONTENTS refers to an Org-mode parsed string; i.e., Org-markup is<br>acknowledged.<br><br>In, hopefully, rare circumstances, one may refer to RAW-CONTENTS<br>to look at the fully unparsed contents.<br><br>Finally, this macro exposes two functions:<br>+ ORG-EXPORT: Wrap the argument in an export block for the current backend.<br>+ ORG-PARSE: This should ONLY be called within an ORG-EXPORT call,<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; to escape text to Org, and out of the export block.<br><br><hr><br><br>TLDR for EXPERIMENTAL and DOCSTRING and BODY, the first two parts are<br>optional; they’re a symbol, a string, then the main body.&emsp;The<br>symbol, O-RESPECT-NEWLINES?, when present enables a highly<br>experimental [i.e., do <strong>not</strong> use it!] feature: No new lines for<br>blocks in HTML export.&emsp;Its need rose from developing the MARGIN<br>block type.<br><br><hr><br><br>The relationship between links and special blocks:<br><br>&emsp;[ [type:label][description]]<br>≈<br>&emsp; #+begin_type label<br>&emsp;&emsp;description<br>&emsp; #+end_type<br><br><hr><br><br>Example declaration, with all possible features shown:<br><br>&emsp; ;; We can use variable values when defining new blocks<br>&emsp; (setq angry-red ’(:foreground ''red'' :weight bold))<br><br>&emsp; (defblock remark<br>&emsp;&emsp; (editor ''Editor Remark'' :face angry-red) (color ''red'' signoff '''')<br>&emsp;&emsp; ''Top level (HTML & LaTeX)O-RESPECT-NEWLINES? editorial remarks; in Emacs they’re angry red.''<br>&emsp;&emsp; (format (if (equal backend ’html)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''<strong style=\''color: %s;\''>⟦%s:&emsp;%s%s⟧</strong>''<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''{\color{%s}\bfseries %s:&emsp;%s%s}'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; color editor contents signoff))<br><br>&emsp; ;; I don’t want to change the definition, but I’d like to have<br>&emsp; ;; the following as personalised defaults for the “remark” block.<br>&emsp; ;; OR, I’d like to set this for links, which do not have argument options.<br>&emsp; (defblock-header-args remark :main-arg ''Jasim Jameson'' :signoff ''( Aim for success! )'')<br><br>Three example uses:<br><br>&emsp;&emsp;;; ⟨0⟩ As a special blocks with arguments given.<br>&emsp;&emsp;#+begin_remark Bobbert Barakallah :signoff ''Thank-you for pointing this out!'' :color green<br>&emsp;&emsp;I was trying to explain that <em>{large (n × (n + 1) over 2}</em> is always an integer.<br>&emsp;&emsp;#+end_remark<br><br>&emsp;&emsp;;; ⟨1⟩ As a terse link, using default values for the args.<br>&emsp;&emsp;;;&emsp;&emsp; Notice that Org-mode formatting is recoqgnised even in links.<br>&emsp;&emsp;[ [remark:Jasim Jameson][Why are you taking about “<em>mathsf{even}</em>” here?]]<br><br>&emsp;&emsp;;; ⟨2⟩ So terse that no editor name is provided.<br>&emsp;&emsp;[ [remark:][Please improve your transition sentences.]]<br><br>&emsp;&emsp;;; ⟨★⟩ Unlike 0, examples 1 and 2 will have the default SIGNOFF<br>&emsp;&emsp;;; catenated as well as the default red color.<br><br>(fn NAME MAIN-ARG KWDS &optional EXPERIMENTAL DOCSTRING &rest BODY)">defblock</abbr> automatically provides an associated link type for the declared
special blocks.
</p>

<ul class="org-ul">
<li>Syntax: <code>[[remark:person_name][editorial remark]]</code>.</li>
<li>This link type exports the same as the <code>remark</code> block type;
however, in Emacs it is shown with an ‘angry’ &#x2014;bold&#x2014; red face.</li>
</ul>

<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Example: Terse remarks via links</h3>

<div style="column-rule-style: solid;column-count: 2;">
<p>
<code>[[edcomm:Jasim][Hello, where are you?]]</code>
</p>

<p>
<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Jasim:</strong></span> Hello, where are you?  <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
</p>

</div>
<hr />
<div style="column-rule-style: solid;column-count: 2;">
<p>
The <code>#+replacewith:</code> switch &#x2014;and usual Org markup&#x2014; also works with these
links:  <br> <code>[[remark:Qasim][/‘j’/ #+replacewith: /‘q’/]]</code>
</p>

<br>
<p>
<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Qasim:&nbsp;<u>Replace:</u></strong></span> <i>‘j’</i>  <span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>  <i>‘q’</i>  <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
</p>

</div>


</div>

<hr />

<p>
All editor comments, remarks, are disabled by declaring, in your Org file:
</p>
<pre class="example" id="org3503dc5">
#+bind: o-hide-editor-comments t
</pre>
<p>
The <code>#+bind:</code> keyword makes Emacs variables buffer-local during export
&#x2014;it is evaluated <i>after</i> any <code>src</code> blocks. To use it, one must declare in
their Emacs init file the following line, which our mode
ensures is true.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">org-export-allow-bind-keywords</span> <span style="color: #268bd2;">t</span>)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">( Remember to <code>C-c C-c</code> the <code>#+bind</code> to activate it, the first time it is written. )</td>
</tr>
</tbody>
</table>
</div>
</div>

<div id="outline-container-Folded-Details" class="outline-2">
<h2 id="Folded-Details"><span class="section-number-2">3</span> <a href="#Folded-Details">Folded Details &#x2014;As well as boxed text and subtle colours</a></h2>
<div class="outline-text-2" id="text-Folded-Details">
<div class="org-center">
<p>
<i>How did we fold away those implementations?</i>
</p>
</div>

<p>
Sometimes there is a remark or a code snippet that is useful to have, but not
relevant to the discussion at hand and so we want to <i>fold away such <abbr class="tooltip" title="Enclose contents in a folded up box, for HTML.<br><br>For LaTeX, this is just a boring, but centered, box.<br><br>By default, the TITLE of such blocks is “Details”<br>and its TITLE-COLOR is green.<br><br>In HTML, we show folded, details, regions with a nice greenish colour.<br><br>In the future ---i.e., when I have time---<br>it may be prudent to expose more aspects as arguments,<br>such as ‘background-color’.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (O-LINK\? nil) (TITLE-COLOR ''green''))">details</abbr></i>.
</p>

<ul class="org-ul">
<li>‘Conversation-style’ articles, where the author asks the reader questions
whose answers are “folded away” so the reader can think about the exercise
before seeing the answer.</li>

<li>Hiding boring but important code snippets, such as a list of import
declarations or a tedious implementation.</li>
</ul>

<div class="org-center">
<p>
Requires: <code class="src src-latex">,,#+latex_header:  <span style="color: #859900; font-weight: bold;">\usepackage</span>{<span style="color: #d33682; font-style: italic;">tcolorbox</span>}</code>
</p>
</div>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-defblock</span> details (title <span style="color: #2aa198;">"Details"</span>) (title-color <span style="color: #2aa198;">"green"</span>)
  <span style="color: #2aa198;">"Enclose contents in a folded up box, for HTML.</span>

<span style="color: #2aa198;">For LaTeX, this is just a boring, but centered, box.</span>

<span style="color: #2aa198;">By default, the TITLE of such blocks is &#8220;Details&#8221;</span>
<span style="color: #2aa198;">and its TITLE-COLOR is green.</span>

<span style="color: #2aa198;">In HTML, we show folded, details, regions with a nice greenish colour.</span>

<span style="color: #2aa198;">In the future ---i.e., when I have time---</span>
<span style="color: #2aa198;">it may be prudent to expose more aspects as arguments,</span>
<span style="color: #2aa198;">such as &#8216;</span><span style="color: #6c71c4; font-weight: bold;">background-color</span><span style="color: #2aa198;">&#8217;.</span>
<span style="color: #2aa198;">"</span>
  (<span style="color: #b58900;">format</span>
   (<span style="color: #859900; font-weight: bold;">pcase</span> backend
     (`latex <span style="color: #2aa198;">"\\begin{quote}</span>
<span style="color: #2aa198;">                  \\begin{tcolorbox}[colback=%s,title={%s},sharp corners,boxrule=0.4pt]</span>
<span style="color: #2aa198;">                    %s</span>
<span style="color: #2aa198;">                  \\end{tcolorbox}</span>
<span style="color: #2aa198;">                \\end{quote}"</span>)
     (_ <span style="color: #2aa198;">"&lt;details class=\"code-details\"</span>
<span style="color: #2aa198;">                 style =\"padding: 1em;</span>
<span style="color: #2aa198;">                          background-color: #e5f5e5;</span>
<span style="color: #2aa198;">                          /* background-color: pink; */</span>
<span style="color: #2aa198;">                          border-radius: 15px;</span>
<span style="color: #2aa198;">                          color: hsl(157 75% 20%);</span>
<span style="color: #2aa198;">                          font-size: 0.9em;</span>
<span style="color: #2aa198;">                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;\"&gt;</span>
<span style="color: #2aa198;">                  &lt;summary&gt;</span>
<span style="color: #2aa198;">                    &lt;strong&gt;</span>
<span style="color: #2aa198;">                      &lt;font face=\"Courier\" size=\"3\" color=\"%s\"&gt;</span>
<span style="color: #2aa198;">                         %s</span>
<span style="color: #2aa198;">                      &lt;/font&gt;</span>
<span style="color: #2aa198;">                    &lt;/strong&gt;</span>
<span style="color: #2aa198;">                  &lt;/summary&gt;</span>
<span style="color: #2aa198;">                  %s</span>
<span style="color: #2aa198;">               &lt;/details&gt;"</span>))
   title-color title contents))
</pre>
</div>

<p>
:HACK:Disabled:
Above is a lower-case ‘d’etails block, we now make a captial-case ‘D’etails
block, for the not-too-odd situation we want to have, right away, one details block
within another.
MA: TODO: The above should not be present, it should instead be factored out
into a defblock-alias function.
</p>
<p>
We could use
<code class="src src-latex"><span style="color: #859900; font-weight: bold;">\begin</span>{<span style="color: #b58900;">quote</span>}<span style="color: #859900; font-weight: bold;">\fbox</span>{<span style="color: #859900; font-weight: bold;">\parbox</span>{<span style="color: #859900; font-weight: bold;">\linewidth</span>}{<span style="color: #859900; font-weight: bold;">\textbf</span>{<span style="font-weight: bold;">Details:</span>} ...}}<span style="color: #859900; font-weight: bold;">\end</span>{<span style="color: #b58900;">quote</span>}</code>; however, this does not work well with <a href="https://github.com/alhassy/emacs.d#bibliography--coloured-latex-using-minted">minted</a> for coloured
source blocks. Instead, we use <code>tcolorbox</code>.
</p>

<p>
Let's have some sanity tests&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"The result is a &lt;details&gt; tag containing the user's title &amp; text."</span>
  [details]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"#+begin_details TITLE-RIGHT-HERE</span>
<span style="color: #2aa198;">          My aside...</span>
<span style="color: #2aa198;">          #+end_details"</span>)
     <span style="color: #2aa198;">"&lt;details"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"TITLE-RIGHT-HERE"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"My aside"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"&lt;/details&gt;"</span>))
</pre>
</div>


</details>

<p>
If you fear that your readers may not click on details boxes in the HTML export,
you could, say, have the details heading “flash pink” whenever the user hovers
over it. This can be accomplished by inserting the following incantation into
your Org file or place it into your <code>org-html-head</code> variable.
</p>
<pre class="example" id="orga5f8611">
#+html: &lt;style&gt;  summary:hover {background:pink;} &lt;/style&gt;
</pre>

<style>  summary:hover {background:pink;} </style>
</div>

<div id="outline-container-Example" class="outline-3">
<h3 id="Example"><span class="section-number-3">3.1</span> <a href="#Example">Example: <i>Here's a nifty puzzle, can you figure it out?</i></a></h3>
<div class="outline-text-3" id="text-Example">
<p>
Reductions &#x2014;incidentally also called ‘folds’<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>&#x2014; embody primitive
recursion and thus computability. For example, what does the following compute
when given a whole number 𝓃?
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #b58900;">-reduce</span> #'<span style="color: #b58900;">/</span> (<span style="color: #b58900;">number-sequence</span> 1.0 &#120003;))
</pre>
</div>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="pink">
                         Solution
                      </font>
                    </strong>
                  </summary>
<p>
Rather than guess-then-check, let's <i>calculate</i>!
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span style="color: #b58900;">-reduce</span> #'<span style="color: #b58900;">/</span> (<span style="color: #b58900;">number-sequence</span> 1.0 &#120003;))
<span style="color: #b58900;">=</span> <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Lisp is strict: Evaluate inner-most expression</span>
  (<span style="color: #b58900;">-reduce</span> #'<span style="color: #b58900;">/</span> '(1.0 2.0 3.0 &#8230; &#120003;))
<span style="color: #b58900;">=</span> <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Evaluate left-associating reduction</span>
  (<span style="color: #b58900;">/</span> (<span style="color: #b58900;">/</span> (<span style="color: #b58900;">/</span> 1.0 2.0) &#8943;) &#120003;)
<span style="color: #b58900;">=</span><span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Arithmetic: (/ (/ a b) c) = (* (/ a b) (/ 1 c)) = (/ a (* b c))</span>
  (<span style="color: #b58900;">/</span> 1.0 (<span style="color: #b58900;">*</span> 2.0 3.0 &#8230; &#120003;))
</pre>
</div>

<p>
We have thus found the above Lisp program to compute the inverse factorial of 𝓃;
i.e., \(\large \frac{1}{𝓃!}\).
</p>


</details>

<p>
Neato, let's do more super cool stuff ^_^
</p>

<div class="footnotesize" id="orge69eec7">
<p>
( In the Emacs Web Wowser, folded regions are displayed unfolded similar to
LaTeX. )
</p>

</div>
</div>
</div>
<div id="outline-container-Boxed-Text" class="outline-3">
<h3 id="Boxed-Text"><span class="section-number-3">3.2</span> <a href="#Boxed-Text">Boxed Text</a></h3>
<div class="outline-text-3" id="text-Boxed-Text">
<p>
Folded regions, as implemented above, are displayed in a super neat text box
which may be useful to enclose text to make it standout &#x2014;without having it
folded away. As such, we provide the special block <abbr class="tooltip" title="Enclose text in a box, possibly with a title.<br><br>By default, the box’s COLOR is green for HTML and red for LaTeX,<br>and it has no TITLE.<br><br>The HTML export uses a padded div, whereas the LaTeX export<br>requires the tcolorbox pacakge.<br><br>In the future, I will likely expose more arguments.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (O-LINK\? nil) (BACKGROUND-COLOR nil))">box</abbr> to enclosing text in
boxes.
</p>

<div class="org-center">
<p>
Requires: <code class="src src-latex">,#+latex_header:  <span style="color: #859900; font-weight: bold;">\usepackage</span>{<span style="color: #d33682; font-style: italic;">tcolorbox</span>}</code>
</p>
</div>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-defblock</span> box (title <span style="color: #2aa198;">""</span>) (background-color nil)
  <span style="color: #2aa198;">"Enclose text in a box, possibly with a title.</span>

<span style="color: #2aa198;">By default, the box's COLOR is green for HTML and red for LaTeX,</span>
<span style="color: #2aa198;">and it has no TITLE.</span>

<span style="color: #2aa198;">The HTML export uses a padded div, whereas the LaTeX export</span>
<span style="color: #2aa198;">requires the tcolorbox pacakge.</span>

<span style="color: #2aa198;">In the future, I will likely expose more arguments.</span>
<span style="color: #2aa198;">"</span>
  (<span style="color: #b58900;">apply</span> #'<span style="color: #b58900;">concat</span>
  (<span style="color: #859900; font-weight: bold;">pcase</span> backend
   (`latex `(<span style="color: #2aa198;">"\\begin{tcolorbox}[title={"</span> ,title <span style="color: #2aa198;">"}"</span>
             <span style="color: #2aa198;">",colback="</span> ,(<span style="color: #b58900;">pp-to-string</span> (<span style="color: #859900; font-weight: bold;">or</span> background-color 'red!5!white))
             <span style="color: #2aa198;">",colframe=red!75!black, colbacktitle=yellow!50!red"</span>
             <span style="color: #2aa198;">",coltitle=red!25!black, fonttitle=\\bfseries,"</span>
             <span style="color: #2aa198;">"subtitle style={boxrule=0.4pt, colback=yellow!50!red!25!white}]"</span>
             ,contents
             <span style="color: #2aa198;">"\\end{tcolorbox}"</span>))
    (_ `(<span style="color: #2aa198;">"&lt;div style=\"padding: 1em; background-color: "</span>
             ,(<span style="color: #b58900;">o-subtle-colors</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s"</span> (<span style="color: #859900; font-weight: bold;">or</span> background-color <span style="color: #2aa198;">"green"</span>)))
             <span style="color: #2aa198;">";border-radius: 15px; font-size: 0.9em"</span>
             <span style="color: #2aa198;">"; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;\"&gt;"</span>
             <span style="color: #2aa198;">"&lt;h3&gt;"</span> ,title <span style="color: #2aa198;">"&lt;/h3&gt;"</span>
            ,contents <span style="color: #2aa198;">"&lt;/div&gt;"</span>)))))
</pre>
</div>

<p>
Let's have some sanity tests&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"We have an HTML box enclosing the user's title (in &lt;h3) and text"</span>
  [box]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"#+begin_box Pay Attention!</span>
<span style="color: #2aa198;">                 This is the key insight...</span>
<span style="color: #2aa198;">                 #+end_box"</span>)
     <span style="color: #2aa198;">"&lt;div style=\"padding: 1em; background-color: #CCFFCC;border-radius: 15px;"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"&lt;h3&gt;Pay Attention!&lt;/h3&gt;"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"This is the key insight"</span>
     (<span style="color: #b58900;">*</span> anything)))
</pre>
</div>


</details>

<br>
<div style="padding: 1em; background-color: #CCFFFF;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Example: A super boring observation presented obscurely</h3>

<p>
If you start walking &#x2014;say, counterclockwise&#x2014; along the unit circle from its
right-most point and walk 180ᵒ, then you will be at its left-most point. That
is, \[ e^{i · \pi} \;=\; - 1 \]
</p>



</div>

<p>
<i>How did we get that nice light blue? What is its HTML code?</i>
That's not something I care to remember, so let's make a handy
dandy utility … Now when users request a colour to <code>box</code> their text,
it will be a ‘subtle colour’ ;-)
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation for Subtle Colours
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="linenr"> 1: </span>(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">o-subtle-colors</span> (c)
<span class="linenr"> 2: </span>  <span style="color: #35a69c; font-style: italic;">"HTML codes for common colours.</span>
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span><span style="color: #35a69c; font-style: italic;">Names are very rough approximates.</span>
<span class="linenr"> 5: </span>
<span class="linenr"> 6: </span><span style="color: #35a69c; font-style: italic;">   Translations from: https://www.december.com/html/spec/softhues.html"</span>
<span class="linenr"> 7: </span>  (<span style="color: #859900; font-weight: bold;">pcase</span> c
<span class="linenr"> 8: </span>    (<span style="color: #2aa198;">"teal"</span>    <span style="color: #2aa198;">"#99FFCC"</span>) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">close to aqua</span>
<span class="linenr"> 9: </span>    (<span style="color: #2aa198;">"brown"</span>   <span style="color: #2aa198;">"#CCCC99"</span>) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">close to moss</span>
<span class="linenr">10: </span>    (<span style="color: #2aa198;">"gray"</span>    <span style="color: #2aa198;">"#CCCCCC"</span>)
<span class="linenr">11: </span>    (<span style="color: #2aa198;">"purple"</span>  <span style="color: #2aa198;">"#CCCCFF"</span>)
<span class="linenr">12: </span>    (<span style="color: #2aa198;">"lime"</span>    <span style="color: #2aa198;">"#CCFF99"</span>) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">brighter than &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">green</span><span style="color: #96A7A9; font-style: italic;">&#8217;</span>
<span class="linenr">13: </span>    (<span style="color: #2aa198;">"green"</span>   <span style="color: #2aa198;">"#CCFFCC"</span>)
<span class="linenr">14: </span>    (<span style="color: #2aa198;">"blue"</span>    <span style="color: #2aa198;">"#CCFFFF"</span>)
<span class="linenr">15: </span>    (<span style="color: #2aa198;">"orange"</span>  <span style="color: #2aa198;">"#FFCC99"</span>)
<span class="linenr">16: </span>    (<span style="color: #2aa198;">"peach"</span>   <span style="color: #2aa198;">"#FFCCCC"</span>)
<span class="linenr">17: </span>    (<span style="color: #2aa198;">"pink"</span>    <span style="color: #2aa198;">"#FFCCFF"</span>)
<span class="linenr">18: </span>    (<span style="color: #2aa198;">"yellow"</span>  <span style="color: #2aa198;">"#FFFF99"</span>)
<span class="linenr">19: </span>    (<span style="color: #2aa198;">"custard"</span> <span style="color: #2aa198;">"#FFFFCC"</span>) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">paler than &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">yellow</span><span style="color: #96A7A9; font-style: italic;">&#8217;</span>
<span class="linenr">20: </span>    (c c)
<span class="linenr">21: </span>  ))
</pre>
</div>

<p>
To use these colour names, you will need the following incantations in your
Org file.
</p>

<div style="column-rule-style: none;column-count: 2;">
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>
<div ><pre class="src src-org">#+latex_header: \usepackage{xcolor}

#+latex_header: \definecolor{teal}    {HTML}{99FFCC}
#+latex_header: \definecolor{brown}   {HTML}{CCCC99}
#+latex_header: \definecolor{gray}    {HTML}{CCCCCC}
#+latex_header: \definecolor{purple}  {HTML}{CCCCFF}
#+latex_header: \definecolor{lime}    {HTML}{CCFF99}
#+latex_header: \definecolor{green}   {HTML}{CCFFCC}
#+latex_header: \definecolor{blue}    {HTML}{CCFFFF}
#+latex_header: \definecolor{orange}  {HTML}{FFCC99}
#+latex_header: \definecolor{peach}   {HTML}{FFCCCC}
#+latex_header: \definecolor{pink}{HTML}{FFCCFF}
#+latex_header: \definecolor{yellow}  {HTML}{FFFF99}
#+latex_header: \definecolor{custard}{HTML}{FFFFCC}

#+latex_header: \definecolor{cyan}{HTML}{00FFFF}
</pre></div>
</div>
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
</div>
</div>
<p>
In the future, it'd be nice to account for colours for LaTeX as well.  ( E.g.,
<code class="src src-latex"><span style="color: #859900; font-weight: bold;">\color</span>{blue}</code> is a nightmare. )
</p>


</details>

<p>
It may be useful to <i>fuse</i> the <code>box</code> and <code>details</code> concepts into one.  Something for
future me &#x2014;or another contributor&#x2014; to think about ;-)
</p>
</div>
</div>
</div>

<div id="outline-container-Parallel" class="outline-2">
<h2 id="Parallel"><span class="section-number-2">4</span> <a href="#Parallel">Parallel</a></h2>
<div class="outline-text-2" id="text-Parallel">
<p>
Articles can get lengthy when vertical whitespace is wasted on thin lines;
instead, one could save space by using <i><abbr class="tooltip" title="Place ideas side-by-side, possibly with a separator.<br><br>There are COLS many columns, and they may be seperated by black<br>solid vertical rules if BAR is a non-nil value.<br><br>Writing “#+begin_parallel 𝓃 :bar (any text except ‘nil’)”<br>will produce a parallel of 𝓃 many columns, possibly<br>seperated by solid rules, or a “bar”.<br><br>The contents of the block may contain ‘#+columnbreak:’ to request<br>a columnbreak. This has no effect on HTML export since HTML<br>describes how text should be formatted on a browser, which can<br>dynamically shrink and grow and thus it makes no sense to have<br>hard columnbreaks. We do replace such declarations by ‘<p><br>’,<br>which sometimes accomplishes the desired goal.<br><br>(fn BACKEND RAW-CONTENTS &optional COLS &rest ## &key (O-LINK\? nil) (BAR nil))">parallel</abbr> columns of text</i>.
</p>

<div class="org-center">
<p>
Requires: <code class="src src-latex">,#+latex_header:  <span style="color: #859900; font-weight: bold;">\usepackage</span>{<span style="color: #d33682; font-style: italic;">multicol</span>}</code>
</p>
</div>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="linenr"> 1: </span>(<span style="color: #859900; font-weight: bold;">o-defblock</span> parallel (cols 2) (bar nil)
<span class="linenr"> 2: </span>  <span style="color: #2aa198;">"Place ideas side-by-side, possibly with a separator.</span>
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span><span style="color: #2aa198;">There are COLS many columns, and they may be seperated by black</span>
<span class="linenr"> 5: </span><span style="color: #2aa198;">solid vertical rules if BAR is a non-nil value.</span>
<span class="linenr"> 6: </span>
<span class="linenr"> 7: </span><span style="color: #2aa198;">Writing &#8220;#+begin_parallel &#120003; :bar (any text except &#8216;</span><span style="color: #6c71c4; font-weight: bold;">nil</span><span style="color: #2aa198;">&#8217;)&#8221;</span>
<span class="linenr"> 8: </span><span style="color: #2aa198;">will produce a parallel of &#120003; many columns, possibly</span>
<span class="linenr"> 9: </span><span style="color: #2aa198;">seperated by solid rules, or a &#8220;bar&#8221;.</span>
<span class="linenr">10: </span>
<span class="linenr">11: </span><span style="color: #2aa198;">The contents of the block may contain &#8216;#+columnbreak:&#8217; to request</span>
<span class="linenr">12: </span><span style="color: #2aa198;">a columnbreak. This has no effect on HTML export since HTML</span>
<span class="linenr">13: </span><span style="color: #2aa198;">describes how text should be formatted on a browser, which can</span>
<span class="linenr">14: </span><span style="color: #2aa198;">dynamically shrink and grow and thus it makes no sense to have</span>
<span class="linenr">15: </span><span style="color: #2aa198;">hard columnbreaks. We do replace such declarations by &#8216;</span><span style="color: #6c71c4; font-weight: bold;">&lt;p&gt;&lt;br&gt;</span><span style="color: #2aa198;">&#8217;,</span>
<span class="linenr">16: </span><span style="color: #2aa198;">which sometimes accomplishes the desired goal.</span>
<span class="linenr">17: </span><span style="color: #2aa198;">"</span>
<span class="linenr">18: </span>  (<span style="color: #859900; font-weight: bold;">let</span> ((rule (<span style="color: #859900; font-weight: bold;">pcase</span> backend
<span class="linenr">19: </span>               (`latex (<span style="color: #859900; font-weight: bold;">if</span> bar 2 0))
<span class="linenr">20: </span>               (_  (<span style="color: #859900; font-weight: bold;">if</span> bar <span style="color: #2aa198;">"solid"</span> <span style="color: #2aa198;">"none"</span>))))
<span class="linenr">21: </span>        (contents&#8242;  (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"#+columnbreak:"</span>
<span class="linenr">22: </span>                               (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">equal</span> 'latex backend) <span style="color: #2aa198;">"\\columnbreak"</span> <span style="color: #2aa198;">"</span><span style="color: #b58900;">@@html</span><span style="color: #2aa198;">:&lt;p&gt;&lt;br&gt;@@"</span>)
<span class="linenr">23: </span>                               contents)))
<span class="linenr">24: </span>  (<span style="color: #b58900;">format</span> (<span style="color: #859900; font-weight: bold;">pcase</span> backend
<span class="linenr">25: </span>   (`latex <span style="color: #2aa198;">"\\par \\setlength{\\columnseprule}{%s pt}</span>
<span class="linenr">26: </span><span style="color: #2aa198;">          \\begin{minipage}[t]{\\linewidth}</span>
<span class="linenr">27: </span><span style="color: #2aa198;">          \\begin{multicols}{%s}</span>
<span class="linenr">28: </span><span style="color: #2aa198;">          %s</span>
<span class="linenr">29: </span><span style="color: #2aa198;">          \\end{multicols}\\end{minipage}"</span>)
<span class="linenr">30: </span>   (_ <span style="color: #2aa198;">"&lt;div style=\"column-rule-style: %s;column-count: %s;\"&gt;%s&lt;/div&gt;"</span>))
<span class="linenr">31: </span>   rule cols contents&#8242;)))
</pre>
</div>

<p>
Going forward, it would be desirable to have the columns take a specified percentage of
the available width &#x2014;whereas currently it splits it uniformly.  Such a feature
would be useful in cases where one column is wide and the others are not.
</p>

<p>
Let's have some sanity tests&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"Parallel blocks work as expected"</span>
  [parallel <span style="color: #b58900;">block</span>]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"#+begin_parallel 2 :bar yes-or-any-other-text</span>
<span style="color: #2aa198;">                  X</span>

<span style="color: #2aa198;">                  #+columnbreak:</span>

<span style="color: #2aa198;">                  Y</span>

<span style="color: #2aa198;">                  Z</span>
<span style="color: #2aa198;">                  #+end_parallel"</span>)

    <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The result is 2 columns with a solid rule between them</span>
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">and it contains the user's text along with the &#8220;#+columnbreak&#8221;.</span>

     <span style="color: #2aa198;">"&lt;div style=\"column-rule-style: solid;column-count: 2;\"&gt;"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"X"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"&lt;p&gt;&lt;br&gt;"</span> <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">&#8220;#+columnbreak&#8221; above</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"Y"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"Z"</span>
     (<span style="color: #b58900;">*</span> anything)))
</pre>
</div>


</details>

<br>
<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Example</h3>
<p>
<span class="underline">This</span>
</p>
<div class="org-src-container">
<pre class="src src-org">#+begin_parallel 2 :bar yes-or-any-other-text
X

#+columnbreak:

Y

Z
#+end_parallel
</pre>
</div>

<p>
<span class="underline">Yields</span>
</p>

<div style="column-rule-style: solid;column-count: 2;">
<p>
X
</p>

<p>
<p><br>
</p>

<p>
Y
</p>

<p>
Z
</p>

</div>

</div>

<div class="org-center">
<p>
( The <a href="https://www.gnu.org/software/emacs/manual/html_mono/eww.html">Emacs Web Wowser</a>, <code>M-x eww</code>, does not display <code>parallel</code> environments as
desired. )
</p>
</div>
</div>
</div>

<div id="outline-container-Colours" class="outline-2">
<h2 id="Colours"><span class="section-number-2">5</span> <a href="#Colours">Colours</a></h2>
<div class="outline-text-2" id="text-Colours">
<p>
Let's develop blocks for colouring text and link types for inline colouring;
e.g., <abbr class="tooltip" title="Format text according to a given COLOR, which is black by default.<br><br>(fn BACKEND RAW-CONTENTS &optional COLOR &rest ## &key (O-LINK\? nil))">color</abbr> and <abbr class="tooltip" title="Show text in teal color.<br><br>(fn BACKEND RAW-CONTENTS &optional THE-COLOR &rest ## &key (O-LINK\? nil))">teal</abbr>.
</p>
<ul class="org-ul">
<li>E.g., <code>[[brown: Hello, World!]]</code> ⇒ <span style="color:brown;"> Hello, World!</span></li>
<li>E.g., <code>brown:Friends!</code>
⇒ <span style="color:brown;">Friends</span>! ( Note the ‘!’ is not coloured; use <code>[[...]]</code> ! )</li>
</ul>

<div style="padding: 1em; background-color: #FFFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3></h3>
<p>
Use <kbd style="">M-x list-colors-display</kbd> to see a list of defined colour names in Emacs
  &#x2014;see <a href="http://muug.ca/mirror/ctan/macros/latex/contrib/xcolor/xcolor.pdf">xcolor</a> for the LaTeX side and <a href="https://htmlcolorcodes.com/color-names/">htmlcolorcodes.com</a> for the HTML side, or
  just visit <a href="http://latexcolor.com/">http://latexcolor.com/</a> for both.
</p>

</div>

<br>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         A Picture and Block Examples
                      </font>
                    </strong>
                  </summary>


<div id="orgc90e959" class="figure">
<p><img src="images/colours.jpg" alt="colours.jpg" />
</p>
</div>

<hr />

<div style="column-rule-style: none;column-count: 2;">
<span style="color:black;">
<p>
This text is black!
</p>

</span>

<span style="color:blue;">
<p>
This text is blue!
</p>

</span>

<span style="color:brown;">
<p>
This text is brown!
</p>

</span>

<span style="color:darkgray;">
<p>
This text is darkgray!
</p>

</span>

<span style="color:gray;">
<p>
This text is gray!
</p>

</span>

<span style="color:green;">
<p>
This text is green!
</p>

</span>

<span style="color:lightgray;">
<p>
This text is lightgray!
</p>

</span>

<span style="color:lime;">
<p>
This text is lime!
</p>

</span>

<span style="color:magenta;">
<p>
This text is magenta!
</p>

</span>

<span style="color:olive;">
<p>
This text is olive!
</p>

</span>

<span style="color:orange;">
<p>
This text is orange!
</p>

</span>

<span style="color:pink;">
<p>
This text is pink!
</p>

</span>

<span style="color:purple;">
<p>
This text is purple!
</p>

</span>

<span style="color:red;">
<p>
This text is red!
</p>

</span>

<span style="color:teal;">
<p>
This text is teal!
</p>

</span>

<span style="color:violet;">
<p>
This text is violet!
</p>

</span>

<span style="color:white;">
<p>
This text is white!
</p>

</span>

<span style="color:yellow;">
<p>
This text is yellow!
</p>

</span>


</div>



</details>

<br>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation of numerous colour blocks/links
                      </font>
                    </strong>
                  </summary>
<p>
We declare a list of colors that should be available on most systems.  Then
using this list, we evaluate the code necessary to produce the necessary
functions that format special blocks.
</p>

<p>
By default, Org uses the <code>graphicx</code> LaTeX package which let's us colour text
&#x2014;see its documentation <a href="http://ctan.mirror.rafal.ca/macros/latex/required/graphics/grfguide.pdf">here</a>.  For example, in an <code>#+begin_export latex</code> block,
the following produces blue coloured text.
</p>
<pre class="example" id="orgf6e5032">
{  \color{blue}  This is a sample text in blue.  }
</pre>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">o--colors</span>
  '(black blue brown cyan darkgray gray green lightgray lime
          magenta olive orange pink purple red teal violet white
          yellow)
  <span style="color: #35a69c; font-style: italic;">"Colours that should be available on all systems."</span>)

(<span style="color: #859900; font-weight: bold;">cl-loop</span> for colour in <span style="color: #268bd2;">o--colors</span>
         <span style="color: #b58900;">do</span> (<span style="color: #b58900;">eval</span> `(<span style="color: #859900; font-weight: bold;">o-defblock</span> ,colour
                     (the-color <span style="color: #2aa198;">"black"</span> <span style="color: #d33682; font-style: italic;">:face</span> `(<span style="color: #d33682; font-style: italic;">:foreground</span> ,(<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s"</span> (<span style="color: #859900; font-weight: bold;">quote</span> ,colour))))
                     nil
                     ,(<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"Show text in %s color."</span> colour)
                     (<span style="color: #859900; font-weight: bold;">let</span> ()
                       (<span style="color: #b58900;">format</span> (<span style="color: #859900; font-weight: bold;">pcase</span> backend
                                 (`latex <span style="color: #2aa198;">"\\begingroup\\color{%s}%s\\endgroup\\,"</span>)
                                 (_  <span style="color: #2aa198;">"&lt;span style=\"color:%s;\"&gt;%s&lt;/span&gt;"</span>))
                               (<span style="color: #859900; font-weight: bold;">quote</span> ,colour) contents)))))
</pre>
</div>

<p>
Let's have some sanity tests&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It is an HTML span styled red that contains the user's text"</span>
  [color red <span style="color: #b58900;">block</span>]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"#+begin_red</span>
<span style="color: #2aa198;">          My cool thoughts...</span>
<span style="color: #2aa198;">          #+end_red"</span>)
     <span style="color: #2aa198;">"&lt;span style=\"color:red;\"&gt;"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"My cool thoughts"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"&lt;/span&gt;"</span>))

<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">We have an HTML span styled with the user's color and it contains the user's text</span>
(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It works as expected"</span>
  [color pink <span style="color: #b58900;">block</span>]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"#+begin_color pink</span>
<span style="color: #2aa198;">          My cool thoughts...</span>
<span style="color: #2aa198;">          #+end_color"</span>)
     <span style="color: #2aa198;">"&lt;span style=\"color:pink;\"&gt;"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"My cool thoughts"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"&lt;/span&gt;"</span>))
</pre>
</div>


</details>


<br>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation of ‘color’
                      </font>
                    </strong>
                  </summary>
<p>
For faster experimentation between colours, we provide a generic <code>color</code> block
that consumes a color argument.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-defblock</span> color
  (color black <span style="color: #d33682; font-style: italic;">:face</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (colour) `(<span style="color: #d33682; font-style: italic;">:foreground</span> ,(<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s"</span> colour))))
  nil
  <span style="color: #2aa198;">"Format text according to a given COLOR, which is black by default."</span>
  (<span style="color: #b58900;">format</span> (<span style="color: #859900; font-weight: bold;">pcase</span> backend
            (`latex <span style="color: #2aa198;">"\\begingroup\\color{%s}%s\\endgroup\\,"</span>)
            (`html  <span style="color: #2aa198;">"&lt;span style=\"color:%s;\"&gt;%s&lt;/span&gt;"</span>))
          color contents))
</pre>
</div>

<p>
[Posterity] Old version which did <i>not</i> allow <code>wombo</code> colour:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-defblock</span> color (color black    <span style="color: #d33682; font-style: italic;">:face</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (colour)
           (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">member</span> (<span style="color: #b58900;">intern</span> colour) <span style="color: #268bd2;">o--colors</span>)
               `(<span style="color: #d33682; font-style: italic;">:foreground</span> ,(<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s"</span> colour))
             `(<span style="color: #d33682; font-style: italic;">:height</span> 300
               <span style="color: #d33682; font-style: italic;">:underline</span> (<span style="color: #d33682; font-style: italic;">:color</span> <span style="color: #2aa198;">"red"</span> <span style="color: #d33682; font-style: italic;">:style</span> wave)
               <span style="color: #d33682; font-style: italic;">:overline</span>  <span style="color: #2aa198;">"red"</span> <span style="color: #d33682; font-style: italic;">:strike-through</span> <span style="color: #2aa198;">"red"</span>)))) <span style="color: #b58900;">nil</span>
  <span style="color: #2aa198;">"Format text according to a given COLOR, which is black by default."</span>
  (<span style="color: #b58900;">format</span> (<span style="color: #859900; font-weight: bold;">pcase</span> backend
            (`latex <span style="color: #2aa198;">"\\begingroup\\color{%s}%s\\endgroup\\,"</span>)
            (`html  <span style="color: #2aa198;">"&lt;span style=\"color:%s;\"&gt;%s&lt;/span&gt;"</span>))
          color contents))
</pre>
</div>


</details>

<p>
Moreover, we have that the syntax <code>red:text</code> <i>renders</i> ‘text’ with the colour red
in <b>both</b> the Emacs interface and in exported backends.
</p>


<div id="org0b66881" class="figure">
<p><img src="images/colour_links.png" alt="colour_links.png" />
</p>
</div>

<div class="org-center">
<p>
Observe: <span style="color:red;">this</span> <span style="color:green;">is</span> <span style="color:cyan;">super</span> <span style="color:teal;">neato</span>, <span style="color:purple;">amigos</span>! and <span style="color:brown;">this is brown ‘color’ link</span> and <span style="color:orange;">this one is an orange ‘color’ link!</span>
</p>

<p>
<del>Also: If we try to use an unsupported colour ‘wombo’, we render the</del>
<del>descriptive text larger in Emacs along with a tooltip explaining why this is
the case; e.g., <code>[[color:wombo][hi]]</code>.</del>
</p>

<p>
<code>[[color:#fad][Using Hex colour code!]]</code> ⇒ <span style="color:#fad;">Using Hex colour code!</span>  ;-)
</p>
</div>

<p>
( Markdown does not support colour; go look at the HTML or PDF! )
</p>
</div>
<div id="outline-container-latex-definitions-for-hiding-LaTeX-declarations-in-HTML" class="outline-3">
<h3 id="latex-definitions-for-hiding-LaTeX-declarations-in-HTML"><span class="section-number-3">5.1</span> <a href="#latex-definitions-for-hiding-LaTeX-declarations-in-HTML">  <code>latex-definitions</code> for hiding LaTeX declarations in HTML</a></h3>
<div class="outline-text-3" id="text-latex-definitions-for-hiding-LaTeX-declarations-in-HTML">
<p>
Before indicating desirable next steps, let us produce an incidentally useful
special block type.
</p>

<p>
We may use LaTeX-style commands such as <code>{\color{red} x}</code> by enclosing them in
<code>$</code>-symbols to obtain \({\color{red}x}\) and other commands to present mathematical
formulae in HTML.  This is known as the MathJax tool &#x2014;Emacs' default HTML
export includes it.
</p>

<p>
It is common to declare LaTeX definitions for convenience, but such
declarations occur within <code>$</code>-delimiters and thereby produce undesirable extra
whitespace. We declare the <code>latex_definitions</code> block type which avoids
displaying such extra whitespace in the resulting HTML.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         ‘latex-definitions’ Implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-defblock</span> latex-definitions nil nil
  <span style="color: #2aa198;">"Declare but do not display the CONTENTS according to the BACKEND."</span>
  (<span style="color: #b58900;">format</span> (<span style="color: #859900; font-weight: bold;">pcase</span> backend
            ('html <span style="color: #2aa198;">"&lt;p style=\"display:none\"&gt;\\[</span><span style="color: #6c71c4; font-weight: bold;">%s\\</span><span style="color: #2aa198;">]&lt;/p&gt;"</span>)
            (_ <span style="color: #2aa198;">"%s"</span>))
          raw-contents))
</pre>
</div>


</details>

<p>
Here &#x2014;which you cannot see, as <i>desired</i>&#x2014;is an example usage, where we
declare <code>\LL</code> to produce a violet left parenthesis. We then use these to produce
an example of quantification notation.
</p>
<p style="display:none">\[ \def\LL{\color{violet}(}
 \def\RR{\color{violet})}
\]</p>

<p>
\[
  {\color{teal}\bigoplus}
  _{   {\color{violet} x}
     = {\color{red} a}}
  ^{\color{cyan} b}
     {\color{brown}{\,f\, x}}
  \quad=\quad
             {\color{brown}{f\,\LL  {\color{red} a} \RR}}
  \;{\color{teal}\oplus}\; {\color{brown}{f \, \LL a + 1 \RR }}
  \;{\color{teal}\oplus}\; {\color{brown}{f \, \LL a + 2 \RR }}
  \;{\color{teal}\oplus}\; \cdots
  \;{\color{teal}\oplus}\; {\color{brown}{f \, \LL {\color{cyan} b} \RR}}
  \]
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><span style="color:teal;">⊕</span></td>
<td class="org-left"><i>Loop sequentially with loop-bodies fused using <span style="color:teal;">⊕</span></i></td>
</tr>

<tr>
<td class="org-left"><i><span style="color:violet;">x</span></i></td>
<td class="org-left"><i>Use <span style="color:violet;">x</span> as the name of the current element</i></td>
</tr>

<tr>
<td class="org-left"><i><span style="color:red;">a</span></i></td>
<td class="org-left"><i>Start with <span style="color:violet;">x</span> being <span style="color:red;">a</span></i></td>
</tr>

<tr>
<td class="org-left"><i><span style="color:cyan;">b</span></i></td>
<td class="org-left"><i>End with <span style="color:violet;">x</span> being <span style="color:cyan;">b</span></i></td>
</tr>

<tr>
<td class="org-left"><i><span style="color:brown;">f x</span></i></td>
<td class="org-left"><i>At each <span style="color:violet;">x</span> value, compute <span style="color:brown;">f x</span></i></td>
</tr>
</tbody>
</table>

<p>
( Markdown does not support MathJax; go look at the HTML or PDF! )
</p>

<hr />

<p>
Unfortunately, MathJax does not easily support arbitrary HTML elements to occur
within the <code>$</code>-delimiters &#x2014;see <a href="https://stackoverflow.com/questions/58883048/mathjax-or-similar-render-arbitrary-html-element-inside-expression">this</a> and <a href="https://github.com/mathjax/MathJax/issues/1707">this</a> for ‘workarounds’.  As such, the
MathJax producing the above example is rather ugly whereas its subsequent
explanatory table is prettier on the writer's side.
</p>

<p>
<span style="color:orange;">Going forward,</span> it would be nice to easily have our colour links work within
a mathematical special block.
</p>

<p>
<span style="color:orange;">Moreover,</span> it would be nice to extend the <code>color</code> block type to take multiple
arguments, say, <code>c₁ c₂ … cₙ</code> such that:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right"><i>n</i></th>
<th scope="col" class="org-left">Behaviour</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-left">No colouring; likewise if no arguments altogether</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">Colour all entries using the given colour c₁</td>
</tr>

<tr>
<td class="org-right"><i>n</i></td>
<td class="org-left">Paragraph &#x2013;region separated by a new line&#x2013; <code>i</code> is coloured by <code>cₖ</code> where <code>k = i mod n</code></td>
</tr>
</tbody>
</table>

<p>
Besides having a colourful article, another usage I envision for this
generalisation would be when rendering text in multiple languages; e.g., use red
and blue to interleave Arabic poetry with its English translation.
</p>
</div>
</div>
</div>

<div id="outline-container-kbd:nice-keystroke-renditions" class="outline-2">
<h2 id="kbd:nice-keystroke-renditions"><span class="section-number-2">6</span> <a href="#kbd:nice-keystroke-renditions">Nice Keystroke Renditions: <abbr class="tooltip" style="border: none; text-decoration: none;" title="C-h h ∷ view-hello-file<br>Display the HELLO file, which lists many languages and characters."><kbd style="border-color: red">C-h h</kbd></abbr></a></h2>
<div class="outline-text-2" id="text-kbd:nice-keystroke-renditions">
<p>
Anyone who writes <i>about</i> Emacs will likely want to mention keystrokes in an
aesthetically pleasing way, such as <kbd style="">C-u 80 -</kbd> to insert 80 dashes,
or <kbd style="">C-c C-e h o</kbd> to export an Org-mode file to HTML,
or the useful <abbr class="tooltip" style="border: none; text-decoration: none;" title="M-s h . ∷ highlight-symbol-at-point<br>Highlight each instance of the symbol at point.<br>Uses the next face from ‘hi-lock-face-defaults’ without prompting,<br>unless you use a prefix argument.<br>Uses ‘find-tag-default-as-symbol-regexp’ to retrieve the symbol at point.<br><br>This uses Font lock mode if it is enabled; otherwise it uses overlays,<br>in which case the highlighting will not update as you type.&emsp;The Font<br>Lock mode is considered ''enabled'' in a buffer if its ‘major-mode’<br>causes ‘font-lock-specified-p’ to return non-nil, which means<br>the major mode specifies support for Font Lock."><kbd style="border-color: red">M-s h .</kbd></abbr>.
</p>

<ul class="org-ul">
<li><p>
<code>kbd:𝒳</code> will show a tooltip defining 𝒳, as an Emacs Lisp function, if possible.
For example, <code>kbd:C-h_h</code> is <abbr class="tooltip" style="border: none; text-decoration: none;" title="C-h h ∷ view-hello-file<br>Display the HELLO file, which lists many languages and characters."><kbd style="border-color: red">C-h h</kbd></abbr>; and likewise <code>&lt;kbd:M-s h .&gt;</code> is <abbr class="tooltip" style="border: none; text-decoration: none;" title="M-s h. ∷ highlight-symbol-at-point<br>Highlight each instance of the symbol at point.<br>Uses the next face from ‘hi-lock-face-defaults’ without prompting,<br>unless you use a prefix argument.<br>Uses ‘find-tag-default-as-symbol-regexp’ to retrieve the symbol at point.<br><br>This uses Font lock mode if it is enabled; otherwise it uses overlays,<br>in which case the highlighting will not update as you type.&emsp;The Font<br>Lock mode is considered ''enabled'' in a buffer if its ‘major-mode’<br>causes ‘font-lock-specified-p’ to return non-nil, which means<br>the major mode specifies support for Font Lock."><kbd style="border-color: red">M-s h.</kbd></abbr> (we need to use <code>&lt;...&gt;</code> since punctuation is not picked up as part of link
labels).  In contrast, <code>kbd:nope</code> renders as <kbd style="">nope</kbd> <i>without</i> a tooltip (nor a
red border).
</p>

<p>
You can also supply explicit tooltip description: <code>[[kbd:key
  sequence][description]]</code> will show as <abbr class="tooltip" style="border: none; text-decoration: none;" title="key sequence ∷ <br>description"><kbd style="border-color: red">key sequence</kbd></abbr>; i.e.,
the key sequence in nice key font along with a tooltip explaining it.
</p></li>
</ul>



<div id="org0783ac4" class="figure">
<p><img src="./images/kbd.png" alt="kbd.png" width="80%" height="80%s" />
</p>
</div>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation
                      </font>
                    </strong>
                  </summary>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-deflink</span> <span style="color: #b58900;">kbd</span>
  <span style="color: #2aa198;">"Show keysequence O-LABEL in a nice grey button-like font, along with a tooltip of its documentation, if any.</span>

<span style="color: #2aa198;">Such links do not get folded in [[bracket]] style, and are rendered as buttons within Emacs.</span>

<span style="color: #2aa198;">Moreover, O-LABEL may use &#8216;_&#8217; in-lieu of spaces or [[bracket]] link notation.</span>

<span style="color: #2aa198;">Examples:</span>
<span style="color: #2aa198;">    [[kbd:C-x C-s]]</span>
<span style="color: #2aa198;">  &#8776; &lt;kbd: C-x C-s&gt;</span>
<span style="color: #2aa198;">  &#8776; kbd:C-x_C-s"</span>
  [<span style="color: #d33682; font-style: italic;">:display</span> 'full
   <span style="color: #d33682; font-style: italic;">:let</span> (the-label  (<span style="color: #b58900;">s-trim</span> (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"_"</span> <span style="color: #2aa198;">" "</span> o-label))
         lisp-func  (<span style="color: #859900; font-weight: bold;">ignore-errors</span> (<span style="color: #b58900;">cl-second</span> (<span style="color: #b58900;">help--analyze-key</span> (<span style="color: #b58900;">kbd</span> the-label) the-label)))
         <span style="color: #556b72; background-color: #FDF6E3;">tooltip</span>    (<span style="color: #859900; font-weight: bold;">or</span> o-description (<span style="color: #859900; font-weight: bold;">ignore-errors</span> (<span style="color: #b58900;">documentation</span> lisp-func)) <span style="color: #2aa198;">""</span>)
         tooltip?   (<span style="color: #b58900;">not</span> (<span style="color: #b58900;">equal</span> <span style="color: #556b72; background-color: #FDF6E3;">tooltip</span> <span style="color: #2aa198;">""</span>))
         style      (<span style="color: #859900; font-weight: bold;">if</span> tooltip? <span style="color: #2aa198;">"border-color: red"</span> <span style="color: #2aa198;">""</span>)
         keystrokes (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;kbd style=\"%s\"&gt;%s&lt;/kbd&gt;"</span> style the-label))
   <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">o-description is always nil when it comes to deciding the :face.</span>
   <span style="color: #d33682; font-style: italic;">:face</span> (<span style="color: #b58900;">list</span> <span style="color: #d33682; font-style: italic;">:inherit</span> '<span style="color: #556b72; background-color: #FDF6E3;">custom-button</span> <span style="color: #d33682; font-style: italic;">:box</span> (<span style="color: #859900; font-weight: bold;">if</span> tooltip? <span style="color: #2aa198;">"red"</span> <span style="color: #268bd2;">t</span>))
   <span style="color: #d33682; font-style: italic;">:help-echo</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s &#8759; %s\n%s"</span> the-label (<span style="color: #859900; font-weight: bold;">or</span> lisp-func <span style="color: #2aa198;">""</span>) <span style="color: #556b72; background-color: #FDF6E3;">tooltip</span>)]
  (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">equal</span> o-backend 'latex)
      (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"\\texttt{%s}"</span> the-label)
    (<span style="color: #859900; font-weight: bold;">if</span> tooltip?
        <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The style=&#8943; is to remove the underlying caused by &lt;abbr&gt;.</span>
        (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;abbr class=\"tooltip\" style=\"border: none; text-decoration: none;\" title=\"%s &#8759; %s&lt;br&gt;%s\"&gt;%s&lt;/abbr&gt;"</span>
                the-label (<span style="color: #859900; font-weight: bold;">or</span> lisp-func <span style="color: #2aa198;">""</span>) (<span style="color: #b58900;">o-html-export-preserving-whitespace</span> <span style="color: #556b72; background-color: #FDF6E3;">tooltip</span>)
                keystrokes)
      keystrokes)))
</pre>
</div>

<p>
The following styling rule is used to make the keystrokes displayed nicely.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">o--kbd-html-setup</span> nil
  <span style="color: #35a69c; font-style: italic;">"Has the necessary keyboard styling HTML beeen added?"</span>)

(<span style="color: #859900; font-weight: bold;">unless</span> <span style="color: #268bd2;">o--kbd-html-setup</span>
  (<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">o--kbd-html-setup</span> <span style="color: #268bd2;">t</span>)
(<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">org-html-head-extra</span>
 (<span style="color: #b58900;">concat</span> <span style="color: #268bd2;">org-html-head-extra</span>
<span style="color: #2aa198;">"</span>
<span style="color: #2aa198;">&lt;style&gt;</span>
<span style="color: #2aa198;">/* From: https://endlessparentheses.com/public/css/endless.css */</span>
<span style="color: #2aa198;">/* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */</span>
<span style="color: #2aa198;">kbd</span>
<span style="color: #2aa198;">{</span>
<span style="color: #2aa198;">  -moz-border-radius: 6px;</span>
<span style="color: #2aa198;">  -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;</span>
<span style="color: #2aa198;">  -webkit-border-radius: 6px;</span>
<span style="color: #2aa198;">  -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;</span>
<span style="color: #2aa198;">  background-color: #f7f7f7;</span>
<span style="color: #2aa198;">  border: 1px solid #ccc;</span>
<span style="color: #2aa198;">  border-radius: 6px;</span>
<span style="color: #2aa198;">  box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;</span>
<span style="color: #2aa198;">  color: #333;</span>
<span style="color: #2aa198;">  display: inline-block;</span>
<span style="color: #2aa198;">  font-family: 'Droid Sans Mono', monospace;</span>
<span style="color: #2aa198;">  font-size: 80%;</span>
<span style="color: #2aa198;">  font-weight: normal;</span>
<span style="color: #2aa198;">  line-height: inherit;</span>
<span style="color: #2aa198;">  margin: 0 .1em;</span>
<span style="color: #2aa198;">  padding: .08em .4em;</span>
<span style="color: #2aa198;">  text-shadow: 0 1px 0 #fff;</span>
<span style="color: #2aa198;">  word-spacing: -4px;</span>

<span style="color: #2aa198;">  box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */</span>
<span style="color: #2aa198;">}</span>
<span style="color: #2aa198;">&lt;/style&gt;"</span>)))
</pre>
</div>

<p>
Let's have some sanity tests&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It becomes &lt;kbd&gt; tags, but final symbol non-ascii *may* be ignored"</span>
  [<span style="color: #b58900;">kbd</span> direct-org-links]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"kbd:C-u_80_-&#8704;"</span>) <span style="color: #2aa198;">"&lt;p&gt;\n&lt;kbd style=\"\"&gt;C-u 80&lt;/kbd&gt;_-&#8704;&lt;/p&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"[[It]] becomes &lt;kbd&gt; tags"</span>
  [<span style="color: #b58900;">kbd</span> square-org-links]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"[[kbd:C-u_80_-]]"</span>) <span style="color: #2aa198;">"&lt;p&gt;\n&lt;kbd style=\"\"&gt;C-u 80 -&lt;/kbd&gt;&lt;/p&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"&lt;It&gt; becomes &lt;kbd&gt; tags, and surrounding space is trimmed"</span>
  [<span style="color: #b58900;">kbd</span> angle-org-links]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"&lt;kbd: C-u 80 - &gt;"</span>)  <span style="color: #2aa198;">"&lt;p&gt;\n&lt;kbd style=\"\"&gt;C-u 80 -&lt;/kbd&gt;&lt;/p&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It has a tooltip documenting the underlying Lisp function, when possible"</span>
  [<span style="color: #b58900;">kbd</span> <span style="color: #556b72; background-color: #FDF6E3;">tooltip</span>]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"&lt;kbd: M-s h .&gt;"</span>)

     <span style="color: #2aa198;">"&lt;abbr class=\"tooltip\""</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"Highlight each instance of the symbol at point.&lt;br&gt;Uses the</span>
<span style="color: #2aa198;">     next face from &#8216;</span><span style="color: #6c71c4; font-weight: bold;">hi-lock-face-defaults</span><span style="color: #2aa198;">&#8217; without</span>
<span style="color: #2aa198;">     prompting,&lt;br&gt;unless you use a prefix argument.&lt;br&gt;Uses</span>
<span style="color: #2aa198;">     &#8216;</span><span style="color: #6c71c4; font-weight: bold;">find-tag-default-as-symbol-regexp</span><span style="color: #2aa198;">&#8217; to retrieve the symbol</span>
<span style="color: #2aa198;">     at point.&lt;br&gt;&lt;br&gt;This uses Font lock mode if it is enabled;</span>
<span style="color: #2aa198;">     otherwise it uses overlays,&lt;br&gt;in which case the</span>
<span style="color: #2aa198;">     highlighting will not update as you type.&amp;emsp;The</span>
<span style="color: #2aa198;">     Font&lt;br&gt;Lock mode is considered ''enabled'' in a buffer if</span>
<span style="color: #2aa198;">     its &#8216;</span><span style="color: #6c71c4; font-weight: bold;">major-mode</span><span style="color: #2aa198;">&#8217;&lt;br&gt;causes &#8216;</span><span style="color: #6c71c4; font-weight: bold;">font-lock-specified-p</span><span style="color: #2aa198;">&#8217; to return</span>
<span style="color: #2aa198;">     non-nil, which means&lt;br&gt;the major mode specifies support for</span>
<span style="color: #2aa198;">     Font Lock."</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"&lt;kbd style=\"border-color: red\"&gt;M-s h .&lt;/kbd&gt;&lt;/abbr&gt;"</span>))
</pre>
</div>



</details>
</div>
</div>
<div id="outline-container-Link-Here-OctoIcons" class="outline-2">
<h2 id="Link-Here-OctoIcons"><span class="section-number-2">7</span> <a href="#Link-Here-OctoIcons">  <i>“Link Here!”</i> &amp; OctoIcons</a></h2>
<div class="outline-text-2" id="text-Link-Here-OctoIcons">
<p>
Use the syntax <code>link-here:name</code> to create an anchor link that alters the URL with
<code>#name</code> as in “<a class="anchor" aria-hidden="true" id="name" href="#name"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16
   16" width="16" height="16"><path fill-rule="evenodd"
   d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69
   3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10
   5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0
   2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5
   0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55
   13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>”
&#x2014;it looks and behaves like the Github generated links for a heading.
Use case: Sometimes you want to explicitly point to a particular location in an
article, such as within a <code>#+begin_details</code> block, this is a possible way to do so.
</p>

<p>
Likewise, get OctoIcons with the syntax <code>octoicon:𝒳</code> where <code>𝒳</code> is one of <code>home,
link, mail, report, tag, clock</code>: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M16 9l-3-3V2h-2v2L8 1 0 9h2l1 5c0 .55.45 1 1 1h8c.55 0 1-.45 1-1l1-5h2zm-4 5H9v-4H7v4H4L2.81 7.69 8 2.5l5.19 5.19L12 14z"></path></svg>, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 16" width="14" height="16"><path fill-rule="evenodd" d="M0 4v8c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1H1c-.55 0-1 .45-1 1zm13 0L7 9 1 4h12zM1 5.5l4 3-4 3v-6zM2 12l3.5-3L7 10.5 8.5 9l3.5 3H2zm11-.5l-4-3 4-3v6z"></path></svg>,
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M0 2a1 1 0 011-1h14a1 1 0 011 1v9a1 1 0 01-1 1H7l-4 4v-4H1a1 1 0 01-1-1V2zm1 0h14v9H6.5L4 13.5V11H1V2zm6 6h2v2H7V8zm0-5h2v4H7V3z"></path></svg>, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 16" width="15" height="16"><path fill-rule="evenodd" d="M7.73 1.73C7.26 1.26 6.62 1 5.96 1H3.5C2.13 1 1 2.13 1 3.5v2.47c0 .66.27 1.3.73 1.77l6.06 6.06c.39.39 1.02.39 1.41 0l4.59-4.59a.996.996 0 000-1.41L7.73 1.73zM2.38 7.09c-.31-.3-.47-.7-.47-1.13V3.5c0-.88.72-1.59 1.59-1.59h2.47c.42 0 .83.16 1.13.47l6.14 6.13-4.73 4.73-6.13-6.15zM3.01 3h2v2H3V3h.01z"></path></svg>, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 16" width="14" height="16"><path fill-rule="evenodd" d="M8 8h3v2H7c-.55 0-1-.45-1-1V4h2v4zM7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 011.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7z"></path></svg>.
</p>

<ul class="org-ul">
<li>Within <code>octoicon:𝒳</code> and <code>link-here:𝒳</code> the label <code>𝒳</code> determines the
OctoIcon shown and the name of the local link to be created, respectively.
<ul class="org-ul">
<li>Descriptions, as in <code>[[link:label][description]]</code>, are ignored.</li>
</ul></li>
<li>Besides the HTML backend, such links are silently omitted.</li>
</ul>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Six OctoIcons and Implementation
                      </font>
                    </strong>
                  </summary>
<p>
The following SVGs are obtained from: <a href="https://primer.style/octicons/">https://primer.style/octicons/</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span>
 <span style="color: #268bd2;">o--supported-octoicons</span>
 (<span style="color: #b58900;">-partition</span> 2
 '(
   home
   <span style="color: #2aa198;">"&lt;svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16</span>
<span style="color: #2aa198;">   16\" width=\"16\" height=\"16\"&gt;&lt;path fill-rule=\"evenodd\"</span>
<span style="color: #2aa198;">   d=\"M16 9l-3-3V2h-2v2L8 1 0 9h2l1 5c0 .55.45 1 1 1h8c.55 0</span>
<span style="color: #2aa198;">   1-.45 1-1l1-5h2zm-4 5H9v-4H7v4H4L2.81 7.69 8 2.5l5.19 5.19L12</span>
<span style="color: #2aa198;">   14z\"&gt;&lt;/path&gt;&lt;/svg&gt;"</span>

   <span style="color: #556b72; background-color: #FDF6E3;">link</span>
   <span style="color: #2aa198;">"&lt;svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16</span>
<span style="color: #2aa198;">   16\" width=\"16\" height=\"16\"&gt;&lt;path fill-rule=\"evenodd\"</span>
<span style="color: #2aa198;">   d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69</span>
<span style="color: #2aa198;">   3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10</span>
<span style="color: #2aa198;">   5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0</span>
<span style="color: #2aa198;">   2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5</span>
<span style="color: #2aa198;">   0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55</span>
<span style="color: #2aa198;">   13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"&gt;&lt;/path&gt;&lt;/svg&gt;"</span>

   <span style="color: #b58900;">mail</span>
   <span style="color: #2aa198;">"&lt;svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 14</span>
<span style="color: #2aa198;">   16\" width=\"14\" height=\"16\"&gt;&lt;path fill-rule=\"evenodd\"</span>
<span style="color: #2aa198;">   d=\"M0 4v8c0 .55.45 1 1 1h12c.55 0 1-.45</span>
<span style="color: #2aa198;">   1-1V4c0-.55-.45-1-1-1H1c-.55 0-1 .45-1 1zm13 0L7 9 1 4h12zM1</span>
<span style="color: #2aa198;">   5.5l4 3-4 3v-6zM2 12l3.5-3L7 10.5 8.5 9l3.5 3H2zm11-.5l-4-3</span>
<span style="color: #2aa198;">   4-3v6z\"&gt;&lt;/path&gt;&lt;/svg&gt;"</span>

   report
   <span style="color: #2aa198;">"&lt;svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16</span>
<span style="color: #2aa198;">   16\" width=\"16\" height=\"16\"&gt;&lt;path fill-rule=\"evenodd\"</span>
<span style="color: #2aa198;">   d=\"M0 2a1 1 0 011-1h14a1 1 0 011 1v9a1 1 0 01-1 1H7l-4</span>
<span style="color: #2aa198;">   4v-4H1a1 1 0 01-1-1V2zm1 0h14v9H6.5L4 13.5V11H1V2zm6</span>
<span style="color: #2aa198;">   6h2v2H7V8zm0-5h2v4H7V3z\"&gt;&lt;/path&gt;&lt;/svg&gt;"</span>

   tag
   <span style="color: #2aa198;">"&lt;svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 15</span>
<span style="color: #2aa198;">   16\" width=\"15\" height=\"16\"&gt;&lt;path fill-rule=\"evenodd\"</span>
<span style="color: #2aa198;">   d=\"M7.73 1.73C7.26 1.26 6.62 1 5.96 1H3.5C2.13 1 1 2.13 1</span>
<span style="color: #2aa198;">   3.5v2.47c0 .66.27 1.3.73 1.77l6.06 6.06c.39.39 1.02.39 1.41</span>
<span style="color: #2aa198;">   0l4.59-4.59a.996.996 0 000-1.41L7.73 1.73zM2.38</span>
<span style="color: #2aa198;">   7.09c-.31-.3-.47-.7-.47-1.13V3.5c0-.88.72-1.59</span>
<span style="color: #2aa198;">   1.59-1.59h2.47c.42 0 .83.16 1.13.47l6.14 6.13-4.73</span>
<span style="color: #2aa198;">   4.73-6.13-6.15zM3.01 3h2v2H3V3h.01z\"&gt;&lt;/path&gt;&lt;/svg&gt;"</span>

   clock
   <span style="color: #2aa198;">"&lt;svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 14</span>
<span style="color: #2aa198;">   16\" width=\"14\" height=\"16\"&gt;&lt;path fill-rule=\"evenodd\"</span>
<span style="color: #2aa198;">   d=\"M8 8h3v2H7c-.55 0-1-.45-1-1V4h2v4zM7 2.3c3.14 0 5.7 2.56</span>
<span style="color: #2aa198;">   5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 011.3 8c0-3.14 2.56-5.7</span>
<span style="color: #2aa198;">   5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14</span>
<span style="color: #2aa198;">   7-7-3.14-7-7-7z\"&gt;&lt;/path&gt;&lt;/svg&gt;"</span>))

<span style="color: #35a69c; font-style: italic;">"An association list of supported OctoIcons.</span>

<span style="color: #35a69c; font-style: italic;">Usage: (cadr (assoc 'ICON o--supported-octoicons))"</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-deflink</span> octoicon
  <span style="color: #2aa198;">"Show an OctoIcon: home, link, mail, report, tag, clock"</span>
  [<span style="color: #d33682; font-style: italic;">:help-echo</span> <span style="color: #2aa198;">"Show an OctoIcon: home, link, mail, report, tag, clock"</span>]
  (<span style="color: #859900; font-weight: bold;">unless</span> (<span style="color: #b58900;">member</span> (<span style="color: #b58900;">intern</span> o-label) '(home <span style="color: #556b72; background-color: #FDF6E3;">link</span> <span style="color: #b58900;">mail</span> report tag clock))
    (<span style="color: #b58900;">error</span> <span style="color: #2aa198;">"octoicon:%s &#8658; This label is not supported!"</span> o-label))
  (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">not</span> (<span style="color: #b58900;">equal</span> o-backend 'html))
      <span style="color: #2aa198;">""</span>
    (<span style="color: #b58900;">s-collapse-whitespace</span>
     (<span style="color: #b58900;">cadr</span> (<span style="color: #b58900;">assoc</span> (<span style="color: #b58900;">intern</span> o-label)
                  <span style="color: #268bd2;">o--supported-octoicons</span>)))))

(<span style="color: #859900; font-weight: bold;">o-deflink</span> link-here
  <span style="color: #2aa198;">"Export a link to the current location in an Org file."</span>
  [<span style="color: #d33682; font-style: italic;">:help-echo</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"This is a local anchor link named &#8220;%s&#8221;"</span> path)]
  (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">not</span> (<span style="color: #b58900;">equal</span> o-backend 'html))
      <span style="color: #2aa198;">""</span>
    (<span style="color: #b58900;">format</span> (<span style="color: #b58900;">s-collapse-whitespace</span>
     <span style="color: #2aa198;">"&lt;a class=\"anchor\" aria-hidden=\"true\" id=\"%s\"</span>
<span style="color: #2aa198;">          href=\"#%s\"&gt;%s&lt;/a&gt;"</span>)
    o-label o-label (<span style="color: #b58900;">cadr</span> (<span style="color: #b58900;">assoc</span> '<span style="color: #556b72; background-color: #FDF6E3;">link</span>
                             <span style="color: #268bd2;">o--supported-octoicons</span>)))))
</pre>
</div>


<p>
Going forward, it would be desirable to provide a non-whitespace alternative for
the LaTeX rendition.  More usefully, before the HTML export hook, we could place
such ‘link-here’ links before every org-title produce clickable org-headings,
similar to Github's &#x2014;the necessary ingredients are likely <a href="https://github.com/alhassy/emacs.d#ensuring-useful-html-anchors">here</a>.
</p>

<p>
Moreover, it may be useful to have <code>octoicon:𝒳|url</code> so the resulting
OctoIcon is optionally a link to the given <code>url</code>. Another direction
would be to support more, if not all, the possible OctoIcons.
</p>



</details>

<br>
<div style="column-rule-style: none;column-count: 2;">
<div style="padding: 1em; background-color: #FFFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>
<div ><pre class="src src-org">link-here:example-location (Click the icon and see the URL has changed!)
</pre></div>
</div>
<div style="padding: 1em; background-color: #FFFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
<p>
<a class="anchor" aria-hidden="true" id="example-location" href="#example-location"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16
   16" width="16" height="16"><path fill-rule="evenodd"
   d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69
   3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10
   5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0
   2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5
   0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55
   13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> (Click the icon and see the URL has changed!)
</p>

</div>
</div>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Tests
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It works as expected: We have an anchor with the given ID, and the default SVG chain icon."</span>
  [link:here]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"link-here:example-location (Click the icon and see the URL has changed!)"</span>)
     <span style="color: #2aa198;">"&lt;a class=\"anchor\" aria-hidden=\"true\" id=\"example-location\" href=\"#example-location\"&gt;&lt;svg"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"&lt;/svg&gt;&lt;/a&gt; (Click the icon and see the URL has changed!)"</span>
     (<span style="color: #b58900;">*</span> anything)))
</pre>
</div>


</details>
</div>
</div>

<div id="outline-container-Badge-Links" class="outline-2">
<h2 id="Badge-Links"><span class="section-number-2">8</span> <a href="#Badge-Links">Badge Links</a></h2>
<div class="outline-text-2" id="text-Badge-Links">
<p>
Badges provide a quick and colourful summary of key features of a project,
such as whether it's maintained, its license, and if it's documented.
</p>


<div id="orgb4f66d4" class="figure">
<p><img src="images/badges.png" alt="badges.png" />
</p>
<p><span class="figure-number">Figure 7: </span>An Emacs interface to <a href="https://shields.io/">https://shields.io/</a></p>
</div>

<blockquote>
<p>
As people who are passionate about writing great code we display "badges" in our
code repositories to signal to fellow developers that we set ourselves high
standards for the code we write, think of them as the software-equivalent of
the brand on your jeans or other reliable product. &#x2014; <a href="https://github.com/dwyl/repo-badges">repo-badges</a>
</p>
</blockquote>

<div style="column-rule-style: none;column-count: 2;">
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>
<div ><pre class="src src-org">What are badges?

badge:Let_me_google_that|for_you!|orange|https://lmgtfy.app/?q=badge+shields.io&iie=1|Elixir

or

[[badge: Let me google that | for you! |orange|
         https://lmgtfy.app/?q=badge+shields.io&iie=1 |Elixir]]

or

badge:Let_me_*not*_google_that|for_you
</pre></div>
</div>
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
<p>
What are badges?
</p>

<p>
<a href="https://lmgtfy.app/?q=badge+shields.io&iie=1"><img src="https://img.shields.io/badge/Let_me_google_that-for_you%21-orange?logo=Elixir"></a>
</p>

<p>
or
</p>

<p>
<a href="https://lmgtfy.app/?q=badge+shields.io&iie=1"><img src="https://img.shields.io/badge/Let%20me%20google%20that-for%20you%21-orange?logo=Elixir"></a>
</p>

<p>
or
</p>

<p>
<img src="https://img.shields.io/badge/Let_me_%2Anot%2A_google_that-for_you-nil?logo=nil">
</p>

</div>
</div>
<p>
Notice that the <span style="color:orange;">orange</span> badge points to a URL and so is clickable, whereas
the <span style="color:green;">green</span> one does not point to a URL and so is not clickable.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Automated Tests
                      </font>
                    </strong>
                  </summary>
<p>
Let's have some sanity tests&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It works when all 5 arguments are provided"</span>
  [badge]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"badge:Let_me_google_that|for_you!|orange|https://lmgtfy.app/?q=badge+shields.io&amp;iie=1|Elixir"</span>)
     <span style="color: #2aa198;">"&lt;a href=\"https://lmgtfy.app/?q=badge+shields.io&amp;iie=1\"&gt;"</span>
     <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/badge/Let_me_google_that-for_you%21-orange?logo=Elixir\"&gt;&lt;/a&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It works when we use [[link]] syntax with generous spaces and newlines"</span>
  [badge]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"[[badge: Let me google that | for you! | orange |</span>
<span style="color: #2aa198;">         https://lmgtfy.app/?q=badge+shields.io&amp;iie=1|Elixir]]"</span>)

     <span style="color: #2aa198;">"&lt;a href=\"https://lmgtfy.app/?q=badge+shields.io&amp;iie=1\"&gt;"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/badge/Let%20me%20google%20that-for%20you%21-orange?logo=Elixir\"&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It works when only the first 2 arguments are provided; asterisks are passed unaltered into the first argument"</span>
  [badge]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"badge:Let_me_*not*_google_that|for_you"</span>)
     <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/badge/Let_me_%2Anot%2A_google_that-for_you-nil?logo=nil\"&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It works when all 5 arguments are provided - URL &#8216;</span><span style="color: #6c71c4; font-weight: bold;">here</span><span style="color: #2aa198;">&#8217; makes it a local link"</span>
  [badge]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"badge:key|value|informational|here|Elixir"</span>)
     <span style="color: #2aa198;">"&lt;a id=\"key\" href=\"#key\"&gt;"</span>
     <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/badge/key-value-informational?logo=Elixir\"&gt;&lt;/a&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"We can use spaces, commas, dashes, and percentage symbols in the first argument"</span>
  [badge]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"badge:example_with_spaces,_-,_and_%|points_right_here|orange|here"</span>)
     <span style="color: #2aa198;">"&lt;a id=\"example_with_spaces,_-,_and_%\" href=\"#example_with_spaces,_-,_and_%\"&gt;"</span>
     <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/badge/example_with_spaces%2C_--%2C_and_%25-points_right_here-orange?logo=nil\"&gt;&lt;/a&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It works when only first 2 arguments are given: Default colour &amp; logo are green &amp; no logo shown"</span>
  [badge]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"badge:key|value"</span>)
     <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/badge/key-value-nil?logo=nil\"&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"When only a key is provided, the value slot is shown as an empty green stub"</span>
  [badge]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"badge:key"</span>)
     <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/badge/key--nil?logo=nil\"&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"When only a value is provided, only the value is shown in a default green ---no stub for the missing key, yay"</span>
  [badge]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"badge:|value"</span>)
        <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/badge/-value-nil?logo=nil\"&gt;"</span>))


(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It's only a green stub when provided with an empty key and empty value"</span>
  [badge]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"badge:||green"</span>)
     <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/badge/--green?logo=nil\"&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It's only a green stub when we use a totally [[badge:]]"</span>
  [badge]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"[[badge:]]"</span>)
     <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/badge/--nil?logo=nil\"&gt;"</span>))
</pre>
</div>


</details>
</div>

<div id="outline-container-Example-Badges" class="outline-3">
<h3 id="Example-Badges"><span class="section-number-3">8.1</span> <a href="#Example-Badges">Example Badges</a></h3>
<div class="outline-text-3" id="text-Example-Badges">
<p>
The general syntax is as follows, with <b>only the first 2</b> are mandatory,
with the colour defaulting to green, and the url and logo both to nil.
We can thus have <code>badge:label|message</code>
</p>
<ul class="org-ul">
<li><a id="key" href="#key"><img src="https://img.shields.io/badge/key-value-informational?logo=Elixir"></a>
⇐ <code>badge:key|value|informational|here|Elixir</code>
<ul class="org-ul">
<li>Standard template; with URL pointing to current location which is named <code>#key</code>
&#x2014;click on it and look at your browser's URL ;-)</li>
</ul></li>

<li><a id="example_with_spaces,_-,_and_%" href="#example_with_spaces,_-,_and_%"><img src="https://img.shields.io/badge/example_with_spaces%2C_--%2C_and_%25-points_right_here-orange?logo=nil"></a>
⇐ <code>badge:example_with_spaces,_-,_and_%|points_right_here|orange|here</code></li>

<li><img src="https://img.shields.io/badge/no_colour-given-nil?logo=nil">
⇐ <code>badge:key|value</code>.</li>

<li><img src="https://img.shields.io/badge/empty_value--informational?logo=nil">
⇐ <code>badge:empty_value||informational</code></li>

<li><img src="https://img.shields.io/badge/-value-nil?logo=nil">
⇐ <code>badge:|value</code></li>

<li><p>
<img src="https://img.shields.io/badge/--green?logo=nil"> ⇐ <code>badge:||green</code> ( No key; nor value! )
</p>

<p>
Also: <img src="https://img.shields.io/badge/--nil?logo=nil">
⇐ <code>[[badge:]]</code>.
</p></li>
</ul>
<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>General Syntax</h3>
<pre class="example" id="org17f6514">
badge:your_key|its_neato_value|some_url|a_logo_as_shown_below

[[badge: your key | its neato value | some url | a logo as shown below]]

reddit-subscribe-to:exact-name-of-a-subreddit

github-stars:user-name/repository-name

github-watchers:user-name/repository-name

github-forks:user-name/repository-name

github-followers:user-name

twitter-follow:user-name

tweet:url
</pre>

<p>
For now, only <code>badge:</code> badges redirect to their URL, if any, upon a user's click.
Within Emacs, hovering over a badge displays a tooltip indicating which values
corresponds to which badge fields.
</p>

<p>
You can make your <i>own</i> badge types with
<abbr class="tooltip" title="Make a link NAME whose export is presented as an SVG badge.<br><br>If the link is intend to be a social badge, then, adhering to<br>shield.io conventions, the appropriate SOCIAL-SHIELDS-NAME must<br>be given.<br><br>The SOCIAL-URL is a URL that the badge points to and it should<br>have a single ‘%s’ where the link label argument will go.<br><br>Some social badges have a uniform URL, but otherwise, such as<br>twitter, deviate and so need their own SOCIAL-SHIELDS-URL,<br>which has a single ‘%s’ for the link’s label argument.<br><br><hr><br><br>E.g., to create a badge named “go”:<br><br>&emsp;&emsp; (o-make-badge ''go'')<br><br>Then the following exports nicely from an Org file:<br><br>&emsp;&emsp; go:key|value|blue|here|gnu-emacs">o-make-badge</abbr>.
</p>

</div>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         o-make-badge
                      </font>
                    </strong>
                  </summary>
<p>
The implementation is a bit lengthy since it attempts to capture a useful
portion of the shilelds.io badge interface.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">cl-defmacro</span> <span style="color: #b58900;">o-make-badge</span>
  (name <span style="color: #b58900; font-style: italic;">&amp;optional</span> social-shields-name social-url social-shields-url )
  <span style="color: #35a69c; font-style: italic;">"Make a link NAME whose export is presented as an SVG badge.</span>

<span style="color: #35a69c; font-style: italic;">If the link is intend to be a social badge, then, adhering to</span>
<span style="color: #35a69c; font-style: italic;">shield.io conventions, the appropriate SOCIAL-SHIELDS-NAME must</span>
<span style="color: #35a69c; font-style: italic;">be given.</span>

<span style="color: #35a69c; font-style: italic;">The SOCIAL-URL is a URL that the badge points to and it should</span>
<span style="color: #35a69c; font-style: italic;">have a single &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">%s</span><span style="color: #35a69c; font-style: italic;">&#8217; where the link label argument will go.</span>

<span style="color: #35a69c; font-style: italic;">Some social badges have a uniform URL, but otherwise, such as</span>
<span style="color: #35a69c; font-style: italic;">twitter, deviate and so need their own SOCIAL-SHIELDS-URL,</span>
<span style="color: #35a69c; font-style: italic;">which has a single &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">%s</span><span style="color: #35a69c; font-style: italic;">&#8217; for the link's label argument.</span>

<span style="color: #35a69c; font-style: italic;">----------------------------------------------------------------------</span>

<span style="color: #35a69c; font-style: italic;">E.g., to create a badge named &#8220;go&#8221;:</span>

<span style="color: #35a69c; font-style: italic;">     (o-make-badge \"go\")</span>

<span style="color: #35a69c; font-style: italic;">Then the following exports nicely from an Org file:</span>

<span style="color: #35a69c; font-style: italic;">     go:key|value|blue|here|gnu-emacs"</span>
  `(<span style="color: #859900; font-weight: bold;">o-deflink</span> ,(<span style="color: #b58900;">intern</span> name)
    <span style="color: #2aa198;">"Export a Shields.io badge, with general Syntax:  badge:key|value|colour|url|logo.</span>
<span style="color: #2aa198;">Precise details for each argument are shown in the Emacs tooltip for this badge."</span>
    [<span style="color: #d33682; font-style: italic;">:display</span> 'full
     <span style="color: #d33682; font-style: italic;">:follow</span> (<span style="color: #859900; font-weight: bold;">--&gt;</span> (<span style="color: #b58900;">s-split</span> <span style="color: #2aa198;">"|"</span> path)
               (<span style="color: #859900; font-weight: bold;">or</span> (<span style="color: #b58900;">nth</span> 3 it) o-label)
               (<span style="color: #b58900;">browse-url</span> it))
    <span style="color: #d33682; font-style: italic;">:help-echo</span>
      (<span style="color: #859900; font-weight: bold;">-let</span> [ (key value color url logo)  (<span style="color: #b58900;">mapcar</span> #'<span style="color: #b58900;">s-trim</span> (<span style="color: #b58900;">s-split</span> <span style="color: #2aa198;">"|"</span> o-label)) ]
        (<span style="color: #b58900;">lf-string</span> <span style="color: #2aa198;">"${o-label}</span>
<span style="color: #2aa198;">                    \nGeneral Syntax:  badge:key|value|colour|url|logo</span>
<span style="color: #2aa198;">                           Key    : ${key}</span>
<span style="color: #2aa198;">                           Value  : ${(or value \"\")}</span>
<span style="color: #2aa198;">                           Colour : ${(or color \"green\")}</span>
<span style="color: #2aa198;">                           URL    : ${(or url \"\")}</span>
<span style="color: #2aa198;">                           Logo   : ${(or logo \"\")}</span>

<span style="color: #2aa198;">                    This results in an SVG badge &#8220;[key&#8739;value]&#8221;, where the &#8216;</span><span style="color: #6c71c4; font-weight: bold;">key</span><span style="color: #2aa198;">&#8217;</span>
<span style="color: #2aa198;">                    is coloured grey and the &#8216;</span><span style="color: #6c71c4; font-weight: bold;">value</span><span style="color: #2aa198;">&#8217; is coloured &#8216;</span><span style="color: #6c71c4; font-weight: bold;">color</span><span style="color: #2aa198;">&#8217;;</span>
<span style="color: #2aa198;">                    for the HTML backend, and otherwise are silently omitted.</span>
<span style="color: #2aa198;">                    Descriptions are ignored; i.e., &#8216;[[badge:label][description]]&#8217;</span>
<span style="color: #2aa198;">                    is the same as &#8216;[[badge:label]]&#8217;.</span>

<span style="color: #2aa198;">                    &#9658; &#8216;</span><span style="color: #6c71c4; font-weight: bold;">key</span><span style="color: #2aa198;">&#8217; and &#8216;</span><span style="color: #6c71c4; font-weight: bold;">value</span><span style="color: #2aa198;">&#8217; have their underscores interpreted as spaces.</span>
<span style="color: #2aa198;">                       &#8658; &#8216;</span><span style="color: #6c71c4; font-weight: bold;">__</span><span style="color: #2aa198;">&#8217; is interpreted as an underscore;</span>
<span style="color: #2aa198;">                         Of course, you can write &#8216;&lt;badge: &#8943;&gt;&#8217;, then &#8216;&#8943;&#8217; may have multiword, spaced, content.</span>
<span style="color: #2aa198;">                       &#8658; &#8216;|&#8217; is not a valid substring, but &#8216;-, %, ?&#8217; are okay.</span>

<span style="color: #2aa198;">                    &#9658; &#8216;</span><span style="color: #6c71c4; font-weight: bold;">|color|url|logo</span><span style="color: #2aa198;">&#8217; are optional;</span>
<span style="color: #2aa198;">                       &#8658; If &#8216;</span><span style="color: #6c71c4; font-weight: bold;">url</span><span style="color: #2aa198;">&#8217; is not present, the resulting badge is not a hyperlink.</span>
<span style="color: #2aa198;">                       &#8658; if &#8216;</span><span style="color: #6c71c4; font-weight: bold;">url</span><span style="color: #2aa198;">&#8217; is &#8216;</span><span style="color: #6c71c4; font-weight: bold;">here</span><span style="color: #2aa198;">&#8217; then we have a local link;</span>
<span style="color: #2aa198;">                          i.e., the resulting badge behaves like &#8216;</span><span style="color: #6c71c4; font-weight: bold;">link-here:key</span><span style="color: #2aa198;">&#8217;.</span>
<span style="color: #2aa198;">                       &#8658; &#8216;</span><span style="color: #6c71c4; font-weight: bold;">color</span><span style="color: #2aa198;">&#8217; may be: &#8216;</span><span style="color: #6c71c4; font-weight: bold;">brightgreen</span><span style="color: #2aa198;">&#8217; or &#8216;</span><span style="color: #6c71c4; font-weight: bold;">success</span><span style="color: #2aa198;">&#8217;,</span>
<span style="color: #2aa198;">                                         &#8216;</span><span style="color: #6c71c4; font-weight: bold;">red</span><span style="color: #2aa198;">&#8217;         or &#8216;</span><span style="color: #6c71c4; font-weight: bold;">important</span><span style="color: #2aa198;">&#8217;,</span>
<span style="color: #2aa198;">                                         &#8216;</span><span style="color: #6c71c4; font-weight: bold;">orange</span><span style="color: #2aa198;">&#8217;      or &#8216;</span><span style="color: #6c71c4; font-weight: bold;">critical</span><span style="color: #2aa198;">&#8217;,</span>
<span style="color: #2aa198;">                                         &#8216;</span><span style="color: #6c71c4; font-weight: bold;">lightgrey</span><span style="color: #2aa198;">&#8217;   or &#8216;</span><span style="color: #6c71c4; font-weight: bold;">inactive</span><span style="color: #2aa198;">&#8217;,</span>
<span style="color: #2aa198;">                                         &#8216;</span><span style="color: #6c71c4; font-weight: bold;">blue</span><span style="color: #2aa198;">&#8217;        or &#8216;</span><span style="color: #6c71c4; font-weight: bold;">informational</span><span style="color: #2aa198;">&#8217;,</span>
<span style="color: #2aa198;">                         or &#8216;</span><span style="color: #6c71c4; font-weight: bold;">green</span><span style="color: #2aa198;">&#8217;, &#8216;</span><span style="color: #6c71c4; font-weight: bold;">yellowgreen</span><span style="color: #2aa198;">&#8217;, &#8216;</span><span style="color: #6c71c4; font-weight: bold;">yellow</span><span style="color: #2aa198;">&#8217;, &#8216;</span><span style="color: #6c71c4; font-weight: bold;">blueviolet</span><span style="color: #2aa198;">&#8217;, &#8216;</span><span style="color: #6c71c4; font-weight: bold;">ff69b4</span><span style="color: #2aa198;">&#8217;, etc.</span>
<span style="color: #2aa198;">                         Consult https://htmlcolorcodes.com/ to see the HEX codes of other colours.</span>
<span style="color: #2aa198;">                       &#8658; &#8216;</span><span style="color: #6c71c4; font-weight: bold;">logo</span><span style="color: #2aa198;">&#8217; examples and how they look can be found at</span>
<span style="color: #2aa198;">                          https://alhassy.github.io/org-special-block-extras/#Example-Badge-Icons</span>

<span style="color: #2aa198;">                   See also: https://alhassy.github.io/org-special-block-extras/#Common-Project-Badges"</span>))]

    <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">:export #'o--link--badge</span>
    (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">equal</span> o-backend 'latex) <span style="color: #2aa198;">""</span>
      (<span style="color: #859900; font-weight: bold;">-let</span> [ (key value color url logo)  (<span style="color: #b58900;">mapcar</span> #'<span style="color: #b58900;">s-trim</span> (<span style="color: #b58900;">s-split</span> <span style="color: #2aa198;">"|"</span> o-label)) ]
        (<span style="color: #b58900;">format</span>
         (<span style="color: #859900; font-weight: bold;">pcase</span> ,(<span style="color: #859900; font-weight: bold;">if</span> social-shields-name `(<span style="color: #b58900;">format</span> ,social-url o-label) 'url)
           (<span style="color: #2aa198;">"here"</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;a id=\"%s\" href=\"#%s\"&gt;%%s&lt;/a&gt;"</span> (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"%"</span> <span style="color: #2aa198;">"%%"</span> key) (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"%"</span> <span style="color: #2aa198;">"%%"</span> key)))
           (<span style="color: #2aa198;">""</span>      <span style="color: #2aa198;">"%s"</span>) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">e.g., badge:key|value|color||logo</span>
           ('nil    <span style="color: #2aa198;">"%s"</span>) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">e.g., badge:key|value|color</span>
           (<span style="color: #268bd2;">t</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;a href=\"%s\"&gt;%%s&lt;/a&gt;"</span>
                      (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"%"</span> <span style="color: #2aa198;">"%%"</span>
                                 ,(<span style="color: #859900; font-weight: bold;">if</span> social-shields-name
                                      `(<span style="color: #b58900;">format</span> ,social-url o-label)
                                    'url)))))
         ,(<span style="color: #859900; font-weight: bold;">if</span> social-shields-name
              (<span style="color: #859900; font-weight: bold;">if</span> social-shields-url
                  `(<span style="color: #b58900;">format</span> ,social-shields-url o-label)
                `(<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/%s/%s?style=social\"&gt;"</span>
                         ,social-shields-name o-label))
            '(<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/badge/%s-%s-%s?logo=%s\"&gt;"</span>
                     (<span style="color: #b58900;">url-hexify-string</span> (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"-"</span> <span style="color: #2aa198;">"--"</span> key))
                     (<span style="color: #b58900;">url-hexify-string</span> (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"-"</span> <span style="color: #2aa198;">"--"</span> (<span style="color: #859900; font-weight: bold;">or</span> value <span style="color: #2aa198;">""</span>)))
                     color
                     logo)))))))
</pre>
</div>

<p>
Notice that we can have special <code>%</code>-HTML characters in URLs; e.g.,
<code>&lt;badge:my key|my value| my
colour|https://www.google.com/search?q=hello%20world|gnu-emacs&gt;</code>
⇒
<a href="https://www.google.com/search?q=hello%20world"><img src="https://img.shields.io/badge/my%20key-my%20value-my colour?logo=gnu-emacs"></a>.
</p>



</details>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: Derived Reddit/Github/Twitter social badges
                      </font>
                    </strong>
                  </summary>

<p>
For example, a super simple ‘badge’ link type
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-make-badge</span> <span style="color: #2aa198;">"badge"</span>)
</pre>
</div>

<hr />

<p>
A more involved example.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Since we're invoking a macro, the twitter-excitement is used lazily; i.e.,</span>
<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">consulted when needed instead of being evaluated once.</span>
(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">o-link-twitter-excitement</span>
  <span style="color: #2aa198;">"This looks super neat (&#8226;&#768;&#7447;&#8226;&#769;)&#1608;:"</span>
  <span style="color: #35a69c; font-style: italic;">"The string prefixing the URL being shared."</span>)

(<span style="color: #859900; font-weight: bold;">o-make-badge</span>
 <span style="color: #2aa198;">"tweet"</span>
 <span style="color: #2aa198;">"twitter/url?=url="</span>
 (<span style="color: #b58900;">format</span>
   <span style="color: #2aa198;">"https://twitter.com/intent/tweet?text=%s:&amp;url=%%s"</span>
   <span style="color: #268bd2;">o-link-twitter-excitement</span>)
 <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/twitter/url?url=%s\"&gt;"</span>
               )
</pre>
</div>

<hr />

<p>
A few more in one, convoluted, go.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">MA: I don't think this is ideal for long-term maintainability, see &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">:OLD</span><span style="color: #96A7A9; font-style: italic;">&#8217; below.</span>
(<span style="color: #859900; font-weight: bold;">cl-loop</span> for (social url name)
         in '((<span style="color: #2aa198;">"reddit/subreddit-subscribers"</span> <span style="color: #2aa198;">"https://www.reddit.com/r/%s"</span> <span style="color: #2aa198;">"reddit"</span>)
             (<span style="color: #2aa198;">"github"</span> <span style="color: #2aa198;">"https://www.github.com/%s"</span>)
             (<span style="color: #2aa198;">"github/stars"</span> <span style="color: #2aa198;">"https://www.github.com/%s/stars"</span>)
             (<span style="color: #2aa198;">"github/watchers"</span> <span style="color: #2aa198;">"https://www.github.com/%s/watchers"</span>)
             (<span style="color: #2aa198;">"github/followers"</span> <span style="color: #2aa198;">"https://www.github.com/%s?tab=followers"</span>)
             (<span style="color: #2aa198;">"github/forks"</span> <span style="color: #2aa198;">"https://www.github.com/%s/fork"</span>)
             (<span style="color: #2aa198;">"twitter/follow"</span> <span style="color: #2aa198;">"https://twitter.com/intent/follow?screen_name=%s"</span>))
         for name&#8242; <span style="color: #b58900;">=</span> (<span style="color: #859900; font-weight: bold;">or</span> name (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"/"</span> <span style="color: #2aa198;">"-"</span> social))
         <span style="color: #b58900;">do</span> (<span style="color: #b58900;">eval</span> `(<span style="color: #859900; font-weight: bold;">o-make-badge</span> ,name&#8242; ,social ,url)))
</pre>
</div>

</details>

<p>
Here are some examples.
</p>

<ul class="org-ul">
<li>Things I like:
<a href="https://www.reddit.com/r/emacs"><img src="https://img.shields.io/reddit/subreddit-subscribers/emacs?style=social"></a>
<a href="https://www.reddit.com/r/common_lisp"><img src="https://img.shields.io/reddit/subreddit-subscribers/common_lisp?style=social"></a>
<a href="https://www.reddit.com/r/coolguides"><img src="https://img.shields.io/reddit/subreddit-subscribers/coolguides?style=social"></a>
<a href="https://www.reddit.com/r/shia"><img src="https://img.shields.io/reddit/subreddit-subscribers/shia?style=social"></a></li>

<li>Info about my cheatsheets:
<a href="https://www.github.com/alhassy/CheatSheet/stars"><img src="https://img.shields.io/github/stars/alhassy/CheatSheet?style=social"></a>
<a href="https://www.github.com/alhassy/CheatSheet/watchers"><img src="https://img.shields.io/github/watchers/alhassy/CheatSheet?style=social"></a>
<a href="https://www.github.com/alhassy/CheatSheet/fork"><img src="https://img.shields.io/github/forks/alhassy/CheatSheet?style=social"></a>
<a href="https://twitter.com/intent/tweet?text=This looks super neat (•̀ᴗ•́)و::&url=https://github.com/alhassy/org-special-block-extras"><img src="https://img.shields.io/twitter/url?url=https://github.com/alhassy/org-special-block-extras"></a></li>

<li>My profile:
<a href="https://www.github.com/alhassy?tab=followers"><img src="https://img.shields.io/github/followers/alhassy?style=social"></a>
<a href="https://twitter.com/intent/follow?screen_name=musa314"><img src="https://img.shields.io/twitter/follow/musa314?style=social"></a></li>
</ul>
</div>
</div>

<div id="outline-container-Example-Colours" class="outline-3">
<h3 id="Example-Colours"><span class="section-number-3">8.2</span> <a href="#Example-Colours">Example Colours</a></h3>
<div class="outline-text-3" id="text-Example-Colours">
<div style="column-rule-style: none;column-count: 2;">
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>
<div ><pre class="src src-org">+ badge:|red|red badge:|critical|critical
+ badge:|blue|blue badge:|informational|informational
+ badge:|brightgreen|brightgreen badge:|success|success
+ badge:|orange|orange badge:|important|important
+ badge:|lightgrey|lightgrey badge:|inactive|inactive
+ badge:|green|green
+ badge:|yellowgreen|yellowgreen
+ badge:|yellow|yellow
+ badge:|blueviolet|blueviolet
+ badge:|ff69b4|ff69b4
+ badge:|9cf|9cf
+ ...

Consult https://htmlcolorcodes.com/ to see the HEX code of any other colour you
wish to use; e.g., badge:|1d8348|1d8348
</pre></div>
</div>
<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
<ul class="org-ul">
<li><img src="https://img.shields.io/badge/-red-red?logo=nil"> <img src="https://img.shields.io/badge/-critical-critical?logo=nil"></li>
<li><img src="https://img.shields.io/badge/-blue-blue?logo=nil"> <img src="https://img.shields.io/badge/-informational-informational?logo=nil"></li>
<li><img src="https://img.shields.io/badge/-brightgreen-brightgreen?logo=nil"> <img src="https://img.shields.io/badge/-success-success?logo=nil"></li>
<li><img src="https://img.shields.io/badge/-orange-orange?logo=nil"> <img src="https://img.shields.io/badge/-important-important?logo=nil"></li>
<li><img src="https://img.shields.io/badge/-lightgrey-lightgrey?logo=nil"> <img src="https://img.shields.io/badge/-inactive-inactive?logo=nil"></li>
<li><img src="https://img.shields.io/badge/-green-green?logo=nil"></li>
<li><img src="https://img.shields.io/badge/-yellowgreen-yellowgreen?logo=nil"></li>
<li><img src="https://img.shields.io/badge/-yellow-yellow?logo=nil"></li>
<li><img src="https://img.shields.io/badge/-blueviolet-blueviolet?logo=nil"></li>
<li><img src="https://img.shields.io/badge/-ff69b4-ff69b4?logo=nil"></li>
<li><img src="https://img.shields.io/badge/-9cf-9cf?logo=nil"></li>
<li>&#x2026;</li>
</ul>

<p>
Consult <a href="https://htmlcolorcodes.com/">https://htmlcolorcodes.com/</a> to see the HEX code of any other colour you
wish to use; e.g., <img src="https://img.shields.io/badge/-1d8348-1d8348?logo=nil">
</p>

</div>
</div>
</div>
</div>

<div id="outline-container-Example-Badge-Icons" class="outline-3">
<h3 id="Example-Badge-Icons"><span class="section-number-3">8.3</span> <a href="#Example-Badge-Icons">Example Badge Icons</a></h3>
<div class="outline-text-3" id="text-Example-Badge-Icons">
<p>
Here are a few free SVG icons for popular brands from <a href="https://simpleicons.org/">https://simpleicons.org/</a>.
</p>

<p>
To use any of the names below, just write, say,
<code>badge:||grey||SVG-NAME-HERE</code>.
</p>

<div style="column-rule-style: solid;column-count: 4;">
<dl class="org-dl">
<dt>“Fire”</dt><dd><ul class="org-ul">
<li><img src="https://img.shields.io/badge/--grey?logo=Elixir">  Elixir</li>
<li><img src="https://img.shields.io/badge/--grey?logo=tinder">  tinder</li>
<li><img src="https://img.shields.io/badge/--grey?logo=codeigniter">  codeigniter</li>
<li><img src="https://img.shields.io/badge/--grey?logo=prometheus">  prometheus</li>
<li><img src="https://img.shields.io/badge/--grey?logo=sparkpost">  sparkpost</li>
</ul></dd>
</dl>

<hr />

<dl class="org-dl">
<dt>“Messaging”</dt><dd><ul class="org-ul">
<li><img src="https://img.shields.io/badge/--grey?logo=quip">  quip</li>
<li><img src="https://img.shields.io/badge/--grey?logo=WeChat">  WeChat</li>
<li><img src="https://img.shields.io/badge/--grey?logo=google-hangouts">  google-hangouts</li>
<li><img src="https://img.shields.io/badge/--grey?logo=hackhands">  hackhands</li>
<li><img src="https://img.shields.io/badge/--grey?logo=google-messages">  google-messages</li>
<li><img src="https://img.shields.io/badge/--grey?logo=Slack">  Slack</li>
</ul></dd>
</dl>

<hr />

<dl class="org-dl">
<dt>“Emacs”</dt><dd><ul class="org-ul">
<li><img src="https://img.shields.io/badge/--grey?logo=gnu-emacs">  gnu-emacs</li>
<li><img src="https://img.shields.io/badge/--grey?logo=spacemacs">  spacemacs</li>
<li><img src="https://img.shields.io/badge/--grey?logo=vim">  vim</li>
<li><img src="https://img.shields.io/badge/--grey?logo=neovim">  neovim</li>
<li><img src="https://img.shields.io/badge/--grey?logo=gnu">  gnu</li>
<li><img src="https://img.shields.io/badge/--grey?logo=github">  github</li>
<li><img src="https://img.shields.io/badge/--grey?logo=acm">  acm</li>
<li><img src="https://img.shields.io/badge/--grey?logo=wikipedia">  wikipedia</li>
<li><img src="https://img.shields.io/badge/--grey?logo=microsoft-excel">  microsoft-excel</li>
<li><img src="https://img.shields.io/badge/--grey?logo=microsoft-word">  microsoft-word</li>
<li><img src="https://img.shields.io/badge/--grey?logo=dropbox">  dropbox</li>
<li><img src="https://img.shields.io/badge/--grey?logo=google-scholar">  google-scholar</li>
<li><img src="https://img.shields.io/badge/--grey?logo=google">  google</li>
<li><img src="https://img.shields.io/badge/--grey?logo=google-translate">  google-translate</li>
<li><img src="https://img.shields.io/badge/--grey?logo=ghost">  ghost</li>
<li><img src="https://img.shields.io/badge/--grey?logo=helm">  helm</li>
<li><img src="https://img.shields.io/badge/--grey?logo=apache-openoffice">  apache-openoffice</li>
<li><img src="https://img.shields.io/badge/--grey?logo=buffer">  buffer</li>
<li><img src="https://img.shields.io/badge/--grey?logo=adobe-fonts">  adobe-fonts</li>
<li><img src="https://img.shields.io/badge/--grey?logo=google-calendar">  google-calendar</li>
</ul></dd>
</dl>

<hr />

<dl class="org-dl">
<dt>“Social”</dt><dd><ul class="org-ul">
<li><img src="https://img.shields.io/badge/--grey?logo=google-cast">  google-cast</li>
<li><img src="https://img.shields.io/badge/--grey?logo=youtube">  youtube</li>
<li><img src="https://img.shields.io/badge/--grey?logo=discord">  discord</li>
<li><img src="https://img.shields.io/badge/--grey?logo=facebook">  facebook</li>
<li><img src="https://img.shields.io/badge/--grey?logo=google-hangouts">  google-hangouts</li>
<li><img src="https://img.shields.io/badge/--grey?logo=whatsapp">  whatsapp</li>
<li><img src="https://img.shields.io/badge/--grey?logo=skype">  skype</li>
<li><img src="https://img.shields.io/badge/--grey?logo=reddit">  reddit</li>
<li><img src="https://img.shields.io/badge/--grey?logo=stack-overflow">  stack-overflow</li>
<li><img src="https://img.shields.io/badge/--grey?logo=stack-exchange">  stack-exchange</li>
<li><img src="https://img.shields.io/badge/--grey?logo=linkedin">  linkedin</li>
<li><img src="https://img.shields.io/badge/--grey?logo=twitter">  twitter</li>
<li><img src="https://img.shields.io/badge/--grey?logo=jabber">  jabber</li>
</ul></dd>
</dl>

<hr />

<dl class="org-dl">
<dt>“Lightbulb”</dt><dd><ul class="org-ul">
<li><img src="https://img.shields.io/badge/--grey?logo=lighthouse">  lighthouse</li>
<li><img src="https://img.shields.io/badge/--grey?logo=google-keep">  google-keep</li>
<li><img src="https://img.shields.io/badge/--grey?logo=minds">  minds</li>
</ul></dd>
</dl>

<hr />

<dl class="org-dl">
<dt>“Programming”</dt><dd><ul class="org-ul">
<li><img src="https://img.shields.io/badge/--grey?logo=git">  git</li>
<li><img src="https://img.shields.io/badge/--grey?logo=ruby">  ruby</li>
<li><img src="https://img.shields.io/badge/--grey?logo=scala">  scala</li>
<li><img src="https://img.shields.io/badge/--grey?logo=OCaml">  OCaml</li>
<li><img src="https://img.shields.io/badge/--grey?logo=javascript">  javascript</li>
<li><img src="https://img.shields.io/badge/--grey?logo=gnu-bash">  gnu-bash</li>
<li><img src="https://img.shields.io/badge/--grey?logo=powershell">  powershell</li>
<li><img src="https://img.shields.io/badge/--grey?logo=LaTeX">  LaTeX</li>
<li><img src="https://img.shields.io/badge/--grey?logo=java">  java</li>
<li><img src="https://img.shields.io/badge/--grey?logo=kotlin">  kotlin</li>
<li><img src="https://img.shields.io/badge/--grey?logo=haskell">  haskell</li>
<li><img src="https://img.shields.io/badge/--grey?logo=coffeescript">  coffeescript</li>
<li><img src="https://img.shields.io/badge/--grey?logo=purescript">  purescript</li>
<li><img src="https://img.shields.io/badge/--grey?logo=rust">  rust</li>
<li><img src="https://img.shields.io/badge/--grey?logo=typescript">  typescript</li>
<li><img src="https://img.shields.io/badge/--grey?logo=css3">  css3</li>
<li><img src="https://img.shields.io/badge/--grey?logo=python">  python</li>
<li><img src="https://img.shields.io/badge/--grey?logo=c">  c</li>
<li><img src="https://img.shields.io/badge/--grey?logo=clojure">  clojure</li>
<li><img src="https://img.shields.io/badge/--grey?logo=lua">  lua</li>
<li><img src="https://img.shields.io/badge/--grey?logo=adobe-acrobat-reader">  adobe-acrobat-reader</li>
<li><img src="https://img.shields.io/badge/--grey?logo=perl">  perl</li>
</ul></dd>
</dl>

<hr />

<dl class="org-dl">
<dt>“Miscellaneous”</dt><dd><ul class="org-ul">
<li><img src="https://img.shields.io/badge/--grey?logo=read-the-docs">  read-the-docs</li>
<li><img src="https://img.shields.io/badge/--grey?logo=buy-me-a-coffee">  buy-me-a-coffee</li>
<li><img src="https://img.shields.io/badge/--grey?logo=gimp">  gimp</li>
<li><img src="https://img.shields.io/badge/--grey?logo=mega">  mega</li>
<li><img src="https://img.shields.io/badge/--grey?logo=nintendo-3ds">  nintendo-3ds</li>
<li><img src="https://img.shields.io/badge/--grey?logo=paypal">  paypal</li>
<li><img src="https://img.shields.io/badge/--grey?logo=pinboard">  pinboard</li>
<li><img src="https://img.shields.io/badge/--grey?logo=mocha">  mocha</li>
<li><img src="https://img.shields.io/badge/--grey?logo=Gitea">  Gitea</li>
<li><img src="https://img.shields.io/badge/--grey?logo=instacart">  instacart</li>
<li><img src="https://img.shields.io/badge/--grey?logo=openStreetMap">  openStreetMap</li>
<li><img src="https://img.shields.io/badge/--grey?logo=amazon">  amazon</li>
<li><img src="https://img.shields.io/badge/--grey?logo=svg">  svg</li>
<li><img src="https://img.shields.io/badge/--grey?logo=rss">  rss</li>
<li><img src="https://img.shields.io/badge/--grey?logo=swagger">  swagger</li>
<li><img src="https://img.shields.io/badge/--grey?logo=pastebin">  pastebin</li>
<li><img src="https://img.shields.io/badge/--grey?logo=skyliner">  skyliner</li>
<li><img src="https://img.shields.io/badge/--grey?logo=iTunes">  iTunes</li>
<li><img src="https://img.shields.io/badge/--grey?logo=gulp">  gulp</li>
<li><img src="https://img.shields.io/badge/--grey?logo=leaflet">  leaflet</li>
<li><img src="https://img.shields.io/badge/--grey?logo=youtube-gaming">  youtube-gaming</li>
<li><img src="https://img.shields.io/badge/--grey?logo=GIMP">  GIMP</li>
<li><img src="https://img.shields.io/badge/--grey?logo=atom">  atom</li>
</ul></dd>
</dl>

</div>
</div>
</div>

<div id="outline-container-Common-Project-Badges" class="outline-3">
<h3 id="Common-Project-Badges"><span class="section-number-3">8.4</span> <a href="#Common-Project-Badges">Common Project Badges &#x2014;with copyable source</a></h3>
<div class="outline-text-3" id="text-Common-Project-Badges">
<ul class="org-ul">
<li><a href="https://www.gnu.org/software/emacs"><img src="https://img.shields.io/badge/Emacs-23%2F26%2F28-green?logo=gnu-emacs"></a> <details><summary>src</summary> <code>badge:Emacs|23/26/28|green|https://www.gnu.org/software/emacs|gnu-emacs</code> </details></li>
<li><a href="https://orgmode.org"><img src="https://img.shields.io/badge/Org-9.3.6-blue?logo=gnu"></a> <details><summary>src</summary> <code>badge:Org|9.3.6|blue|https://orgmode.org|gnu</code> </details></li>
<li><a href="https://alhassy.github.io/org-special-block-extras/README.html"><img src="https://img.shields.io/badge/org--special--block--extras-1.0-informational?logo=Gnu-Emacs"></a> <details><summary>src</summary> <code>[[badge:org-special-block-extras|1.0|informational|https://alhassy.github.io/org-special-block-extras/README.html|Gnu-Emacs][org-special-block-extras badge]]</code> </details></li>
<li><a href="https://github.com/alhassy/emacs.d#use-package-the-start-of-initel"><img src="https://img.shields.io/badge/melpa-pending-critical?logo=github"></a> <details><summary>src</summary> <code>[[badge:melpa|pending|critical|https://github.com/alhassy/emacs.d#use-package-the-start-of-initel|github][melpa badge]]</code> </details></li>
<li><a href="https://github.com/alhassy/emacs.d#what-does-literate-programming-look-like"><img src="https://img.shields.io/badge/docs-literate-success?logo=read-the-docs"></a> <details><summary>src</summary> <code>[[badge:docs|literate|success|https://github.com/alhassy/emacs.d#what-does-literate-programming-look-like|read-the-docs][read-the-docs badge]]</code> </details>
<a id="wiki" href="#wiki"><img src="https://img.shields.io/badge/wiki-github-informational?logo=wikipedia"></a> <details><summary>src</summary> <code>badge:wiki|github|informational|here|wikipedia</code> </details></li>
<li><a id="code_coverage" href="#code_coverage"><img src="https://img.shields.io/badge/code_coverage-88%25-green?logo=codecov"></a> <details><summary>src</summary> <code>badge:code_coverage|88%|green|here|codecov</code> </details>
<a id="build" href="#build"><img src="https://img.shields.io/badge/build-passing-success?logo=azure-pipelines"></a> <details><summary>src</summary> <code>badge:build|passing|success|here|azure-pipelines</code> </details></li>
<li><a href="https://alhassy.github.io/"><img src="https://img.shields.io/badge/author-musa_al--hassy-purple?logo=nintendo-3ds"></a> <details><summary>src</summary> <code>badge:author|musa_al-hassy|purple|https://alhassy.github.io/|nintendo-3ds</code> </details></li>
<li><a href="https://alhassy.github.io/"><img src="https://img.shields.io/badge/author-musa_al--hassy-purple?logo=gimp"></a> <details><summary>src</summary> <code>badge:author|musa_al-hassy|purple|https://alhassy.github.io/|gimp</code> </details></li>
<li><a href="https://www.gnu.org/licenses/gpl-3.0.en.html"><img src="https://img.shields.io/badge/license-GNU_3-informational?logo=read-the-docs"></a> <details><summary>src</summary> <code>[[badge:license|GNU_3|informational|https://www.gnu.org/licenses/gpl-3.0.en.html|read-the-docs][gnu 3 license badge]]</code> </details></li>
<li><a id="issue_tracking" href="#issue_tracking"><img src="https://img.shields.io/badge/issue_tracking-github-informational?logo=github"></a> <details><summary>src</summary> <code>badge:issue_tracking|github|informational|here|github</code> </details></li>
<li><a id="help_forum" href="#help_forum"><img src="https://img.shields.io/badge/help_forum-discourse-informational?logo=discourse"></a> <details><summary>src</summary> <code>badge:help_forum|discourse|informational|here|discourse</code> </details></li>
<li><a href="https://gitter.im/explore"><img src="https://img.shields.io/badge/social_chat-gitter-informational?logo=gitter"></a> <details><summary>src</summary> <code>badge:social_chat|gitter|informational|https://gitter.im/explore|gitter</code> </details></li>
<li><img src="https://img.shields.io/badge/Maintained%3F-yes-success?logo=nil"> <details><summary>src</summary> <code>badge:Maintained?|yes|success</code> </details>
<img src="https://img.shields.io/badge/Maintained%3F-no-critical?logo=nil"> <details><summary>src</summary> <code>badge:Maintained?|no|critical</code> </details>
<a href="http://unmaintained.tech/"><img src="https://img.shields.io/badge/No_Maintenance_Intended-%C3%97-critical?logo=nil"></a> <details><summary>src</summary> <code>badge:No_Maintenance_Intended|×|critical|http://unmaintained.tech/</code> </details></li>
<li><img src="https://img.shields.io/badge/website-up-success?logo=nil"> <details><summary>src</summary> <code>badge:website|up|success</code> </details>
<img src="https://img.shields.io/badge/website-down-critical?logo=nil"> <details><summary>src</summary> <code>badge:website|down|critical</code> </details></li>
<li><img src="https://img.shields.io/badge/Ask_me-anything-1abc9c?logo=nil"> <details><summary>src</summary> <code>badge:Ask_me|anything|1abc9c</code> </details>
<a href="https://github.com/alhassy/org-special-block-extras/issues"><img src="https://img.shields.io/badge/contributions-welcome-green?logo=nil"></a> <details><summary>src</summary> <code>badge:contributions|welcome|green|https://github.com/alhassy/org-special-block-extras/issues</code> </details></li>
<li><img src="https://img.shields.io/badge/Made_with-Python%2C_LaTeX%2C_MathJax%2C_and_Emacs_Org--mode-1f425?logo=nil">
 <details><summary>src</summary>
<code>badge:Made_with|Python,_LaTeX,_MathJax,_and_Emacs_Org-mode|1f425</code>
 </details></li>
</ul>
</div>
</div>
<div class="outline-text-2" id="text-Badge-Links">
</div>
<div id="outline-container-Next-Steps-badges" class="outline-3">
<h3 id="Next-Steps-badges"><span class="section-number-3">8.5</span> <a href="#Next-Steps-badges">Next Steps</a></h3>
<div class="outline-text-3" id="text-Next-Steps-badges">
<p>
<span style="color:orange;">Going forward,</span> it would be desirable to provide non-whitespace alternatives for
the LaTeX backend.  <p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Author:</strong></span> That is why no examples are shown in the PDF  <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p> It
may be useful to colour the <code>|</code>-separated fields of a badge link.
</p>
</div>
</div>
</div>
<div id="outline-container-Tooltips-for-Glossaries-Dictionaries-and-Documentation" class="outline-2">
<h2 id="Tooltips-for-Glossaries-Dictionaries-and-Documentation"><span class="section-number-2">9</span> <a href="#Tooltips-for-Glossaries-Dictionaries-and-Documentation">Tooltips for Glossaries, Dictionaries, and Documentation</a></h2>
<div class="outline-text-2" id="text-Tooltips-for-Glossaries-Dictionaries-and-Documentation">


<p>
Let's make a link type <code>doc</code> that shows a tooltip documentation &#x2014;e.g., glossary
or abbreviation&#x2014; for a given label.
E.g., user-declared <abbr class="tooltip" title="A theory of typed composition; e.g., typed monoids.">Category Theory</abbr> and Emacs-retrieved <abbr class="tooltip" title="The Common Lisp ‘loop’ macro.<br>Valid clauses include:<br>&emsp;For clauses:<br>&emsp;&emsp;for VAR from/upfrom/downfrom EXPR1 to/upto/downto/above/below EXPR2 [by EXPR3]<br>&emsp;&emsp;for VAR = EXPR1 then EXPR2<br>&emsp;&emsp;for VAR in/on/in-ref LIST [by FUNC]<br>&emsp;&emsp;for VAR across/across-ref ARRAY<br>&emsp;&emsp;for VAR being:<br>&emsp;&emsp;&emsp;the elements of/of-ref SEQUENCE [using (index VAR2)]<br>&emsp;&emsp;&emsp;the symbols [of OBARRAY]<br>&emsp;&emsp;&emsp;the hash-keys/hash-values of HASH-TABLE [using (hash-values/hash-keys V2)]<br>&emsp;&emsp;&emsp;the key-codes/key-bindings/key-seqs of KEYMAP [using (key-bindings VAR2)]<br>&emsp;&emsp;&emsp;the overlays/intervals [of BUFFER] [from POS1] [to POS2]<br>&emsp;&emsp;&emsp;the frames/buffers<br>&emsp;&emsp;&emsp;the windows [of FRAME]<br>&emsp;Iteration clauses:<br>&emsp;&emsp;repeat INTEGER<br>&emsp;&emsp;while/until/always/never/thereis CONDITION<br>&emsp;Accumulation clauses:<br>&emsp;&emsp;collect/append/nconc/concat/vconcat/count/sum/maximize/minimize FORM<br>&emsp;&emsp;&emsp;[into VAR]<br>&emsp;Miscellaneous clauses:<br>&emsp;&emsp;with VAR = INIT<br>&emsp;&emsp;if/when/unless COND CLAUSE [and CLAUSE]... else CLAUSE [and CLAUSE...]<br>&emsp;&emsp;named NAME<br>&emsp;&emsp;initially/finally [do] EXPRS...<br>&emsp;&emsp;do EXPRS...<br>&emsp;&emsp;[finally] return EXPR<br><br>For more details, see Info node ‘(cl)Loop Facility’.<br><br>(fn CLAUSE...)">loop</abbr> and <abbr class="tooltip" title="Thread FORMS elements as the last argument of their successor.<br>Example:<br>&emsp;&emsp;(thread-last<br>&emsp;&emsp;&emsp;5<br>&emsp;&emsp;&emsp;(+ 20)<br>&emsp;&emsp;&emsp;(<em> 25)<br>&emsp;&emsp;&emsp;-<br>&emsp;&emsp;&emsp;(+ 40))<br>Is equivalent to:<br>&emsp;&emsp;(+ 40 (- (</em> 25 (+ 20 5))))<br>Note how the single ‘-’ got converted into a list before<br>threading.<br><br>(fn &rest FORMS)">thread-last</abbr> ^_^
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Eye-candy ---A gallery of images
                      </font>
                    </strong>
                  </summary>

<div id="orge629be7" class="figure">
<p><img src="images/tooltips_browser.png" alt="tooltips_browser.png" />
</p>
<p><span class="figure-number">Figure 8: </span>Tooltips for documentation and glossary items &#x2013;in the browser!</p>
</div>


<div id="org69e4124" class="figure">
<p><img src="images/tooltips_emacs.png" alt="tooltips_emacs.png" />
</p>
<p><span class="figure-number">Figure 9: </span>Tooltips for documentation and glossary items &#x2013;in Emacs!</p>
</div>


<div id="orgd838746" class="figure">
<p><img src="images/tooltips_pdf.png" alt="tooltips_pdf.png" />
</p>
<p><span class="figure-number">Figure 10: </span>Tooltips for documentation and glossary items &#x2013;in the PDF!</p>
</div>


</details>
<div style="padding: 1em; background-color: #FFFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Full Example</h3>
<p>
<span class="underline">User enters …</span>
</p>
<div class="org-src-container">
<pre class="src src-org">#+begin_documentation Existential Angst :label "ex-angst"
A negative feeling arising from freedom and responsibility.

Also known as
1. /Existential Dread/, and
2. *Existential Anxiety*.

Perhaps a distraction, such as [[https://www.w3schools.com][visiting W3Schools]], may help ;-)

Then again, ~coding~ can be frustrating at times, maybe have
a slice of pie with maths by reading &#8220;$e^{i&#215;&#960;} + 1 = 0$&#8221; as a poem ;-)
#+end_documentation
</pre>
</div>



<p>
<span class="underline">Then…</span> <code>doc:ex-angst</code> gives us <abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>Also known as<br>1. <em>Existential Dread</em>, and<br>2. <strong>Existential Anxiety</strong>.<br><br>Perhaps a distraction, such as visiting W3Schools (https://www.w3schools.com), may help ;-)<br><br>Then again, <code>coding</code> can be frustrating at times, maybe have<br>a slice of pie with maths by reading “<em>e^{i×π} + 1 = 0</em>” as a poem ;-)">Existential Angst</abbr>,
or using a description: <abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>Also known as<br>1. <em>Existential Dread</em>, and<br>2. <strong>Existential Anxiety</strong>.<br><br>Perhaps a distraction, such as visiting W3Schools (https://www.w3schools.com), may help ;-)<br><br>Then again, <code>coding</code> can be frustrating at times, maybe have<br>a slice of pie with maths by reading “<em>e^{i×π} + 1 = 0</em>” as a poem ;-)">“existence is pain”?</abbr>
( <code>[[doc:ex-angst][“existence is pain”?]]</code> )
</p>

</div>

<blockquote>
<p>
As it stands, Emacs tooltips <b>only</b> appear after an export has happened:
The export updates the dictionary variable which is used for the tooltips
utility.
</p>

<p>
The <code>:label</code> is optional; when not provided it defaults to the name of the entry
with spaces replaced by ‘_’.  For more, see
<abbr class="tooltip" title="Register the dictionary entries in CONTENTS to the dictionary variable.<br><br>The dictionary variable is ‘o--docs’.<br><br>A documentation entry may have its LABEL, its primary identifier,<br>be:<br>1. Omitted<br>2. Given as a single symbol<br>3. Given as a many aliases ’(lbl₀ lbl₁ … lblₙ)<br><br>The third case is for when there is no canonical label to refer to<br>an entry, or it is convenient to use multiple labels for the same<br>entry.<br><br>In all of the above cases, two additional labels are included:<br>The entry name with spaces replaced by underscores, and again but<br>all lower case.<br><br>Documentation blocks are not shown upon export;<br>unless SHOW is non-nil, in which case they are shown<br>using the ‘box’ block, with the provided COLOR passed to it.<br><br>In the futture, it may be nice to have an option to render tooltips.<br>That’d require the ‘doc:𝒳’ link construction be refactored via a ‘defun’.<br><br>(fn BACKEND RAW-CONTENTS &optional NAME &rest ## &key (O-LINK\? nil) (LABEL nil) (SHOW nil) (COLOR ''green''))">o--documentation</abbr>.
</p>

<p>
Entry names do not need to be unique, but labels do!
( The labels are like the addresses used to look up a person's home. )
</p>
</blockquote>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         ‼TODO More Examples
                      </font>
                    </strong>
                  </summary>



<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Supported</th>
<th scope="col" class="org-left">Example</th>
<th scope="col" class="org-left">Source</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">No description</td>
<td class="org-left"><abbr class="tooltip" title="A theory of typed composition; e.g., typed monoids.">Category Theory</abbr></td>
<td class="org-left"><code>doc:cat</code></td>
</tr>

<tr>
<td class="org-left">With description and code font</td>
<td class="org-left"><abbr class="tooltip" title="Methods that do not perform any “type casing”."><code>polymorphism</code></abbr></td>
<td class="org-left"><code>[[doc:natural-transformation][=polymorphism=]]</code></td>
</tr>

<tr>
<td class="org-left">Fallback: Arbitrary ELisp Docs (function)</td>
<td class="org-left"><abbr class="tooltip" title="Thread FORMS elements as the first argument of their successor.<br>Example:<br>&emsp;&emsp;(thread-first<br>&emsp;&emsp;&emsp;5<br>&emsp;&emsp;&emsp;(+ 20)<br>&emsp;&emsp;&emsp;(<em> 25)<br>&emsp;&emsp;&emsp;-<br>&emsp;&emsp;&emsp;(+ 40))<br>Is equivalent to:<br>&emsp;&emsp;(+ (- (</em> (+ 5 20) 25)) 40)<br>Note how the single ‘-’ got converted into a list before<br>threading.<br><br>(fn &rest FORMS)">thread-first</abbr></td>
<td class="org-left"><code>doc:thread-first</code></td>
</tr>

<tr>
<td class="org-left">Fallback: Arbitrary ELisp Docs (variable)</td>
<td class="org-left"><abbr class="tooltip" title="The email address of the current user.<br>This defaults to either: the value of EMAIL environment variable; or<br>user@host, using ‘user-login-name’ and ‘mail-host-address’ (or ‘system-name’).">user-mail-address</abbr></td>
<td class="org-left"><code>doc:user-mail-address</code></td>
</tr>

<tr>
<td class="org-left">Fallback: Arbitrary English word</td>
<td class="org-left"><abbr class="tooltip" title="<br>Overview of noun user<br><br>The noun user has 3 senses (first 2 from tagged texts)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; <br>1. (3) user -- (a person who makes use of a thing; someone who uses or employs something)<br>2. (1) exploiter, user -- (a person who uses something or someone selfishly or unethically)<br>3. drug user, substance abuser, user -- (a person who takes drugs)<br><br>Synonyms/Hypernyms (Ordered by Estimated Frequency) of noun user<br><br>3 senses of user&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<br><br>Sense 1<br>user<br>&emsp;&emsp;&emsp; => person, individual, someone, somebody, mortal, soul<br><br>Sense 2<br>exploiter, user<br>&emsp;&emsp;&emsp; => selfish person<br><br>Sense 3<br>drug user, substance abuser, user<br>&emsp;&emsp;&emsp; => person, individual, someone, somebody, mortal, soul<br>">user</abbr></td>
<td class="org-left"><code>doc:user</code></td>
</tr>
</tbody>
</table>

<p>
Notice how hovering over items makes them appear, but to make them disappear you
should click on them or scroll away.  This is ideal when one wants to have
multiple ‘definitions’ visible ;-)
</p>

<p>
Below are the entries in my personal glossary ;-)
</p>

<p>
‼ TODO
</p>
<p>
In the export, it looks like some names are repeated, but in the source one
would notice that we have <i>labels</i> in both upper and lower cases and with underscores ;-)
They just happen to be referring to the same <i>named</i> entry.
</p>

<hr />

<p>
My personal documentation library can be seen here:
<a href="https://alhassy.github.io/org-special-block-extras/documentation.org.html"><img src="https://img.shields.io/badge/Htmlized-Org-green?logo=nil"></a>
or
<a href="https://alhassy.github.io/org-special-block-extras/documentation.html"><img src="https://img.shields.io/badge/Pretty-HTML-green?logo=nil"></a>.
</p>


</details>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Tests
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It gives a tooltip whose title is the Lisp docs of APPLY"</span>
  [doc]
  (&#8669; (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"doc:apply"</span>)
     <span style="color: #2aa198;">"&lt;abbr class=\"tooltip\" title=\""</span>
     (literal (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"\n"</span> <span style="color: #2aa198;">"&lt;br&gt;"</span> (<span style="color: #b58900;">documentation</span> #'<span style="color: #b58900;">apply</span>)))
     <span style="color: #2aa198;">"\"&gt;apply&lt;/abbr&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">setq</span> angst
      (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"#+begin_documentation Existential Angst :label \"ex-angst\"</span>
<span style="color: #2aa198;">                       A negative feeling arising from freedom and responsibility.</span>

<span style="color: #2aa198;">                       Also known as</span>
<span style="color: #2aa198;">                       1. /Existential Dread/, and</span>
<span style="color: #2aa198;">                       2. *Existential Anxiety*.</span>

<span style="color: #2aa198;">                       Perhaps a distraction, such as [[https://www.w3schools.com][visiting W3Schools]], may help ;-)</span>

<span style="color: #2aa198;">                       Then again, ~coding~ can be frustrating at times, maybe have</span>
<span style="color: #2aa198;">                       a slice of pie with maths by reading &#8220;$e^{i&#215;&#960;} + 1 = 0$&#8221; as a poem ;-)</span>
<span style="color: #2aa198;">                       #+end_documentation</span>

<span style="color: #2aa198;">                       We now use this as doc:ex-angst."</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"Documentation blocks are not exported; they produce a new osbe--docs entry"</span>
  [doc <span style="color: #b58900;">documentation</span> o--name&amp;doc]
    (<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">o-docs-get</span> <span style="color: #2aa198;">"ex-angst"</span>)))

<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Upon export, the #+begin_documentation is /not/ present.</span>
<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">We have the text outside that block only.</span>
<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Along, with a htmlified tooltip of the new entry.</span>
(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"The osbe--docs entry of the documentation block appears within a tooltip"</span>
    [doc <span style="color: #b58900;">documentation</span> o--name&amp;doc]
    (&#8669; angst <span style="color: #2aa198;">" &lt;p&gt; We now use this as &lt;abbr class=\"tooltip\" title=\""</span>
             (literal (<span style="color: #b58900;">o-html-export-preserving-whitespace</span>
                       (<span style="color: #b58900;">cl-second</span> (<span style="color: #b58900;">o-docs-get</span> <span style="color: #2aa198;">"ex-angst"</span>))))
                    <span style="color: #2aa198;">"\"&gt;Existential Angst&lt;/abbr&gt;.&lt;/p&gt; "</span>))
</pre>
</div>


</details>
</div>

<div id="outline-container-The-doc-link-type" class="outline-3">
<h3 id="The-doc-link-type"><span class="section-number-3">9.1</span> <a href="#The-doc-link-type">Implementation Details: <code>doc</code> link, <code>documentation</code> block, and <a href="https://iamceege.github.io/tooltipster/#triggers">tooltipster</a></a></h3>
<div class="outline-text-3" id="text-The-doc-link-type">
<p>
We begin by making use of a list of documentation-glossary entries
&#x2014;a lightweight database of information, if you will.
</p>

<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Overview of relevant Lisp</h3>
<ul class="org-ul">
<li><abbr class="tooltip" title="An alist of (LABEL NAME DESCRIPTION) entries; our glossary.<br><br>Example setter:<br>0. (o-docs-set ''os'' ''Emacs'' ''A place wherein I do all of my computing.'')<br><br>Example getters:<br>0. (o-docs-get LABEL)<br>1. (-let [(name description) (cdr (assoc LABEL o--docs))] ⋯)<br><br>See also ‘o--docs-from-libraries’ and ‘o-docs-load-libraries’.">o--docs</abbr> is the global variable that holds the glossary/database for the
current session. Entries may be inserted with <abbr class="tooltip" title="Add a new documentation-glossary entry, if it is not already present.<br><br>We associate LABEL to have title NAME and glossary value DESCRIPTION.<br><br>Example usage:<br>&emsp;(o-docs-set ''cat''<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;''Category Theory''<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;''A theory of typed&emsp;composition; e.g., typed monoids.'')">o-docs-set</abbr> and retrieved
with <abbr class="tooltip" title="Return the name and documentation-glossary values associated with LABEL.<br><br>It returns a list of length 2.<br><br>Example uses:<br><br>&emsp;;; Get the Lisp documentation of ‘thread-last’<br>&emsp;(o-docs-get ''thread-last'')<br><br>&emsp;;; Get the English definition of ‘computing’<br>&emsp;(o-docs-get ''computing'')<br><br>We look for LABEL from within the current buffer first, using ‘o--docs’,<br>and otherwise look among the loaded libraries, using ‘o--docs-from-libraries’,<br>and, finally, look for the documentation entry using ‘o-docs-fallback’.">o-docs-get</abbr>.</li>

<li><abbr class="tooltip" title="The fallback method to retriving documentation or glossary entries.<br><br>We try to retrive the Emacs Lisp function documentation of the<br>given LABEL, if possible, otherwise we try to retrive the Emacs<br>Lisp variable documentation, and if that fails then we look up<br>the word in the English dictionary.<br><br>The English definition is obtained from the command line tool ‘wn’, WordNet.">o-docs-fallback</abbr> is a <i>fallback method</i> for retriving documentation-glossary
entries from elsewhere besides the current buffer; e.g., using Emacs'
<abbr class="tooltip" title="Return the documentation string of FUNCTION.<br>Unless a non-nil second argument RAW is given, the<br>string is passed through ‘substitute-command-keys’.<br><br>(fn FUNCTION &optional RAW)">documentation</abbr> function or the <code>wn</code> WordNet command for definitions of
English words. We use <abbr class="tooltip" title="Load documentation-glossary libraries LIBS.<br><br>If no LIBS are provided, simply use those declared<br>o-docs-libraries.<br><br>See ‘o-docs-from-libraries’.<br><br>(fn &optional (LIBS o-docs-libraries))">o-docs-load-libraries</abbr> to load documentation-glossary
entries from external files.</li>

<li><abbr class="tooltip" title="Insert a “doc:𝒳” link from user’s documentation-glossary database.<br><br>It can be tricky to remember what you have, or what documentation entries mention, and so<br>this command gives a searchable way to insert doc links.">o-docs-insert</abbr> for interactively inserting links for documented-glossary words.</li>
</ul>

</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">o--docs</span> nil
  <span style="color: #35a69c; font-style: italic;">"An alist of (LABEL NAME DESCRIPTION) entries; our glossary.</span>

<span style="color: #35a69c; font-style: italic;">Example setter:</span>
<span style="color: #35a69c; font-style: italic;">0. (o-docs-set \"os\" \"Emacs\" \"A place wherein I do all of my computing.\")</span>

<span style="color: #35a69c; font-style: italic;">Example getters:</span>
<span style="color: #35a69c; font-style: italic;">0. (o-docs-get LABEL)</span>
<span style="color: #35a69c; font-style: italic;">1. (-let [(name description) (cdr (assoc LABEL o--docs))] &#8943;)</span>

<span style="color: #35a69c; font-style: italic;">See also `</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">o--docs-from-libraries</span><span style="color: #35a69c; font-style: italic;">' and `</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">o-docs-load-libraries</span><span style="color: #35a69c; font-style: italic;">'."</span>)

(<span style="color: #859900; font-weight: bold;">cl-defun</span> <span style="color: #b58900;">o-docs-set</span> (label name description)
  <span style="color: #35a69c; font-style: italic;">"Add a new documentation-glossary entry, if it is not already present.</span>

<span style="color: #35a69c; font-style: italic;">We associate LABEL to have title NAME and glossary value DESCRIPTION.</span>

<span style="color: #35a69c; font-style: italic;">Example usage:</span>
<span style="color: #35a69c; font-style: italic;">  (o-docs-set \"cat\"</span>
<span style="color: #35a69c; font-style: italic;">              \"Category Theory\"</span>
<span style="color: #35a69c; font-style: italic;">              \"A theory of typed  composition; e.g., typed monoids.\")"</span>
  (<span style="color: #b58900;">add-to-list</span> '<span style="color: #268bd2;">o--docs</span> (<span style="color: #b58900;">list</span> label name description)))

(<span style="color: #859900; font-weight: bold;">cl-defun</span> <span style="color: #b58900;">o-docs-get</span> (label)
  <span style="color: #35a69c; font-style: italic;">"Return the name and documentation-glossary values associated with LABEL.</span>

<span style="color: #35a69c; font-style: italic;">It returns a list of length 2.</span>

<span style="color: #35a69c; font-style: italic;">Example uses:</span>

<span style="color: #35a69c; font-style: italic;">  ;; Get the Lisp documentation of `</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">thread-last</span><span style="color: #35a69c; font-style: italic;">'</span>
<span style="color: #35a69c; font-style: italic;">  (o-docs-get \"thread-last\")</span>

<span style="color: #35a69c; font-style: italic;">  ;; Get the English definition of &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">computing</span><span style="color: #35a69c; font-style: italic;">&#8217;</span>
<span style="color: #35a69c; font-style: italic;">  (o-docs-get \"computing\")</span>

<span style="color: #35a69c; font-style: italic;">We look for LABEL from within the current buffer first, using `</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">o--docs</span><span style="color: #35a69c; font-style: italic;">',</span>
<span style="color: #35a69c; font-style: italic;">and otherwise look among the loaded libraries, using `</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">o--docs-from-libraries</span><span style="color: #35a69c; font-style: italic;">',</span>
<span style="color: #35a69c; font-style: italic;">and, finally, look for the documentation entry using `</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">o-docs-fallback</span><span style="color: #35a69c; font-style: italic;">'."</span>
  (<span style="color: #b58900;">cdr</span> (<span style="color: #859900; font-weight: bold;">or</span> (<span style="color: #b58900;">assoc</span> label <span style="color: #268bd2;">o--docs</span>)
           (<span style="color: #b58900;">assoc</span> label <span style="color: #268bd2;">o--docs-from-libraries</span>)
           (<span style="color: #b58900;">funcall</span> <span style="color: #268bd2;">o-docs-fallback</span> label)
           (<span style="color: #b58900;">error</span> <span style="color: #2aa198;">"Error: No documentation-glossary entry for &#8220;%s&#8221;!"</span> label))))

(<span style="color: #859900; font-weight: bold;">cl-defun</span> <span style="color: #b58900;">o-docs-insert</span> ()
  <span style="color: #35a69c; font-style: italic;">"Insert a &#8220;doc:&#119987;&#8221; link from user's documentation-glossary database.</span>

<span style="color: #35a69c; font-style: italic;">It can be tricky to remember what you have, or what documentation entries mention, and so</span>
<span style="color: #35a69c; font-style: italic;">this command gives a searchable way to insert doc links."</span>
  (<span style="color: #859900; font-weight: bold;">interactive</span>)
  (<span style="color: #859900; font-weight: bold;">thread-last</span>
      (<span style="color: #b58900;">cl-remove-duplicates</span> (<span style="color: #b58900;">-concat</span> <span style="color: #268bd2;">o--docs</span> <span style="color: #268bd2;">o--docs-from-libraries</span>)
                            <span style="color: #d33682; font-style: italic;">:test</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (x y) (<span style="color: #b58900;">cl-equalp</span> (<span style="color: #b58900;">car</span> x) (<span style="color: #b58900;">car</span> y))))
    (<span style="color: #859900; font-weight: bold;">--map</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s &#8759; %s"</span> (<span style="color: #b58900;">car</span> it) (<span style="color: #b58900;">cl-third</span> it)))
    (<span style="color: #b58900;">completing-read</span> <span style="color: #2aa198;">"Insert doc link &#8759; "</span>)
    (<span style="color: #b58900;">s-split</span> <span style="color: #2aa198;">"&#8759;"</span>)
    <span style="color: #b58900;">car</span>
    (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"doc:"</span>)
    (<span style="color: #b58900;">insert</span>)))
</pre>
</div>

<p>
We may wish to use Emacs' <abbr class="tooltip" title="Return the documentation string of FUNCTION.<br>Unless a non-nil second argument RAW is given, the<br>string is passed through ‘substitute-command-keys’.<br><br>(fn FUNCTION &optional RAW)">documentation</abbr> (or <abbr class="tooltip" title="Essentially, ‘lf-documentation’ ≈ ‘documentation’ + ‘documentation-property’.<br><br>If the final argument NEWDOC is provided, then this function becomes a setter;<br>otherwise it is a getter.<br><br>By default, Emacs Lisp’s ‘documentation’ returns the function documentation of<br>a given symbol.&emsp;As such, ours will be biased towards variable documentation.<br><br>(lf-documentation NAME ’function)&emsp;≈&emsp;(documentation NAME).<br><br>Interestingly, Common Lisp’s ‘documentation’ primitive takes<br>two arguments, NAME and KIND.&emsp;We have based ours on Common Lisp’s.<br><br>(fn NAME &optional KIND NEWDOC)">lf-documentation</abbr>) command to
retrieve entries &#x2014;this is useful for an online article that refers to
unfamiliar Emacs terms ;-) To avoid copy-pasting documentation entries from one
location to another, users may declare a fallback method. Besides Emacs'
<abbr class="tooltip" title="Return the documentation string of FUNCTION.<br>Unless a non-nil second argument RAW is given, the<br>string is passed through ‘substitute-command-keys’.<br><br>(fn FUNCTION &optional RAW)">documentation</abbr>, the fallback can be refer to a user's personal ‘global
glossary’ variable &#x2014;which may live in their Emacs' init file&#x2014;, for more see:
<abbr class="tooltip" title="Load documentation-glossary libraries LIBS.<br><br>If no LIBS are provided, simply use those declared<br>o-docs-libraries.<br><br>See ‘o-docs-from-libraries’.<br><br>(fn &optional (LIBS o-docs-libraries))">o-docs-load-libraries</abbr>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">o-docs-fallback</span>
  (<span style="color: #859900; font-weight: bold;">lambda</span> (label) (<span style="color: #b58900;">list</span>
              <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">label</span>
              label
              <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">name</span>
              label
              <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">documentation</span>
              (<span style="color: #859900; font-weight: bold;">or</span>
               (<span style="color: #859900; font-weight: bold;">ignore-errors</span> (<span style="color: #b58900;">documentation</span> (<span style="color: #b58900;">intern</span> label)))
               (<span style="color: #859900; font-weight: bold;">ignore-errors</span> (<span style="color: #b58900;">documentation-property</span>
                               (<span style="color: #b58900;">intern</span> label)
                               'variable-documentation))
               (<span style="color: #859900; font-weight: bold;">-let</span> [it (<span style="color: #b58900;">shell-command-to-string</span>
                          (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"wn %s -over -synsn"</span> label))]
                 (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">s-blank-p</span> it)
                     (<span style="color: #b58900;">error</span> <span style="color: #2aa198;">"Error: No documentation-glossary entry for &#8220;%s&#8221;!"</span> label)
                   it)))))

  <span style="color: #35a69c; font-style: italic;">"The fallback method to retriving documentation or glossary entries.</span>

<span style="color: #35a69c; font-style: italic;">We try to retrive the Emacs Lisp function documentation of the</span>
<span style="color: #35a69c; font-style: italic;">given LABEL, if possible, otherwise we try to retrive the Emacs</span>
<span style="color: #35a69c; font-style: italic;">Lisp variable documentation, and if that fails then we look up</span>
<span style="color: #35a69c; font-style: italic;">the word in the English dictionary.</span>

<span style="color: #35a69c; font-style: italic;">The English definition is obtained from the command line tool &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">wn</span><span style="color: #35a69c; font-style: italic;">&#8217;, WordNet."</span>)
</pre>
</div>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation matter for user libraries
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">o-docs-libraries</span> nil
  <span style="color: #35a69c; font-style: italic;">"List of Org files that have &#8216;#+begin_documentation&#8217; blocks that should be loaded</span>
<span style="color: #35a69c; font-style: italic;">   for use with the &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">doc:&#119987;</span><span style="color: #35a69c; font-style: italic;">&#8217; link type."</span>)
</pre>
</div>

<p>
In your init, you could do the following. ( See the installation instructions
below, for more! )
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org4cf680f">(<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">o-docs-libraries</span>
  '(<span style="color: #2aa198;">"~/org-special-block-extras/documentation.org"</span>))
</pre>
</div>

<p>
My personal documentation library can be seen here:
<a href="https://alhassy.github.io/org-special-block-extras/documentation.org.html"><img src="https://img.shields.io/badge/Htmlized-Org-green?logo=nil"></a>
or
<a href="https://alhassy.github.io/org-special-block-extras/documentation.html"><img src="https://img.shields.io/badge/Pretty-HTML-green?logo=nil"></a>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">cl-defun</span> <span style="color: #b58900;">o-docs-load-libraries</span>
    (<span style="color: #b58900; font-style: italic;">&amp;optional</span> (libs <span style="color: #268bd2;">o-docs-libraries</span>))
<span style="color: #35a69c; font-style: italic;">"Load documentation-glossary libraries LIBS.</span>

<span style="color: #35a69c; font-style: italic;">If no LIBS are provided, simply use those declared</span>
<span style="color: #35a69c; font-style: italic;">o-docs-libraries.</span>

<span style="color: #35a69c; font-style: italic;">See `</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">o-docs-from-libraries</span><span style="color: #35a69c; font-style: italic;">'."</span>
(<span style="color: #859900; font-weight: bold;">interactive</span>)
(<span style="color: #859900; font-weight: bold;">cl-loop</span> for lib in libs
      <span style="color: #b58900;">do</span> (<span style="color: #859900; font-weight: bold;">with-temp-buffer</span>
           (<span style="color: #b58900;">insert-file-contents</span> lib)
           <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">doc only activates after an export</span>
           (<span style="color: #859900; font-weight: bold;">-let</span> [<span style="color: #268bd2;">org-export-with-broken-links</span> <span style="color: #268bd2;">t</span>] (<span style="color: #b58900;">org-html-export-as-html</span>))
           (<span style="color: #b58900;">kill-buffer</span>)
           (<span style="color: #b58900;">delete-window</span>)
           (<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">o--docs-from-libraries</span> (<span style="color: #b58900;">-concat</span> <span style="color: #268bd2;">o--docs</span> <span style="color: #268bd2;">o--docs-from-libraries</span>))
           (<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">o--docs</span> nil))))

(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">o--docs-from-libraries</span> nil

  <span style="color: #35a69c; font-style: italic;">"The alist of (label name description) entries loaded from the libraries.</span>

<span style="color: #35a69c; font-style: italic;">The &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">doc:&#119987;</span><span style="color: #35a69c; font-style: italic;">&#8217; link will load the libraries, possibly setting this variable to &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">nil</span><span style="color: #35a69c; font-style: italic;">&#8217;,</span>
<span style="color: #35a69c; font-style: italic;">then make use of this variable when looking for documentation strings.</span>

<span style="color: #35a69c; font-style: italic;">Interactively call `</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">o-docs-load-libraries</span><span style="color: #35a69c; font-style: italic;">'</span>
<span style="color: #35a69c; font-style: italic;">to force your documentation libraries to be reloaded.</span>

<span style="color: #35a69c; font-style: italic;">See also `</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">o-docs-libraries</span><span style="color: #35a69c; font-style: italic;">'."</span>)
</pre>
</div>

<p>
When the mode is actually enabled, then we load the user's libraries.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Ensure user's documentation libraries have loaded</span>
(<span style="color: #859900; font-weight: bold;">unless</span> <span style="color: #268bd2;">o--docs-from-libraries</span>
  (<span style="color: #b58900;">o-docs-load-libraries</span>))
</pre>
</div>



</details>

<p>
Let's keep track of where documentation comes from &#x2014;either the current article
or from the fallback&#x2014; so that we may process it later on.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">o--docs-actually-used</span> nil
  <span style="color: #35a69c; font-style: italic;">"Which words are actually cited in the current article.</span>

<span style="color: #35a69c; font-style: italic;">We use this listing to actually print a glossary using</span>
<span style="color: #35a69c; font-style: italic;">&#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">show:GLOSSARY</span><span style="color: #35a69c; font-style: italic;">&#8217;."</span>)
</pre>
</div>

<p>
Now HTML exporting such links as tooltips and displaying them in Emacs as
tooltips happens in two stages: First we check the documentation, if there is no
entry, we try the fallback &#x2014;if that falls, an error is reported at export
time. E.g., upon export <code>doc:wombo</code> will produce a no-entry error.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         ‘doc’ link implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orgf30932f">(<span style="color: #859900; font-weight: bold;">o-deflink</span> doc
 <span style="color: #2aa198;">"Export O-LABEL as itself, or as the provided O-DESCRIPTION,</span>
<span style="color: #2aa198;"> along with a tooltip that shows the user's</span>
<span style="color: #2aa198;"> documentation-glossary for o-LABEL and using that entry's name</span>
<span style="color: #2aa198;"> when no O-DESCRIPTION is provided."</span>
 [<span style="color: #d33682; font-style: italic;">:let</span> (entry (<span style="color: #b58900;">o-docs-get</span> o-label)
        name (<span style="color: #b58900;">cl-first</span> entry)
        docs (<span style="color: #b58900;">cl-second</span> entry)
        display-name (<span style="color: #859900; font-weight: bold;">or</span> o-description name))
  <span style="color: #d33682; font-style: italic;">:help-echo</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"[%s] %s :: %s"</span> o-label name docs)
  <span style="color: #d33682; font-style: italic;">:face</span> '(<span style="color: #556b72; background-color: #FDF6E3;">custom-button</span>)]
   (<span style="color: #b58900;">add-to-list</span> '<span style="color: #268bd2;">o--docs-actually-used</span> (<span style="color: #b58900;">list</span> o-label name docs))
   (<span style="color: #859900; font-weight: bold;">pcase</span> o-backend
     (`html  (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;abbr class=\"tooltip\" title=\"%s\"&gt;%s&lt;/abbr&gt;"</span>
                     (<span style="color: #b58900;">o-html-export-preserving-whitespace</span> docs)
                     display-name))
     <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Make the current word refer to its glosary entry;</span>
     <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">also declare the location that the glossary should refer back to.</span>
     (`latex (<span style="color: #b58900;">format</span> (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"\\hyperref"</span>
                             <span style="color: #2aa198;">"[o-glossary-%s]{%s}"</span>
                             <span style="color: #2aa198;">"\\label{o-glossary"</span>
                             <span style="color: #2aa198;">"-declaration-site-%s}"</span>)
                     label display-name label))))

<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">WHERE ...</span>

(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">o-html-export-preserving-whitespace</span> (s)
  <span style="color: #35a69c; font-style: italic;">"Make Org-markup'd string S ready for HTML presentation, preserving whitespace.</span>

<span style="color: #35a69c; font-style: italic;">This is orthogonal to the  `</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">org-export-string-as</span><span style="color: #35a69c; font-style: italic;">' command; i.e.,</span>
<span style="color: #35a69c; font-style: italic;">(org-export-string-as s 'html :body-only-please) does something</span>
<span style="color: #35a69c; font-style: italic;">else!  In particular, what this yields is an HTML rendition that</span>
<span style="color: #35a69c; font-style: italic;">does not account for whitespace, such as indentation and</span>
<span style="color: #35a69c; font-style: italic;">newlines.</span>
<span style="color: #35a69c; font-style: italic;">"</span>
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Make it look pretty!</span>
  (<span style="color: #859900; font-weight: bold;">thread-last</span> s
    (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"\\#\\+begin_src [</span><span style="color: #268bd2; font-weight: bold;">^</span><span style="color: #2aa198;">\n]*\n"</span> <span style="color: #2aa198;">"&lt;pre class='tooltip'&gt;"</span>)
    (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">(</span><span style="color: #2aa198;"> </span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">)</span><span style="color: #2aa198;">*\\#\\+end_src\n"</span> <span style="color: #2aa198;">"&lt;/pre&gt;"</span>)
    (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"\\#\\+begin_export [</span><span style="color: #268bd2; font-weight: bold;">^</span><span style="color: #2aa198;">\n]*\n"</span> <span style="color: #2aa198;">""</span>)
    (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">(</span><span style="color: #2aa198;"> </span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">)</span><span style="color: #2aa198;">*\\#\\+end_export"</span> <span style="color: #2aa198;">""</span>)
    (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"  "</span> <span style="color: #2aa198;">"&amp;emsp;"</span>) <span style="color: #96A7A9; font-style: italic;">; </span><span style="color: #96A7A9; font-style: italic;">Preserve newlines</span>
    (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"\n"</span> <span style="color: #2aa198;">"&lt;br&gt;"</span>)   <span style="color: #96A7A9; font-style: italic;">; </span><span style="color: #96A7A9; font-style: italic;">Preserve whitespace</span>
    (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"\\#\\+begin_example&lt;br&gt;"</span> <span style="color: #2aa198;">""</span>)
    (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"\\#\\+end_example&lt;br&gt;"</span> <span style="color: #2aa198;">""</span>)
    <span style="color: #96A7A9; font-style: italic;">; </span><span style="color: #96A7A9; font-style: italic;">(s-replace-regexp "\\#\\+begin_src \\(.\\)*\\#\\+end_src)" "&lt;pre&gt;\1&lt;/pre&gt;")</span>
    <span style="color: #96A7A9; font-style: italic;">; </span><span style="color: #96A7A9; font-style: italic;">(s-replace-regexp "\\#\\+begin_src [</span><span style="color: #268bd2; font-weight: bold; font-style: italic;">^</span><span style="color: #96A7A9; font-style: italic;">&lt;]*&lt;br&gt;" "&lt;pre&gt;")</span>
    <span style="color: #96A7A9; font-style: italic;">; </span><span style="color: #96A7A9; font-style: italic;">(s-replace-regexp "&lt;br&gt;\\( \\)*\\#\\+end_src&lt;br&gt;" "&lt;br&gt;\1&lt;/pre&gt;")</span>
    <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Translate Org markup</span>
    <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Only replace /.*/ by &lt;em&gt;.*&lt;em&gt; when it does not have an alphanum,:,/,&lt; before it.</span>
    (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">(</span><span style="color: #2aa198;">[</span><span style="color: #268bd2; font-weight: bold;">^</span><span style="color: #2aa198;">a-z0-9A-Z:/&lt;]</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">)</span><span style="color: #2aa198;">/</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">(</span><span style="color: #2aa198;">.+?</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">)</span><span style="color: #2aa198;">/"</span> <span style="color: #2aa198;">"\\1&lt;em&gt;\\2&lt;/em&gt;"</span>)
    (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"\\*</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">(</span><span style="color: #2aa198;">.+?</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">)</span><span style="color: #2aa198;">\\*"</span> <span style="color: #2aa198;">"&lt;strong&gt;\\1&lt;/strong&gt;"</span>)
    (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"\\~</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">(</span><span style="color: #2aa198;">[</span><span style="color: #268bd2; font-weight: bold;">^</span><span style="color: #2aa198;"> ].*?</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">)</span><span style="color: #2aa198;">\\~"</span> <span style="color: #2aa198;">"&lt;code&gt;\\1&lt;/code&gt;"</span>)
    <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">No, sometimes we want equalities.</span>
    <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">(s-replace-regexp "=\\([</span><span style="color: #268bd2; font-weight: bold; font-style: italic;">^</span><span style="color: #96A7A9; font-style: italic;"> \n].*?\\)=" "&lt;code&gt;\\1&lt;/code&gt;")</span>
    (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"\\$</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">(</span><span style="color: #2aa198;">.+?</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">)</span><span style="color: #2aa198;">\\$"</span> <span style="color: #2aa198;">"&lt;em&gt;\\1&lt;/em&gt;"</span>)
    (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"\\[\\[</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">(</span><span style="color: #2aa198;">.*</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">)</span><span style="color: #2aa198;">\\]\\[</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">(</span><span style="color: #2aa198;">.*</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">)</span><span style="color: #2aa198;">\\]\\]"</span> <span style="color: #2aa198;">"\\2 (\\1)"</span>)
    <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">5+ dashes result in a horizontal line</span>
    (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"-----+"</span> <span style="color: #2aa198;">"&lt;hr&gt;"</span>)
    <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Spacing in math mode</span>
    (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"\\\\quad"</span> <span style="color: #2aa198;">"&amp;#x2000;"</span>)
    (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"\\\\,"</span> <span style="color: #2aa198;">"&amp;#8194;"</span>) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">en space</span>
    (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"\\\\;"</span> <span style="color: #2aa198;">"&amp;#8195;"</span>) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">em space</span>
    <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The presence of &#8216;\"&#8217; in tooltips breaks things, so omit them.</span>
    (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"\\\""</span> <span style="color: #2aa198;">"''"</span>)))
</pre>
</div>

<p>
Since tooltips are not clickable and do not support MathJax,
we have manually transpiled what are perhaps the most common
instances of Org-markup: Bold, emphasises, code/verbatim, math, and links.
</p>


</details>

<p>
Things look great at the HTML side and on the Emacs side for <b>consuming</b>
documented text.  Besides being inconvenient, we cannot with good conscious
force the average user to write Lisp as we did for the <code>doc:cat</code> entry. We turn to
the problem of <b>producing</b> documentation entries with a block type interface&#x2026;
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         ‘documentation’ Implementation: An Example of Mandatory Arguments and Using ‘raw-contents’
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-defblock</span> <span style="color: #b58900;">documentation</span>
  (name (<span style="color: #b58900;">error</span> <span style="color: #2aa198;">"Documentation block: Name must be provided"</span>))
  (label nil show nil color <span style="color: #2aa198;">"green"</span>)
  <span style="color: #2aa198;">"Register the dictionary entries in CONTENTS to the dictionary variable.</span>

<span style="color: #2aa198;">The dictionary variable is &#8216;</span><span style="color: #6c71c4; font-weight: bold;">o--docs</span><span style="color: #2aa198;">&#8217;.</span>

<span style="color: #2aa198;">A documentation entry may have its LABEL, its primary identifier,</span>
<span style="color: #2aa198;">be:</span>
<span style="color: #2aa198;">1. Omitted</span>
<span style="color: #2aa198;">2. Given as a single symbol</span>
<span style="color: #2aa198;">3. Given as a many aliases '(lbl&#8320; lbl&#8321; &#8230; lbl&#8345;)</span>

<span style="color: #2aa198;">The third case is for when there is no canonical label to refer to</span>
<span style="color: #2aa198;">an entry, or it is convenient to use multiple labels for the same</span>
<span style="color: #2aa198;">entry.</span>

<span style="color: #2aa198;">In all of the above cases, two additional labels are included:</span>
<span style="color: #2aa198;">The entry name with spaces replaced by underscores, and again but</span>
<span style="color: #2aa198;">all lower case.</span>

<span style="color: #2aa198;">Documentation blocks are not shown upon export;</span>
<span style="color: #2aa198;">unless SHOW is non-nil, in which case they are shown</span>
<span style="color: #2aa198;">using the &#8216;</span><span style="color: #6c71c4; font-weight: bold;">box</span><span style="color: #2aa198;">&#8217; block, with the provided COLOR passed to it.</span>

<span style="color: #2aa198;">In the futture, it may be nice to have an option to render tooltips.</span>
<span style="color: #2aa198;">That'd require the &#8216;</span><span style="color: #6c71c4; font-weight: bold;">doc:&#119987;</span><span style="color: #2aa198;">&#8217; link construction be refactored via a &#8216;</span><span style="color: #6c71c4; font-weight: bold;">defun</span><span style="color: #2aa198;">&#8217;."</span>
  (<span style="color: #859900; font-weight: bold;">unless</span> (<span style="color: #b58900;">consp</span> label) (<span style="color: #859900; font-weight: bold;">setq</span> label (<span style="color: #b58900;">list</span> label)))
  (<span style="color: #859900; font-weight: bold;">push</span> (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">" "</span> <span style="color: #2aa198;">"_"</span> name) label)
  (<span style="color: #859900; font-weight: bold;">push</span> (<span style="color: #b58900;">downcase</span> (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">" "</span> <span style="color: #2aa198;">"_"</span> name)) label)
  (<span style="color: #859900; font-weight: bold;">cl-loop</span> for l in label
        <span style="color: #b58900;">do</span>  (<span style="color: #b58900;">add-to-list</span> '<span style="color: #268bd2;">o--docs</span>
                         (<span style="color: #b58900;">mapcar</span> #'<span style="color: #b58900;">s-trim</span> (<span style="color: #b58900;">list</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s"</span> l) name (<span style="color: #b58900;">substring-no-properties</span> raw-contents)))))
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Should the special block show something upon export?</span>
  (<span style="color: #859900; font-weight: bold;">if</span> show (<span style="color: #859900; font-weight: bold;">o--blockcall</span> box name <span style="color: #d33682; font-style: italic;">:background-color</span> color raw-contents) <span style="color: #2aa198;">""</span>))
</pre>
</div>



</details>

<p>
Thus far, Org entities are converted into HTML tags such as <code>&lt;i&gt;</code> for italicised
text. However, HTML's default tooltip utility &#x2014;using <code>title="⋯"</code> in a <code>div</code>&#x2014;
does not render arbitrary HTML elements. Moreover, the default tooltip utility
is rather slow. As such, we move to using <i>tooltipster</i>.  The incantation below
sets up the required magic to make this happen.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Fast, Sleek, and Beautiful Tooltips: Touching ‘org-html-head-extra’
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">o--tooltip-html-setup</span> nil
  <span style="color: #35a69c; font-style: italic;">"Has the necessary HTML beeen added?"</span>)

(<span style="color: #859900; font-weight: bold;">unless</span> <span style="color: #268bd2;">o--tooltip-html-setup</span>
  (<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">o--tooltip-html-setup</span> <span style="color: #268bd2;">t</span>)
(<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">org-html-head-extra</span>
 (<span style="color: #b58900;">concat</span> <span style="color: #268bd2;">org-html-head-extra</span>
<span style="color: #2aa198;">"</span>
<span style="color: #2aa198;">&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css\"/&gt;</span>

<span style="color: #2aa198;">&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css\" /&gt;</span>

<span style="color: #2aa198;">&lt;script type=\"text/javascript\"&gt;</span>
<span style="color: #2aa198;">    if (typeof jQuery == 'undefined') {</span>
<span style="color: #2aa198;">        document.write(unescape('%3Cscript src=\"https://code.jquery.com/jquery-1.10.0.min.js\"%3E%3C/script%3E'));</span>
<span style="color: #2aa198;">    }</span>
<span style="color: #2aa198;">&lt;/script&gt;</span>

<span style="color: #2aa198;"> &lt;script type=\"text/javascript\"            src=\"https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js\"&gt;&lt;/script&gt;</span>

<span style="color: #2aa198;">  &lt;script&gt;</span>
<span style="color: #2aa198;">         $(document).ready(function() {</span>
<span style="color: #2aa198;">             $('.tooltip').tooltipster({</span>
<span style="color: #2aa198;">                 theme: 'tooltipster-punk',</span>
<span style="color: #2aa198;">                 contentAsHTML: true,</span>
<span style="color: #2aa198;">                 animation: 'grow',</span>
<span style="color: #2aa198;">                 delay: [100,500],</span>
<span style="color: #2aa198;">                 // trigger: 'click'</span>
<span style="color: #2aa198;">                 trigger: 'custom',</span>
<span style="color: #2aa198;">                 triggerOpen: {</span>
<span style="color: #2aa198;">                     mouseenter: true</span>
<span style="color: #2aa198;">                 },</span>
<span style="color: #2aa198;">                 triggerClose: {</span>
<span style="color: #2aa198;">                     originClick: true,</span>
<span style="color: #2aa198;">                     scroll: true</span>
<span style="color: #2aa198;">                 }</span>
<span style="color: #2aa198;"> });</span>
<span style="color: #2aa198;">         });</span>
<span style="color: #2aa198;">     &lt;/script&gt;</span>

<span style="color: #2aa198;">&lt;style&gt;</span>
<span style="color: #2aa198;">   abbr {color: red;}</span>

<span style="color: #2aa198;">   .tooltip { border-bottom: 1px dotted #000;</span>
<span style="color: #2aa198;">              color:red;</span>
<span style="color: #2aa198;">              text-decoration: none;}</span>
<span style="color: #2aa198;">&lt;/style&gt;</span>
<span style="color: #2aa198;">"</span>)))
</pre>
</div>

<p>
Note that we have a conditional in the middle to avoid loading jQuery multiple
times &#x2014;e.g., when one uses the <code>read-the-org</code> them in combination with this
library. Multiple imports lead to broken features.
</p>


</details>
</div>
</div>

<div id="outline-container-hola" class="outline-3">
<h3 id="hola"><span class="section-number-3">9.2</span> <a href="#hola">Wait, what about the LaTeX?</a></h3>
<div class="outline-text-3" id="text-hola">
<p>
A PDF is essentially a fancy piece of paper, so tooltips will take on the
form of glossary entries: Using <code>doc:𝒳</code> will result in the word <code>𝒳</code> being printed
as a hyperlink to a glossary entry, which you the user will eventually
declare using <code>show:GLOSSARY</code>; moreover, the glossary entry will also have a
link back to where the <code>doc:𝒳</code> was declared.  E.g., <abbr class="tooltip" title="Define NAME as a macro.<br>When the macro is called, as in (NAME ARGS...),<br>the function (lambda ARGLIST BODY...) is applied to<br>the list ARGS... as it appears in the expression,<br>and the result should be a form to be evaluated instead of the original.<br>DECL is a declaration, optional, of the form (declare DECLS...) where<br>DECLS is a list of elements of the form (PROP . VALUES).&emsp;These are<br>interpreted according to ‘macro-declarations-alist’.<br>The return value is undefined.<br><br>(fn NAME ARGLIST &optional DOCSTRING DECL &rest BODY)">defmacro</abbr> and
<abbr class="tooltip" title="Return an anonymous function.<br>Under dynamic binding, a call of the form (lambda ARGS DOCSTRING<br>INTERACTIVE BODY) is self-quoting; the result of evaluating the<br>lambda expression is the expression itself.&emsp;Under lexical<br>binding, the result is a closure.&emsp;Regardless, the result is a<br>function, i.e., it may be stored as the function value of a<br>symbol, passed to ‘funcall’ or ‘mapcar’, etc.<br><br>ARGS should take the same form as an argument list for a ‘defun’.<br>DOCSTRING is an optional documentation string.<br> If present, it should describe how to call the function.<br> But documentation strings are usually not useful in nameless functions.<br>INTERACTIVE should be a call to the function ‘interactive’, which see.<br>It may also be omitted.<br>BODY should be a list of Lisp expressions.<br><br>(fn ARGS [DOCSTRING] [INTERACTIVE] BODY)">lambda</abbr>.
</p>

<p>
We make a <code>show:𝒳</code> link type to print the value of the variable <code>𝒳</code>
as follows, with <code>GLOSSARY</code> being a reserved name.
</p>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation of ‘show’
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-deflink</span> show
  <span style="color: #2aa198;">"Yield the value of the expression O-LABEL, with =GLOSSARY= being a reserved name.</span>

<span style="color: #2aa198;">Example uses:</span>

<span style="color: #2aa198;">    show:user-full-name</span>

<span style="color: #2aa198;">    &lt;show: (* 2 (+ 3 4 (- pi))) &gt;</span>


<span style="color: #2aa198;">Note that there is `</span><span style="color: #6c71c4; font-weight: bold;">elisp</span><span style="color: #2aa198;">' links with Emacs, out of the box.</span>
<span style="color: #2aa198;">However, they only serve to evaluate Lisp expressions; for example,</span>
<span style="color: #2aa198;">to make &#8220;link buttons&#8221; that do useful things, as follows.</span>

<span style="color: #2aa198;">   [[elisp:(find-file user-init-file)][Init]]</span>

<span style="color: #2aa198;">In particular, `</span><span style="color: #6c71c4; font-weight: bold;">elisp</span><span style="color: #2aa198;">' links do not export the value of their expression.</span>
<span style="color: #2aa198;">That is what we accomplish with this new `</span><span style="color: #6c71c4; font-weight: bold;">show</span><span style="color: #2aa198;">' link type."</span>
  [<span style="color: #d33682; font-style: italic;">:face</span> '(<span style="color: #d33682; font-style: italic;">:underline</span> <span style="color: #2aa198;">"green"</span>)
   <span style="color: #d33682; font-style: italic;">:let</span> (o-value (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">equal</span> o-label <span style="color: #2aa198;">"GLOSSARY"</span>)
                     (<span style="color: #b58900;">pp-to-string</span> (<span style="color: #b58900;">mapcar</span> #'<span style="color: #b58900;">cl-second</span> <span style="color: #268bd2;">o--docs-actually-used</span>))
                   (<span style="color: #b58900;">pp-to-string</span> (<span style="color: #b58900;">eval</span> (<span style="color: #b58900;">car</span> (<span style="color: #b58900;">read-from-string</span> o-label)))))
         o-expr (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">equal</span> o-label <span style="color: #2aa198;">"GLOSSARY"</span>)
                    (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"GLOSSARY ---i.e., o--docs-actually-used"</span>
                            <span style="color: #2aa198;">"\n\nWe erase the glossary not on the first export, but on the second export."</span>
                            <span style="color: #2aa198;">"\nThe first export collects all citations, which are used in the second export."</span>)
                  o-label))
  <span style="color: #d33682; font-style: italic;">:help-echo</span> (<span style="color: #b58900;">format</span>
              (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"Upon export, the following will be placed literally"</span>
                      <span style="color: #2aa198;">"\n\t%s"</span>
                      <span style="color: #2aa198;">"\nWhich is the value of the expression:\n\t%s"</span>)
              o-value
              o-expr)]
  (<span style="color: #859900; font-weight: bold;">cond</span> ((<span style="color: #b58900;">not</span> (<span style="color: #b58900;">equal</span> o-label <span style="color: #2aa198;">"GLOSSARY"</span>)) o-value)

       <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Otherwise O-LABEL is glossary, which we print in HTML &amp; LaTeX</span>
       ((<span style="color: #b58900;">equal</span> 'html o-backend)
          (<span style="color: #b58900;">s-join</span> <span style="color: #2aa198;">" "</span>
                  (<span style="color: #859900; font-weight: bold;">--map</span>
                   (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;abbr class=\"tooltip\" title=\"%s\"&gt;%s&lt;/abbr&gt;"</span>
                           (<span style="color: #b58900;">o-html-export-preserving-whitespace</span> (<span style="color: #b58900;">cl-third</span> it))
                           (<span style="color: #b58900;">cl-second</span> it))
                   <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Ignore duplicates; i.e., entries with the same name/title.</span>
                   (<span style="color: #b58900;">cl-remove-duplicates</span> <span style="color: #268bd2;">o--docs-actually-used</span>
                                         <span style="color: #d33682; font-style: italic;">:test</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (x y) (<span style="color: #b58900;">cl-equalp</span> (<span style="color: #b58900;">cl-second</span> x) (<span style="color: #b58900;">cl-second</span> y)))))))
       (<span style="color: #268bd2;">t</span> (<span style="color: #b58900;">s-join</span> <span style="color: #2aa198;">"\n\n"</span>
                  (<span style="color: #859900; font-weight: bold;">cl-loop</span> for (label name doc)
                           in <span style="color: #268bd2;">o--docs-actually-used</span>
                           collect
                           (<span style="color: #b58900;">format</span>
                           (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"\\vspace{1em}\\phantomsection"</span>
                                   <span style="color: #2aa198;">"\\textbf{%s}\\quad"</span>
                                   <span style="color: #2aa198;">"\\label{o-glossary-%s}"</span>
                                   <span style="color: #2aa198;">"%s See page "</span>
                                   <span style="color: #2aa198;">"\\pageref{org-special-block-extras"</span>
                                   <span style="color: #2aa198;">"-glossary-declaration-site-%s}"</span>)
                           name
                           o-label
                           (<span style="color: #859900; font-weight: bold;">when</span> doc
                             (<span style="color: #859900; font-weight: bold;">thread-last</span> doc <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">preserve whitespace</span>
                               (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"&amp;"</span> <span style="color: #2aa198;">"\\&amp;"</span>) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Hack!</span>
                               (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"  "</span> <span style="color: #2aa198;">" \\quad "</span>)
                               (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"\n"</span> <span style="color: #2aa198;">" \\newline{\\color{white}.}"</span>)))
                           o-label))))))
</pre>
</div>


</details>

<p>
As an example, we know have generic sentences:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left"><code>My name is show:user-full-name and I am using Emacs show:emacs-version ^_^</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">My name is "Musa Al-hassy" and I am using Emacs "27.2" ^_^</td>
</tr>
</tbody>
</table>

<p>
For example, here is a word whose documentation is obtained from Emacs rather
than me writing it: <abbr class="tooltip" title="Thread FORMS elements as the last argument of their successor.<br>Example:<br>&emsp;&emsp;(thread-last<br>&emsp;&emsp;&emsp;5<br>&emsp;&emsp;&emsp;(+ 20)<br>&emsp;&emsp;&emsp;(<em> 25)<br>&emsp;&emsp;&emsp;-<br>&emsp;&emsp;&emsp;(+ 40))<br>Is equivalent to:<br>&emsp;&emsp;(+ 40 (- (</em> 25 (+ 20 5))))<br>Note how the single ‘-’ got converted into a list before<br>threading.<br><br>(fn &rest FORMS)">thread-last</abbr>.  If you click on it, in the LaTeX output,
you will be directed to the glossary at the end of this article &#x2014;glossaries
are not printed in HTML rendering.
</p>

<p>
<i>Neato! The whitespace in the documentation is preserved in the LaTeX output as
is the case for HTML.</i>
</p>

<p>
If we decide to erase a <code>doc:𝒳</code>, then it should not longer appear in the
printed glossary listing. Likewise, a <code>documentation</code> block has its Org markup
exported according to the backend being exported to, hence if we decide to
switch between different backends then only the first rendition will be used
<i>unless</i> we erase the database each time after export.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">o--docs-empty!</span> (<span style="color: #b58900;">list</span> nil <span style="color: #268bd2;">t</span>)
  <span style="color: #35a69c; font-style: italic;">"An indicator of when glossary entries should be erased.</span>

<span style="color: #35a69c; font-style: italic;">We erase the glossary not on the first export, but on the second export.</span>
<span style="color: #35a69c; font-style: italic;">The first export collects all citations, which are used in the second export."</span>)
(<span style="color: #b58900;">setcdr</span> (<span style="color: #b58900;">last</span> <span style="color: #268bd2;">o--docs-empty!</span>) <span style="color: #268bd2;">o--docs-empty!</span>) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">It's an infinite cyclic list.</span>

<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Actual used glossary entries depends on the buffer; so clean up after each export</span>
(<span style="color: #b58900;">advice-add</span> #'<span style="color: #b58900;">org-export-dispatch</span>
  <span style="color: #d33682; font-style: italic;">:after</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (<span style="color: #b58900; font-style: italic;">&amp;rest</span> _)
  (<span style="color: #859900; font-weight: bold;">when</span> (<span style="color: #859900; font-weight: bold;">pop</span> <span style="color: #268bd2;">o--docs-empty!</span>)
      (<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">o--docs-actually-used</span> nil <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The &#119987; of each &#8220;doc:&#119987;&#8221; that appears in the current buffer.</span>
            <span style="color: #268bd2;">o--docs</span> nil))))           <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The &#8220;#+begin_documentation &#8943; :label &#119987;&#8221; of the current buffer.</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-Next-Steps-tooltips" class="outline-3">
<h3 id="Next-Steps-tooltips"><span class="section-number-3">9.3</span> <a href="#Next-Steps-tooltips">Next Steps</a></h3>
<div class="outline-text-3" id="text-Next-Steps-tooltips">
<p>
Going forward, it'd be nice to have URLs work well upon export for <code>documentation</code>
block types; whereas they currently break the HTML export.
</p>
<ul class="org-ul">
<li>If an entry is referenced multiple times, such as <abbr class="tooltip" title="A theory of typed composition; e.g., typed monoids.">Category Theory</abbr>, then it would be
nice if the glossary referred to the pages of all such locations rather than
just the final one.</li>
<li>The glossary current prints in order of appearance; we may want to have
the option to print it in a sorted fashion.</li>
<li>Perhaps use the line activation feature to provide link tooltips
immediately rather than rely on exportation.</li>
<li><del>The <code>show</code> link type could accept an arbitrary Lisp expression as a bracketed
link.</del> It does ;-)</li>
<li>When one clicks on a <code>doc</code> documentation link, it would be nice to ‘jump’
to its associated <code>#+begin_documentation</code> declaration block in the current
buffer, if possible.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-Marginal-one-off-remarks" class="outline-2">
<h2 id="Marginal-one-off-remarks"><span class="section-number-2">10</span> <a href="#Marginal-one-off-remarks">Marginal, “one-off”, remarks</a></h2>
<div class="outline-text-2" id="text-Marginal-one-off-remarks">
<div class="tiny" id="orge15cfa0">
<div class="org-center">
<p>
<i>(Scroll to make tooltips disappear!)</i>
</p>
</div>

</div>

<p>
The use of <code>doc:𝒳</code> &#x2014; and <abbr class="tooltip" title="Register the dictionary entries in CONTENTS to the dictionary variable.<br><br>The dictionary variable is ‘o--docs’.<br><br>A documentation entry may have its LABEL, its primary identifier,<br>be:<br>1. Omitted<br>2. Given as a single symbol<br>3. Given as a many aliases ’(lbl₀ lbl₁ … lblₙ)<br><br>The third case is for when there is no canonical label to refer to<br>an entry, or it is convenient to use multiple labels for the same<br>entry.<br><br>In all of the above cases, two additional labels are included:<br>The entry name with spaces replaced by underscores, and again but<br>all lower case.<br><br>Documentation blocks are not shown upon export;<br>unless SHOW is non-nil, in which case they are shown<br>using the ‘box’ block, with the provided COLOR passed to it.<br><br>In the futture, it may be nice to have an option to render tooltips.<br>That’d require the ‘doc:𝒳’ link construction be refactored via a ‘defun’.<br><br>(fn BACKEND RAW-CONTENTS &optional NAME &rest ## &key (O-LINK\? nil) (LABEL nil) (SHOW nil) (COLOR ''green''))">documentation</abbr> &#x2014; are for explanatory remarks, personal
documentation, or glossary, that is intended to be used in multiple places.
However, sometimes we want a “one-off” remark containing, say, references or
additional explanation; for that we provide <abbr class="tooltip" title="Produce an HTML tooltip or a LaTeX margin note.<br><br>The ‘margin’ block is intended for “one-off” (mostly optional) remarks.<br><br>For notes that you want to use repeatedly, in multiple articles<br>or in multiple locations in the same article, consider using<br>‘documentation’ to declare them and ‘doc’ to invoke them.<br><br>For LaTeX, place ‘#+resize:’ to have the remainder of a block be<br>resized, for now 1.3 the margin width ---requires \usepackage{adjustbox}.<br><br><hr><br><br>WIDTH, COUNTER, and COLOR are LaTeX specfic.<br><br>When no label, marker, is used for a marginal note, we rely<br>on a COUNTER, such as ‘footnote’ (default) or ‘sidenote.’<br>Since HTML has no margin per se, we use “∘” as default marker:<br>Users hover over it to read the marginal note.<br><br>Marginal notes have their labels, markers, in black<br>and the notes themselves have COLOR being grey!80.<br>In Emacs, margin links appear grey with an orange tinted boarder.<br><br>Regarding LaTeX, since verbatim environments do not in general work well<br>as arguments to other commands, such as ‘\marginpar’, we save the contents<br>of the special block in a ‘minipage’ within a LaTeX ‘box’; then we can unfold such<br>a box in the margin. Hence, ‘src’ blocks can appear within ‘margin’ blocks (•̀ᴗ•́)و<br><br>The WIDTH argument is the width of the margin; i.e., the width of the underlying<br>minipage.<br><br>One could use \maxsizebox{.25\textwidth}{\textheight}{ ... }<br>which only resizes the content if its natural size is larger than<br>the given 〈width〉 or 〈height〉.&emsp;We don’t use this, since<br>maxsizebox does not natively allow linebreaks<br>(e.g., one would wrap contents in a tabular environment then use<br>‘\\’, two backslashes, to request a line break; but this<br>crashes if one wants to also use verbatim environments.)<br><br>In LaTeX, it may be useful to invoke ‘\dotfill’.<br><br>(fn BACKEND RAW-CONTENTS &optional MARKER &rest ## &key (O-LINK\? nil) (COLOR ''gray!80'') (COUNTER ''footnote'') (WIDTH ''\\paperwidth - \\textwidth - \\oddsidemargin - 1in - 3ex''))">margin</abbr>. For example:
</p>
<blockquote>
<p>
<i>Allah<abbr class="tooltip" title="The God of Abraham; known as Elohim in the Bible">°</abbr>&emsp13; does not
burden a soul beyond what it can bear.</i> &#x2014; Quran 2:286
</p>

<hr />
<p>
<b>Source:</b>
</p>
<div class="org-src-container">
<pre class="src src-org">/Allah[[margin:][The God of Abraham; known as Elohim in the Bible]] does not
burden a soul beyond what it can bear./ --- Quran 2:286
</pre>
</div>
</blockquote>

<p>
In HTML, such “marginal remarks” appear as tooltips;
in LaTeX, they appear in the margin.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Tests
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">setq</span> margin (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"/Allah[[margin:][The God of Abraham; known as Elohim</span>
<span style="color: #2aa198;">               in the Bible]] does not burden a soul beyond what it can bear./</span>
<span style="color: #2aa198;">               --- Quran 2:286"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It exports into an &lt;abbr&gt; tooltip"</span>
  [margin]
  (&#8669; margin <span style="color: #2aa198;">"&lt;abbr class=\"tooltip\""</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It mentions the margin link's key before the tooltip"</span>
  [margin]
  (&#8669; margin <span style="color: #2aa198;">"Allah&lt;abbr class=\"tooltip\""</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"Our personalised marginal remark appears in an &lt;abbr&gt; title"</span>
  [margin]
  (&#8669; margin <span style="color: #2aa198;">"title=\"The God of Abraham; known as Elohim"</span>
            <span style="color: #2aa198;">"&lt;br&gt;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp; in the Bible\"&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"The marginal remark appears in a tiny circle"</span>
  [margin]
  (&#8669; margin <span style="color: #2aa198;">"&lt;abbr"</span> (<span style="color: #b58900;">*</span> anything) <span style="color: #2aa198;">"&#176;&lt;/abbr&gt;"</span>))
</pre>
</div>


</details>

<hr />

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="pink">
                         Implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-defblock</span> margin
  (marker nil
          <span style="color: #d33682; font-style: italic;">:display</span> 'full
          <span style="color: #d33682; font-style: italic;">:face</span> '(<span style="color: #d33682; font-style: italic;">:foreground</span> <span style="color: #2aa198;">"grey"</span> <span style="color: #d33682; font-style: italic;">:weight</span> <span style="color: #b58900;">bold</span>
          <span style="color: #d33682; font-style: italic;">:underline</span> <span style="color: #2aa198;">"orange"</span> <span style="color: #d33682; font-style: italic;">:overline</span> <span style="color: #2aa198;">"orange"</span>))
  (color <span style="color: #2aa198;">"gray!80"</span>
          counter <span style="color: #2aa198;">"footnote"</span>
          width <span style="color: #2aa198;">"\\paperwidth - \\textwidth - \\oddsidemargin - 1in - 3ex"</span>)
          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Width: https://tex.stackexchange.com/a/101861/69371</span>
  <span style="color: #d33682; font-style: italic;">:please-inline__no-extra-newlines__k-thx-bye!</span>
  <span style="color: #2aa198;">"Produce an HTML tooltip or a LaTeX margin note.</span>

<span style="color: #2aa198;">The &#8216;</span><span style="color: #6c71c4; font-weight: bold;">margin</span><span style="color: #2aa198;">&#8217; block is intended for &#8220;one-off&#8221; (mostly optional) remarks.</span>

<span style="color: #2aa198;">For notes that you want to use repeatedly, in multiple articles</span>
<span style="color: #2aa198;">or in multiple locations in the same article, consider using</span>
<span style="color: #2aa198;">&#8216;</span><span style="color: #6c71c4; font-weight: bold;">documentation</span><span style="color: #2aa198;">&#8217; to declare them and &#8216;</span><span style="color: #6c71c4; font-weight: bold;">doc</span><span style="color: #2aa198;">&#8217; to invoke them.</span>

<span style="color: #2aa198;">For LaTeX, place &#8216;#+resize:&#8217; to have the remainder of a block be</span>
<span style="color: #2aa198;">resized, for now 1.3 the margin width ---requires \\usepackage{adjustbox}.</span>

<span style="color: #2aa198;">----------------------------------------------------------------------</span>

<span style="color: #2aa198;">WIDTH, COUNTER, and COLOR are LaTeX specfic.</span>

<span style="color: #2aa198;">When no label, marker, is used for a marginal note, we rely</span>
<span style="color: #2aa198;">on a COUNTER, such as &#8216;</span><span style="color: #6c71c4; font-weight: bold;">footnote</span><span style="color: #2aa198;">&#8217; (default) or &#8216;</span><span style="color: #6c71c4; font-weight: bold;">sidenote.</span><span style="color: #2aa198;">&#8217;</span>
<span style="color: #2aa198;">Since HTML has no margin per se, we use &#8220;&#8728;&#8221; as default marker:</span>
<span style="color: #2aa198;">Users hover over it to read the marginal note.</span>

<span style="color: #2aa198;">Marginal notes have their labels, markers, in black</span>
<span style="color: #2aa198;">and the notes themselves have COLOR being grey!80.</span>
<span style="color: #2aa198;">In Emacs, margin links appear grey with an orange tinted boarder.</span>

<span style="color: #2aa198;">Regarding LaTeX, since verbatim environments do not in general work well</span>
<span style="color: #2aa198;">as arguments to other commands, such as &#8216;</span><span style="color: #6c71c4; font-weight: bold;">\\marginpar</span><span style="color: #2aa198;">&#8217;, we save the contents</span>
<span style="color: #2aa198;">of the special block in a &#8216;</span><span style="color: #6c71c4; font-weight: bold;">minipage</span><span style="color: #2aa198;">&#8217; within a LaTeX &#8216;</span><span style="color: #6c71c4; font-weight: bold;">box</span><span style="color: #2aa198;">&#8217;; then we can unfold such</span>
<span style="color: #2aa198;">a box in the margin. Hence, &#8216;</span><span style="color: #6c71c4; font-weight: bold;">src</span><span style="color: #2aa198;">&#8217; blocks can appear within &#8216;</span><span style="color: #6c71c4; font-weight: bold;">margin</span><span style="color: #2aa198;">&#8217; blocks (&#8226;&#768;&#7447;&#8226;&#769;)&#1608;</span>

<span style="color: #2aa198;">The WIDTH argument is the width of the margin; i.e., the width of the underlying</span>
<span style="color: #2aa198;">minipage.</span>

<span style="color: #2aa198;">One could use \\maxsizebox{.25\\textwidth}{\\textheight}{ ... }</span>
<span style="color: #2aa198;">which only resizes the content if its natural size is larger than</span>
<span style="color: #2aa198;">the given &#9001;width&#9002; or &#9001;height&#9002;.  We don't use this, since</span>
<span style="color: #2aa198;">maxsizebox does not natively allow linebreaks</span>
<span style="color: #2aa198;">(e.g., one would wrap contents in a tabular environment then use</span>
<span style="color: #2aa198;">&#8216;</span><span style="color: #6c71c4; font-weight: bold;">\\\\</span><span style="color: #2aa198;">&#8217;, two backslashes, to request a line break; but this</span>
<span style="color: #2aa198;">crashes if one wants to also use verbatim environments.)</span>

<span style="color: #2aa198;">In LaTeX, it may be useful to invoke &#8216;</span><span style="color: #6c71c4; font-weight: bold;">\\dotfill</span><span style="color: #2aa198;">&#8217;."</span>
  (<span style="color: #859900; font-weight: bold;">-let</span> [stepcounter (<span style="color: #859900; font-weight: bold;">if</span> marker <span style="color: #2aa198;">""</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"\\stepcounter{%s}"</span> counter))]
    (<span style="color: #859900; font-weight: bold;">pcase</span> backend
      (`latex
       (<span style="color: #859900; font-weight: bold;">setq</span> marker (<span style="color: #859900; font-weight: bold;">or</span> marker (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"{\\the%s}"</span> counter))) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">"\\circ"</span>
       (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"\\!\\!${}^{\\textnormal{%s}}$</span>
<span style="color: #2aa198;">               \\newsavebox{\\OrgSpecialBlockExtrasMarginBox}</span>
<span style="color: #2aa198;">               \\begin{lrbox}{\\OrgSpecialBlockExtrasMarginBox}</span>
<span style="color: #2aa198;">               \\begin{minipage}{%s}</span>
<span style="color: #2aa198;">               \\raggedright \\iffalse Otherwise default alignment is fully justified. \\fi</span>
<span style="color: #2aa198;">               \\footnotesize</span>
<span style="color: #2aa198;">               \\setminted{fontsize=\\footnotesize, breaklines} \\iffalse </span><span style="color: #b1951d;">HACK</span><span style="color: #2aa198;">! \\fi</span>
<span style="color: #2aa198;">               \\color{%s}</span>
<span style="color: #2aa198;">               {\\color{black}${}^{\\textnormal{%s}}$}\n\\normalfont\n %s</span>
<span style="color: #2aa198;">               \\end{minipage}</span>
<span style="color: #2aa198;">               \\end{lrbox}</span>
<span style="color: #2aa198;">               \\marginpar{\\usebox{\\OrgSpecialBlockExtrasMarginBox}%s}</span>
<span style="color: #2aa198;">               \\hspace{-1.9ex}</span>
<span style="color: #2aa198;">               \\global\\let\\OrgSpecialBlockExtrasMarginBox\\relax"</span>
               marker
               width
               color
               marker
               (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">s-contains?</span> <span style="color: #2aa198;">"#+resize:"</span> contents)
                   (<span style="color: #b58900;">s-concat</span>
                    (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"#+resize:"</span>
                               <span style="color: #2aa198;">"#+latex: \\maxsizebox{1.3\\textwidth}{\\textheight}{\\begin{tabular}{l}\n"</span>
                               (<span style="color: #b58900;">s-trim</span> contents))
                    <span style="color: #2aa198;">"\n\\end{tabular}}"</span>)
                 (<span style="color: #b58900;">s-trim</span> contents))
               stepcounter))
      (_ (<span style="color: #859900; font-weight: bold;">setq</span> marker (<span style="color: #859900; font-weight: bold;">or</span> marker <span style="color: #2aa198;">"&#176;"</span>))
         (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;abbr class=\"tooltip\" title=\"%s\"&gt;%s&lt;/abbr&gt;&amp;emsp13;"</span>
                 (<span style="color: #b58900;">o-html-export-preserving-whitespace</span> contents)
                 <span style="color: #96A7A9; font-style: italic;">; </span><span style="color: #96A7A9; font-style: italic;">MA: </span><span style="color: #dc752f;">FIXME</span><span style="color: #96A7A9; font-style: italic;">: (org-export-string-as contents 'html :body-only-please)</span>
                 marker)))))
</pre>
</div>













</details>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: Links, without and with explict lables
                      </font>
                    </strong>
                  </summary>
<p>
This <abbr class="tooltip" title="hola and <b>woah</b> ">°</abbr>&emsp13; works!
</p>

<p>
This <abbr class="tooltip" title="hola">look!</abbr>&emsp13; works!
</p>

<hr />
<p>
<b>Source:</b>
</p>
<div class="org-src-container">
<pre class="src src-org"> This [[margin:][hola and *woah* ]] works!

 This [[margin:look!][hola]] works!
</pre>
</div>


</details>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: Middle of a sentence, no explicit label
                      </font>
                    </strong>
                  </summary>

<p>
Hello this
<abbr class="tooltip" title=" Extra details about whatever it is I'm talking about.&lt;br&gt;">°</abbr>&emsp13;
is super neat!
</p>

<hr />
<p>
<b>Source:</b>
</p>

<div class="org-src-container">
<pre class="src src-org"> Hello this
 #+begin_margin
 Extra details about whatever it is I'm talking about.
 #+end_margin
 is super neat!
</pre>
</div>


</details>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: Middle of a sentence, explicit (full word) label
                      </font>
                    </strong>
                  </summary>
<p>
Hello
<abbr class="tooltip" title=" Extra details about whatever it is I'm talking about.&lt;br&gt;">this</abbr>&emsp13;
is super neat!
</p>

<hr />
<p>
<b>Source:</b>
</p>
<div class="org-src-container">
<pre class="src src-org"> Hello
 #+begin_margin this
 Extra details about whatever it is I'm talking about.
 #+end_margin
 is super neat!
</pre>
</div>



</details>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="orange">
                         ★ Example: A ‘margin’ with an ‘export’ in the middle
                      </font>
                    </strong>
                  </summary>
<p>
An HTML “marquee”
<abbr class="tooltip" title=" An example is best:&lt;br&gt;&amp;emsp;&lt;marquee&gt;Catch me if you can!&lt;/marquee&gt;&lt;br&gt;&lt;br&gt; It is pronounced “mar key”.&lt;br&gt;">°</abbr>&emsp13;
is a scrolling piece of text.
</p>

<hr />
<p>
<b>Source:</b>
</p>
<div class="org-src-container">
<pre class="src src-org"> An HTML &#8220;marquee&#8221;
 #+begin_margin
 An example is best:
 #+begin_export html
 &lt;marquee&gt;Catch me if you can!&lt;/marquee&gt;
 #+end_export
 It is pronounced &#8220;mar key&#8221;.
 #+end_margin
 is a scrolling piece of text.
</pre>
</div>


</details>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: Brief code snippet in tooltip/margin
                      </font>
                    </strong>
                  </summary>
<p>
It's a
<abbr class="tooltip" title="&lt;em&gt;Proof Sketch:&lt;/em&gt; “Squint” your eyes to see &lt;code&gt;zero : ℕ&lt;/code&gt; and &lt;code&gt;nothing : Maybe ℕ&lt;/code&gt; as&lt;br&gt;essentially the same, and “squint” your eyes to see that &lt;code&gt;suc&lt;/code&gt; is essentially the&lt;br&gt;same as &lt;code&gt;just&lt;/code&gt;.&lt;br&gt;&lt;br&gt;More formally, here's one direction:&lt;br&gt;&lt;pre class='tooltip'&gt;to : Maybe ℕ → ℕ&lt;br&gt;to nothing&amp;emsp;= zero&lt;br&gt;to (just n) = suc n&lt;br&gt;&lt;/PRE&gt;&lt;br&gt;The rest is an arduous exercise if you don't know what's going on.&lt;br&gt;">simple</abbr>&emsp13;
exercise to show that ℕ is fixedpoint of <code>Maybe</code>.
</p>
<hr />
<p>
<b>Source:</b>
</p>
<div class="org-src-container">
<pre class="src src-org">It's a
#+begin_margin simple
/Proof Sketch:/ &#8220;Squint&#8221; your eyes to see ~zero : &#8469;~ and ~nothing : Maybe &#8469;~ as
essentially the same, and &#8220;squint&#8221; your eyes to see that ~suc~ is essentially the
same as ~just~.

More formally, here's one direction:
#+begin_src haskell :tangle no
to : Maybe &#8469; &#8594; &#8469;
to nothing  = zero
to (just n) = suc n
#+end_src

The rest is an arduous exercise if you don't know what's going on.
#+end_margin
exercise to show that &#8469; is fixedpoint of ~Maybe~.
</pre>
</div>


</details>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="orange">
                         ★ Example: Lengthy ‘margin’ with multiple code blocks!
                      </font>
                    </strong>
                  </summary>
<p>
It's a
<abbr class="tooltip" title="&amp;emsp;We show that there is an &lt;em&gt;isomorphism&lt;/em&gt;; i.e., a non-lossy protocol between &lt;code&gt;Maybe ℕ&lt;/code&gt;&lt;br&gt;&amp;emsp;and &lt;code&gt;ℕ&lt;/code&gt; in stages.&lt;br&gt;&lt;br&gt;&amp;emsp;First, let's recall the definitions &#x2026; in Agda &#x2026;&lt;br&gt;&amp;emsp;&lt;pre class='tooltip'&gt;data Maybe (A : Set) : Set₁ where&lt;br&gt;&amp;emsp;nothing : Maybe A&lt;br&gt;&amp;emsp;just&amp;emsp;&amp;emsp;: A → Maybe A&lt;br&gt;&lt;br&gt;data ℕ : Set where&lt;br&gt;&amp;emsp;zero : ℕ&lt;br&gt;&amp;emsp;suc&amp;emsp;: ℕ → ℕ&lt;br&gt;&lt;/PRE&gt;&lt;br&gt;&amp;emsp;We can show &lt;code&gt;Maybe ℕ ≅ ℕ&lt;/code&gt; by writing two functions&#x2026;&lt;br&gt;&amp;emsp;&lt;pre class='tooltip'&gt;to : Maybe ℕ → ℕ&lt;br&gt;to nothing = zero&lt;br&gt;to (just n) = suc n&lt;br&gt;&lt;br&gt;from : ℕ → Maybe ℕ&lt;br&gt;from zero = nothing&lt;br&gt;from (suc n) = just n&lt;br&gt;&lt;/PRE&gt;&lt;br&gt;&amp;emsp;&#x2026;and, finally, checking that the two functions undo each other&#x2026;&lt;br&gt;&amp;emsp;&lt;pre class='tooltip'&gt;to∘from : ∀ {n} →&amp;emsp;to (from n)&amp;emsp;≡&amp;emsp;n&lt;br&gt;to∘from n = {! try it! }&lt;br&gt;&lt;br&gt;from∘to : ∀ {m} →&amp;emsp;from (to m)&amp;emsp;≡&amp;emsp;m&lt;br&gt;from∘to m = {! try it! }&lt;br&gt;&lt;/PRE&gt;&lt;br&gt;&lt;br&gt;&amp;emsp;This is “simple”, but involved!&lt;br&gt;">simple</abbr>&emsp13;
exercise to show that ℕ is fixedpoint of <code>Maybe</code>.
</p>
<hr />
<p>
<b>Source:</b>
</p>
<div class="org-src-container">
<pre class="src src-org">It's a
#+begin_margin simple
We show that there is an /isomorphism/; i.e., a non-lossy protocol between ~Maybe &#8469;~
and ~&#8469;~ in stages.

First, let's recall the definitions ... in Agda ...
#+begin_src haskell :tangle no :tangle no
data Maybe (A : Set) : Set&#8321; where
  nothing : Maybe A
  just    : A &#8594; Maybe A

data &#8469; : Set where
  zero : &#8469;
  suc  : &#8469; &#8594; &#8469;
#+end_src

We can show ~Maybe &#8469; &#8773; &#8469;~ by writing two functions...
#+begin_src haskell :tangle no
to : Maybe &#8469; &#8594; &#8469;
to nothing = zero
to (just n) = suc n

from : &#8469; &#8594; Maybe &#8469;
from zero = nothing
from (suc n) = just n
#+end_src

...and, finally, checking that the two functions undo each other...
#+begin_src emacs-lisp
to&#8728;from : &#8704; {n} &#8594;  to (from n)  &#8801;  n
to&#8728;from n = {! try it! }

from&#8728;to : &#8704; {m} &#8594;  from (to m)  &#8801;  m
from&#8728;to m = {! try it! }
#+end_src

This is &#8220;simple&#8221;, but involved!
#+end_margin
exercise to show that &#8469; is fixedpoint of ~Maybe~.
</pre>
</div>


</details>


<style> pre.tooltip {color: black; background-color:Snow;} </style>

<p>
For the tooltips containing code snippets, I've declared
the following to make the code look nice.
</p>
<div class="org-src-container">
<pre class="src src-org">#+html:      &lt;style&gt; pre.tooltip {color: black; background-color:Snow;} &lt;/style&gt;
</pre>
</div>

<hr />

<p>
<span style="color:orange;">Going</span> <span style="color:orange;">forward</span>, it would be nice to get full code colouring of
source blocks in the HTML tooltips &#x2014;which can be done using
<abbr class="tooltip" title="Transcode STRING into BACKEND code.<br><br>BACKEND is either an export back-end, as returned by, e.g.,<br>‘org-export-create-backend’, or a symbol referring to<br>a registered back-end.<br><br>When optional argument BODY-ONLY is non-nil, only return body<br>code, without preamble nor postamble.<br><br>Optional argument EXT-PLIST, when provided, is a property list<br>with external parameters overriding Org default settings, but<br>still inferior to file-local settings.<br><br>Return code as a string.<br><br>(fn STRING BACKEND &optional BODY-ONLY EXT-PLIST)">org-export-string-as</abbr>, just need the time.
</p>
</div>
</div>

<div id="outline-container-Equational-Proofs" class="outline-2">
<h2 id="Equational-Proofs"><span class="section-number-2">11</span> <a href="#Equational-Proofs">Equational Proofs</a></h2>
<div class="outline-text-2" id="text-Equational-Proofs">
<p>
Sometimes you just want to have a quick, yet <i>detailed</i>, explanation and so we can
use <b><span style="color:green;">org-lists as equational proofs</span></b> &#x2014;thanks to the <abbr class="tooltip" title="Render an Org-list as an equational proof.<br><br>Sometimes the notation delimiting justification hints may clash<br>with the domain topic, so we can change the hint format, e.g., to<br>''\left\langle %s \right\rangle''.&emsp;Set HINT-FORMAT to the<br>empty string, '''', to comment-out all hints in the exported<br>version.<br><br>The hint is the text immediately after a “--”, if there are<br>multiple such delimiters only the first is shown; this can be<br>useful if we want to have multiple alternatives, say for extra<br>details in the source but not so much in the export.<br><br>Line breaks are taken literally in the hints, but not in the<br>math; where one uses \\.&emsp;For math with multiple lines, use ‘&’<br>as an alignment marker; otherwise math is right-justified.<br><br>For HTML, to use an TeX it must be enclosed in $, since that is<br>what is required by MathJaX.<br><br>(fn BACKEND RAW-CONTENTS &optional MAIN-ARG &rest ## &key (O-LINK\? nil) (REL ''='') (HINT-FORMAT ''\\left[ %s \\right.'') (EXPLICIT-VSPACE 2) (COLOR ''maroon''))">calc</abbr> block!
</p>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="pink">
                         Implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">o--list-to-calc</span> (lst rel hint-format NL-length color)
  <span style="color: #35a69c; font-style: italic;">"Get a result from org-list-to-lisp and render it as a calculational proof.</span>

<span style="color: #35a69c; font-style: italic;">LST is an expression, possibly with a hint and dedicated relation.</span>
<span style="color: #35a69c; font-style: italic;">The expression may contain multiple lines, as may the hints.</span>

<span style="color: #35a69c; font-style: italic;">REL is the default relation in the left-most column.</span>

<span style="color: #35a69c; font-style: italic;">HINT_FORMAT is the formatting string for hints; e.g.,</span>
<span style="color: #35a69c; font-style: italic;">\"\\color{maroon}{\\langle\\large\\substack{\\text{ %s }}&#10217;}\"</span>

<span style="color: #35a69c; font-style: italic;">NL-length is how long the explicit vertical space, \\, should be.</span>
<span style="color: #35a69c; font-style: italic;">The number refers to the vspace occupied nearly by the height of</span>
<span style="color: #35a69c; font-style: italic;">a single normal sized letter.</span>

<span style="color: #35a69c; font-style: italic;">COLOR is the colour of the hints."</span>
  (<span style="color: #859900; font-weight: bold;">cond</span>
   ((<span style="color: #b58900;">symbolp</span> lst) <span style="color: #2aa198;">""</span>)
   ((<span style="color: #b58900;">symbolp</span> (<span style="color: #b58900;">car</span> lst)) (<span style="color: #b58900;">o--list-to-calc</span> (<span style="color: #b58900;">cadr</span> lst)))
   (<span style="color: #268bd2;">t</span> (<span style="color: #859900; font-weight: bold;">-let*</span> (((conclusion&#8320; children) lst)
              ((expr&#8320; hint) (<span style="color: #b58900;">s-split</span> <span style="color: #2aa198;">"--"</span> conclusion&#8320;))
              ((op&#8320; expr&#8321;) (<span style="color: #b58900;">cdr</span> (<span style="color: #b58900;">s-match</span> <span style="color: #2aa198;">"^\\[</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">(</span><span style="color: #2aa198;">.*</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">)</span><span style="color: #2aa198;">\\]</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">(</span><span style="color: #2aa198;">.*</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">)</span><span style="color: #2aa198;">"</span> expr&#8320;)))
              (op (<span style="color: #859900; font-weight: bold;">or</span> op&#8320; rel))
              (expr (<span style="color: #859900; font-weight: bold;">or</span> expr&#8321; expr&#8320;)))
        (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">not</span> children)
            (<span style="color: #859900; font-weight: bold;">if</span> hint
                (<span style="color: #b58900;">format</span>
                 <span style="color: #2aa198;">"\n %s \\;\\; &amp; \\qquad \\color{%s}{%s} \n \\\\ &amp; \\begin{split}%s\\end{split}"</span>
                 op
                 color
                 <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">the hfill is so that we do not use substack's default</span>
                 <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">centering, but instead left-align justificatiion</span>
                 <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">hints.</span>
                 (<span style="color: #b58900;">format</span> (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"%s"</span> <span style="color: #2aa198;">"{\\large\\substack{\\text{ %s } \\hfill\\\\\n}}"</span> hint-format)
                         (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"\n"</span> <span style="color: #2aa198;">" } \\hfill\\\\\n\\text{ "</span>
                                    (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"\n\n"</span> (<span style="color: #b58900;">s-repeat</span> (<span style="color: #b58900;">*</span> 6 NL-length) <span style="color: #2aa198;">"\n $\\,$"</span>) (<span style="color: #b58900;">s-trim</span> hint))))
                 expr)
              (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"\\begin{split}%s\\end{split} \n"</span> expr))
       <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">MA: The following could be improved.</span>
          (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"\n %s \\;\\; &amp; \\qquad \\color{%s}{%s} \n \\\\ &amp; \\begin{split}%s\\end{split}"</span>
                  op color
                  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">BEGIN similar as above</span>
                  (<span style="color: #b58900;">format</span> (<span style="color: #b58900;">s-replace</span>
                           <span style="color: #2aa198;">"%s"</span>
                           <span style="color: #2aa198;">"{\\large\\substack{\\text{ %s } \\hfill\\\\ \\begin{split} &amp; %s \n\\end{split}\\hfill\\\\\n}}"</span>
                           hint-format)
                          (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"\n"</span> <span style="color: #2aa198;">" } \\hfill\\\\\n\\text{ "</span>
                                     (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"\n\n"</span> (<span style="color: #b58900;">s-repeat</span> (<span style="color: #b58900;">*</span> 6 NL-length) <span style="color: #2aa198;">"\n $\\,$"</span>) (<span style="color: #b58900;">s-trim</span> hint)))
                          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">END similar</span>
                          (<span style="color: #b58900;">s-chop-prefix</span>
                           <span style="color: #2aa198;">"\\\\"</span> (<span style="color: #b58900;">s-join</span>
                                   <span style="color: #2aa198;">"\\\\"</span>
                                   (<span style="color: #859900; font-weight: bold;">--map</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s"</span> (<span style="color: #b58900;">o--list-to-calc</span> it rel hint-format NL-length color))
                                          children))))
                  expr))))))

(<span style="color: #859900; font-weight: bold;">o-defblock</span> <span style="color: #b58900;">calc</span>
  (main-arg)
  (rel <span style="color: #2aa198;">"="</span> hint-format <span style="color: #2aa198;">"\\left[ %s \\right."</span> explicit-vspace 2 color <span style="color: #2aa198;">"maroon"</span>)
  <span style="color: #2aa198;">"Render an Org-list as an equational proof.</span>

<span style="color: #2aa198;">Sometimes the notation delimiting justification hints may clash</span>
<span style="color: #2aa198;">with the domain topic, so we can change the hint format, e.g., to</span>
<span style="color: #2aa198;">\"\\left\\langle %s \\right\\rangle\".  Set HINT-FORMAT to the</span>
<span style="color: #2aa198;">empty string, \"\", to comment-out all hints in the exported</span>
<span style="color: #2aa198;">version.</span>

<span style="color: #2aa198;">The hint is the text immediately after a &#8220;--&#8221;, if there are</span>
<span style="color: #2aa198;">multiple such delimiters only the first is shown; this can be</span>
<span style="color: #2aa198;">useful if we want to have multiple alternatives, say for extra</span>
<span style="color: #2aa198;">details in the source but not so much in the export.</span>

<span style="color: #2aa198;">Line breaks are taken literally in the hints, but not in the</span>
<span style="color: #2aa198;">math; where one uses \\\\.  For math with multiple lines, use &#8216;&amp;&#8217;</span>
<span style="color: #2aa198;">as an alignment marker; otherwise math is right-justified.</span>

<span style="color: #2aa198;">For HTML, to use an TeX it must be enclosed in $, since that is</span>
<span style="color: #2aa198;">what is required by MathJaX."</span>
  (<span style="color: #859900; font-weight: bold;">thread-last</span> (<span style="color: #859900; font-weight: bold;">with-temp-buffer</span>
                 (<span style="color: #b58900;">insert</span> raw-contents)
                 (<span style="color: #b58900;">goto-char</span> (<span style="color: #b58900;">point-min</span>))
                 (<span style="color: #b58900;">org-list-to-lisp</span>))
    <span style="color: #b58900;">cdr</span>
    (<span style="color: #859900; font-weight: bold;">--map</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s"</span> (<span style="color: #b58900;">o--list-to-calc</span> it rel hint-format explicit-vspace color)))
    (<span style="color: #b58900;">s-join</span> <span style="color: #2aa198;">"\\\\"</span>)
    (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"$$\\begin{align*} &amp; %s \n\\end{align*}$$"</span>)))
</pre>
</div>




</details>
<div style="padding: 1em; background-color: #CCFFFF;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>“Programming Comments  ≈  Proof Hints”</h3>
<p>
Let's prove that \(x ≤ z\)&#x2026;
</p>
<div style="column-rule-style: none;column-count: 2;">
<p>
<b>Source:</b>
</p>
<div class="org-src-container">
<pre class="src src-org">#+begin_calc :hint-format "\\left\\{ %s\\right."
+     x
+     y -- Explanation of why $x \;=\; y$
  Actually, let me explain:
  * x
  * x&#8242; -- hint 1
  * y  -- hint 2

  No words can appear (in the export) *after* a nested calculation, for now.
+ [&#8804;] z
  --
  Explanation of why $y \;\leq\; z$

  -- explain it more, this is ignored from export ;-)
#+end_calc
</pre>
</div>
<p>
<p>
<b>Result:</b>
</p>
$$\begin{align*} & \begin{split}x\end{split}
\\
 = \;\; & \qquad \color{maroon}{\left\{ {\large\substack{\text{ Explanation of why $x \;=\; y$ } \hfill\\
\text{ Actually, let me explain: } \hfill\\ \begin{split} & \begin{split}x\end{split}
\\
 = \;\; & \qquad \color{maroon}{\left\{ {\large\substack{\text{ hint 1 } \hfill\\
}}\right.}
 \\ & \begin{split}x′ \end{split}\\
 = \;\; & \qquad \color{maroon}{\left\{ {\large\substack{\text{ hint 2 } \hfill\\
}}\right.}
 \\ & \begin{split}y  \end{split}
\end{split}\hfill\\
}}\right.}
 \\ & \begin{split}    y \end{split}\\
 ≤ \;\; & \qquad \color{maroon}{\left\{ {\large\substack{\text{ Explanation of why $y \;\leq\; z$ } \hfill\\
}}\right.}
 \\ & \begin{split} z\end{split}
\end{align*}$$

</div>

<p>
Benefits of Org-lists for proofs:
</p>
<ul class="org-ul">
<li>Nested proofs can be <i>folded-away</i> with <abbr class="tooltip" style="border: none; text-decoration: none;" title="TAB ∷ org-cycle<br>TAB-action and visibility cycling for Org mode.<br><br>This is the command invoked in Org mode by the ‘TAB’ key.&emsp;Its main<br>purpose is outline visibility cycling, but it also invokes other actions<br>in special contexts.<br><br>When this function is called with a ‘C-u’ prefix, rotate the entire<br>buffer through 3 states (global cycling)<br>&emsp;1. OVERVIEW: Show only top-level headlines.<br>&emsp;2. CONTENTS: Show all headlines of all levels, but no body text.<br>&emsp;3. SHOW ALL: Show everything.<br><br>With a ‘C-u C-u’ prefix argument, switch to the startup visibility,<br>determined by the variable ‘org-startup-folded’, and by any VISIBILITY<br>properties in the buffer.<br><br>With a ‘C-u C-u C-u’ prefix argument, show the entire buffer, including<br>any drawers.<br><br>When inside a table, re-align the table and move to the next field.<br><br>When point is at the beginning of a headline, rotate the subtree started<br>by this line through 3 different states (local cycling)<br>&emsp;1. FOLDED:&emsp; Only the main headline is shown.<br>&emsp;2. CHILDREN: The main headline and the direct children are shown.<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; From this state, you can move to one of the children<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; and zoom in further.<br>&emsp;3. SUBTREE:&emsp;Show the entire subtree, including body text.<br>If there is no subtree, switch directly from CHILDREN to FOLDED.<br><br>When point is at the beginning of an empty headline and the variable<br>‘org-cycle-level-after-item/entry-creation’ is set, cycle the level<br>of the headline by demoting and promoting it to likely levels.&emsp;This<br>speeds up creation document structure by pressing ‘TAB’ once or several<br>times right after creating a new headline.<br><br>When there is a numeric prefix, go up to a heading with level ARG, do<br>a ‘show-subtree’ and return to the previous cursor position.&emsp;If ARG<br>is negative, go up that many levels.<br><br>When point is not at the beginning of a headline, execute the global<br>binding for ‘TAB’, which is re-indenting the line.&emsp;See the option<br>‘org-cycle-emulate-tab’ for details.<br><br>As a special case, if point is at the very beginning of the buffer, if<br>there is no headline there, and if the variable ‘org-cycle-global-at-bob’<br>is non-nil, this function acts as if called with prefix argument (‘C-u TAB’,<br>same as ‘S-TAB’) also when called without prefix argument.<br><br>(fn &optional ARG)"><kbd style="border-color: red">TAB</kbd></abbr>.
<ul class="org-ul">
<li>This provides a nice <i>proof outline!</i></li>
</ul></li>
<li>All Org support for lists active; e.g., <kbd style="">M-↑,↓</kbd> for moving <i>proof steps</i> (list
items) and <abbr class="tooltip" style="border: none; text-decoration: none;" title="M-RET ∷ org-meta-return<br>Insert a new heading or wrap a region in a table.<br>Calls ‘org-insert-heading’, ‘org-insert-item’ or<br>‘org-table-wrap-region’, depending on context.&emsp;When called with<br>an argument, unconditionally call ‘org-insert-heading’.<br><br>(fn &optional ARG)"><kbd style="border-color: red">M-RET</kbd></abbr> for new <i>proof steps</i>.</li>

<li>Intentional explanations can make the proof argument more <i>convincing</i>, or
accurate.</li>
</ul>

<p>
Examples below: Rational root equivales perfect power, Handshaking lemma,
calculating train length, and last, but not least, “1 + 1 = 2”.
</p>

<hr />

<p>
Align the proof hints with <kbd style="">M-x align-regexp RET -- RET</kbd> &#x2026;let's calculate that \(a ⊆ e\)&#x2026;
</p>

<div style="column-rule-style: none;column-count: 2;">
<p>
<b>Source:</b>
</p>
<div class="org-src-container">
<pre class="src src-org">#+begin_calc
+     a
+     b  --  reason for the equality
+ [&#8838;] c  --  reason for the inclusion
+     d  --  reason for the equality
+     e  --  final justification
#+end_calc
</pre>
</div>

<br><p><br>
<p>
<b>Result:</b>
</p>
$$\begin{align*} & \begin{split}a\end{split}
\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ reason for the equality } \hfill\\
}} \right.}
 \\ & \begin{split}b  \end{split}\\
 ⊆ \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ reason for the inclusion } \hfill\\
}} \right.}
 \\ & \begin{split} c  \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ reason for the equality } \hfill\\
}} \right.}
 \\ & \begin{split}d  \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ final justification } \hfill\\
}} \right.}
 \\ & \begin{split}e  \end{split}
\end{align*}$$

</div>

</div>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Tests
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #b58900;">calc</span> (<span style="color: #b58900;">&#10224;</span> <span style="color: #2aa198;">"#+begin_calc :hint-format \"\\\\left\\{ %s\\\\right.\"</span>
<span style="color: #2aa198;">                  +     x</span>
<span style="color: #2aa198;">                  +     y -- Explanation of why $x \\;=\\; y$</span>
<span style="color: #2aa198;">                    Actually, let me explain:</span>
<span style="color: #2aa198;">                    * x</span>
<span style="color: #2aa198;">                    * x&#8242; -- hint 1</span>
<span style="color: #2aa198;">                    * y  -- hint 2</span>

<span style="color: #2aa198;">                    No words can appear (in the export) *after* a nested calculation, for now.</span>
<span style="color: #2aa198;">                  + [&#8804;] z</span>
<span style="color: #2aa198;">                    --</span>
<span style="color: #2aa198;">                    Explanation of why $y \\;\\leq\\; z$</span>

<span style="color: #2aa198;">                    -- explain it more, this is ignored from export ;-)</span>
<span style="color: #2aa198;">                  #+end_calc"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It's an align environment, in displayed math mode"</span>
  [<span style="color: #b58900;">calc</span>]
  (&#8669; <span style="color: #b58900;">calc</span> <span style="color: #2aa198;">"$$\\begin{align*}"</span> (<span style="color: #b58900;">*</span> anything) <span style="color: #2aa198;">"\\end{align*}$$"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"The calculation has 4 proof steps"</span>
  [<span style="color: #b58900;">calc</span>]
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The number of steps in a calculation is the number of items in each nesting, minus 1 (at each nesting).</span>
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Above we have depth 2 with 3 items in each depth, for a total of (3-1) + (3-1) = 2 + 2 = 4.</span>
  (<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">=</span> 4 (<span style="color: #b58900;">s-count-matches</span> (<span style="color: #859900; font-weight: bold;">rx</span> (seq <span style="color: #2aa198;">"\\"</span> (<span style="color: #b58900;">*</span> whitespace) (any <span style="color: #2aa198;">"="</span> <span style="color: #2aa198;">"&#8804;"</span>))) <span style="color: #b58900;">calc</span>))))


(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"Of our 4 steps, 3 of them are equalities and one is an inclusion."</span>
  [<span style="color: #b58900;">calc</span>]
  (<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">=</span> 3 (<span style="color: #b58900;">s-count-matches</span> (<span style="color: #859900; font-weight: bold;">rx</span> <span style="color: #2aa198;">"= \\;\\;"</span>) <span style="color: #b58900;">calc</span>)))
  (<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">=</span> 1 (<span style="color: #b58900;">s-count-matches</span> (<span style="color: #859900; font-weight: bold;">rx</span> <span style="color: #2aa198;">"&#8804; \\;\\;"</span>) <span style="color: #b58900;">calc</span>))))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"All of the hints actually appear in the calculational proof"</span>
  [<span style="color: #b58900;">calc</span>]
  (<span style="color: #b58900;">mapc</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (hint) (<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">s-contains?</span> hint <span style="color: #b58900;">calc</span>)))
        '(<span style="color: #2aa198;">"Explanation of why $x \\;=\\; y$"</span>
          <span style="color: #2aa198;">"Actually, let me explain:"</span>
          <span style="color: #2aa198;">"hint 1"</span>
          <span style="color: #2aa198;">"hint 2"</span>
          <span style="color: #2aa198;">"Explanation of why $y \\;\\leq\\; z$"</span>)))
</pre>
</div>


</details>

<hr />

<p>
Examples&#x2026;
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="orange">
                         ★ Proof of “1 + 1 = 2” with source
                      </font>
                    </strong>
                  </summary>
<p>
<a class="anchor" aria-hidden="true" id="1+1=2" href="#1+1=2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16
   16" width="16" height="16"><path fill-rule="evenodd"
   d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69
   3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10
   5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0
   2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5
   0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55
   13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
</p>
$$\begin{align*} & \begin{split}1 + 1\end{split}
\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ $\def\suc{\mathsf{suc}\,} \def\zero{\mathsf{zero}}$ } \hfill\\
\text{ “1” abbreviates “$\suc \zero$” } \hfill\\
}} \right.}
 \\ & \begin{split}\suc \zero + \suc \zero
\end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Addition is defined by moving the $\suc$-s from the left argument to the } \hfill\\
\text{ right. } \hfill\\
\text{ $\def\eqn#1#2{\begin{equation} #2 \tag{#1} \label{#1} \end{equation}}$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$That is, we define $x + y$ by considering the possible $shape$ of $x$, } \hfill\\
\text{ which could only be a $\zero$ or a $\suc$-cessor. } \hfill\\
\text{ When $x$ is zero, there are no $\suc$-s to move to the right, so we yield the  right. } \hfill\\
\text{ $\eqn{Base Case}{\zero + n \; = \; n}$ } \hfill\\
\text{ When $x$ is a $\suc$, we move the $\suc$ to the right, and continue to try adding. } \hfill\\
\text{ $\eqn{Inductive Step}{\suc m \,+\, n \; = \; m \,+\, \suc n}$ } \hfill\\
\text{ Since we're moving a $\suc$ at each step, eventually we'll hit the } \hfill\\
\text{ base case and be done adding. } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$For now, we apply the \eqref{Inductive Step}. } \hfill\\
}} \right.}
 \\ & \begin{split}\zero + \suc (\suc \zero) \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Using the \eqref{Base Case} definition of addition. } \hfill\\
}} \right.}
 \\ & \begin{split}\suc (\suc \zero)
\end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Switching to ‘conventional’ notation } \hfill\\
}} \right.}
 \\ & \begin{split}2 \end{split}
\end{align*}$$
<hr />
<p>
<b>Source:</b>
</p>
<div class="org-src-container">
<pre class="src src-org">#+begin_calc
+ 1 + 1
+ \suc \zero + \suc \zero
  --
  $\def\suc{\mathsf{suc}\,} \def\zero{\mathsf{zero}}$
  &#8220;1&#8221; abbreviates &#8220;$\suc \zero$&#8221;
+ \zero + \suc (\suc \zero) --
  Addition is defined by moving the $\suc$-s from the left argument to the
  right.
  $\def\eqn#1#2{\begin{equation} #2 \tag{#1} \label{#1} \end{equation}}$

  That is, we define $x + y$ by considering the possible $shape$ of $x$,
  which could only be a $\zero$ or a $\suc$-cessor.
  When $x$ is zero, there are no $\suc$-s to move to the right, so we yield the  right.
  $\eqn{Base Case}{\zero + n \; = \; n}$
  When $x$ is a $\suc$, we move the $\suc$ to the right, and continue to try adding.
  $\eqn{Inductive Step}{\suc m \,+\, n \; = \; m \,+\, \suc n}$
  Since we're moving a $\suc$ at each step, eventually we'll hit the
  base case and be done adding.

  For now, we apply the \eqref{Inductive Step}.

+ \suc (\suc \zero)
  -- Using the \eqref{Base Case} definition of addition.
+ 2 -- Switching to &#8216;conventional&#8217; notation
#+end_calc
</pre>
</div>


</details>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         “Calculating” the length of a train
                      </font>
                    </strong>
                  </summary>
<p>
<a class="anchor" aria-hidden="true" id="calculating-the-length-of-a-train" href="#calculating-the-length-of-a-train"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16
   16" width="16" height="16"><path fill-rule="evenodd"
   d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69
   3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10
   5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0
   2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5
   0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55
   13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
Let us <b><span style="color:green;">calculate</span></b> the length of a train, that is travelling at a speed of
60 km/hr and, on its way, it crosses a pole in 9 seconds.
</p>

$$\begin{align*} & \begin{split}\text{ the length of the train }
\end{split}
\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Express length as a difference of distance } \hfill\\
}} \right.}
 \\ & \begin{split}\text{ the distance from the end of the train to its front }
\end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ distance = time × speed } \hfill\\
}} \right.}
 \\ & \begin{split}& \left(\begin{split} &\text{ difference in time from when the train's front}
   \\ &\text{ crosses the pole until its back crosses the pole } \end{split}\right)
  \;\times\; \text{speed of the train}
\end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Rephrase } \hfill\\
}} \right.}
 \\ & \begin{split}& \text{ how long it takes the train to cross the pole }
  \;\times\; \text{speed of the train}
\end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ $\def\meters{\,\mathsf{meters}\,} \def\seconds{\,\mathsf{seconds}\,}$ } \hfill\\
\text{ The train crosses the pole in 9 seconds; } \hfill\\
\text{ and the train is travelling at the speed of 60km/hr. } \hfill\\
}} \right.}
 \\ & \begin{split}9 \text{ seconds } \times 60 \text{ km / hr}
\end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Express things in common units, such as seconds; i.e.,: } \hfill\\ \begin{split} & \begin{split}1 \text{ km / hr}\end{split}
\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Be more explicit } \hfill\\
}} \right.}
 \\ & \begin{split}1 \text{ km } /\; 1 \text{ hr }      \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ A kilometre is 1000 meters } \hfill\\
}} \right.}
 \\ & \begin{split}1000 \meters /\, 1 \text{ hr }   \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Express hours in terms of seconds: } \hfill\\ \begin{split} & \begin{split}1 \text{ hr }\end{split}
\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Express in minutes } \hfill\\
}} \right.}
 \\ & \begin{split}60 \,\mathsf{minutes}              \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Be more explicit } \hfill\\
}} \right.}
 \\ & \begin{split}60 \,\times\, 1 \,\mathsf{minutes} \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ A minute has 60 seconds } \hfill\\
}} \right.}
 \\ & \begin{split}60 \,\times\, 60 \,\seconds        \end{split}
\end{split}\hfill\\
}} \right.}
 \\ & \begin{split}1000 \meters /\, (60 × 60) \seconds  \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Collecting like-terms } \hfill\\
}} \right.}
 \\ & \begin{split}(1000 / 60 × 60) \meters / \seconds  \end{split}
\end{split}\hfill\\
}} \right.}
 \\ & \begin{split}9 \seconds \times 60 × (1000 / 60 × 60) \meters / \seconds
\end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Division cancels multiplication: $b × (a / b) = a$ } \hfill\\
}} \right.}
 \\ & \begin{split}9 \seconds \times (1000 / 60) \meters / \seconds
\end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Collect like-terms; i.e., commutativity of × } \hfill\\
}} \right.}
 \\ & \begin{split}(1000 / 60) × 9 \seconds × (\meters / \seconds)
\end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Division cancels multiplication: $b × (a / b) = a$ } \hfill\\
}} \right.}
 \\ & \begin{split}(1000 / 60) × 9 \meters
\end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Arithmetic } \hfill\\
}} \right.}
 \\ & \begin{split}150 \meters
\end{split}
\end{align*}$$


</details>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Euler's Handshaking Lemma
                      </font>
                    </strong>
                  </summary>

<p>
<a class="anchor" aria-hidden="true" id="handshaking-lemma" href="#handshaking-lemma"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16
   16" width="16" height="16"><path fill-rule="evenodd"
   d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69
   3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10
   5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0
   2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5
   0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55
   13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
<i>At a party of 7 people, is it possible that everybody knows exactly 3 other
people?</i>
</p>

<p>
We could consider all possible cases, which is not particularly enlightening; or
we could <i>calculate</i>&#x2026;
</p>

$$\begin{align*} & \begin{split}\text{“Obviously”, the sum of everyone's friendship count is twice the total
number of friendships}\end{split}
\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Formalise... } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$Let $f(p)$ denote the number of friends that person $p$ has, } \hfill\\
\text{ which is 0 if $p$ has no friends. } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$Let $F$ be the total number of friendships (between any 2 people). } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$Since friendships are always between two people, we have } \hfill\\
\text{ that $\sum_p f(p) = 2 × F$: Counting-up the number of friends } \hfill\\
\text{ that everyone has will always be twice the total number of relationships } \hfill\\ \begin{split} & \begin{split}\text{sum of everyone's friendship count}\end{split}
\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Formalise, where $p$ ranges over people } \hfill\\
}} \right]}
 \\ & \begin{split}\sum_p f(p)             \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Definition of $f$: } \hfill\\
\text{ Let $𝑭𝒓_{p, r}$ be 1 exactly when $p$ participates in } \hfill\\
\text{ friendship/relationship $r$, } \hfill\\
\text{ and 0 otherwise, then $f(p) = \sum_r 𝑭𝒓_{p, r}$. } \hfill\\
}} \right]}
 \\ & \begin{split}\sum_p \sum_r 𝑭𝒓_{p, r} \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Quantifier interchange; i.e., Fubini's Principle } \hfill\\
}} \right]}
 \\ & \begin{split}\sum_r \sum_p 𝑭𝒓_{p, r} \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Every relationship $r$ is between 2 people; } \hfill\\
\text{ i.e., $\sum_p 𝑭𝒓_{p, r} = 2$ } \hfill\\
}} \right]}
 \\ & \begin{split}\sum_r 2                \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Factoring } \hfill\\
}} \right]}
 \\ & \begin{split}2 × \sum_r 1            \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ The total number of friendships is $F$ } \hfill\\
}} \right]}
 \\ & \begin{split}2 × F                   \end{split}
\end{split}\hfill\\
}} \right]}
 \\ & \begin{split}∑_p f(p) = 2×F                      \end{split}\\
 ⇒ \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Equals for equals; } \hfill\\
\text{ i.e., $if$ those numbers are equal $then$ their parities are equal } \hfill\\
\text{ $\def\even#1{\mathsf{even}\,\left(#1\right)}$ } \hfill\\
\text{ $\def\odd#1{\mathsf{odd}\,\left(#1\right)}$ } \hfill\\
}} \right]}
 \\ & \begin{split} \even{∑_p f(p)} ≡ \even{2 × F}  \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ The right side is clearly true; } \hfill\\
\text{ (‘true’ is the identity of ‘≡’) } \hfill\\
}} \right]}
 \\ & \begin{split}\even{∑_p f(p)}                     \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ $\even{-}$ distributes over sums turning them into equivalences ‘≡’ } \hfill\\
}} \right]}
 \\ & \begin{split}{\LARGE ≡}_p \;\even{f(p)}          \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ By definition, a chain of equivalences is true exactly when } \hfill\\
\text{ it has an even number of false values } \hfill\\
}} \right]}
 \\ & \begin{split}\even{ ♯\{p ∣ ¬ \even{f(p)}\} }      \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ A non-even number is precisely an odd number } \hfill\\
}} \right]}
 \\ & \begin{split}\even{ ♯\{p ∣ \odd{f(p)} \} }        \end{split}\\
 = \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Un-formalise } \hfill\\
}} \right]}
 \\ & \begin{split}\text{an even number of people have an odd number of friends} \end{split}
\end{align*}$$

<p>
Back to the problem: At a party of 7 people, is it possible that everybody knows
exactly 3 other people?
</p>

<p>
If such a party were possible, the number of people with an odd friend count
must be even, but 7 is not even, and so no such party is possible.  (
Alternatively, if such a party were possible, then by the Handshaking Lemma, \(F
= {∑_p f(p) \over 2} = {7 × 3 \over 2} = 10.5\): This is absurd since there
cannot be a ‘.5’ relationship! Hence, no such party is possible. )
</p>

<ul class="org-ul">
<li>Likewise, if exactly 5 people in a room each claim to have shaken 3 hands,
then someone is lying.</li>
</ul>

<p>
( Rephrased: The sum of the degrees of the vertices of a (total) <abbr class="tooltip" title="A <em>(Partial, resp. Total) Graph</em> <em>G = (V, E, src, tgt)</em> consists of<br>&emsp; + <EM>V</EM>, a set of “points, nodes, vertices”<br>&emsp; + <EM>E</EM>, a set of “arcs, edges”<br>&emsp; + <em>src, tgt : E ↔ V</em>, a pair of <em>partial (resp. total)</em> functions.<br><br>⟦ Tersely put, in any category, a <em>graph</em> is a parallel pair of morphisms. ⟧<br><br><em>Edge parallelism</em> is the relation <em>Ξ = src ⨾ src ˘ ∩ tgt ⨾ tgt˘</em>; two arcs are<br>related when they have the same starting point and the same ending point, which<br>both exist. Joyously, the name ‘Ξ’ is a neat reminder of the concept:<br>The name is three parallel lines, for the concept of edge(line) parallelism.<br><br>+ A graph is <em>total</em> exactly when <em>Id ⊆ Ξ</em>; and so Ξ is an equivalence.<br>+ A graph has <em>no parallel arrows</em> exactly when <em>Ξ ⊆ Id</em>.<br>+ A graph is <em>simple</em> exactly when <em>Ξ = Id</em>.<br><br>The <em>associated relation</em> is the relation <em>_⟶_ = src ˘ ⨾ tgt</em> that relates two nodes<br>when the first is the source of some edge that happens to have the second point<br>as its target. One uses the associated relation to study properties not<br>involving partial or parallel arrows. One writes <em>⟵</em> for <em>⟶˘</em>;<br>one writes ⟶⋆ for the <em>reachability</em> relation.<br><br>+ Node <em>y</em> is <em>reachable via a non-empty path</em> from node <em>x</em> exactly when <em>x ⟶⁺ y</em>.<br>&emsp;- Node <em>x</em> lies on a cycle exactly when <em>x ⟶⁺ x</em>.<br>&emsp;- A graph is <em>DAG, acylic, circuit-free,</em> exactly when <em>⟶⁺ ⊆ ∼Id</em>; i.e., <em>⟶⁺ ∩ Id = ⊥</em>.<br>&emsp;- An acyclic graph is a (<em>directed) forest</em> exactly when ⟶ is injective; i.e.,<br>&emsp;&emsp;every node has at most one predecessor; i.e., <em>⟶ ⨾ ⟵ ⊆ Id</em>.<br>+ A node <em>r</em> is a <em>root</em> exactly when every node is reachable from it; i.e., <em>{r} × V ⊆ ⟶⋆;</em><br>&emsp;i.e., <em>𝕃 r ⨾ ⟶⋆ = ⊤</em> where <em>𝕃 r</em> is defined by <em>𝕃 r = (ℝ r)˘</em> and <em>x 〔ℝ r〕 y &#8195;≡&#8195; x = r</em>.<br>&emsp;- <em>x〔𝕃 r ⨾ R〕 y &#8195;≡&#8195; r〔R〕 y</em> and <em>x 〔R ⨾ ℝ r〕 y &#8195;≡&#8195; x 〔R〕 r</em><br>&emsp;- A <em>tree</em> is a forest with a root.<br>+ A graph is <em>loop free</em> exactly when <em>⟶ ⊆ ∼Id</em>.<br>+ A graph is <em>strongly connected</em> exactly when <em>⟶⋆ = ⊤</em>; i.e., <em>∼Id ⊆ ⟶⁺</em>;<br>&emsp;i.e., every point is reachable from any <em>other</em> point; i.e., <em>∼Id ⊆ ⟶ ∩ ⟵˘</em>;<br>&emsp;i.e., any two distinct points lie on an undirected circuit.<br>&emsp;- The equivalence classes of <em>⟶⋆ ∩ ⟵⋆</em> are the <em>strongly connected components</em>.<br>+ <em>Terminal∣sinks</em> are nodes from which it is <em>not</em> possible to proceed <em>any</em> further;<br>&emsp;i.e., terminals have no successors; the domain of <em>∼(⟶ ⨾ ⊤)</em> is all terminals.<br>+ <em>Initial∣sources</em> are nodes from which it is <em>not</em> possible to proceed backward;<br>&emsp;i.e., initials have no predecessors; the domain of <em>∼(⟵ ⨾ ⊤)</em> is all initials.">Graph</abbr> is
twice the number of edges of the graph; moreover, an even number of vertices
have an odd degree.
</p>

<p>
The party problem is then: <i>Is there a graph of 7 nodes with each node being
connected to exactly 3 other nodes?</i> Apparently not, and we didn't need to draw
any graphs at all to prove it.
</p>

<p>
For more on Graph Theory, <a href="https://ptwiddle.github.io/MAS341-Graph-Theory-2017/">here</a> are some lecture notes. )
</p>

<ul class="org-ul">
<li><a href="http://homepage.tudelft.nl/64a8q/papers/handshake.pdf">The power of shaking hands</a> has a few non-trivial applications of this lemma.</li>
</ul>


</details>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="orange">
                         ★ Rational root equivales perfect power
                      </font>
                    </strong>
                  </summary>
<p>
<a class="anchor" aria-hidden="true" id="rational-root-equivales-perfect-power" href="#rational-root-equivales-perfect-power"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16
   16" width="16" height="16"><path fill-rule="evenodd"
   d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69
   3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10
   5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0
   2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5
   0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55
   13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
</p>
$$\begin{align*} & \begin{split}\sqrt[n]{k} \text{ is a rational number }
\end{split}
\\
 ⇔ \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ A rational number is the fraction of two integers. } \hfill\\
\text{ Let variables $a,\, b$ range over integer numbers. } \hfill\\
}} \right.}
 \\ & \begin{split}∃\, a, b •\; \sqrt[n]{k} = {a \over b} \end{split}\\
 ⇔ \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Use arithmetic to eliminate the $n$-th root operator. } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$$\def\exp#1#2{\mathsf{exp}_#1\,#2}$ } \hfill\\
\text{ $\def\eq{\;=\;}$ } \hfill\\
}} \right.}
 \\ & \begin{split}∃\, a, b •\; k · a ^n = b ^n \end{split}\\
 ⇔ \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Let $\exp{m} x$ be the number of times that $m$ divides $x$. } \hfill\\
\text{ For example, $\exp{2} 48 \eq 4$ and $\exp{2} 49 \eq 0$. } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$The numbers $p$ with $∀ m : ℤ⁺ \;•\; \exp{m}p \,≠\, 0 \,≡\, m \,=\, p$ } \hfill\\
\text{ are called $prime$ numbers. Let variable $p$ range over prime numbers. } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$ } \hfill\\
\text{  $\,$Fundamental theorem of arithmetic: Numbers are determined by their prime powers. } \hfill\\
\text{ That is, $\big(∀ \,p\, •\;\; \exp{p} x \eq f(p)\big) \;\;≡\;\; x \eq \big(Π\, p\, •\; p^{f(p)}\big)$ for any $f$. } \hfill\\
\text{ As such, every number is the product of its prime powers: } \hfill\\
\text{ $\qquad x \eq \big(Π \,p\, •\; p^{\exp{p} x}\big)$. } \hfill\\
\text{ And so, any two numbers are the same precisely when they have the same primes: } \hfill\\
\text{ $\qquad x \eq y \;\;≡\;\; \big(∀ p \,•\, \exp{p} x \eq \exp{p} y\big)$. } \hfill\\
}} \right.}
 \\ & \begin{split}∃\, a, b •\; ∀\, p •\; \exp{p}(k · a ^n) \eq \exp{p}(b ^n ) \end{split}\\
 ⇔ \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ When $p$ is prime, $\exp{p}(x · y) \eq \exp{p} x \,+\, \exp{p} y$. } \hfill\\
\text{ Aside: In general, $\exp{p}(Π \,i\, \,•\, x_i) \eq (Σ \,i\, \,•\, \exp{p} x_i)$. } \hfill\\
}} \right.}
 \\ & \begin{split}∃\, a, b •\; ∀\, p •\; \exp{p} k + n · \exp{p} a \eq n · \exp{p} b \end{split}\\
 ⇔ \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Use arithmetic to collect similar terms. } \hfill\\
}} \right.}
 \\ & \begin{split}∃\, a, b •\; ∀\, p •\; \exp{p} k \eq  n · \Big(\exp{p} b - \exp{p} a\Big) \end{split}\\
 ⇔ \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ (⇒) is the definition of multiplicity; } \hfill\\
\text{ (⇐) take $a \,≔\, 1$ and define $b$ by its prime powers: } \hfill\\
\text{ $\qquad ∀\, p \,•\, \exp{p} b \,≔\, {\exp{p} k \,/\, n}$ } \hfill\\
}} \right.}
 \\ & \begin{split}∀\, p •\; \exp{p} k \text{ is a multiple of } n  \end{split}\\
 ⇔ \;\; & \qquad \color{maroon}{\left[ {\large\substack{\text{ Fundamental theorem of arithmetic and definition of ‘perfect’ } \hfill\\
}} \right.}
 \\ & \begin{split}k \text{ is a perfect $n$-th power; i.e., of the shape } x^n  \end{split}
\end{align*}$$


</details>

<hr />

<p>
Possibly Useful links:
</p>
<ul class="org-ul">
<li><a href="https://www.onemathematicalcat.org/MathJaxDocumentation/TeXSyntax.htm">TeX Commands available in MathJax</a></li>
<li>MathJax crashes if <code>\label</code> names are not unique &#x2014;e.g., for labelled
equations, see “1 + 1 = 2” example above.</li>
</ul>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="orange">
                         ★ What if I want to do this in LaTeX (e.g., for math.stackexchange.com)?
                      </font>
                    </strong>
                  </summary>
<p>
<a class="anchor" aria-hidden="true" id="equational-proofs-in-LaTeX" href="#equational-proofs-in-LaTeX"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16
   16" width="16" height="16"><path fill-rule="evenodd"
   d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69
   3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10
   5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0
   2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5
   0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55
   13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
Copy-paste the following&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-latex">$
<span style="color: #96A7A9; font-style: italic;">% </span><span style="color: #96A7A9; font-style: italic;">set up \step command</span>
<span style="color: #859900; font-weight: bold;">\def</span>\<span style="color: #b58900;">BEGINstep</span>{ <span style="color: #859900; font-weight: bold;">\left\langle</span> }
<span style="color: #859900; font-weight: bold;">\def</span>\<span style="color: #b58900;">ENDstep</span>{ <span style="color: #859900; font-weight: bold;">\right\rangle</span> }
<span style="color: #859900; font-weight: bold;">\newcommand</span>{<span style="color: #b58900;">\step</span>}[2][=]{ <span style="color: #b58900;">\\</span> #1 <span style="color: #859900; font-weight: bold;">\;\;</span> &amp; <span style="color: #859900; font-weight: bold;">\qquad</span> <span style="color: #859900; font-weight: bold;">\color</span>{maroon}{<span style="color: #859900; font-weight: bold;">\BEGINstep\text</span>{ #2 } <span style="color: #859900; font-weight: bold;">\ENDstep</span>} <span style="color: #b58900;">\\</span> &amp; }
<span style="color: #96A7A9; font-style: italic;">% </span><span style="color: #96A7A9; font-style: italic;">multi-line step with </span><span style="color: #96A7A9; font-style: italic; text-decoration: underline;">many</span><span style="color: #96A7A9; font-style: italic;"> lines of text</span>
<span style="color: #859900; font-weight: bold;">\newcommand</span>{<span style="color: #b58900;">\line</span>}[1]{ <span style="color: #859900; font-weight: bold;">\text</span>{#1}<span style="color: #859900; font-weight: bold;">\hfill</span><span style="color: #b58900;">\\</span> }
<span style="color: #859900; font-weight: bold;">\newcommand</span>{<span style="color: #b58900;">\stepmany</span>}[2][=]{ <span style="color: #b58900;">\\</span> #1 <span style="color: #859900; font-weight: bold;">\;\;</span> &amp; <span style="color: #859900; font-weight: bold;">\qquad</span> <span style="color: #859900; font-weight: bold;">\color</span>{maroon}{<span style="color: #859900; font-weight: bold;">\BEGINstep</span> <span style="color: #859900; font-weight: bold;">\large\substack</span>{ #2 } <span style="color: #859900; font-weight: bold;">\ENDstep</span>} <span style="color: #b58900;">\\</span> &amp; }
<span style="color: #96A7A9; font-style: italic;">% </span><span style="color: #96A7A9; font-style: italic;">multi-line step with 4 lines of text</span>
<span style="color: #859900; font-weight: bold;">\newcommand</span>{<span style="color: #b58900;">\stepfour</span>}[5][=]{ <span style="color: #859900; font-weight: bold;">\stepmany</span>[#1]{<span style="color: #859900; font-weight: bold;">\line</span>{#2} <span style="color: #859900; font-weight: bold;">\line</span>{#3} <span style="color: #859900; font-weight: bold;">\line</span>{#4}
<span style="color: #859900; font-weight: bold;">\line</span>{#5}} }
<span style="color: #859900; font-weight: bold;">\newenvironment</span>{<span style="color: #b58900;">calc</span>}{<span style="color: #859900; font-weight: bold;">\begin</span>{<span style="color: #b58900;">align*</span>} &amp; }{<span style="color: #859900; font-weight: bold;">\end</span>{<span style="color: #b58900;">align*</span>}}
$
</pre>
</div>
<p>
Then, use it as follows&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-latex"><span style="color: #859900; font-weight: bold;">\begin</span>{<span style="color: #b58900;">calc</span>}
x
<span style="color: #859900; font-weight: bold;">\step</span>{reason for equality}
y
<span style="color: #859900; font-weight: bold;">\step</span>[<span style="color: #859900; font-weight: bold;">\leq</span>]{reason for inclusion}
z
<span style="color: #859900; font-weight: bold;">\end</span>{<span style="color: #b58900;">calc</span>}
</pre>
</div>


</details>
</div>
</div>

<div id="outline-container-Summary" class="outline-2">
<h2 id="Summary"><span class="section-number-2">12</span> <a href="#Summary">Summary</a></h2>
<div class="outline-text-2" id="text-Summary">
<blockquote>
<p>
The full article may be read as a <a href="https://alhassy.github.io/org-special-block-extras/index.pdf">PDF</a> or as <a href="https://alhassy.github.io/org-special-block-extras">HTML</a> &#x2014;or visit the <a href="https://github.com/alhassy/org-special-block-extras">repo</a>.
</p>
</blockquote>

<p>
<a class="anchor" aria-hidden="true" id="summary" href="#summary"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16
   16" width="16" height="16"><path fill-rule="evenodd"
   d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69
   3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10
   5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0
   2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5
   0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55
   13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
Let <code>𝒞</code> be any of the following: <code>black</code>, <code>blue</code>, <code>brown</code>, <code>cyan</code>, <code>darkgray</code>, <code>gray</code>, <code>green</code>,
<code>lightgray</code>, <code>lime</code>, <code>magenta</code>, <code>olive orange</code>, <code>pink</code>, <code>purple</code>, <code>red</code>, <code>teal</code>, <code>violet</code>, <code>white</code>,
<code>yellow</code>.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Idea</th>
<th scope="col" class="org-left">Documentation</th>
<th scope="col" class="org-left">Link only?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Colours</td>
<td class="org-left"><code>𝒞</code>, <abbr class="tooltip" title="Declare but do not display the CONTENTS according to the BACKEND.<br><br>(fn BACKEND RAW-CONTENTS &optional MAIN-ARG &rest ## &key (O-LINK\? nil))">latex-definitions</abbr>, <abbr class="tooltip" title="Format text according to a given COLOR, which is black by default.<br><br>(fn BACKEND RAW-CONTENTS &optional COLOR &rest ## &key (O-LINK\? nil))">color</abbr></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Parallel</td>
<td class="org-left"><abbr class="tooltip" title="Place ideas side-by-side, possibly with a separator.<br><br>There are COLS many columns, and they may be seperated by black<br>solid vertical rules if BAR is a non-nil value.<br><br>Writing “#+begin_parallel 𝓃 :bar (any text except ‘nil’)”<br>will produce a parallel of 𝓃 many columns, possibly<br>seperated by solid rules, or a “bar”.<br><br>The contents of the block may contain ‘#+columnbreak:’ to request<br>a columnbreak. This has no effect on HTML export since HTML<br>describes how text should be formatted on a browser, which can<br>dynamically shrink and grow and thus it makes no sense to have<br>hard columnbreaks. We do replace such declarations by ‘<p><br>’,<br>which sometimes accomplishes the desired goal.<br><br>(fn BACKEND RAW-CONTENTS &optional COLS &rest ## &key (O-LINK\? nil) (BAR nil))">parallel</abbr></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Editorial Comments</td>
<td class="org-left"><abbr class="tooltip" title="Format CONTENTS as an first-class editor comment according to BACKEND.<br><br>The CONTENTS string has an optional switch: If it contains a line<br>with having only ‘#+replacewith:’, then the text preceding this<br>clause should be replaced by the text after it; i.e., this is<br>what the EDITOR (the person editing) intends and so we fromat the<br>replacement instruction (to the authour) as such.<br><br>In Emacs, as links, editor remarks are shown with a bold red; but<br>the exported COLOR of a remark is black by default and it is not<br>STRONG ---i.e., bold---. There is an optional SIGNOFF message<br>that is appended to the remark.<br><br>(fn BACKEND RAW-CONTENTS &optional EDITOR &rest ## &key (O-LINK\? nil) (COLOR ''black'') (SIGNOFF '''') (STRONG nil))">remark</abbr></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Folded Details</td>
<td class="org-left"><abbr class="tooltip" title="Enclose contents in a folded up box, for HTML.<br><br>For LaTeX, this is just a boring, but centered, box.<br><br>By default, the TITLE of such blocks is “Details”<br>and its TITLE-COLOR is green.<br><br>In HTML, we show folded, details, regions with a nice greenish colour.<br><br>In the future ---i.e., when I have time---<br>it may be prudent to expose more aspects as arguments,<br>such as ‘background-color’.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (O-LINK\? nil) (TITLE-COLOR ''green''))">details</abbr> ,  <abbr class="tooltip" title="Enclose text in a box, possibly with a title.<br><br>By default, the box’s COLOR is green for HTML and red for LaTeX,<br>and it has no TITLE.<br><br>The HTML export uses a padded div, whereas the LaTeX export<br>requires the tcolorbox pacakge.<br><br>In the future, I will likely expose more arguments.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (O-LINK\? nil) (BACKGROUND-COLOR nil))">box</abbr></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Keystrokes</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>kbd</code></td>
</tr>

<tr>
<td class="org-left">OctoIcons &amp; Link Here</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>octoicon</code>, <code>link-here</code></td>
</tr>

<tr>
<td class="org-left">Documentation-Glossary</td>
<td class="org-left"><abbr class="tooltip" title="Register the dictionary entries in CONTENTS to the dictionary variable.<br><br>The dictionary variable is ‘o--docs’.<br><br>A documentation entry may have its LABEL, its primary identifier,<br>be:<br>1. Omitted<br>2. Given as a single symbol<br>3. Given as a many aliases ’(lbl₀ lbl₁ … lblₙ)<br><br>The third case is for when there is no canonical label to refer to<br>an entry, or it is convenient to use multiple labels for the same<br>entry.<br><br>In all of the above cases, two additional labels are included:<br>The entry name with spaces replaced by underscores, and again but<br>all lower case.<br><br>Documentation blocks are not shown upon export;<br>unless SHOW is non-nil, in which case they are shown<br>using the ‘box’ block, with the provided COLOR passed to it.<br><br>In the futture, it may be nice to have an option to render tooltips.<br>That’d require the ‘doc:𝒳’ link construction be refactored via a ‘defun’.<br><br>(fn BACKEND RAW-CONTENTS &optional NAME &rest ## &key (O-LINK\? nil) (LABEL nil) (SHOW nil) (COLOR ''green''))">documentation</abbr></td>
<td class="org-left"><code>doc</code></td>
</tr>

<tr>
<td class="org-left">Marginal remarks</td>
<td class="org-left"><abbr class="tooltip" title="Produce an HTML tooltip or a LaTeX margin note.<br><br>The ‘margin’ block is intended for “one-off” (mostly optional) remarks.<br><br>For notes that you want to use repeatedly, in multiple articles<br>or in multiple locations in the same article, consider using<br>‘documentation’ to declare them and ‘doc’ to invoke them.<br><br>For LaTeX, place ‘#+resize:’ to have the remainder of a block be<br>resized, for now 1.3 the margin width ---requires \usepackage{adjustbox}.<br><br><hr><br><br>WIDTH, COUNTER, and COLOR are LaTeX specfic.<br><br>When no label, marker, is used for a marginal note, we rely<br>on a COUNTER, such as ‘footnote’ (default) or ‘sidenote.’<br>Since HTML has no margin per se, we use “∘” as default marker:<br>Users hover over it to read the marginal note.<br><br>Marginal notes have their labels, markers, in black<br>and the notes themselves have COLOR being grey!80.<br>In Emacs, margin links appear grey with an orange tinted boarder.<br><br>Regarding LaTeX, since verbatim environments do not in general work well<br>as arguments to other commands, such as ‘\marginpar’, we save the contents<br>of the special block in a ‘minipage’ within a LaTeX ‘box’; then we can unfold such<br>a box in the margin. Hence, ‘src’ blocks can appear within ‘margin’ blocks (•̀ᴗ•́)و<br><br>The WIDTH argument is the width of the margin; i.e., the width of the underlying<br>minipage.<br><br>One could use \maxsizebox{.25\textwidth}{\textheight}{ ... }<br>which only resizes the content if its natural size is larger than<br>the given 〈width〉 or 〈height〉.&emsp;We don’t use this, since<br>maxsizebox does not natively allow linebreaks<br>(e.g., one would wrap contents in a tabular environment then use<br>‘\\’, two backslashes, to request a line break; but this<br>crashes if one wants to also use verbatim environments.)<br><br>In LaTeX, it may be useful to invoke ‘\dotfill’.<br><br>(fn BACKEND RAW-CONTENTS &optional MARKER &rest ## &key (O-LINK\? nil) (COLOR ''gray!80'') (COUNTER ''footnote'') (WIDTH ''\\paperwidth - \\textwidth - \\oddsidemargin - 1in - 3ex''))">margin</abbr></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Badges</td>
<td class="org-left"><abbr class="tooltip" title="Make a link NAME whose export is presented as an SVG badge.<br><br>If the link is intend to be a social badge, then, adhering to<br>shield.io conventions, the appropriate SOCIAL-SHIELDS-NAME must<br>be given.<br><br>The SOCIAL-URL is a URL that the badge points to and it should<br>have a single ‘%s’ where the link label argument will go.<br><br>Some social badges have a uniform URL, but otherwise, such as<br>twitter, deviate and so need their own SOCIAL-SHIELDS-URL,<br>which has a single ‘%s’ for the link’s label argument.<br><br><hr><br><br>E.g., to create a badge named “go”:<br><br>&emsp;&emsp; (o-make-badge ''go'')<br><br>Then the following exports nicely from an Org file:<br><br>&emsp;&emsp; go:key|value|blue|here|gnu-emacs">badge</abbr></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Equational proofs</td>
<td class="org-left"><abbr class="tooltip" title="Render an Org-list as an equational proof.<br><br>Sometimes the notation delimiting justification hints may clash<br>with the domain topic, so we can change the hint format, e.g., to<br>''\left\langle %s \right\rangle''.&emsp;Set HINT-FORMAT to the<br>empty string, '''', to comment-out all hints in the exported<br>version.<br><br>The hint is the text immediately after a “--”, if there are<br>multiple such delimiters only the first is shown; this can be<br>useful if we want to have multiple alternatives, say for extra<br>details in the source but not so much in the export.<br><br>Line breaks are taken literally in the hints, but not in the<br>math; where one uses \\.&emsp;For math with multiple lines, use ‘&’<br>as an alignment marker; otherwise math is right-justified.<br><br>For HTML, to use an TeX it must be enclosed in $, since that is<br>what is required by MathJaX.<br><br>(fn BACKEND RAW-CONTENTS &optional MAIN-ARG &rest ## &key (O-LINK\? nil) (REL ''='') (HINT-FORMAT ''\\left[ %s \\right.'') (EXPLICIT-VSPACE 2) (COLOR ''maroon''))">calc</abbr></td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Other fun stuff: <abbr class="tooltip" title="Show the answers to a problem, but with a reprimand in case no attempt was made.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (O-LINK\? nil) (REPRIMAND ''Did you actually try? Maybe see the ‘hints’ above!'') (REALLY ''Solution, for real''))">solution</abbr>, <abbr class="tooltip" title="Output the CONTENTS of the block as both parsed Org and unparsed.<br><br>Label the source text by SOURCE and the result text by RESULT<br><br>finally, the source-result fragments can be shown in a STYLE<br>that is either “parallel” (default) or “sequential”.<br><br>SEP is the separator; e.g., a rule ‘<hr>’.<br><br>(fn BACKEND RAW-CONTENTS &optional MAIN-ARG &rest ## &key (O-LINK\? nil) (SOURCE ''Source'') (RESULT ''Result'') (SOURCE-COLOR ''cyan'') (RESULT-COLOR ''cyan'') (STYLE ''parallel'') (SEP (if (equal backend 'html) ''@@html:<p><br>@@'' ''\n\n\n\n'')))">org-demo</abbr>, <abbr class="tooltip" title="Output the CONTENTS of the block REPS many times<br><br>(fn BACKEND RAW-CONTENTS &optional REPS &rest ## &key (O-LINK\? nil))">stutter</abbr>, <abbr class="tooltip" title="Perform the given LIST of substitutions on the text.<br>The LIST is a comma separated list of ‘to’ separated symbols.<br>In a link, no quotes are needed.<br><br>(fn BACKEND RAW-CONTENTS &optional LIST &rest ## &key (O-LINK\? nil))">rename</abbr>, <abbr class="tooltip" title="Hide text enclosed in double parens ((like this)) as if it were spoilers.<br>&emsp; LEFT and RIGHT may be other kinds of delimiters.<br>&emsp; The main argument, COLOR, indicates which color to use.<br><br>For LaTeX, this becomes “fill in the blanks”, with the answers<br>in the footnotes.<br><br>(fn BACKEND RAW-CONTENTS &optional COLOR &rest ## &key (O-LINK\? nil) (LEFT ''(('') (RIGHT ''))''))">spoiler</abbr>, <abbr class="tooltip" title="Write a proof tree using Org-lists.<br><br>To get<br><br>&emsp;&emsp;&emsp;&emsp; premises₀&emsp;…&emsp; premisesₙ<br>&emsp;&emsp;&emsp; ────────────────────────────[ reason ]<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; conclusion<br><br>You type<br><br>&emsp;&emsp;&emsp; #+begin_tree<br>&emsp;&emsp;&emsp; + reason :: conclusion<br>&emsp;&emsp;&emsp;&emsp; - premises₀<br>&emsp;&emsp;&emsp;&emsp; - premises₁<br>&emsp;&emsp;&emsp;&emsp; ⋮<br>&emsp;&emsp;&emsp;&emsp; - premisesₙ<br>&emsp;&emsp;&emsp; #+end_tree<br><br>Where each premisesᵢ may, recursively, also have named reasons<br>and (indented) child premises of its own.<br><br>If there are multiple trees, they are shown one after the other.<br><br>The text in this block should be considered LaTeX;<br>as such, Org markup is not recognised.<br><br>A proof tree, derivation, is then just a deeply nested<br>itemisation.&emsp;For instance, assuming P = Q(X), X = Y, Q(Y) = R,<br>the following proves P = R.<br><br>&emsp;#+begin_tree<br>&emsp;+ Trans :: P = R<br>&emsp;&emsp;- P = Q(X)<br>&emsp;&emsp;&emsp;+ ✓<br>&emsp;&emsp;- Trans :: Q(X) = R<br>&emsp;&emsp;&emsp;+ Trans :: Q(X) = Q(Y)<br>&emsp;&emsp;&emsp;&emsp;- Refl :: Q(X) = Q(X)<br>&emsp;&emsp;&emsp;&emsp;&emsp;+ ✓<br>&emsp;&emsp;&emsp;&emsp;- Leibniz :: Q(X) = Q(Y)<br>&emsp;&emsp;&emsp;&emsp;&emsp;+ X = Y<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;- ✓<br>&emsp;&emsp;&emsp;+ Sym :: Q(Y) = R<br>&emsp;&emsp;&emsp;&emsp;- R = Q(Y)<br>&emsp;&emsp;&emsp;&emsp;&emsp;- ✓<br>&emsp;#+end_tree<br><br>(fn BACKEND RAW-CONTENTS &optional MAIN-ARG &rest ## &key (O-LINK\? nil))">tree</abbr> :grin:
</p>

<p>
There are also the social badge links:
<code>reddit-subscribe-to</code>, <code>github-followers</code>, <code>github-forks</code>, <code>github-stars, github-watchers</code>, <code>twitter-follow</code>, and <code>tweet</code>.
</p>
</div>

<div id="outline-container-Installation-Instructions" class="outline-3">
<h3 id="Installation-Instructions"><span class="section-number-3">12.1</span> <a href="#Installation-Instructions">Installation Instructions</a></h3>
<div class="outline-text-3" id="text-Installation-Instructions">
<p>
Manually or using <a href="https://github.com/alhassy/emacs.d#installing-emacs-packages-directly-from-source">quelpa</a>:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">&#10216;0&#10217; Download the org-special-block-extras.el file manually or using quelpa</span>
(<span style="color: #b58900;">quelpa</span> '(org-special-block-extras <span style="color: #d33682; font-style: italic;">:fetcher</span> github <span style="color: #d33682; font-style: italic;">:repo</span>
<span style="color: #2aa198;">"alhassy/org-special-block-extras"</span>))

<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">&#10216;1&#10217; Have this always active in Org buffers</span>
(<span style="color: #b58900;">add-hook</span> #'<span style="color: #268bd2;">org-mode-hook</span> #'<span style="color: #b58900;">org-special-block-extras-mode</span>)

<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">&#10216;1&#8242;&#10217; Or use: &#8220;M-x org-special-block-extras-mode&#8221; to turn it on/off</span>
</pre>
</div>

<p>
<b>Or</b> with <a href="https://github.com/alhassy/emacs.d#use-package-the-start-of-initel">use-package</a>:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">use-package</span> <span style="color: #6c71c4; font-weight: bold;">org-special-block-extras</span>
  <span style="color: #d33682; font-style: italic;">:ensure</span> <span style="color: #268bd2;">t</span>
  <span style="color: #d33682; font-style: italic;">:hook</span> (<span style="color: #b58900;">org-mode</span> . <span style="color: #b58900;">org-special-block-extras-mode</span>)
  <span style="color: #d33682; font-style: italic;">:custom</span>
    <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The places where I keep my &#8216;#+documentation&#8217;</span>
    (<span style="color: #268bd2;">o-docs-libraries</span>
     '(<span style="color: #2aa198;">"~/org-special-block-extras/documentation.org"</span>))
    <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Details heading &#8220;flash pink&#8221; whenever the user hovers over them?</span>
    (<span style="color: #268bd2;">org-html-head-extra</span> (<span style="color: #b58900;">concat</span> <span style="color: #268bd2;">org-html-head-extra</span> <span style="color: #2aa198;">"&lt;style&gt;  summary:hover {background:pink;} &lt;/style&gt;"</span>))
    <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The message prefixing a &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">tweet:url</span><span style="color: #96A7A9; font-style: italic;">&#8217; badge</span>
    (<span style="color: #268bd2;">o-link-twitter-excitement</span>
     <span style="color: #2aa198;">"This looks super neat (&#8226;&#768;&#7447;&#8226;&#769;)&#1608;:"</span>))
</pre>
</div>

<p>
Then, provide support for a new type of special block, say re-using the <code>src</code>
blocks that, say, folds up all such blocks in HTML export, by declaring the
following.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">o-defblock</span> src (lang nil) (title nil exports nil file nil)
  <span style="color: #2aa198;">"Fold-away all &#8216;</span><span style="color: #6c71c4; font-weight: bold;">src</span><span style="color: #2aa198;">&#8217; blocks as &#8216;</span><span style="color: #6c71c4; font-weight: bold;">&lt;details&gt;</span><span style="color: #2aa198;">&#8217; HTML export.</span>
<span style="color: #2aa198;">If a block has a &#8216;</span><span style="color: #6c71c4; font-weight: bold;">:title</span><span style="color: #2aa198;">&#8217;, use that to title the &#8216;</span><span style="color: #6c71c4; font-weight: bold;">&lt;details&gt;</span><span style="color: #2aa198;">&#8217;."</span>
  (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;details&gt; &lt;summary&gt; %s &lt;/summary&gt; &lt;pre&gt; %s &lt;/pre&gt;&lt;/details&gt;"</span>
          (<span style="color: #859900; font-weight: bold;">or</span> title (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"Details; "</span> lang))
          raw-contents))
</pre>
</div>
</div>
</div>

<div id="outline-container-Minimal-working-example" class="outline-3">
<h3 id="Minimal-working-example"><span class="section-number-3">12.2</span> <a href="#Minimal-working-example">Minimal working example</a></h3>
<div class="outline-text-3" id="text-Minimal-working-example">
<p>
The following example showcases the prominent features of this library.
</p>

<pre class="example" id="org46dbddd">
#+begin_parallel
[[color:orange][Are you excited to learn some Lisp?]] [[blue:Yes!]]

Pop-quiz: How does doc:apply work?
#+end_parallel

#+begin_details Answer
link-here:solution
Syntactically, ~(apply f '(x0 ... xN)) = (f x0 ... xN)~.

[[remark:Musa][Ain't that cool?]]

#+begin_spoiler aqua
That is, [[color:magenta][we can ((apply)) a function to a list of arguments!]]
#+end_spoiler

#+end_details

#+html: &lt;br&gt;
#+begin_box
octoicon:report Note that kbd:C-x_C-e evaluates a Lisp form!
#+end_box

/Allah[[margin:][The God of Abraham; known as Elohim in the Bible]] does
not burden a soul beyond what it can bear./ --- Quran 2:286

#+LATEX_HEADER: \usepackage{multicol}
#+LATEX_HEADER: \usepackage{tcolorbox}
#+latex: In the LaTeX output, we have a glossary.

show:GLOSSARY

badge:Thanks|for_reading
tweet:https://github.com/alhassy/org-special-block-extras
badge:|buy_me_a coffee|gray|https://www.buymeacoffee.com/alhassy|buy-me-a-coffee
</pre>

<p>
Here is what it looks like as HTML (left) and LaTeX (right):
</p>

<div id="org5e46a24" class="figure">
<p><img src="images/minimal-working-example.png" alt="minimal-working-example.png" width="800px" />
</p>
</div>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Tests
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #96A7A9; font-style: italic;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Run all MWE tests</span>
<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">(ert "mwe")</span>

(<span style="color: #859900; font-weight: bold;">setq</span> mwe (<span style="color: #b58900;">&#10224;</span>
 <span style="color: #2aa198;">"</span>
<span style="color: #2aa198;">#+begin_parallel</span>
<span style="color: #2aa198;">[[color:orange][Are you excited to learn some Lisp?]] [[blue:Yes!]]</span>

<span style="color: #2aa198;">Pop-quiz: How does doc:apply work?</span>
<span style="color: #2aa198;">#+end_parallel</span>

<span style="color: #2aa198;">#+begin_details Answer</span>
<span style="color: #2aa198;">link-here:solution</span>
<span style="color: #2aa198;">Syntactically, ~(apply f '(x0 ... xN)) = (f x0 ... xN)~.</span>

<span style="color: #2aa198;">[[remark:Musa][Ain't that cool?]]</span>

<span style="color: #2aa198;">#+begin_spoiler aqua</span>
<span style="color: #2aa198;">That is, [[color:magenta][we can ((apply)) a function to a list of arguments!]]</span>
<span style="color: #2aa198;">#+end_spoiler</span>

<span style="color: #2aa198;">#+end_details</span>

<span style="color: #2aa198;">#+html: &lt;br&gt;</span>
<span style="color: #2aa198;">#+begin_box</span>
<span style="color: #2aa198;">octoicon:report Note that kbd:C-x_C-e evaluates a Lisp form!</span>
<span style="color: #2aa198;">#+end_box</span>

<span style="color: #2aa198;">/Allah [[margin:][The God of Abraham; known as Elohim in the Bible]] does not burden a soul</span>
<span style="color: #2aa198;">beyond what it can bear./ --- Quran 2:286</span>

<span style="color: #2aa198;">#+LATEX_HEADER: \\usepackage{multicol}</span>
<span style="color: #2aa198;">#+LATEX_HEADER: \\usepackage{tcolorbox}</span>
<span style="color: #2aa198;">#+latex: In the LaTeX output, we have a glossary.</span>

<span style="color: #2aa198;">show:GLOSSARY</span>

<span style="color: #2aa198;">badge:Thanks|for_reading</span>
<span style="color: #2aa198;">tweet:https://github.com/alhassy/org-special-block-extras</span>
<span style="color: #2aa198;">badge:|buy_me_a&#160;coffee|gray|https://www.buymeacoffee.com/alhassy|buy-me-a-coffee</span>
<span style="color: #2aa198;">"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It exports to HTML without any problems"</span>
  [mwe html-export]
  (<span style="color: #b58900;">find-file</span> <span style="color: #2aa198;">"mwe.org"</span>)
  (<span style="color: #859900; font-weight: bold;">should</span> (<span style="color: #b58900;">org-html-export-to-html</span>)))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It starts with a 2-column div for &#8216;</span><span style="color: #6c71c4; font-weight: bold;">parallel</span><span style="color: #2aa198;">&#8217;"</span>
  [mwe parallel]
  (&#8669; mwe <span style="color: #2aa198;">"&lt;div style=\"column-rule-style: none;column-count: 2;\"&gt;"</span>
         (<span style="color: #b58900;">*</span> anything)
         <span style="color: #2aa198;">"&lt;/div&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"Its initial question is in &#8216;</span><span style="color: #6c71c4; font-weight: bold;">orange</span><span style="color: #2aa198;">&#8217;, with answer in &#8216;</span><span style="color: #6c71c4; font-weight: bold;">blue</span><span style="color: #2aa198;">&#8217;"</span>
  [mwe color orange blue]
  (&#8669; mwe <span style="color: #2aa198;">"&lt;span style=\"color:orange;\"&gt;Are you excited to learn some Lisp?&lt;/span&gt;"</span>
         (<span style="color: #b58900;">*</span> anything)
         <span style="color: #2aa198;">"&lt;span style=\"color:blue;\"&gt;Yes!&lt;/span&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"Its second question, about &#8216;</span><span style="color: #6c71c4; font-weight: bold;">apply</span><span style="color: #2aa198;">&#8217;, has a tooltip"</span>
  [mwe doc]
  (&#8669; mwe <span style="color: #2aa198;">"Pop-quiz: How does "</span>
         <span style="color: #2aa198;">"&lt;abbr class=\"tooltip\" title=\"Call FUNCTION with our remaining args, "</span>
         <span style="color: #2aa198;">"using our last arg as list of args.&lt;br&gt;Then return the value FUNCTION returns."</span>
         <span style="color: #2aa198;">"&lt;br&gt;Thus, (apply '+ 1 2 '(3 4)) returns 10.&lt;br&gt;&lt;br&gt;(fn FUNCTION &amp;rest ARGUMENTS)\""</span>
         <span style="color: #2aa198;">"&gt;apply&lt;/abbr&gt; work?"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"Its &#8216;</span><span style="color: #6c71c4; font-weight: bold;">details</span><span style="color: #2aa198;">&#8217; block is titled &#8220;Answer&#8221;, in green"</span>
  [mwe details]
  (&#8669; mwe
     <span style="color: #2aa198;">"&lt;details"</span>
     (<span style="color: #b58900;">*</span> anything) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">styling</span>
     <span style="color: #2aa198;">"&lt;summary&gt;"</span>
     (<span style="color: #b58900;">*</span> anything) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">styling</span>
     <span style="color: #2aa198;">"&lt;font face=\"Courier\" size=\"3\" color=\"green\"&gt;"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"Answer"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"Its details block begins with an SVG anchor identified as &#8216;</span><span style="color: #6c71c4; font-weight: bold;">solution</span><span style="color: #2aa198;">&#8217;"</span>
  [mwe link-here]
  (&#8669; mwe <span style="color: #2aa198;">"&lt;details"</span>
         (<span style="color: #b58900;">*</span> anything) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">styling</span>
         <span style="color: #2aa198;">"&lt;a class=\"anchor\""</span>
         (<span style="color: #b58900;">*</span> anything)
         <span style="color: #2aa198;">"href=\"#solution\"&gt;"</span> <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">link-here:solution</span>
         <span style="color: #2aa198;">"&lt;svg"</span>
         (<span style="color: #b58900;">*</span> anything)
         <span style="color: #2aa198;">"&lt;/svg&gt;&lt;/a&gt;"</span>
         (<span style="color: #b58900;">*</span> anything)
         <span style="color: #2aa198;">"Syntactically, &lt;code&gt;(apply f '(x0 ... xN)) = (f x0 ... xN)&lt;/code&gt;."</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"Its top-level remark is my name in a box, then the text, then a closing box delimiter"</span>
  [mwe remark]
  (&#8669; mwe <span style="color: #2aa198;">"&lt;details"</span>
         (<span style="color: #b58900;">*</span> anything)
         <span style="color: #2aa198;">"&lt;p style=\"color: black;\"&gt;"</span>
         <span style="color: #2aa198;">"&lt;span style=\"border-width:1px;border-style:solid;padding:5px\"&gt;"</span>
         <span style="color: #2aa198;">"&lt;strong&gt;[Musa:&lt;/strong&gt;"</span>
         <span style="color: #2aa198;">"&lt;/span&gt;"</span>
         <span style="color: #2aa198;">" Ain't that cool?  "</span>
         <span style="color: #2aa198;">"&lt;span style=\"border-width:1px;border-style:solid;padding:5px\"&gt;&lt;strong&gt;]&lt;/strong&gt;&lt;/span&gt;"</span>
         ))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"The aqua-coloured &#8216;</span><span style="color: #6c71c4; font-weight: bold;">spoiler</span><span style="color: #2aa198;">&#8217; appears within a magenta coloured piece of text"</span>
  [mwe spoiler color magenta <span style="color: #b58900;">gensym</span>]

  (&#8669; mwe <span style="color: #2aa198;">"&lt;details"</span>
         (<span style="color: #b58900;">*</span> anything)
         <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The local spoiler style is declared</span>
         <span style="color: #2aa198;">"&lt;style&gt;"</span>
         (<span style="color: #b58900;">*</span> anything) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">A random id; e.g., #g289</span>
         <span style="color: #2aa198;">"{color: aqua; background-color:aqua;}"</span>
         (<span style="color: #b58900;">*</span> anything)
         <span style="color: #2aa198;">":hover {color: black; background-color:white;} "</span>
         <span style="color: #2aa198;">"&lt;/style&gt;"</span>
         (<span style="color: #b58900;">*</span> anything)
         <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Then it is used</span>
         <span style="color: #2aa198;">"That is, &lt;span style=\"color:magenta;\"&gt;"</span>
         <span style="color: #2aa198;">"we can &lt;span id="</span>
         (<span style="color: #b58900;">*</span> anything) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">our random id is used here</span>
         <span style="color: #2aa198;">"&gt; apply &lt;/span&gt;"</span> <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Here is the spoiler!</span>
         <span style="color: #2aa198;">" a function to a list of arguments!&lt;/span&gt;"</span>
         (<span style="color: #b58900;">*</span> anything)
         <span style="color: #2aa198;">"&lt;/details&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It has a title-less green box starting with an octoicon"</span>
  [mwe box octoicon <span style="color: #b58900;">kbd</span>]
  <span style="color: #d33682; font-style: italic;">:expected-result</span> <span style="color: #d33682; font-style: italic;">:failed</span> <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #dc752f;">FIXME</span><span style="color: #96A7A9; font-style: italic;"> The MWE has been updated, and more tests need to be written.</span>
  (&#8669; mwe
     <span style="color: #2aa198;">"&lt;div style=\"padding: 1em;"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"&lt;h3&gt;&lt;/h3&gt;"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"&lt;svg"</span> <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">octoicon:report</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"Note that &lt;kbd&gt; C-x C-e &lt;/kbd&gt; evaluates a Lisp form!"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"&lt;/div&gt;"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"Its Quranic quote has the user requested tooltip indicated by a small raised circle"</span>
  [mwe margin]
  (&#8669; mwe
     <span style="color: #2aa198;">"Allah &lt;abbr class=\"tooltip\""</span>
     <span style="color: #2aa198;">" title=\"The God of Abraham; known as Elohim in the Bible\"&gt;&#176;&lt;/abbr&gt;&amp;emsp13;"</span> <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">&#8728; !</span>
     <span style="color: #2aa198;">" does not burden a soul beyond what it can bear."</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"Quran 2:286"</span>))

(<span style="color: #859900; font-weight: bold;">deftest</span> <span style="color: #2aa198;">"It concludes with three beautiful badges"</span>
  [mwe badge]
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">badge:Thanks|for_reading</span>
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">tweet:https://github.com/alhassy/org-special-block-extras</span>
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">badge:|buy_me_a&#160;coffee|gray|https://www.buymeacoffee.com/alhassy|buy-me-a-coffee</span>
  (&#8669; mwe
     <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/badge/Thanks-for_reading-nil?logo=nil\"&gt;"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/twitter/url?url=https://github.com/alhassy/org-special-block-extras\"&gt;"</span>
     (<span style="color: #b58900;">*</span> anything)
     <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/badge/-buy_me_a%C2%A0coffee-gray?logo=buy-me-a-coffee\"&gt;"</span>))

<span style="color: #96A7A9; font-style: italic;">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</pre>
</div>


</details>

<p>
The above section, <a href="#practice_problems">‘practice problems’</a>, presents a few puzzles to get you
comfortable with <code>defblock</code> ;-)
</p>

<p>
Other cool stuff&#x2026;
</p>

<div id="orga548949" class="figure">
<p><img src="images/inference-rules.png" alt="inference-rules.png" width="800px" />
</p>
</div>


<div id="orga812b67" class="figure">
<p><img src="images/calculational_proofs.png" alt="calculational_proofs.png" width="800px" />
</p>
</div>


<div id="orgedf4a25" class="figure">
<p><img src="images/marginal_remarks.png" alt="marginal_remarks.png" width="800px" />
</p>
</div>
</div>
</div>

<div id="outline-container-Bye" class="outline-3">
<h3 id="Bye"><span class="section-number-3">12.3</span> <a href="#Bye">Bye!</a></h3>
<div class="outline-text-3" id="text-Bye">
<p>
<img src="https://img.shields.io/badge/thanks-for_reading-nil?logo=nil">
<a href="https://twitter.com/intent/tweet?text=This looks super neat (•̀ᴗ•́)و::&url=https://github.com/alhassy/org-special-block-extras"><img src="https://img.shields.io/twitter/url?url=https://github.com/alhassy/org-special-block-extras"></a>
<a href="https://www.buymeacoffee.com/alhassy"><img src="https://img.shields.io/badge/-buy_me_a%C2%A0coffee-gray?logo=buy-me-a-coffee"></a>
</p>
</div>
</div>
</div>

<p>
<abbr class="tooltip" title="Output the CONTENTS of the block as both parsed Org and unparsed.<br><br>Label the source text by SOURCE and the result text by RESULT<br><br>finally, the source-result fragments can be shown in a STYLE<br>that is either “parallel” (default) or “sequential”.<br><br>SEP is the separator; e.g., a rule ‘<hr>’.<br><br>(fn BACKEND RAW-CONTENTS &optional MAIN-ARG &rest ## &key (O-LINK\? nil) (SOURCE ''Source'') (RESULT ''Result'') (SOURCE-COLOR ''cyan'') (RESULT-COLOR ''cyan'') (STYLE ''parallel'') (SEP (if (equal backend 'html) ''@@html:<p><br>@@'' ''\n\n\n\n'')))">o--org-demo</abbr> <abbr class="tooltip" title="Show the answers to a problem, but with a reprimand in case no attempt was made.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (O-LINK\? nil) (REPRIMAND ''Did you actually try? Maybe see the ‘hints’ above!'') (REALLY ''Solution, for real''))">o--solution</abbr> <abbr class="tooltip" title="Format CONTENTS as an first-class editor comment according to BACKEND.<br><br>The CONTENTS string has an optional switch: If it contains a line<br>with having only ‘#+replacewith:’, then the text preceding this<br>clause should be replaced by the text after it; i.e., this is<br>what the EDITOR (the person editing) intends and so we fromat the<br>replacement instruction (to the authour) as such.<br><br>In Emacs, as links, editor remarks are shown with a bold red; but<br>the exported COLOR of a remark is black by default and it is not<br>STRONG ---i.e., bold---. There is an optional SIGNOFF message<br>that is appended to the remark.<br><br>(fn BACKEND RAW-CONTENTS &optional EDITOR &rest ## &key (O-LINK\? nil) (COLOR ''black'') (SIGNOFF '''') (STRONG nil))">o--remark</abbr> <abbr class="tooltip" title="Declare but do not display the CONTENTS according to the BACKEND.<br><br>(fn BACKEND RAW-CONTENTS &optional MAIN-ARG &rest ## &key (O-LINK\? nil))">o--latex-definitions</abbr> <abbr class="tooltip" title="A <em>(Partial, resp. Total) Graph</em> <em>G = (V, E, src, tgt)</em> consists of<br>&emsp; + <EM>V</EM>, a set of “points, nodes, vertices”<br>&emsp; + <EM>E</EM>, a set of “arcs, edges”<br>&emsp; + <em>src, tgt : E ↔ V</em>, a pair of <em>partial (resp. total)</em> functions.<br><br>⟦ Tersely put, in any category, a <em>graph</em> is a parallel pair of morphisms. ⟧<br><br><em>Edge parallelism</em> is the relation <em>Ξ = src ⨾ src ˘ ∩ tgt ⨾ tgt˘</em>; two arcs are<br>related when they have the same starting point and the same ending point, which<br>both exist. Joyously, the name ‘Ξ’ is a neat reminder of the concept:<br>The name is three parallel lines, for the concept of edge(line) parallelism.<br><br>+ A graph is <em>total</em> exactly when <em>Id ⊆ Ξ</em>; and so Ξ is an equivalence.<br>+ A graph has <em>no parallel arrows</em> exactly when <em>Ξ ⊆ Id</em>.<br>+ A graph is <em>simple</em> exactly when <em>Ξ = Id</em>.<br><br>The <em>associated relation</em> is the relation <em>_⟶_ = src ˘ ⨾ tgt</em> that relates two nodes<br>when the first is the source of some edge that happens to have the second point<br>as its target. One uses the associated relation to study properties not<br>involving partial or parallel arrows. One writes <em>⟵</em> for <em>⟶˘</em>;<br>one writes ⟶⋆ for the <em>reachability</em> relation.<br><br>+ Node <em>y</em> is <em>reachable via a non-empty path</em> from node <em>x</em> exactly when <em>x ⟶⁺ y</em>.<br>&emsp;- Node <em>x</em> lies on a cycle exactly when <em>x ⟶⁺ x</em>.<br>&emsp;- A graph is <em>DAG, acylic, circuit-free,</em> exactly when <em>⟶⁺ ⊆ ∼Id</em>; i.e., <em>⟶⁺ ∩ Id = ⊥</em>.<br>&emsp;- An acyclic graph is a (<em>directed) forest</em> exactly when ⟶ is injective; i.e.,<br>&emsp;&emsp;every node has at most one predecessor; i.e., <em>⟶ ⨾ ⟵ ⊆ Id</em>.<br>+ A node <em>r</em> is a <em>root</em> exactly when every node is reachable from it; i.e., <em>{r} × V ⊆ ⟶⋆;</em><br>&emsp;i.e., <em>𝕃 r ⨾ ⟶⋆ = ⊤</em> where <em>𝕃 r</em> is defined by <em>𝕃 r = (ℝ r)˘</em> and <em>x 〔ℝ r〕 y &#8195;≡&#8195; x = r</em>.<br>&emsp;- <em>x〔𝕃 r ⨾ R〕 y &#8195;≡&#8195; r〔R〕 y</em> and <em>x 〔R ⨾ ℝ r〕 y &#8195;≡&#8195; x 〔R〕 r</em><br>&emsp;- A <em>tree</em> is a forest with a root.<br>+ A graph is <em>loop free</em> exactly when <em>⟶ ⊆ ∼Id</em>.<br>+ A graph is <em>strongly connected</em> exactly when <em>⟶⋆ = ⊤</em>; i.e., <em>∼Id ⊆ ⟶⁺</em>;<br>&emsp;i.e., every point is reachable from any <em>other</em> point; i.e., <em>∼Id ⊆ ⟶ ∩ ⟵˘</em>;<br>&emsp;i.e., any two distinct points lie on an undirected circuit.<br>&emsp;- The equivalence classes of <em>⟶⋆ ∩ ⟵⋆</em> are the <em>strongly connected components</em>.<br>+ <em>Terminal∣sinks</em> are nodes from which it is <em>not</em> possible to proceed <em>any</em> further;<br>&emsp;i.e., terminals have no successors; the domain of <em>∼(⟶ ⨾ ⊤)</em> is all terminals.<br>+ <em>Initial∣sources</em> are nodes from which it is <em>not</em> possible to proceed backward;<br>&emsp;i.e., initials have no predecessors; the domain of <em>∼(⟵ ⨾ ⊤)</em> is all initials.">Graph</abbr> <abbr class="tooltip" title="Render an Org-list as an equational proof.<br><br>Sometimes the notation delimiting justification hints may clash<br>with the domain topic, so we can change the hint format, e.g., to<br>''\left\langle %s \right\rangle''.&emsp;Set HINT-FORMAT to the<br>empty string, '''', to comment-out all hints in the exported<br>version.<br><br>The hint is the text immediately after a “--”, if there are<br>multiple such delimiters only the first is shown; this can be<br>useful if we want to have multiple alternatives, say for extra<br>details in the source but not so much in the export.<br><br>Line breaks are taken literally in the hints, but not in the<br>math; where one uses \\.&emsp;For math with multiple lines, use ‘&’<br>as an alignment marker; otherwise math is right-justified.<br><br>For HTML, to use an TeX it must be enclosed in $, since that is<br>what is required by MathJaX.<br><br>(fn BACKEND RAW-CONTENTS &optional MAIN-ARG &rest ## &key (O-LINK\? nil) (REL ''='') (HINT-FORMAT ''\\left[ %s \\right.'') (EXPLICIT-VSPACE 2) (COLOR ''maroon''))">o--calc</abbr> <abbr class="tooltip" title="Transcode STRING into BACKEND code.<br><br>BACKEND is either an export back-end, as returned by, e.g.,<br>‘org-export-create-backend’, or a symbol referring to<br>a registered back-end.<br><br>When optional argument BODY-ONLY is non-nil, only return body<br>code, without preamble nor postamble.<br><br>Optional argument EXT-PLIST, when provided, is a property list<br>with external parameters overriding Org default settings, but<br>still inferior to file-local settings.<br><br>Return code as a string.<br><br>(fn STRING BACKEND &optional BODY-ONLY EXT-PLIST)">org-export-string-as</abbr> <abbr class="tooltip" title="Produce an HTML tooltip or a LaTeX margin note.<br><br>The ‘margin’ block is intended for “one-off” (mostly optional) remarks.<br><br>For notes that you want to use repeatedly, in multiple articles<br>or in multiple locations in the same article, consider using<br>‘documentation’ to declare them and ‘doc’ to invoke them.<br><br>For LaTeX, place ‘#+resize:’ to have the remainder of a block be<br>resized, for now 1.3 the margin width ---requires \usepackage{adjustbox}.<br><br><hr><br><br>WIDTH, COUNTER, and COLOR are LaTeX specfic.<br><br>When no label, marker, is used for a marginal note, we rely<br>on a COUNTER, such as ‘footnote’ (default) or ‘sidenote.’<br>Since HTML has no margin per se, we use “∘” as default marker:<br>Users hover over it to read the marginal note.<br><br>Marginal notes have their labels, markers, in black<br>and the notes themselves have COLOR being grey!80.<br>In Emacs, margin links appear grey with an orange tinted boarder.<br><br>Regarding LaTeX, since verbatim environments do not in general work well<br>as arguments to other commands, such as ‘\marginpar’, we save the contents<br>of the special block in a ‘minipage’ within a LaTeX ‘box’; then we can unfold such<br>a box in the margin. Hence, ‘src’ blocks can appear within ‘margin’ blocks (•̀ᴗ•́)و<br><br>The WIDTH argument is the width of the margin; i.e., the width of the underlying<br>minipage.<br><br>One could use \maxsizebox{.25\textwidth}{\textheight}{ ... }<br>which only resizes the content if its natural size is larger than<br>the given 〈width〉 or 〈height〉.&emsp;We don’t use this, since<br>maxsizebox does not natively allow linebreaks<br>(e.g., one would wrap contents in a tabular environment then use<br>‘\\’, two backslashes, to request a line break; but this<br>crashes if one wants to also use verbatim environments.)<br><br>In LaTeX, it may be useful to invoke ‘\dotfill’.<br><br>(fn BACKEND RAW-CONTENTS &optional MARKER &rest ## &key (O-LINK\? nil) (COLOR ''gray!80'') (COUNTER ''footnote'') (WIDTH ''\\paperwidth - \\textwidth - \\oddsidemargin - 1in - 3ex''))">o--margin</abbr> <abbr class="tooltip" title="Return an anonymous function.<br>Under dynamic binding, a call of the form (lambda ARGS DOCSTRING<br>INTERACTIVE BODY) is self-quoting; the result of evaluating the<br>lambda expression is the expression itself.&emsp;Under lexical<br>binding, the result is a closure.&emsp;Regardless, the result is a<br>function, i.e., it may be stored as the function value of a<br>symbol, passed to ‘funcall’ or ‘mapcar’, etc.<br><br>ARGS should take the same form as an argument list for a ‘defun’.<br>DOCSTRING is an optional documentation string.<br> If present, it should describe how to call the function.<br> But documentation strings are usually not useful in nameless functions.<br>INTERACTIVE should be a call to the function ‘interactive’, which see.<br>It may also be omitted.<br>BODY should be a list of Lisp expressions.<br><br>(fn ARGS [DOCSTRING] [INTERACTIVE] BODY)">lambda</abbr> <abbr class="tooltip" title="Essentially, ‘lf-documentation’ ≈ ‘documentation’ + ‘documentation-property’.<br><br>If the final argument NEWDOC is provided, then this function becomes a setter;<br>otherwise it is a getter.<br><br>By default, Emacs Lisp’s ‘documentation’ returns the function documentation of<br>a given symbol.&emsp;As such, ours will be biased towards variable documentation.<br><br>(lf-documentation NAME ’function)&emsp;≈&emsp;(documentation NAME).<br><br>Interestingly, Common Lisp’s ‘documentation’ primitive takes<br>two arguments, NAME and KIND.&emsp;We have based ours on Common Lisp’s.<br><br>(fn NAME &optional KIND NEWDOC)">lf-documentation</abbr> <abbr class="tooltip" title="Insert a “doc:𝒳” link from user’s documentation-glossary database.<br><br>It can be tricky to remember what you have, or what documentation entries mention, and so<br>this command gives a searchable way to insert doc links.">o-docs-insert</abbr> <abbr class="tooltip" title="Load documentation-glossary libraries LIBS.<br><br>If no LIBS are provided, simply use those declared<br>o-docs-libraries.<br><br>See ‘o-docs-from-libraries’.<br><br>(fn &optional (LIBS o-docs-libraries))">o-docs-load-libraries</abbr> <abbr class="tooltip" title="The fallback method to retriving documentation or glossary entries.<br><br>We try to retrive the Emacs Lisp function documentation of the<br>given LABEL, if possible, otherwise we try to retrive the Emacs<br>Lisp variable documentation, and if that fails then we look up<br>the word in the English dictionary.<br><br>The English definition is obtained from the command line tool ‘wn’, WordNet.">o-docs-fallback</abbr> <abbr class="tooltip" title="Return the name and documentation-glossary values associated with LABEL.<br><br>It returns a list of length 2.<br><br>Example uses:<br><br>&emsp;;; Get the Lisp documentation of ‘thread-last’<br>&emsp;(o-docs-get ''thread-last'')<br><br>&emsp;;; Get the English definition of ‘computing’<br>&emsp;(o-docs-get ''computing'')<br><br>We look for LABEL from within the current buffer first, using ‘o--docs’,<br>and otherwise look among the loaded libraries, using ‘o--docs-from-libraries’,<br>and, finally, look for the documentation entry using ‘o-docs-fallback’.">o-docs-get</abbr> <abbr class="tooltip" title="Add a new documentation-glossary entry, if it is not already present.<br><br>We associate LABEL to have title NAME and glossary value DESCRIPTION.<br><br>Example usage:<br>&emsp;(o-docs-set ''cat''<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;''Category Theory''<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;''A theory of typed&emsp;composition; e.g., typed monoids.'')">o-docs-set</abbr> <abbr class="tooltip" title="An alist of (LABEL NAME DESCRIPTION) entries; our glossary.<br><br>Example setter:<br>0. (o-docs-set ''os'' ''Emacs'' ''A place wherein I do all of my computing.'')<br><br>Example getters:<br>0. (o-docs-get LABEL)<br>1. (-let [(name description) (cdr (assoc LABEL o--docs))] ⋯)<br><br>See also ‘o--docs-from-libraries’ and ‘o-docs-load-libraries’.">o--docs</abbr> <abbr class="tooltip" title="<br>Overview of noun user<br><br>The noun user has 3 senses (first 2 from tagged texts)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; <br>1. (3) user -- (a person who makes use of a thing; someone who uses or employs something)<br>2. (1) exploiter, user -- (a person who uses something or someone selfishly or unethically)<br>3. drug user, substance abuser, user -- (a person who takes drugs)<br><br>Synonyms/Hypernyms (Ordered by Estimated Frequency) of noun user<br><br>3 senses of user&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<br><br>Sense 1<br>user<br>&emsp;&emsp;&emsp; => person, individual, someone, somebody, mortal, soul<br><br>Sense 2<br>exploiter, user<br>&emsp;&emsp;&emsp; => selfish person<br><br>Sense 3<br>drug user, substance abuser, user<br>&emsp;&emsp;&emsp; => person, individual, someone, somebody, mortal, soul<br>">user</abbr> <abbr class="tooltip" title="The email address of the current user.<br>This defaults to either: the value of EMAIL environment variable; or<br>user@host, using ‘user-login-name’ and ‘mail-host-address’ (or ‘system-name’).">user-mail-address</abbr> <abbr class="tooltip" title="Methods that do not perform any “type casing”.">Natural Transformation</abbr> <abbr class="tooltip" title="Register the dictionary entries in CONTENTS to the dictionary variable.<br><br>The dictionary variable is ‘o--docs’.<br><br>A documentation entry may have its LABEL, its primary identifier,<br>be:<br>1. Omitted<br>2. Given as a single symbol<br>3. Given as a many aliases ’(lbl₀ lbl₁ … lblₙ)<br><br>The third case is for when there is no canonical label to refer to<br>an entry, or it is convenient to use multiple labels for the same<br>entry.<br><br>In all of the above cases, two additional labels are included:<br>The entry name with spaces replaced by underscores, and again but<br>all lower case.<br><br>Documentation blocks are not shown upon export;<br>unless SHOW is non-nil, in which case they are shown<br>using the ‘box’ block, with the provided COLOR passed to it.<br><br>In the futture, it may be nice to have an option to render tooltips.<br>That’d require the ‘doc:𝒳’ link construction be refactored via a ‘defun’.<br><br>(fn BACKEND RAW-CONTENTS &optional NAME &rest ## &key (O-LINK\? nil) (LABEL nil) (SHOW nil) (COLOR ''green''))">o--documentation</abbr> <abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>Also known as<br>1. <em>Existential Dread</em>, and<br>2. <strong>Existential Anxiety</strong>.<br><br>Perhaps a distraction, such as visiting W3Schools (https://www.w3schools.com), may help ;-)<br><br>Then again, <code>coding</code> can be frustrating at times, maybe have<br>a slice of pie with maths by reading “<em>e^{i×π} + 1 = 0</em>” as a poem ;-)">Existential Angst</abbr> <abbr class="tooltip" title="The Common Lisp ‘loop’ macro.<br>Valid clauses include:<br>&emsp;For clauses:<br>&emsp;&emsp;for VAR from/upfrom/downfrom EXPR1 to/upto/downto/above/below EXPR2 [by EXPR3]<br>&emsp;&emsp;for VAR = EXPR1 then EXPR2<br>&emsp;&emsp;for VAR in/on/in-ref LIST [by FUNC]<br>&emsp;&emsp;for VAR across/across-ref ARRAY<br>&emsp;&emsp;for VAR being:<br>&emsp;&emsp;&emsp;the elements of/of-ref SEQUENCE [using (index VAR2)]<br>&emsp;&emsp;&emsp;the symbols [of OBARRAY]<br>&emsp;&emsp;&emsp;the hash-keys/hash-values of HASH-TABLE [using (hash-values/hash-keys V2)]<br>&emsp;&emsp;&emsp;the key-codes/key-bindings/key-seqs of KEYMAP [using (key-bindings VAR2)]<br>&emsp;&emsp;&emsp;the overlays/intervals [of BUFFER] [from POS1] [to POS2]<br>&emsp;&emsp;&emsp;the frames/buffers<br>&emsp;&emsp;&emsp;the windows [of FRAME]<br>&emsp;Iteration clauses:<br>&emsp;&emsp;repeat INTEGER<br>&emsp;&emsp;while/until/always/never/thereis CONDITION<br>&emsp;Accumulation clauses:<br>&emsp;&emsp;collect/append/nconc/concat/vconcat/count/sum/maximize/minimize FORM<br>&emsp;&emsp;&emsp;[into VAR]<br>&emsp;Miscellaneous clauses:<br>&emsp;&emsp;with VAR = INIT<br>&emsp;&emsp;if/when/unless COND CLAUSE [and CLAUSE]... else CLAUSE [and CLAUSE...]<br>&emsp;&emsp;named NAME<br>&emsp;&emsp;initially/finally [do] EXPRS...<br>&emsp;&emsp;do EXPRS...<br>&emsp;&emsp;[finally] return EXPR<br><br>For more details, see Info node ‘(cl)Loop Facility’.<br><br>(fn CLAUSE...)">loop</abbr> <abbr class="tooltip" title="A theory of typed composition; e.g., typed monoids.">Category Theory</abbr> <abbr class="tooltip" title="Make a link NAME whose export is presented as an SVG badge.<br><br>If the link is intend to be a social badge, then, adhering to<br>shield.io conventions, the appropriate SOCIAL-SHIELDS-NAME must<br>be given.<br><br>The SOCIAL-URL is a URL that the badge points to and it should<br>have a single ‘%s’ where the link label argument will go.<br><br>Some social badges have a uniform URL, but otherwise, such as<br>twitter, deviate and so need their own SOCIAL-SHIELDS-URL,<br>which has a single ‘%s’ for the link’s label argument.<br><br><hr><br><br>E.g., to create a badge named “go”:<br><br>&emsp;&emsp; (o-make-badge ''go'')<br><br>Then the following exports nicely from an Org file:<br><br>&emsp;&emsp; go:key|value|blue|here|gnu-emacs">o-make-badge</abbr> <abbr class="tooltip" title="Show text in teal color.<br><br>(fn BACKEND RAW-CONTENTS &optional THE-COLOR &rest ## &key (O-LINK\? nil))">o--teal</abbr> <abbr class="tooltip" title="Format text according to a given COLOR, which is black by default.<br><br>(fn BACKEND RAW-CONTENTS &optional COLOR &rest ## &key (O-LINK\? nil))">o--color</abbr> <abbr class="tooltip" title="Place ideas side-by-side, possibly with a separator.<br><br>There are COLS many columns, and they may be seperated by black<br>solid vertical rules if BAR is a non-nil value.<br><br>Writing “#+begin_parallel 𝓃 :bar (any text except ‘nil’)”<br>will produce a parallel of 𝓃 many columns, possibly<br>seperated by solid rules, or a “bar”.<br><br>The contents of the block may contain ‘#+columnbreak:’ to request<br>a columnbreak. This has no effect on HTML export since HTML<br>describes how text should be formatted on a browser, which can<br>dynamically shrink and grow and thus it makes no sense to have<br>hard columnbreaks. We do replace such declarations by ‘<p><br>’,<br>which sometimes accomplishes the desired goal.<br><br>(fn BACKEND RAW-CONTENTS &optional COLS &rest ## &key (O-LINK\? nil) (BAR nil))">o--parallel</abbr> <abbr class="tooltip" title="Create a temporary buffer, and evaluate BODY there like ‘progn’.<br>See also ‘with-temp-file’ and ‘with-output-to-string’.<br><br>(fn &rest BODY)">with-temp-buffer</abbr> <abbr class="tooltip" title="Parse the list at point and maybe DELETE it.<br><br>Return a list whose car is a symbol of list type, among<br>‘ordered’, ‘unordered’ and ‘descriptive’.&emsp;Then, each item is<br>a list of strings and other sub-lists.<br><br>For example, the following list:<br><br>&emsp;1. first item<br>&emsp;&emsp; + sub-item one<br>&emsp;&emsp; + [X] sub-item two<br>&emsp;&emsp; more text in first item<br>&emsp;2. [@3] last item<br><br>is parsed as<br><br> (ordered<br>&emsp;(''first item''<br>&emsp; (unordered<br>&emsp;&emsp;(''sub-item one'')<br>&emsp;&emsp;(''[X] sub-item two''))<br>&emsp; ''more text in first item'')<br>&emsp;(''[@3] last item''))<br><br>Point is left at list’s end.<br><br>(fn &optional DELETE)">org-list-to-lisp</abbr> <abbr class="tooltip" title="Write a proof tree using Org-lists.<br><br>To get<br><br>&emsp;&emsp;&emsp;&emsp; premises₀&emsp;…&emsp; premisesₙ<br>&emsp;&emsp;&emsp; ────────────────────────────[ reason ]<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; conclusion<br><br>You type<br><br>&emsp;&emsp;&emsp; #+begin_tree<br>&emsp;&emsp;&emsp; + reason :: conclusion<br>&emsp;&emsp;&emsp;&emsp; - premises₀<br>&emsp;&emsp;&emsp;&emsp; - premises₁<br>&emsp;&emsp;&emsp;&emsp; ⋮<br>&emsp;&emsp;&emsp;&emsp; - premisesₙ<br>&emsp;&emsp;&emsp; #+end_tree<br><br>Where each premisesᵢ may, recursively, also have named reasons<br>and (indented) child premises of its own.<br><br>If there are multiple trees, they are shown one after the other.<br><br>The text in this block should be considered LaTeX;<br>as such, Org markup is not recognised.<br><br>A proof tree, derivation, is then just a deeply nested<br>itemisation.&emsp;For instance, assuming P = Q(X), X = Y, Q(Y) = R,<br>the following proves P = R.<br><br>&emsp;#+begin_tree<br>&emsp;+ Trans :: P = R<br>&emsp;&emsp;- P = Q(X)<br>&emsp;&emsp;&emsp;+ ✓<br>&emsp;&emsp;- Trans :: Q(X) = R<br>&emsp;&emsp;&emsp;+ Trans :: Q(X) = Q(Y)<br>&emsp;&emsp;&emsp;&emsp;- Refl :: Q(X) = Q(X)<br>&emsp;&emsp;&emsp;&emsp;&emsp;+ ✓<br>&emsp;&emsp;&emsp;&emsp;- Leibniz :: Q(X) = Q(Y)<br>&emsp;&emsp;&emsp;&emsp;&emsp;+ X = Y<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;- ✓<br>&emsp;&emsp;&emsp;+ Sym :: Q(Y) = R<br>&emsp;&emsp;&emsp;&emsp;- R = Q(Y)<br>&emsp;&emsp;&emsp;&emsp;&emsp;- ✓<br>&emsp;#+end_tree<br><br>(fn BACKEND RAW-CONTENTS &optional MAIN-ARG &rest ## &key (O-LINK\? nil))">o--tree</abbr> <abbr class="tooltip" title="Return a regexp string which matches exactly STRING and nothing else.<br><br>(fn STRING)">regexp-quote</abbr> <abbr class="tooltip" title="Replace all matches for REGEXP with REP in STRING.<br><br>Return a new string containing the replacements.<br><br>Optional arguments FIXEDCASE, LITERAL and SUBEXP are like the<br>arguments with the same names of function ‘replace-match’.&emsp;If START<br>is non-nil, start replacements at that index in STRING, and omit<br>the first START characters of STRING from the return value.<br><br>REP is either a string used as the NEWTEXT arg of ‘replace-match’ or a<br>function.&emsp;If it is a function, it is called with the actual text of each<br>match, and its value is used as the replacement text.&emsp;When REP is called,<br>the match data are the result of matching REGEXP against a substring<br>of STRING, the same substring that is the actual text of the match which<br>is passed to REP as its argument.<br><br>To replace only the first match (if any), make REGEXP match up to \'<br>and replace a sub-expression, e.g.<br>&emsp;(replace-regexp-in-string ''\\(foo\\).*\\''' ''bar'' '' foo foo'' nil nil 1)<br>&emsp;&emsp;=> '' bar foo''<br><br>(fn REGEXP REP STRING &optional FIXEDCASE LITERAL SUBEXP START)">s-replace-regexp</abbr> <abbr class="tooltip" title="Remove whitespace at the beginning and end of S.">s-trim</abbr> <abbr class="tooltip" title="Split S into substrings bounded by matches for regexp SEPARATOR.<br>If OMIT-NULLS is non-nil, zero-length substrings are omitted.<br><br>This is a simple wrapper around the built-in ‘split-string’.">s-split</abbr> <abbr class="tooltip" title="Apply FN to each item in LIST and return the list of results.<br><br>This function’s anaphoric counterpart is ‘--map’.<br><br>(fn FN LIST)">-map</abbr> <abbr class="tooltip" title="Eval FORM for each item in LIST and return the list of results.<br>Each element of LIST in turn is bound to ‘it’ before evaluating<br>FORM.<br>This is the anaphoric counterpart to ‘-map’.<br><br>(fn FORM LIST)">--map</abbr> <abbr class="tooltip" title="REPLACEMENTS is a list of cons-cells. Each ‘car‘ is replaced with ‘cdr‘ in S.">s-replace-all</abbr> <abbr class="tooltip" title="Parse STRING as a decimal number and return the number.<br>Ignore leading spaces and tabs, and all trailing chars.&emsp;Return 0 if<br>STRING cannot be parsed as an integer or floating point number.<br><br>If BASE, interpret STRING as a number in that base.&emsp;If BASE isn’t<br>present, base 10 is used.&emsp;BASE must be between 2 and 16 (inclusive).<br>If the base used is not 10, STRING is always parsed as an integer.<br><br>(fn STRING &optional BASE)">string-to-number</abbr> <abbr class="tooltip" title="Return t if OBJECT is a number (floating point or integer).<br><br>(fn OBJECT)">numberp</abbr> <abbr class="tooltip" title="Make a string of S repeated NUM times.">s-repeat</abbr> <abbr class="tooltip" title="Output the CONTENTS of the block REPS many times<br><br>(fn BACKEND RAW-CONTENTS &optional REPS &rest ## &key (O-LINK\? nil))">o--stutter</abbr> <abbr class="tooltip" title="Hide text enclosed in double parens ((like this)) as if it were spoilers.<br>&emsp; LEFT and RIGHT may be other kinds of delimiters.<br>&emsp; The main argument, COLOR, indicates which color to use.<br><br>For LaTeX, this becomes “fill in the blanks”, with the answers<br>in the footnotes.<br><br>(fn BACKEND RAW-CONTENTS &optional COLOR &rest ## &key (O-LINK\? nil) (LEFT ''(('') (RIGHT ''))''))">o--spoiler</abbr> <abbr class="tooltip" title="Perform the given LIST of substitutions on the text.<br>The LIST is a comma separated list of ‘to’ separated symbols.<br>In a link, no quotes are needed.<br><br>(fn BACKEND RAW-CONTENTS &optional LIST &rest ## &key (O-LINK\? nil))">o--rename</abbr> <abbr class="tooltip" title="Enclose text in a box, possibly with a title.<br><br>By default, the box’s COLOR is green for HTML and red for LaTeX,<br>and it has no TITLE.<br><br>The HTML export uses a padded div, whereas the LaTeX export<br>requires the tcolorbox pacakge.<br><br>In the future, I will likely expose more arguments.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (O-LINK\? nil) (BACKGROUND-COLOR nil))">o--box</abbr> <abbr class="tooltip" title="Enclose contents in a folded up box, for HTML.<br><br>For LaTeX, this is just a boring, but centered, box.<br><br>By default, the TITLE of such blocks is “Details”<br>and its TITLE-COLOR is green.<br><br>In HTML, we show folded, details, regions with a nice greenish colour.<br><br>In the future ---i.e., when I have time---<br>it may be prudent to expose more aspects as arguments,<br>such as ‘background-color’.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (O-LINK\? nil) (TITLE-COLOR ''green''))">o--details</abbr> <abbr class="tooltip" title="Thread text through a number of blocks.<br><br>BODY is likely to be ‘raw-contents’, possibly with user manipulations.<br><br>Each FORMS is of the shape “(block-name main-argument<br>:key-value-pairs)”<br><br>(thread-blockcall x)&emsp;&emsp;&emsp; = x<br>(thread-blockcall x (f a)) = (blockcall f a x)<br>(thread-blockcall x f₁ f₂) ≈ (f₂ (f₁ x))<br><br>The third is a ‘≈’, and not ‘=’, because the RHS contains<br>‘blockcall’s as well as massages the export matter<br>between conseqeuctive blockcalls.<br><br>A full example:<br><br>&emsp;&emsp;(o-defblock nesting (name) nil<br>&emsp;&emsp;&emsp;''Show text in a box, within details, which contains a box.''<br><br>&emsp;&emsp;&emsp;(o-thread-blockcall raw-contents<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;(box name)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;(details (upcase name) :title-color ''green'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;(box (format ''⇨ %s ⇦'' name) :background-color ''blue'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;))<br>">o-thread-blockcall</abbr> <abbr class="tooltip" title="Thread FORMS elements as the last argument of their successor.<br>Example:<br>&emsp;&emsp;(thread-last<br>&emsp;&emsp;&emsp;5<br>&emsp;&emsp;&emsp;(+ 20)<br>&emsp;&emsp;&emsp;(<em> 25)<br>&emsp;&emsp;&emsp;-<br>&emsp;&emsp;&emsp;(+ 40))<br>Is equivalent to:<br>&emsp;&emsp;(+ 40 (- (</em> 25 (+ 20 5))))<br>Note how the single ‘-’ got converted into a list before<br>threading.<br><br>(fn &rest FORMS)">thread-last</abbr> <abbr class="tooltip" title="Call first argument as a function, passing remaining arguments to it.<br>Return the value that function returns.<br>Thus, (funcall 'cons 'x 'y) returns (x . y).<br><br>(fn FUNCTION &rest ARGUMENTS)">funcall</abbr> <abbr class="tooltip" title="Return the documentation string of FUNCTION.<br>Unless a non-nil second argument RAW is given, the<br>string is passed through ‘substitute-command-keys’.<br><br>(fn FUNCTION &optional RAW)">documentation</abbr> <abbr class="tooltip" title="Alist of properties that defines all the links in Org mode.<br><br>The key in each association is a string of the link type.<br>Subsequent optional elements make up a property list for that<br>type.<br><br>All properties are optional.&emsp;However, the most important ones<br>are, in this order, ‘:follow’, ‘:export’, and ‘:store’, described<br>below.<br><br>‘:follow’<br><br>&emsp;Function used to follow the link, when the ‘org-open-at-point’<br>&emsp;command runs on it.&emsp;It is called with two arguments: the path,<br>&emsp;as a string, and a universal prefix argument.<br><br>&emsp;Here, you may use ‘org-link-open-as-file’ helper function for<br>&emsp;types similar to ''file''.<br><br>‘:export’<br><br>&emsp;Function that accepts four arguments:<br>&emsp;- the path, as a string,<br>&emsp;- the description as a string, or nil,<br>&emsp;- the export back-end,<br>&emsp;- the export communication channel, as a plist.<br><br>&emsp;When nil, export for that type of link is delegated to the<br>&emsp;back-end.<br><br>‘:store’<br><br>&emsp;Function responsible for storing the link.&emsp;See the function<br>&emsp;‘org-store-link-functions’ for a description of the expected<br>&emsp;arguments.<br><br>Additional properties provide more specific control over the<br>link.<br><br>‘:activate-func’<br><br>&emsp;Function to run at the end of Font Lock activation.&emsp;It must<br>&emsp;accept four arguments:<br>&emsp;- the buffer position at the start of the link,<br>&emsp;- the buffer position at its end,<br>&emsp;- the path, as a string,<br>&emsp;- a boolean, non-nil when the link has brackets.<br><br>‘:complete’<br><br>&emsp;Function that inserts a link with completion.&emsp;The function<br>&emsp;takes one optional prefix argument.<br><br>‘:display’<br><br>&emsp;Value for ‘invisible’ text property on the hidden parts of the<br>&emsp;link.&emsp;The most useful value is ‘full’, which will not fold the<br>&emsp;link in descriptive display.&emsp;Default is ‘org-link’.<br><br>‘:face’<br><br>&emsp;Face for the link, or a function returning a face.&emsp;The<br>&emsp;function takes one argument, which is the path.<br><br>&emsp;The default face is ‘org-link’.<br><br>‘:help-echo’<br><br>&emsp;String or function used as a value for the ‘help-echo’ text<br>&emsp;property.&emsp;The function is called with one argument, the help<br>&emsp;string to display, and should return a string.<br><br>‘:htmlize-link’<br><br>&emsp;Function or plist for the ‘htmlize-link’ text property.&emsp;The<br>&emsp;function takes no argument.<br><br>&emsp;Default is (:uri ''type:path'')<br><br>‘:keymap’<br><br>&emsp;Active keymap when point is on the link.&emsp;Default is<br>&emsp;‘org-mouse-map’.<br><br>‘:mouse-face’<br><br>&emsp;Face used when hovering over the link.&emsp;Default is<br>&emsp;‘highlight’.">org-link-parameters</abbr> <abbr class="tooltip" title="Add a new TYPE link.<br>FOLLOW and EXPORT are two functions.<br><br>FOLLOW should take the link path as the single argument and do whatever<br>is necessary to follow the link, for example find a file or display<br>a mail message.<br><br>EXPORT should format the link path for export to one of the export formats.<br>It should be a function accepting three arguments:<br><br>&emsp;path&emsp;&emsp;the path of the link, the text after the prefix (like ''http:'')<br>&emsp;desc&emsp;&emsp;the description of the link, if any<br>&emsp;format&emsp;the export format, a symbol like ‘html’ or ‘latex’ or ‘ascii’.<br><br>The function may use the FORMAT information to return different values<br>depending on the format.&emsp;The return value will be put literally into<br>the exported file.&emsp;If the return value is nil, this means Org should<br>do what it normally does with links which do not have EXPORT defined.<br><br>Org mode has a built-in default for exporting links.&emsp;If you are happy with<br>this default, there is no need to define an export function for the link<br>type.&emsp;For a simple example of an export function, see ‘org-bbdb.el’.<br><br>If TYPE already exists, update it with the arguments.<br>See ‘org-link-parameters’ for documentation on the other parameters.<br><br>(fn TYPE &optional FOLLOW EXPORT)">org-add-link-type</abbr> <abbr class="tooltip" title="Set link TYPE properties to PARAMETERS.<br>PARAMETERS should be keyword value pairs.&emsp;See<br>‘org-link-parameters’ for supported keys.<br><br>(fn TYPE &rest PARAMETERS)">org-link-set-parameters</abbr> <abbr class="tooltip" title="Define NAME as a function.<br>Like normal ‘defun’, except ARGLIST allows full Common Lisp conventions,<br>and BODY is implicitly surrounded by (cl-block NAME ...).<br><br>The full form of a Common Lisp function argument list is<br><br>&emsp; (VAR...<br>&emsp;&emsp;[&optional (VAR [INITFORM [SVAR]])...]<br>&emsp;&emsp;[&rest|&body VAR]<br>&emsp;&emsp;[&key (([KEYWORD] VAR) [INITFORM [SVAR]])... [&allow-other-keys]]<br>&emsp;&emsp;[&aux (VAR [INITFORM])...])<br><br>VAR may be replaced recursively with an argument list for<br>destructuring, ‘&whole’ is supported within these sublists.&emsp;If<br>SVAR, INITFORM, and KEYWORD are all omitted, then ‘(VAR)’ may be<br>written simply ‘VAR’.&emsp;See the Info node ‘(cl)Argument Lists’ for<br>more details.<br><br>(fn NAME ARGLIST [DOCSTRING] BODY...)">cl-defun</abbr> <abbr class="tooltip" title="Make a new Org-link NAME that exports using form BODY.<br><br>Since Org links are essentially string-valued functions,<br>a function ‘o-link/NAME’ is created.<br><br>DOCSTRING is optional; it is visible with<br>&emsp; (documentation ’o-link/NAME)<br><br>BODY is a string-valued expression, that may make use of the names<br>o-label, o-description, o-backend. The final one refers to the export<br>backend, such as ’html or ’latex. The first two are obtained from uses:<br><br>&emsp; Y (name:o-label][o-description]]<br><br>In particular, the use case “name:o-label” means that o-description is nil.<br><br>Example use:<br><br>&emsp; ;; In a Lisp buffer, press “C-x C-e” to load this definition<br>&emsp; (o-deflink shout (upcase (or o-description o-label)))<br><br>&emsp; ;; In an Org-buffer, press “C-c C-e h o” to see how this exports<br>&emsp; <shout: hello world!><br><br>&emsp; ;; Or using the bracket format<br>&emsp; [[shout:][hello world!]]<br>&emsp; [[shout: hello world!]]<br><br>&emsp; ;; or using the plain format<br>&emsp; shout:hello_world<br><br>Here is a more complex, involved, example that makes use of<br>‘:let’ for local declarations. For instance, “define:hello”<br>renders as the word “hello” with a tooltip defining the word; the<br>definition is obtained from the command line tool ‘wn’.<br><br>&emsp;(o-deflink define<br>&emsp;&emsp;''Define the given word using WordNet, along with synonyms and coordinate terms.''<br>&emsp;&emsp;[:let (definition (shell-command-to-string (format ''wn %s -over -synsn -coorn'' o-label)))<br>&emsp;&emsp; :help-echo definition]<br>&emsp;&emsp;(--> definition<br>&emsp;&emsp;&emsp;(s-replace-regexp ''\\\'''' ''’’'' it) ;; The presence of ‘\''’ in tooltips breaks things, so omit them.<br>&emsp;&emsp;&emsp;(s-replace-regexp ''\n'' ''<br>'' it)<br>&emsp;&emsp;&emsp;(format ''<abbr class=\''tooltip\'' title=\''%s\''>%s</abbr>'' it o-label)))<br><br>For HTML tooltips, see ‘o-html-export-preserving-whitespace’.<br><br>More generally, org-special-block-extra’s “doc” link type<br>supports, in order of precedence: User definitions, Emacs Lisp<br>documentation of functions & variables, and definitions of<br>English words. For example, “doc:existential_angst” for an entry<br>‘existential_angst’ whose associated documentation-glossary is<br>user-defined in a ‘#+documentation’ Org-block, or<br>“doc:thread-first” for the Emacs Lisp documentation of the<br>function ‘thread-first’, or “doc:user-mail-address” for the Emacs<br>Lisp documentation of the variable ‘user-mail-address’, or<br>“doc:hello” for the definition of the English word ‘hello’.<br><br>DISPLAY is a vector consisting of key-value pairs that affects how the link<br>is displayed in Emacs Org buffers. The keys are as follows.<br><br>+ :help-echo is a string-valued expression of the tooltip that should accompany<br>&emsp;the new link in Org buffers. It has access to o-format being one of ‘plain’,<br>&emsp;‘angle’, ‘bracket’ which indicates the format of the link, as shown above.<br>&emsp;It also has access to o-label and o-description.<br><br>&emsp;By default, the tooltip is the link name followed by the documentation<br>&emsp;of the link, and, finally, the HTML export of the link.<br>&emsp;That way, upon hover, users can visually see the link contents,<br>&emsp;know what/how the link exports, and actually see the HTML export.<br><br>&emsp;That is to say, for the ‘shout’ example aboce, the default display is essentially:<br>&emsp;[:help-echo (o-link/shout o-label o-description ’html)]<br><br>&emsp;You may want to add the following to your Emacs init file:<br><br>&emsp;&emsp;;; Nearly instantaneous display of tooltips.<br>&emsp;&emsp;(setq tooltip-delay 0)<br>&emsp;&emsp;;; Give user 30 seconds before tooltip automatically disappears.<br>&emsp;&emsp;(setq tooltip-hide-delay 300)<br><br>+ :face specifies how should these links be displayed within Emacs.<br>&emsp; It is a list-valued expression.<br>&emsp; As usual, it may make use of O-LABEL (but O-DESCRIPTION has value nil).<br><br>+ [:display full] if you do not want bracket links to be<br>&emsp;folded away in Org buffers; i.e., “[[X)” does not render as just “Y”.<br><br>+ :follow is a form that is executed when you click on such links; e.g., to open<br>&emsp; another buffer, browser, or other action. It makes use of (an implicit argument) ‘o-label’.<br>&emsp; Be aware that ‘o-label’ is a string that may contain spaces; e.g., when the action is to open<br>&emsp; a URL in a browser.<br><br>&emsp; If you are in need of providing similar, related, actions on a single link<br>&emsp; then your :follow can condition on the current prefix argument via ‘o-prefix’<br>&emsp; (which is essentially ‘current-prefix-arg’).<br>&emsp; For instance, a user presses “C-u RET” on your link to do one thing<br>&emsp; but “C-u 72 RET” to do another action.<br><br>+ :keymap is an alternating list of keys and actions to be<br>&emsp;performed when those keys are pressed while point is on the link.<br>&emsp;For example:<br>&emsp;&emsp;&emsp;[:keymap (C-h (message-box ''hola''))]<br><br>&emsp;By default, C-n and C-p are for moving to next and previous occruances of the same link type.<br><br>+ :let is a list of alternating variable symbol name and value, which are then used to form<br>&emsp;a concrete ‘let*’ clause. This is useful for introducing local variables for use in the DISPLAY<br>&emsp;as well as in the CONTENTS. Such local declarations may make use of O-LABEL and O-DESCRIPTION, as usual.<br><br>(fn NAME &optional DOCSTRING DISPLAY &rest BODY)">o-deflink</abbr> <abbr class="tooltip" title="Define NAME as a macro.<br>When the macro is called, as in (NAME ARGS...),<br>the function (lambda ARGLIST BODY...) is applied to<br>the list ARGS... as it appears in the expression,<br>and the result should be a form to be evaluated instead of the original.<br>DECL is a declaration, optional, of the form (declare DECLS...) where<br>DECLS is a list of elements of the form (PROP . VALUES).&emsp;These are<br>interpreted according to ‘macro-declarations-alist’.<br>The return value is undefined.<br><br>(fn NAME ARGLIST &optional DOCSTRING DECL &rest BODY)">defmacro</abbr> <abbr class="tooltip" title="Edit and re-evaluate last complex command, or ARGth from last.<br>A complex command is one that used the minibuffer.<br>The command is placed in the minibuffer as a Lisp form for editing.<br>The result is executed, repeating the command as changed.<br>If the command has been changed or is not the most recent previous<br>command it is added to the front of the command history.<br>You can use the minibuffer history commands M-n and M-p<br>to get different commands to edit and resubmit.<br><br>(fn ARG)">repeat-complex-command</abbr> <abbr class="tooltip" title="Hussein ibn Ali is the grandson of Prophet Muhammad, who is known to have<br>declared <strong>“Hussain is from me and I am from Hussain; God loves whoever loves Hussain.”</strong><br><br>He is honoured as “The Chief of Martyrs” for his selfless stand for social justice<br>against Yazid, the corrupt 7ᵗʰ caliph. The Karbala Massacre is commemorated annually<br>in the first Islamic month, Muharram, as a reminder to stand against oppression and tyranny;<br>Jesus Christ, son of Mary, makes an indirect appearance in the story.<br><br>A terse summary of the chain of events leading to the massacre may be found at<br>https://www.al-islam.org/articles/karbala-chain-events.<br><br>An elegant English recitation recounting the Karbala Massacre may be found at<br>https://youtu.be/2i9Y3Km6h08 ---“Arbaeen Maqtal - Sheikh Hamam Nassereddine - 1439”.<br><hr><br> <strong>Charles Dickens:</strong> <em>“If Hussain had fought to quench his worldly desires...then I</em><br><em>do not understand why his sister, wife, and children accompanied him. It stands<br>to reason therefore, that he sacrificed purely for Islam.”</em><br><br><strong>Gandhi:</strong> <em>“I learned from Hussain how to achieve victory while being oppressed.”</em><br><br><strong>Thomas Carlyle:</strong> <em>“The victory of Hussein, despite his minority, marvels me.”</em><br><br><strong>Thomas Masaryk:</strong> <em>“Although our clergies also move us while describing the<br>Christ's sufferings, but the zeal and zest that is found in the followers of</em><br><em>Hussain will not be found in the followers of Christ. And it seems that the<br>suffering of Christ against the suffering of Hussain is like a blade of straw</em> <em>in<br>front of a huge mountain.”</em>">Hussain</abbr> <abbr class="tooltip" title="<br>Overview of noun family<br><br>The noun family has 8 senses (first 6 from tagged texts)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; <br>1. (66) family, household, house, home, menage -- (a social unit living together; ''he moved his family to Virginia''; ''It was a good Christian household''; ''I waited until the whole house was asleep''; ''the teacher asked how many people made up his home'')<br>2. (52) family, family unit -- (primary social group; parents and children; ''he wanted to have a good job before starting a family'')<br>3. (8) class, category, family -- (a collection of things sharing a common attribute; ''there are two classes of detergents'')<br>4. (5) family, family line, folk, kinfolk, kinsfolk, sept, phratry -- (people descended from a common ancestor; ''his family has lived in Massachusetts since the Mayflower'')<br>5. (2) kin, kinsperson, family -- (a person having kinship with another or others; ''he's kin''; ''he's family'')<br>6. (2) family -- ((biology) a taxonomic group containing one or more genera; ''sharks belong to the fish family'')<br>7. syndicate, crime syndicate, mob, family -- (a loose affiliation of gangsters in charge of organized criminal activities)<br>8. family, fellowship -- (an association of people who share common beliefs or activities; ''the message was addressed not just to employees but to every member of the company family''; ''the church welcomed new members into its fellowship'')<br><br>Synonyms/Hypernyms (Ordered by Estimated Frequency) of noun family<br><br>8 senses of family&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;<br><br>Sense 1<br>family, household, house, home, menage<br>&emsp;&emsp;&emsp; => unit, social unit<br><br>Sense 2<br>family, family unit<br>&emsp;&emsp;&emsp; => kin, kin group, kinship group, kindred, clan, tribe<br><br>Sense 3<br>class, category, family<br>&emsp;&emsp;&emsp; => collection, aggregation, accumulation, assemblage<br><br>Sense 4<br>family, family line, folk, kinfolk, kinsfolk, sept, phratry<br>&emsp;&emsp;&emsp; => lineage, line, line of descent, descent, bloodline, blood line, blood, pedigree, ancestry, origin, parentage, stemma, stock<br><br>Sense 5<br>kin, kinsperson, family<br>&emsp;&emsp;&emsp; => relative, relation<br><br>Sense 6<br>family<br>&emsp;&emsp;&emsp; => taxonomic group, taxonomic category, taxon<br><br>Sense 7<br>syndicate, crime syndicate, mob, family<br>&emsp;&emsp;&emsp; => organized crime, gangland, gangdom<br><br>Sense 8<br>family, fellowship<br>&emsp;&emsp;&emsp; => association<br>">family</abbr> <abbr class="tooltip" title="Thread FORMS elements as the first argument of their successor.<br>Example:<br>&emsp;&emsp;(thread-first<br>&emsp;&emsp;&emsp;5<br>&emsp;&emsp;&emsp;(+ 20)<br>&emsp;&emsp;&emsp;(<em> 25)<br>&emsp;&emsp;&emsp;-<br>&emsp;&emsp;&emsp;(+ 40))<br>Is equivalent to:<br>&emsp;&emsp;(+ (- (</em> (+ 5 20) 25)) 40)<br>Note how the single ‘-’ got converted into a list before<br>threading.<br><br>(fn &rest FORMS)">thread-first</abbr> <abbr class="tooltip" title="Show an OctoIcon: home, link, mail, report, tag, clock">o-link/octoicon</abbr> <abbr class="tooltip" title="Narrow buffer to current element.">org-narrow-to-element</abbr> <abbr class="tooltip" title="Define NAME as a function.<br>The definition is (lambda ARGLIST [DOCSTRING] BODY...).<br>See also the function ‘interactive’.<br>DECL is a declaration, optional, of the form (declare DECLS...) where<br>DECLS is a list of elements of the form (PROP . VALUES).&emsp;These are<br>interpreted according to ‘defun-declarations-alist’.<br>The return value is undefined.<br><br>(fn NAME ARGLIST &optional DOCSTRING DECL &rest BODY)">defun</abbr> <abbr class="tooltip" title="Declare a new special block, and link, in the style of DEFUN.<br><br>A full featured example is at the end of this documentation string.<br><br>This is an anaphoric macro that provides export support for<br>special blocks <strong>and</strong> links named NAME. Just as an Org-mode<br>src-block consumes as main argument the language for the src<br>block, our special blocks too consume a MAIN-ARG; it may be a<br>symbol or a cons-list consisting of a symbolic name (with which<br>to refer to the main argument in the definition of the block)<br>followed by a default value, then, optionally, any information<br>for a one-time setup of the associated link type.<br><br>The main arg may be a sequence of symbols separated by spaces,<br>and a few punctuation with the exception of comma ‘,’ since it is<br>a special Lisp operator. In doubt, enclose the main arg in<br>quotes.<br><br>Then, just as Org-mode src blocks consume key-value pairs, our<br>special blocks consume a number of KWDS, which is a list of the<br>form (key₀ value₀ … keyₙ valueₙ).<br><br>After that is an optional DOCSTRING, a familar feature of DEFUN.<br>The docstring is displayed as part of the tooltip for the<br>produced link type.<br><br>Finally, the BODY is a (sequence of) Lisp forms ---no progn<br>needed--- that may refer to the names BACKEND and CONTENTS which<br>refer to the current export backend and the contents of the<br>special block ---or the description clause of a link.<br><br>CONTENTS refers to an Org-mode parsed string; i.e., Org-markup is<br>acknowledged.<br><br>In, hopefully, rare circumstances, one may refer to RAW-CONTENTS<br>to look at the fully unparsed contents.<br><br>Finally, this macro exposes two functions:<br>+ ORG-EXPORT: Wrap the argument in an export block for the current backend.<br>+ ORG-PARSE: This should ONLY be called within an ORG-EXPORT call,<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; to escape text to Org, and out of the export block.<br><br><hr><br><br>TLDR for EXPERIMENTAL and DOCSTRING and BODY, the first two parts are<br>optional; they’re a symbol, a string, then the main body.&emsp;The<br>symbol, O-RESPECT-NEWLINES?, when present enables a highly<br>experimental [i.e., do <strong>not</strong> use it!] feature: No new lines for<br>blocks in HTML export.&emsp;Its need rose from developing the MARGIN<br>block type.<br><br><hr><br><br>The relationship between links and special blocks:<br><br>&emsp;[ [type:label][description]]<br>≈<br>&emsp; #+begin_type label<br>&emsp;&emsp;description<br>&emsp; #+end_type<br><br><hr><br><br>Example declaration, with all possible features shown:<br><br>&emsp; ;; We can use variable values when defining new blocks<br>&emsp; (setq angry-red ’(:foreground ''red'' :weight bold))<br><br>&emsp; (defblock remark<br>&emsp;&emsp; (editor ''Editor Remark'' :face angry-red) (color ''red'' signoff '''')<br>&emsp;&emsp; ''Top level (HTML & LaTeX)O-RESPECT-NEWLINES? editorial remarks; in Emacs they’re angry red.''<br>&emsp;&emsp; (format (if (equal backend ’html)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''<strong style=\''color: %s;\''>⟦%s:&emsp;%s%s⟧</strong>''<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''{\color{%s}\bfseries %s:&emsp;%s%s}'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; color editor contents signoff))<br><br>&emsp; ;; I don’t want to change the definition, but I’d like to have<br>&emsp; ;; the following as personalised defaults for the “remark” block.<br>&emsp; ;; OR, I’d like to set this for links, which do not have argument options.<br>&emsp; (defblock-header-args remark :main-arg ''Jasim Jameson'' :signoff ''( Aim for success! )'')<br><br>Three example uses:<br><br>&emsp;&emsp;;; ⟨0⟩ As a special blocks with arguments given.<br>&emsp;&emsp;#+begin_remark Bobbert Barakallah :signoff ''Thank-you for pointing this out!'' :color green<br>&emsp;&emsp;I was trying to explain that <em>{large (n × (n + 1) over 2}</em> is always an integer.<br>&emsp;&emsp;#+end_remark<br><br>&emsp;&emsp;;; ⟨1⟩ As a terse link, using default values for the args.<br>&emsp;&emsp;;;&emsp;&emsp; Notice that Org-mode formatting is recoqgnised even in links.<br>&emsp;&emsp;[ [remark:Jasim Jameson][Why are you taking about “<em>mathsf{even}</em>” here?]]<br><br>&emsp;&emsp;;; ⟨2⟩ So terse that no editor name is provided.<br>&emsp;&emsp;[ [remark:][Please improve your transition sentences.]]<br><br>&emsp;&emsp;;; ⟨★⟩ Unlike 0, examples 1 and 2 will have the default SIGNOFF<br>&emsp;&emsp;;; catenated as well as the default red color.<br><br>(fn NAME MAIN-ARG KWDS &optional EXPERIMENTAL DOCSTRING &rest BODY)">o-defblock</abbr>
</p>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
See <a href="http://www.cs.nott.ac.uk/~pszgmh/fold.pdf"><i>A tutorial on the universality and expressiveness of fold</i></a> and
<a href="http://www.cs.ox.ac.uk/people/jeremy.gibbons/publications/urs.pdf"><i>Unifying Structured Recursion Schemes</i></a>
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: Musa Al-hassy</p>
<p class="date">Created: 2021-09-09 Thu 16:25</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
