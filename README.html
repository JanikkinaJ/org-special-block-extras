<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-04-24 Fri 00:52 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>org-special-block-extras</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Musa Al-hassy" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link href="https://alhassy.github.io/next-700-module-systems/prototype/org-notes-style.css" rel="stylesheet" type="text/css" />

<link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css"/>

<link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css" />

<script type="text/javascript" src="https://code.jquery.com/jquery-1.10.0.min.js"></script>

 <script type="text/javascript"            src="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js"></script>

  <script>
         $(document).ready(function() {
             $('.tooltip').tooltipster({
                 theme: 'tooltipster-punk',
                 contentAsHTML: true,
                 animation: 'grow',
                 delay: [100,500],
                 // trigger: 'click'
                 trigger: 'custom',
                 triggerOpen: {
                     mouseenter: true
                 },
                 triggerClose: {
                     originClick: true,
                     scroll: true
                 }
 });
         });
     </script>

<style>
   abbr {color: red;}

   .tooltip { border-bottom: 1px dotted #000;
              color:red;
              text-decoration: none;}
</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2020 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">org-special-block-extras</h1>

<div class="org-center">
<p>
<i><b>Warning: Incomplete!</b></i>
</p>
</div>

<div class="org-center">
<p>
<b>Abstract</b>
</p>
</div>
<blockquote>
<p>
The aim is to write something once using Org-mode markup
then generate the markup for multiple backends.
That is, <i><b>write once, generate many!</b></i>
</p>

<p>
In particular, we are concerned with <i>‘custom’, or ‘special’, blocks</i> which
delimit how a particular region of text is supposed to be formatted according to
the possible export backends.  In some sense, special blocks are meta-blocks.
Rather than writing text in, say, LaTeX environments using LaTeX commands or in
HTML <code>div</code>'s using HTML tags, we promote using Org-mode markup in special blocks
&#x2014;Org markup cannot be used explicitly within HTML or LaTeX environments.
</p>

<p>
Consequently, we extend the number of block types available to the Emacs
Org-mode user <b>without forcing the user</b> to learn HTML or LaTeX.
Indeed, I am not a web developer and had to learn a number of HTML concepts
in the process &#x2014;the average Org user should not have to do so.
</p>

<p>
Similarly, we provide a number of ‘link types’ <code>[[linktype:label][description]]</code>
for producing in-line coloured text and SVG “badges”.
</p>

<p>
We begin with the first two sections serving as mini-tutorials on special blocks
and on link types. The special block setup we use is <i>extensible</i> in that a new
block named <code>𝒞</code> will automatically be supported if the user defines a function
<code>org-special-block-extras--𝒞</code> that formats the text of a block.  *The remaining
sections are literate implementation matter, along with examples and
screenshots.*
</p>

<p>
In summary, we provide 20 colour block types and 20 colour link types,
an ‘editor comment’ block type as well as a link type,
a ‘details’ block type, a ‘parallel’ multiple columns view block type,
a ‘link here’ link type, 8 badge link types,
and block and link types for making documentation-glossary entries.
That is, <b>we provide 29 block types and 32 link types</b>.
</p>
</blockquote>

<div class="org-center">
<blockquote>
<p>
The full article may be read as a <a href="https://alhassy.github.io/org-special-block-extras/README.pdf">PDF</a> or as <a href="https://alhassy.github.io/org-special-block-extras/README.html">HTML</a> or as pure <a href="https:/raw.githubusercontent.com/alhassy/org-special-block-extras/master/org-special-block-extras.org">Org</a>!
&#x2014;or visit the <a href="https://github.com/alhassy/org-special-block-extras">repo</a>.
</p>
</blockquote>
</div>


<div class="figure">
<p><img src="images/foo_block.png" alt="foo_block.png" />
</p>
<p><span class="figure-number">Figure 1: </span>Extensibility! <i>Plug and play support for new block types!</i></p>
</div>

<p>
<i>First, a gallery of what's possible!</i>
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><b>Write Org-markup once, generate for many backends ^_^</b></td>
</tr>
</tbody>
</table>

<div class="figure">
<p><img src="images/colours.jpg" alt="colours.jpg" />
</p>
</div>


<div class="figure">
<p><img src="images/colour_links.png" alt="colour_links.png" />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><b>Displaying thoughts side-by-side ^_^</b></td>
</tr>
</tbody>
</table>

<div class="figure">
<p><img src="images/parallel.png" alt="parallel.png" />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><b>“First-class editor comments” In order: Chrome, Emacs Web Wowser, Org source, PDF</b></td>
</tr>
</tbody>
</table>

<div class="figure">
<p><img src="images/edcomm.png" alt="edcomm.png" />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><b>Visually hiding, folding away, details</b></td>
</tr>
</tbody>
</table>

<div class="figure">
<p><img src="images/details.png" alt="details.png" />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><b>An Emacs interface to <a href="https://shields.io/">https://shields.io/</a></b></td>
</tr>
</tbody>
</table>

<div class="figure">
<p><img src="images/badges.png" alt="badges.png" />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><b>Tooltips for documentation and glossary items &#x2013;in the browser!</b></td>
</tr>
</tbody>
</table>

<div class="figure">
<p><img src="images/tooltips_browser.png" alt="tooltips_browser.png" />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><b>Tooltips for documentation and glossary items &#x2013;in Emacs!</b></td>
</tr>
</tbody>
</table>

<div class="figure">
<p><img src="images/tooltips_emacs.png" alt="tooltips_emacs.png" />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><b>Tooltips for documentation and glossary items &#x2013;in the PDF!</b></td>
</tr>
</tbody>
</table>

<div class="figure">
<p><img src="images/tooltips_pdf.png" alt="tooltips_pdf.png" />
</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><b>Declaring documentation-glossary items</b></td>
</tr>
</tbody>
</table>

<div class="figure">
<p><img src="images/tooltips_declaration.png" alt="tooltips_declaration.png" />
</p>
</div>

<blockquote>
<p>
The full article may be read as a <a href="https://alhassy.github.io/org-special-block-extras/README.pdf">PDF</a> or as <a href="https://alhassy.github.io/org-special-block-extras/README.html">HTML</a> or as pure <a href="https:/raw.githubusercontent.com/alhassy/org-special-block-extras/master/org-special-block-extras.org">Org</a>!
&#x2014;or visit the <a href="https://github.com/alhassy/org-special-block-extras">repo</a>.
</p>
</blockquote>

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#Core-Utility">1. <i>How do I make a new special block?</i> &#x2014;Core Utility</a>
<ul>
<li><a href="#What-is-a-special-block">1.1. <i>What is a special block?</i></a></li>
<li><a href="#Core-Utility">1.2. Core Utility</a></li>
<li><a href="#argument-Extraction">1.3. <code>:argument:</code> Extraction</a></li>
<li><a href="#COMMENT-An-Example-Special-Block-foo">1.4. An Example Special Block ---<code>foo</code></a></li>
<li><a href="#Next-Steps">1.5. Next Steps</a></li>
</ul>
</li>
<li><a href="#Links">2. <i>How do I make a new link type?</i></a></li>
<li><a href="#Colours">3. Colours</a>
<ul>
<li><a href="#org-special-block-extras-𝒞-where-𝒞-org-special-block-extras-colors">3.1. <code>org-special-block-extras--𝒞</code> where <code>𝒞 ∈ org-special-block-extras--colors</code></a></li>
<li><a href="#Examples">3.2. Block Examples</a></li>
<li><a href="#Colour-Link-Types">3.3. Colour Link Types</a></li>
<li><a href="#Next-Steps-colours">3.4. Next Steps</a></li>
</ul>
</li>
<li><a href="#Parallel">4. Parallel</a>
<ul>
<li><a href="#Example">4.1. Example</a></li>
<li><a href="#Next-Steps-parallel">4.2. Next Steps</a></li>
</ul>
</li>
<li><a href="#editor-comments">5. Editor Comments</a>
<ul>
<li><a href="#Examples">5.1. Block Examples</a></li>
<li><a href="#Link-Type">5.2. Link Type</a></li>
</ul>
</li>
<li><a href="#Folded-Details">6. Folded Details</a>
<ul>
<li><a href="#Example">6.1. Example</a></li>
</ul>
</li>
<li><a href="#Link-Here-OctoIcons">7. <i>“Link Here!”</i> OctoIcon</a></li>
<li><a href="#Badge-Links">8. Badge Links</a>
<ul>
<li><a href="#The-badge-Link">8.1. The <code>badge</code> Link and derived Reddit/Github/Twitter socials</a></li>
<li><a href="#Example-Social-Icons">8.2. Example Social Icons</a></li>
<li><a href="#Example-Badges">8.3. Example Badges</a></li>
<li><a href="#Example-Colours">8.4. Example Colours</a></li>
<li><a href="#Example-Badge-Icons">8.5. Example Badge Icons</a></li>
<li><a href="#Common-Project-Badges">8.6. Common Project Badges</a></li>
<li><a href="#Next-Steps-badges">8.7. Next Steps</a></li>
</ul>
</li>
<li><a href="#Tooltips-for-Glossaries-Dictionaries-and-Documentation">9. Tooltips for Glossaries, Dictionaries, and Documentation</a>
<ul>
<li><a href="#The-doc-link-type">9.1. The <code>doc</code> link type</a></li>
<li><a href="#Documentation-Blocks">9.2. Documentation Blocks</a></li>
<li><a href="#Examples">9.3. Examples</a></li>
<li><a href="#tooltipster">9.4. Tooltipster &#x2014;Fast, Sleek, &amp; Beautiful Tooltips</a></li>
<li><a href="#hola">9.5. Wait, what about the LaTeX?</a></li>
<li><a href="#Next-Steps-tooltips">9.6. Next Steps</a></li>
</ul>
</li>
<li><a href="#Summary">10. Summary</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgd85ed94" class="outline-2">
<h2 id="Core-Utility"><span class="section-number-2">1</span> <i>How do I make a new special block?</i> &#x2014;Core Utility</h2>
<div class="outline-text-2" id="text-Core-Utility">
<p>
An Org mode block is a region of text surrounded by <code>#+BEGIN_𝒳 … #+END_𝒳</code>; they
serve various purposes as summarised in the table below.  However, we shall
<b>use such blocks to execute arbitrary code on their contents</b>.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">𝒳</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>example</code></td>
<td class="org-left">Format text verbatim, leaving markup as is</td>
</tr>

<tr>
<td class="org-left"><code>src</code></td>
<td class="org-left">Format source code</td>
</tr>

<tr>
<td class="org-left"><code>center</code></td>
<td class="org-left">Centre text</td>
</tr>

<tr>
<td class="org-left"><code>quote</code></td>
<td class="org-left">Format text as a quotation</td>
</tr>

<tr>
<td class="org-left"><code>tiny</code></td>
<td class="org-left">Render text in a small font; likewise <code>footnotesize</code></td>
</tr>

<tr>
<td class="org-left"><code>comment</code></td>
<td class="org-left">Completely omit the text from export</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>They can be folded and unfolded in Emacs by pressing TAB in the <code>#+BEGIN</code> line.</li>
<li>The contents of blocks can be highlighted as if they were of language ℒ such
as <code>org, html, latex, haskell, lisp, python, …</code> by writing <code>#+BEGIN_𝒳 ℒ</code> on the
starting line, where <code>𝒳</code> is the name of the block type.</li>
<li>You can ‘zoom in temporarily’, <i>narrowing</i> your focus to only on a particular
block, with <code>org-narrow-to-element</code>, <code>C-x n e</code>, to make your window only show
the block.  Then use <code>C-x n w</code> to <i>widen</i> your vision of the buffer's contents.</li>
</ul>
</div>

<div id="outline-container-org29a56ab" class="outline-3">
<h3 id="What-is-a-special-block"><span class="section-number-3">1.1</span> <i>What is a special block?</i></h3>
<div class="outline-text-3" id="text-What-is-a-special-block">
<p>
Our goal is to turn Org blocks into LaTeX environments and HTML divs.
</p>

<p>
Why not use LaTeX or HTML environments directly?
</p>
<ul class="org-ul">
<li>Can no longer use Org markup in such settings.</li>
<li>Committed to one specific export type.</li>
</ul>

<div style="column-rule-style:solid;column-count:3;"<p>
In general, a “special block” such as
</p>
<pre class="example">
   #+begin_𝒳
   I /love/ Emacs!
   #+end_𝒳
</pre>

<p>

</p>

<p>
Exports to LaTeX as:
</p>
<div class="org-src-container">
<pre class="src src-latex">   <span style="color: #859900; font-weight: bold;">\begin</span>{<span style="color: #b58900;">&#119987;</span>}
   I <span style="color: #859900; font-weight: bold;">\emph</span>{<span style="font-style: italic;">love</span>} Emacs!
   <span style="color: #859900; font-weight: bold;">\end</span>{<span style="color: #b58900;">&#119987;</span>}
</pre>
</div>

<p>

</p>

<p>
Exports to HTML as:
</p>
<div class="org-src-container">
<pre class="src src-html">   &lt;<span style="color: #b58900;">div</span> <span style="color: #268bd2;">class</span>=<span style="color: #2aa198;">"&#119987;"</span>&gt;
   I &lt;<span style="color: #b58900;">em</span>&gt;<span style="font-style: italic;">love</span>&lt;/<span style="color: #b58900;">em</span>&gt; Emacs!
   &lt;/<span style="color: #b58900;">div</span>&gt;
</pre>
</div>
</div>

<div class="org-center">
<p>
<i>Notice that the standard org markup is also translated according to the export
type.</i>
</p>
</div>

<p>
If the <code>𝒳</code> environment exists in a backend &#x2014;e.g., by some <code>\usepackage{⋯}</code> or
manually with
<code>\newenvironment{𝒳}{⋯}{⋯}</code> in LaTeX&#x2014; then the file will compile
without error.  Otherwise, you need to ensure it exists &#x2014;e.g., by defining the
backend formatting manually yourself.
</p>

<p> <span style="border-width:1px;border-style:solid;padding:5px"><strong>[ Aside:</strong></span>

LaTeX packages that a user needs consistently are declared in the
 list <code>org-latex-packages-alist</code>. See its documentation, with <code>C-h o</code>,
to learn more.  To export to your own LaTeX classes, <code>C-h o org-latex-classes</code>.

 <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
<p>
A <code>div</code> tag defines a division or a section in an HTML document that is styled in
a particular fashion or has JavaScript code applied to it.  For example
&#x2014;placing the following in an <code>#+begin_export html ⋯ #+end_export</code>&#x2014; results in
a section of text that is editable by the user &#x2014;i.e., one can just alter text
in-place&#x2014; and its foreground colour is red, while its background colour is
light blue, and it has an uninformative tooltip.
</p>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #b58900;">div</span> <span style="color: #268bd2;">contenteditable</span>=<span style="color: #2aa198;">"true"</span>
     <span style="color: #268bd2;">title</span>=<span style="color: #2aa198;">"woah, a tool tip!"</span>
     <span style="color: #268bd2;">style</span>=<span style="color: #2aa198;">"color:red; background-color:lightblue"</span>&gt;
This is <span style="text-decoration: underline;">some</span> text!
&lt;/<span style="color: #b58900;">div</span>&gt;
</pre>
</div>

<p>
To use a collection of style settings repeatedly, we may declare them in a <code>class</code>
&#x2014;which is just a an alias for the ;-separated list of <code>attribute:value</code>
pairs. Then our <code>div</code>'s refer to that particular <code>class</code> name.
</p>

<div style="column-rule-style:solid;column-count:2;"<p>
For example, in an HTML export block, we may declare the following style class
named <code>red</code>.
</p>
<pre class="example">
#+begin_export html
&lt;style&gt;
.red { color:red; }
&lt;/style&gt;
#+end_export
</pre>
<p>

Now, the above syntax with <code>𝒳</code> replaced by <code>red</code> works as desired in HTML export.
</p>

<span style="color:red;"><p>
I <i>love</i> Emacs!
</p>
</span>

<p>
This, however, will not work if we want to produce LaTeX and so requires a
duplication of efforts. We will declare such formatting once for each backend.
</p>
</div>
</div>
</div>

<div id="outline-container-orgf45301a" class="outline-3">
<h3 id="Core-Utility"><span class="section-number-3">1.2</span> Core Utility</h3>
<div class="outline-text-3" id="text-Core-Utility">
<p>
The simplest route is to ‘advise’ &#x2014;i.e., function patch or overload&#x2014; the Org
export utility for special blocks to consider calling a method
<code>org-special-block-extras--𝒳</code> whenever it encounters a special block named <code>𝒳</code>.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #b58900;">advice-add</span> #'<span style="color: #b58900;">org-html-special-block</span>
   <span style="color: #d33682; font-style: italic;">:before-until</span> (<span style="color: #b58900;">apply-partially</span> #'<span style="color: #b58900;">org-special-block-extras--advice</span> 'html))

(<span style="color: #b58900;">advice-add</span> #'<span style="color: #b58900;">org-latex-special-block</span>
   <span style="color: #d33682; font-style: italic;">:before-until</span> (<span style="color: #b58900;">apply-partially</span> #'<span style="color: #b58900;">org-special-block-extras--advice</span> 'latex))
</pre>
</div>

<p>
Here is the actual advice:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">org-special-block-extras--advice</span> (backend blk contents _)
  <span style="color: #35a69c; font-style: italic;">"Invoke the appropriate custom block handler, if any.</span>

<span style="color: #35a69c; font-style: italic;">A given custom block BLK has a TYPE extracted from it, then we</span>
<span style="color: #35a69c; font-style: italic;">send the block CONTENTS along with the current export BACKEND to</span>
<span style="color: #35a69c; font-style: italic;">the formatting function ORG-SPECIAL-BLOCK-EXTRAS--TYPE if it is</span>
<span style="color: #35a69c; font-style: italic;">defined, otherwise, we leave the CONTENTS of the block as is.</span>

<span style="color: #35a69c; font-style: italic;">We also support the seemingly useless blocks that have no</span>
<span style="color: #35a69c; font-style: italic;">contents at all, not even an empty new line."</span>
  (<span style="color: #859900; font-weight: bold;">let*</span> ((type    (<span style="color: #b58900;">nth</span> 1 (<span style="color: #b58900;">nth</span> 1 blk)))
         (handler (<span style="color: #b58900;">intern</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"org-special-block-extras--%s"</span> type))))
    (<span style="color: #859900; font-weight: bold;">ignore-errors</span> (<span style="color: #b58900;">apply</span> handler backend (<span style="color: #859900; font-weight: bold;">or</span> contents <span style="color: #2aa198;">""</span>) nil))))
</pre>
</div>

<p>
<b>To support a new block named 𝒳:</b>
</p>
<ol class="org-ol">
<li>Define a function <code>org-special-block-extras--𝒳</code>.</li>
<li>It must take two arguments:
<ul class="org-ul">
<li><code>backend</code> ⇒ A symbol such as <code>'html</code> or <code>'latex</code>,</li>
<li><code>content</code> ⇒ The string contents of the special block.</li>
</ul></li>
<li>The function must return a string, possibly depending on the backend being
exported to. The resulting string is inserted literally in the exported file.</li>
<li>Test out your function as in <code>(org-special-block-extras--𝒳 'html "some input")</code>
&#x2014;this is a quick way to find errors.</li>
<li>Enjoy ^_^</li>
</ol>

<div class="org-center">
<p>
If no such function is defined, we export <code>𝒳</code> blocks using the default
mechanism, as discussed earlier, as a LaTeX environment or an HTML <code>div</code>.
</p>
</div>

<p>
An example is provided at the end of this section.
</p>

<p>
Of-course, when the user disables our mode, then we remove such advice.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #b58900;">advice-remove</span> #'<span style="color: #b58900;">org-html-special-block</span>
               (<span style="color: #b58900;">apply-partially</span> #'<span style="color: #b58900;">org-special-block-extras--advice</span> 'html))

(<span style="color: #b58900;">advice-remove</span> #'<span style="color: #b58900;">org-latex-special-block</span>
               (<span style="color: #b58900;">apply-partially</span> #'<span style="color: #b58900;">org-special-block-extras--advice</span> 'latex))
</pre>
</div>
</div>
</div>

<div id="outline-container-org2b999fd" class="outline-3">
<h3 id="argument-Extraction"><span class="section-number-3">1.3</span> <code>:argument:</code> Extraction</h3>
<div class="outline-text-3" id="text-argument-Extraction">
<p>
As far as I can tell, there is no way to provide arguments to special blocks.
As such, the following utility looks for lines of the form <code>:argument: value</code>
within the contents of a block and returns an updated contents string that no
longer has such lines followed by an association list of such argument-value
pairs.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">org-special-block-extras--extract-arguments</span> (contents <span style="color: #b58900; font-style: italic;">&amp;rest</span> args)
<span style="color: #35a69c; font-style: italic;">"Get list of CONTENTS string with ARGS lines stripped out and values of ARGS.</span>

<span style="color: #35a69c; font-style: italic;">Example usage:</span>

<span style="color: #35a69c; font-style: italic;">    (-let [(contents&#8242; . (&amp;alist 'k&#8320; &#8230; 'k&#8345;))</span>
<span style="color: #35a69c; font-style: italic;">           (&#8230;extract-arguments contents 'k&#8320; &#8230; 'k&#8345;)]</span>
<span style="color: #35a69c; font-style: italic;">          body)</span>

<span style="color: #35a69c; font-style: italic;">Within &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">body</span><span style="color: #35a69c; font-style: italic;">&#8217;, each &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">k&#7522;</span><span style="color: #35a69c; font-style: italic;">&#8217; refers to the &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">value</span><span style="color: #35a69c; font-style: italic;">&#8217; of argument</span>
<span style="color: #35a69c; font-style: italic;">&#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">:k&#7522;:</span><span style="color: #35a69c; font-style: italic;">&#8217; in the CONTENTS text and &#8216;contents&#8242;&#8217; is CONTENTS</span>
<span style="color: #35a69c; font-style: italic;">with all &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">:k&#7522;:</span><span style="color: #35a69c; font-style: italic;">&#8217; lines stripped out.</span>

<span style="color: #35a69c; font-style: italic;">+ If &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">:k:</span><span style="color: #35a69c; font-style: italic;">&#8217; is not an argument in CONTENTS, then it is assigned value NIL.</span>
<span style="color: #35a69c; font-style: italic;">+ If &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">:k:</span><span style="color: #35a69c; font-style: italic;">&#8217; is an argument in CONTENTS but is not given a value in CONTENTS,</span>
<span style="color: #35a69c; font-style: italic;">  then it has value the empty string."</span>
  (<span style="color: #859900; font-weight: bold;">let</span> ((ctnts contents)
        (<span style="color: #b58900;">values</span> (<span style="color: #859900; font-weight: bold;">cl-loop</span> for a in args
                         for regex <span style="color: #b58900;">=</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">":%s:</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">(</span><span style="color: #2aa198;">.*</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">)</span><span style="color: #2aa198;">"</span> a)
                         for v <span style="color: #b58900;">=</span> (<span style="color: #b58900;">cadr</span> (<span style="color: #b58900;">s-match</span> regex contents))
                         collect (<span style="color: #b58900;">cons</span> a v))))
    (<span style="color: #859900; font-weight: bold;">cl-loop</span> for a in args
             for regex <span style="color: #b58900;">=</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">":%s:</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">(</span><span style="color: #2aa198;">.*</span><span style="color: #268bd2; font-weight: bold;">\\</span><span style="color: #268bd2; font-weight: bold;">)</span><span style="color: #2aa198;">"</span> a)
             <span style="color: #b58900;">do</span> (<span style="color: #859900; font-weight: bold;">setq</span> ctnts (<span style="color: #b58900;">s-replace-regexp</span> regex <span style="color: #2aa198;">""</span> ctnts)))
    (<span style="color: #b58900;">cons</span> ctnts <span style="color: #b58900;">values</span>)))
</pre>
</div>

<p>
For example, we use this feature to indicate when a column break should happen
in a <code>parallel</code> block and which person is making editorial remarks in an
<code>edcomm</code> block.
</p>

<p>
Why the <code>:𝒳:</code> notation? At the start of a line, a string of this form is coloured
&#x2014;I don't recall why that is&#x2014; and that's a good enough reason to make use of
such an existing support.
</p>

<p> <span style="border-width:1px;border-style:solid;padding:5px"><strong>[ Aside:</strong></span>

In org-mode, ‘drawers’ are pieces of text that begin with
<code>:my_drawer_name:</code> on a line by itself and end with <code>:end:</code> on a line by itself, and
these delimiters allow us to fold away such regions and possibly exclude them
from export. That is, drawers act as a light-weight form of blocks. Anyhow, Org
colours drawer delimiters,

 <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
</div>
</div>

<div id="outline-container-orga34bccc" class="outline-3">
<h3 id="COMMENT-An-Example-Special-Block-foo"><span class="section-number-3">1.4</span> An Example Special Block ---<code>foo</code></h3>
<div class="outline-text-3" id="text-COMMENT-An-Example-Special-Block-foo">
<p>
Herein we show an example function <code>org-special-block-extras--𝒳</code> that makes use of
arguments.  In a so-called <code>foo</code> block, all occurrences of the word <code>foo</code> are
replaced by <code>bar</code> unless the argument <code>:replacement:</code> is given a value.
</p>


<div class="figure">
<p><img src="images/foo_block.png" alt="foo_block.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">org-special-block-extras--foo</span> (backend contents)
  <span style="color: #35a69c; font-style: italic;">"The FOO block type replaces all occurances of &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">foo</span><span style="color: #35a69c; font-style: italic;">&#8217; with &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">bar</span><span style="color: #35a69c; font-style: italic;">&#8217;,</span>
<span style="color: #35a69c; font-style: italic;">unless a &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">:replacement:</span><span style="color: #35a69c; font-style: italic;">&#8217; is provided."</span>
  (<span style="color: #859900; font-weight: bold;">-let</span> [(contents&#8242; . (<span style="color: #b58900; font-style: italic;">&amp;alist</span> 'replacement))
           (<span style="color: #b58900;">org-special-block-extras--extract-arguments</span> contents 'replacement)]
    (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"foo"</span> (<span style="color: #859900; font-weight: bold;">or</span> replacement <span style="color: #2aa198;">"bar"</span>) contents&#8242;)))
</pre>
</div>

<p>
Here's an example usage:
</p>
<div style="column-rule-style:solid;column-count:2;"<pre class="example">
#+begin_foo
:replacement: woah
I am foo; Indeed FoO is what I fOo!
#+end_foo
</pre>

<p>

</p>

<p>

I am  woah; Indeed  woah is what I  woah!
</p>
</div>

<p>
See the implementation matter of <code>edcomm</code> or <code>parallel</code> for a more involved definition
that behaves differently depending on the export backend.
</p>
</div>
</div>

<div id="outline-container-org074aaad" class="outline-3">
<h3 id="Next-Steps"><span class="section-number-3">1.5</span> Next Steps</h3>
<div class="outline-text-3" id="text-Next-Steps">
<p>
<span style="color:orange;">Going forward,</span> it would be nice to have a set of switches that apply to all
special blocks. For instance, <code>:ignore:</code> to simply bypass the user-defined
behaviour of a block type, and <code>:noexport:</code> to zero-out a block upon export.
These are super easy to do &#x2014;just need a few minutes to breath.  It may also be
desirable to provide support for <a href="https://github.com/alhassy/emacs.d#html-folded-drawers">drawers</a>, and to ‘fuse’ the block-type and
link-type approaches used here into one macro.
</p>
</div>
</div>
</div>

<div id="outline-container-orgecab355" class="outline-2">
<h2 id="Links"><span class="section-number-2">2</span> <i>How do I make a new link type?</i></h2>
<div class="outline-text-2" id="text-Links">
<p>
Use <code>(org-link-set-parameters params)</code> to add a new link type
&#x2014;an older obsolete method is <code>org-add-link-type</code>.
The list of all supported link types is <code>org-link-parameters</code>;
its documentation identifies the possibilities for <code>params</code>.
</p>

<p>
Let's produce an example link type, then discuss its code.
</p>

<p>
Intended usage:
Raw use <a href="https://lmgtfy.com/?q=salam">salam</a> and descriptive, <a href="https://lmgtfy.com/?q=hola">using ‘example’ link type</a> ^_^
<img src="images/example_link.png" alt="example_link.png" />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="linenr"> 1: </span>(<span style="color: #b58900;">org-link-set-parameters</span>
<span class="linenr"> 2: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The name of the new link type, usage: &#8220;example:label&#8221;</span>
<span id="coderef-extype" class="coderef-off"><span class="linenr"> 3: </span>  <span style="color: #2aa198;">"example"</span></span>
<span class="linenr"> 4: </span>
<span class="linenr"> 5: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">When you click on such links, &#8220;let me google that for you&#8221; happens</span>
<span id="coderef-exfollow" class="coderef-off"><span class="linenr"> 6: </span>  <span style="color: #d33682; font-style: italic;">:follow</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (label) (<span style="color: #b58900;">browse-url</span> (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"https://lmgtfy.com/?q="</span> label)))</span>
<span class="linenr"> 7: </span>
<span class="linenr"> 8: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Upon export, make it a &#8220;let me google that for you&#8221; link</span>
<span id="coderef-exexport" class="coderef-off"><span class="linenr"> 9: </span>  <span style="color: #d33682; font-style: italic;">:export</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (label description backend)</span>
<span class="linenr">10: </span>            (<span style="color: #b58900;">format</span> (<span style="color: #859900; font-weight: bold;">pcase</span> backend
<span class="linenr">11: </span>                      ('html <span style="color: #2aa198;">"&lt;a href=\"%s\"&gt;%s&lt;/a&gt;"</span>)
<span class="linenr">12: </span>                      ('latex <span style="color: #2aa198;">"\\href{%s}{%s}"</span>)
<span class="linenr">13: </span>                      (_ <span style="color: #2aa198;">"I don&#8217;t know how to export that!"</span>))
<span class="linenr">14: </span>                    (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"https://lmgtfy.com/?q="</span> label)
<span class="linenr">15: </span>                    (<span style="color: #859900; font-weight: bold;">or</span> description label)))
<span class="linenr">16: </span>
<span class="linenr">17: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">These links should *never* be folded in descriptive display;</span>
<span class="linenr">18: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">i.e., &#8220;[[example:lable][description]]&#8221; will always appear verbatim</span>
<span class="linenr">19: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">and not hide the first pair [&#8230;].</span>
<span id="coderef-exdisplay" class="coderef-off"><span class="linenr">20: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">:display 'full</span></span>
<span class="linenr">21: </span>
<span class="linenr">22: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The tooltip alongside a link</span>
<span id="coderef-exhelpecho" class="coderef-off"><span class="linenr">23: </span>  <span style="color: #d33682; font-style: italic;">:help-echo</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (window object <span style="color: #b58900;">position</span>)</span>
<span class="linenr">24: </span>               (<span style="color: #859900; font-weight: bold;">save-excursion</span>
<span class="linenr">25: </span>                 (<span style="color: #b58900;">goto-char</span> <span style="color: #b58900;">position</span>)
<span class="linenr">26: </span>                 (<span style="color: #859900; font-weight: bold;">-let*</span> (((<span style="color: #b58900; font-style: italic;">&amp;plist</span> <span style="color: #d33682; font-style: italic;">:path</span> <span style="color: #d33682; font-style: italic;">:format</span> <span style="color: #d33682; font-style: italic;">:raw-link</span> <span style="color: #d33682; font-style: italic;">:contents-begin</span> <span style="color: #d33682; font-style: italic;">:contents-end</span>)
<span class="linenr">27: </span>                          (<span style="color: #b58900;">cadr</span> (<span style="color: #b58900;">org-element-context</span>)))
<span class="linenr">28: </span>                         <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">(org-element-property :path (org-element-context))</span>
<span class="linenr">29: </span>                         (description
<span class="linenr">30: </span>                          (<span style="color: #859900; font-weight: bold;">when</span> (<span style="color: #b58900;">equal</span> <span style="color: #b58900;">format</span> 'bracket)
<span class="linenr">31: </span>                            (<span style="color: #b58900;">copy-region-as-kill</span> contents-begin contents-end)
<span class="linenr">32: </span>                            (<span style="color: #b58900;">substring-no-properties</span> (<span style="color: #b58900;">car</span> <span style="color: #268bd2;">kill-ring</span>)))))
<span class="linenr">33: </span>                   (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&#8220;%s&#8221; :: Let me google &#8220;%s&#8221; for you -__-"</span>
<span class="linenr">34: </span>                           (<span style="color: #859900; font-weight: bold;">or</span> description raw-link) (<span style="color: #b58900;">pp</span> window)))))
<span class="linenr">35: </span>
<span class="linenr">36: </span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">How should these links be displayed</span>
<span id="coderef-exface" class="coderef-off"><span class="linenr">37: </span>  <span style="color: #d33682; font-style: italic;">:face</span> '(<span style="color: #d33682; font-style: italic;">:foreground</span> <span style="color: #2aa198;">"red"</span> <span style="color: #d33682; font-style: italic;">:weight</span> <span style="color: #556b72; background-color: #FDF6E3;">bold</span></span>
<span class="linenr">38: </span>          <span style="color: #d33682; font-style: italic;">:underline</span> <span style="color: #2aa198;">"orange"</span> <span style="color: #d33682; font-style: italic;">:overline</span> <span style="color: #2aa198;">"orange"</span>))
</pre>
</div>


<dl class="org-dl">
<dt>Line <a href="#coderef-extype" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-extype');" onmouseout="CodeHighlightOff(this, 'coderef-extype');">3</a> <code>"example"</code></dt><dd><p>
Add a new <code>example</code> link type.
</p>
<ul class="org-ul">
<li>If the type already exists, update it with the given arguments.</li>
</ul>

<p>
The syntax for a raw link is <code>example:path</code>
and for the bracketed descriptive form <code>[[example:path][description]]</code>.
</p>

<ul class="org-ul">
<li>Some of my intended uses for links including colouring text and doing
nothing else, as such the terminology ‘path’ is not sufficiently generic and
so I use the designation ‘label’ instead.</li>
</ul></dd>

<dt>Line <a href="#coderef-exfollow" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-exfollow');" onmouseout="CodeHighlightOff(this, 'coderef-exfollow');">6</a> <code>:follow</code></dt><dd><p>
What should happen when a user clicks on such links?
</p>

<p>
This is a function taking the link path as the single argument and does
whatever is necessary to “follow the link”, for example find a file or display
a message. In our case, we open the user's browser and go to a particular URL.
</p></dd>

<dt>Line <a href="#coderef-exexport" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-exexport');" onmouseout="CodeHighlightOff(this, 'coderef-exexport');">9</a> <code>:export</code></dt><dd><p>
How should this link type be exported to HTML, LaTeX, etc?
</p>

<p>
This is a three-argument function that formats the link according to the given
backend, the resulting string value os placed literally into the exported
file. Its arguments are:
</p>

<ol class="org-ol">
<li><code>label</code> ⇒ the path of the link, the text after the link type prefix</li>
<li><code>description</code> ⇒ the description of the link, if any</li>
<li><code>backend</code> ⇒ the export format, a symbol like <code>html</code> or <code>latex</code> or <code>ascii</code>.</li>
</ol>

<p>
In our example above, we return different values depending on the <code>backend</code>
value.
</p>

<ul class="org-ul">
<li>If <code>:export</code> is not provided, default Org-link exportation happens.</li>
</ul></dd>

<dt>Line <a href="#coderef-exdisplay" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-exdisplay');" onmouseout="CodeHighlightOff(this, 'coderef-exdisplay');">20</a> <code>:display</code></dt><dd>Should links be prettily folded away when a description
is provided?</dd>

<dt>Line <a href="#coderef-exhelpecho" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-exhelpecho');" onmouseout="CodeHighlightOff(this, 'coderef-exhelpecho');">23</a> <code>:help-echo</code></dt><dd><p>
What should happen when the user's mouse is over
the link?
</p>

<p>
This is <b>either a string or a string-valued function</b> that takes the current
window, the current buffer object, and its position in the current window.
</p>

<p>
In our example link, we go to the position of the object, destructure the Org
link's properties using <code>-let</code>, find the description of the link, if any, then
provide a string based on the link's path and description.
</p>

<details class="code-details"> <summary> <strong> <font face="Courier" size="3" color="green"> <code>help-echo</code> is a general textual property </font> </strong> </summary> <p>

</p>

<p>
We may use <code>help-echo</code> to attach tooltips to arbitrary text in a file, as
follows. I have found this to be useful in <a href="https://alhassy.github.io/next-700-module-systems/prototype/package-former.html"><b>metaprogramming</b></a> to have
elaborated, generated, code shown as a tooltip attached to its named
specification.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Nearly instantaneous display of tooltips.</span>
(<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #b58900;">tooltip-delay</span> 0)

<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Give user 30 seconds before tooltip automatically disappears.</span>
(<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">tooltip-hide-delay</span> 300)

(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">tooltipify</span> (phrase notification <span style="color: #b58900; font-style: italic;">&amp;optional</span> <span style="color: #556b72; background-color: #FDF6E3;">underline</span>)
  <span style="color: #35a69c; font-style: italic;">"Add a tooltip to every instance of PHRASE to show NOTIFICATION.</span>

<span style="color: #35a69c; font-style: italic;">We only add tooltips to PHRASE as a standalone word, not as a subword.</span>

<span style="color: #35a69c; font-style: italic;">If UNDERLINE is provided, we underline the given PHRASE so as to</span>
<span style="color: #35a69c; font-style: italic;">provide a visual clue that it has a tooltip attched to it.</span>

<span style="color: #35a69c; font-style: italic;">The PHRASE is taken literally; no regexp operators are recognised."</span>
  (<span style="color: #859900; font-weight: bold;">assert</span> (<span style="color: #b58900;">stringp</span> phrase))
  (<span style="color: #859900; font-weight: bold;">assert</span> (<span style="color: #b58900;">stringp</span> notification))
  (<span style="color: #859900; font-weight: bold;">save-excursion</span>  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Return cursour to current-point afterwards.</span>
    (<span style="color: #b58900;">goto-char</span> 1)
    <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The \b are for empty-string at the start or end of a word.</span>
    (<span style="color: #859900; font-weight: bold;">while</span> (<span style="color: #b58900;">search-forward-regexp</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"\\b%s\\b"</span> (<span style="color: #b58900;">regexp-quote</span> phrase))
                                  (<span style="color: #b58900;">point-max</span>) <span style="color: #268bd2;">t</span>)
      <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">(add-text-properties x y ps)</span>
      <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">&#8658; Override properties ps for all text between x and y.</span>
      (<span style="color: #b58900;">add-text-properties</span> (<span style="color: #b58900;">match-beginning</span> 0)
                           (<span style="color: #b58900;">match-end</span> 0)
                           (<span style="color: #b58900;">list</span> 'help-echo (<span style="color: #b58900;">s-trim</span> notification)))))
 <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Example use</span>
(tooltipify
  <span style="color: #2aa198;">"Line"</span>
  <span style="color: #2aa198;">"A sequential formatation of entities or the trace of a particle in linear motion"</span>)
</pre>
</div>

<p>
Useful info on tooltips:
</p>
<ul class="org-ul">
<li><a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Changing-Properties.html">Changing text properties &#x2014;GNU</a></li>
<li><a href="http://kitchingroup.cheme.cmu.edu/blog/2013/04/12/Tool-tips-on-text-in-Emacs/">Tooltips on text in Emacs &#x2014;Kitchin</a></li>
<li><a href="http://kitchingroup.cheme.cmu.edu/blog/2016/03/16/Getting-graphical-feedback-as-tooltips-in-Emacs/">Getting graphical feedback as tooltips in Emacs &#x2014;Kitchin</a></li>
<li><a href="https://stackoverflow.com/questions/293853/defining-new-tooltips-in-emacs">Defining new tooltips in Emacs &#x2014;Stackoverflow</a></li>
</ul>
 </details></dd>

<dt>Line <a href="#coderef-exface" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-exface');" onmouseout="CodeHighlightOff(this, 'coderef-exface');">37</a> <code>:face</code></dt><dd><p>
What textual properties do these links possess?
</p>

<p>
This is <b>either a face or a face-valued function</b> that takes the current link's
path label as the only argument. That is, we could change the face according
to the link's label &#x2014;which is what we will do for the <code>color</code> link type as in
<code>[[color:brown][hello]]</code> will be rendered in brown text.
</p>

<ul class="org-ul">
<li>If <code>:face</code> is not provided, the default underlined blue face for Org links is used.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Faces.html">Learn more about faces!</a></li>
</ul></dd>

<dt>More</dt><dd>See <code>org-link-parameters</code> for documentation on more parameters.</dd>
</dl>
</div>
</div>

<div id="outline-container-org1d26d30" class="outline-2">
<h2 id="Colours"><span class="section-number-2">3</span> Colours</h2>
<div class="outline-text-2" id="text-Colours">
<p>
Let's develop blocks for colouring text and link types for inline
colouring.
</p>
<ul class="org-ul">
<li>Use <code>M-x list-colors-display</code> to see a list of defined colour names in Emacs
&#x2014;see <a href="http://muug.ca/mirror/ctan/macros/latex/contrib/xcolor/xcolor.pdf">xcolor</a> for the LaTeX side and <a href="https://htmlcolorcodes.com/color-names/">htmlcolorcodes.com</a> for the HTML side, or
just visit <a href="http://latexcolor.com/">http://latexcolor.com/</a> for both.</li>
</ul>



<div class="figure">
<p><img src="images/colours.jpg" alt="colours.jpg" />
</p>
</div>
</div>

<div id="outline-container-orgcb89d78" class="outline-3">
<h3 id="org-special-block-extras-𝒞-where-𝒞-org-special-block-extras-colors"><span class="section-number-3">3.1</span> <code>org-special-block-extras--𝒞</code> where <code>𝒞 ∈ org-special-block-extras--colors</code></h3>
<div class="outline-text-3" id="text-org-special-block-extras-𝒞-where-𝒞-org-special-block-extras-colors">
<p>
We declare a list of colors that should be available on most systems.  Then
using this list, we evaluate the code necessary to produce the necessary
functions that format special blocks.
</p>

<p>
By default, Org uses the <code>graphicx</code> LaTeX package which let's us colour text
&#x2014;see its documentation <a href="http://ctan.mirror.rafal.ca/macros/latex/required/graphics/grfguide.pdf">here</a>.  For example, in an <code>#+begin_export latex</code> block,
the following produces blue coloured text.
</p>
<pre class="example">
{  \color{blue}  This is a sample text in blue.  }
</pre>
<p>
Below, we format colour block types to essentially format block contents like
this.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">org-special-block-extras--colors</span>
  '(black blue brown cyan darkgray gray green lightgray lime
          magenta olive orange pink purple red teal violet white
          yellow)
  <span style="color: #35a69c; font-style: italic;">"Colours that should be available on all systems."</span>)

(<span style="color: #859900; font-weight: bold;">cl-loop</span> for colour in <span style="color: #268bd2;">org-special-block-extras--colors</span>
      <span style="color: #b58900;">do</span> (<span style="color: #b58900;">eval</span> (<span style="color: #b58900;">read</span> (<span style="color: #b58900;">format</span>
                      <span style="color: #2aa198;">"(defun org-special-block-extras--%s (backend contents)</span>
<span style="color: #2aa198;">                     (format (pcase backend</span>
<span style="color: #2aa198;">                     (`latex \"\\\\begingroup\\\\color{%s}%%s\\\\endgroup\\\\,\")</span>
<span style="color: #2aa198;">                     (_  \"&lt;span style=\\\"color:%s;\\\"&gt;%%s&lt;/span&gt;\"))</span>
<span style="color: #2aa198;">                     contents))"</span>
                      colour colour colour))))
</pre>
</div>

<p>
For faster experimentation between colours, we provide a generic <code>color</code> block
that consumes a <code>:color:</code> argument.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">org-special-block-extras--color</span> (backend contents)
  <span style="color: #35a69c; font-style: italic;">"Format CONTENTS according to the &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">:color:</span><span style="color: #35a69c; font-style: italic;">&#8217; they specify for BACKEND."</span>
  (<span style="color: #859900; font-weight: bold;">-let*</span> (((contents&#8242; . (<span style="color: #b58900; font-style: italic;">&amp;alist</span> 'color))
           (<span style="color: #b58900;">org-special-block-extras--extract-arguments</span> contents 'color))
         (block-coloring
          (<span style="color: #b58900;">intern</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"org-special-block-extras--%s"</span> (<span style="color: #b58900;">s-trim</span> color)))))
    (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">member</span> (<span style="color: #b58900;">intern</span> (<span style="color: #b58900;">s-trim</span> color)) <span style="color: #268bd2;">org-special-block-extras--colors</span>)
        (<span style="color: #b58900;">funcall</span> block-coloring backend contents&#8242;)
      (<span style="color: #b58900;">error</span> <span style="color: #2aa198;">"Error: &#8220;#+begin_color:%s&#8221; &#8658; Unsupported colour!"</span> color))))
</pre>
</div>

<p>
For example:
</p>
<span style="color:green;"><p>

Hello, friends!
</p>
</span>
</div>
</div>

<div id="outline-container-org87e7e01" class="outline-3">
<h3 id="Examples"><span class="section-number-3">3.2</span> Block Examples</h3>
<div class="outline-text-3" id="text-Examples">
<div style="column-rule-style:solid;column-count:2;"<span style="color:black;"><p>
This text is black!
</p>
</span>

<span style="color:blue;"><p>
This text is blue!
</p>
</span>

<span style="color:brown;"><p>
This text is brown!
</p>
</span>

<span style="color:cyan;"><p>
This text is cyan!
</p>
</span>

<span style="color:darkgray;"><p>
This text is darkgray!
</p>
</span>

<span style="color:gray;"><p>
This text is gray!
</p>
</span>

<span style="color:green;"><p>
This text is green!
</p>
</span>

<span style="color:lightgray;"><p>
This text is lightgray!
</p>
</span>

<span style="color:lime;"><p>
This text is lime!
</p>
</span>

<span style="color:magenta;"><p>
This text is magenta!
</p>
</span>

<span style="color:olive;"><p>
This text is olive!
</p>
</span>

<span style="color:orange;"><p>
This text is orange!
</p>
</span>

<span style="color:pink;"><p>
This text is pink!
</p>
</span>

<span style="color:purple;"><p>
This text is purple!
</p>
</span>

<span style="color:red;"><p>
This text is red!
</p>
</span>

<span style="color:teal;"><p>
This text is teal!
</p>
</span>

<span style="color:violet;"><p>
This text is violet!
</p>
</span>

<span style="color:white;"><p>
This text is white!
</p>
</span>

<span style="color:yellow;"><p>
This text is yellow!
</p>
</span>
</div>
</div>
</div>
<div id="outline-container-org0022fa9" class="outline-3">
<h3 id="Colour-Link-Types"><span class="section-number-3">3.3</span> Colour Link Types</h3>
<div class="outline-text-3" id="text-Colour-Link-Types">
<p>
We want the syntax <code>red:text</code> to <i>render</i> ‘text’ with the colour red
in <b>both</b> the Emacs interface and in exported backends.
</p>


<div class="figure">
<p><img src="images/colour_links.png" alt="colour_links.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">[[&#119966;:text&#8320;][text&#8321;]] &#8658; Colour &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">text&#8342;</span><span style="color: #96A7A9; font-style: italic;">&#8217; by &#119966;, where k is 1, if present, otherwise 0.</span>
<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">If text&#8321; is present, it is suggested to use &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">color:&#119966;</span><span style="color: #96A7A9; font-style: italic;">&#8217;, defined below.</span>
(<span style="color: #859900; font-weight: bold;">cl-loop</span> for colour in <span style="color: #268bd2;">org-special-block-extras--colors</span>
         <span style="color: #b58900;">do</span> (<span style="color: #b58900;">org-link-set-parameters</span>
             (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s"</span> colour)
              <span style="color: #d33682; font-style: italic;">:follow</span> `(<span style="color: #859900; font-weight: bold;">lambda</span> (path) (<span style="color: #b58900;">message</span> <span style="color: #2aa198;">"Colouring &#8220;%s&#8221; %s."</span> path (<span style="color: #859900; font-weight: bold;">quote</span> ,colour)))
              <span style="color: #d33682; font-style: italic;">:export</span> `(<span style="color: #859900; font-weight: bold;">lambda</span> (label description backend)
                        (<span style="color: #859900; font-weight: bold;">-let</span> [block-colouring
                               (<span style="color: #b58900;">intern</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"org-special-block-extras--%s"</span> (<span style="color: #859900; font-weight: bold;">quote</span> ,colour)))]
                          (<span style="color: #b58900;">funcall</span> block-colouring backend (<span style="color: #859900; font-weight: bold;">or</span> description label))))
              <span style="color: #d33682; font-style: italic;">:face</span> `(<span style="color: #d33682; font-style: italic;">:foreground</span> ,(<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s"</span> colour))))

<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Generic &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">color</span><span style="color: #96A7A9; font-style: italic;">&#8217; link type [[color:&#119966;][text]] &#8658; Colour &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">text</span><span style="color: #96A7A9; font-style: italic;">&#8217; by &#119966;.</span>
<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">If &#119966; is an unsupported colour, &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">text</span><span style="color: #96A7A9; font-style: italic;">&#8217; is rendered in large font</span>
<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">and surrounded by red lines.</span>
(<span style="color: #b58900;">org-link-set-parameters</span> <span style="color: #2aa198;">"color"</span>
   <span style="color: #d33682; font-style: italic;">:follow</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (_))
   <span style="color: #d33682; font-style: italic;">:face</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (colour)
           (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">member</span> (<span style="color: #b58900;">intern</span> colour) <span style="color: #268bd2;">org-special-block-extras--colors</span>)
               `(<span style="color: #d33682; font-style: italic;">:foreground</span> ,(<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s"</span> colour))
             `(<span style="color: #d33682; font-style: italic;">:height</span> 300
               <span style="color: #d33682; font-style: italic;">:underline</span> (<span style="color: #d33682; font-style: italic;">:color</span> <span style="color: #2aa198;">"red"</span> <span style="color: #d33682; font-style: italic;">:style</span> wave)
               <span style="color: #d33682; font-style: italic;">:overline</span>  <span style="color: #2aa198;">"red"</span> <span style="color: #d33682; font-style: italic;">:strike-through</span> <span style="color: #2aa198;">"red"</span>)))
 <span style="color: #d33682; font-style: italic;">:help-echo</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (window object <span style="color: #b58900;">position</span>)
              (<span style="color: #859900; font-weight: bold;">save-excursion</span>
                (<span style="color: #b58900;">goto-char</span> <span style="color: #b58900;">position</span>)
                (<span style="color: #859900; font-weight: bold;">-let*</span> (((<span style="color: #b58900; font-style: italic;">&amp;plist</span> <span style="color: #d33682; font-style: italic;">:path</span>) (<span style="color: #b58900;">cadr</span> (<span style="color: #b58900;">org-element-context</span>))))
                  (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">member</span> (<span style="color: #b58900;">intern</span> path) <span style="color: #268bd2;">org-special-block-extras--colors</span>)
                      <span style="color: #2aa198;">"Colour links just colour the descriptive text"</span>
                    (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"Error: &#8220;color:%s&#8221; &#8658; Unsupported colour!"</span> path)))))
   <span style="color: #d33682; font-style: italic;">:export</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (colour description backend)
             (<span style="color: #859900; font-weight: bold;">-let</span> [block-colouring
                    (<span style="color: #b58900;">intern</span> (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"org-special-block-extras--%s"</span> colour))]
               (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">member</span> (<span style="color: #b58900;">intern</span> colour) <span style="color: #268bd2;">org-special-block-extras--colors</span>)
                   (<span style="color: #b58900;">funcall</span> block-colouring backend description)
                 (<span style="color: #b58900;">error</span> <span style="color: #2aa198;">"Error: &#8220;color:%s&#8221; &#8658; Unsupported colour!"</span> colour)))))
</pre>
</div>

<p>
Observe: <span style="color:red;">this</span> <span style="color:green;">is</span> <span style="color:cyan;">super</span> <span style="color:teal;">neato</span>, <span style="color:purple;">amigos</span>! and <span style="color:brown;">this is brown ‘color’ link</span> and <span style="color:orange;">this one is an orange ‘color’ link!</span>
</p>

<p>
Also: If we try to use an unsupported colour ‘wombo’, we render the descriptive
text larger in Emacs along with a tooltip explaining why this is the case;
e.g.,
<code>[[color:wombo][hi]]</code>.
</p>

<p>
( Markdown does not support colour; go look at the HTML or PDF! )
</p>
</div>
</div>

<div id="outline-container-orgc7b37d7" class="outline-3">
<h3 id="Next-Steps-colours"><span class="section-number-3">3.4</span> Next Steps</h3>
<div class="outline-text-3" id="text-Next-Steps-colours">
<p>
Before indicating desirable next steps, let us produce an incidentally useful
special block type.
</p>

<p>
We may use LaTeX-style commands such as <code>{\color{red} x}</code> by enclosing them in
<code>$</code>-symbols to obtain \({\color{red}x}\) and other commands to present mathematical
formulae in HTML.  This is known as the MathJax tool &#x2014;Emacs' default HTML
export includes it.
</p>

<p>
It is common to declare LaTeX definitions for convenience, but such
declarations occur within <code>$</code>-delimiters and thereby produce undesirable extra
whitespace. We declare the <code>latex_definitions</code> block type which avoids
displaying such extra whitespace in the resulting HTML.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">org-special-block-extras--latex-definitions</span> (backend contents)
  <span style="color: #35a69c; font-style: italic;">"Declare but do not display the CONTENTS according to the BACKEND."</span>
  (<span style="color: #859900; font-weight: bold;">loop</span> for (this that) in (<span style="color: #b58900;">-partition</span> 2 '(<span style="color: #2aa198;">"&lt;p&gt;"</span> <span style="color: #2aa198;">""</span>
                                           <span style="color: #2aa198;">"&lt;/p&gt;"</span> <span style="color: #2aa198;">""</span>
                                           <span style="color: #2aa198;">"\\{"</span> <span style="color: #2aa198;">"{"</span>
                                           <span style="color: #2aa198;">"\\}"</span> <span style="color: #2aa198;">"}"</span>))
        <span style="color: #b58900;">do</span> (<span style="color: #859900; font-weight: bold;">setq</span> contents (<span style="color: #b58900;">s-replace</span> this that contents)))
  (<span style="color: #b58900;">format</span> (<span style="color: #859900; font-weight: bold;">pcase</span> backend
            ('html <span style="color: #2aa198;">"&lt;p style=\"display:none\"&gt;\\[</span><span style="color: #6c71c4; font-weight: bold;">%s\\</span><span style="color: #2aa198;">]&lt;/p&gt;"</span>)
            (_ <span style="color: #2aa198;">"%s"</span>))
          contents))
</pre>
</div>

<ul class="org-ul">
<li><p>
Org escapes <code>{,}</code> in LaTeX export, so we need to ‘unescape’ them.
This is clearly a hack.
</p>

<p>
Here is an example usage, where we declare <code>\LL</code> to produce a violet left
parenthesis. We then use these to produce an example of linear quantification
notation &#x2014;also known as Z-notation.
</p>
<p style="display:none">\[
\def\LL{\color{violet}(}
\def\RR{\color{violet})}

\]</p>
<p>
\[
 {\color{teal}\bigoplus}
 _{   {\color{violet} x}
    = {\color{red} a}}
 ^{\color{cyan} b}
    {\color{brown}{\,f\, x}}
 \quad=\quad
            {\color{brown}{f\,\LL  {\color{red} a} \RR}}
 \;{\color{teal}\oplus}\; {\color{brown}{f \, \LL a + 1 \RR }}
 \;{\color{teal}\oplus}\; {\color{brown}{f \, \LL a + 2 \RR }}
 \;{\color{teal}\oplus}\; \cdots
 \;{\color{teal}\oplus}\; {\color{brown}{f \, \LL {\color{cyan} b} \RR}}
 \]
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><span style="color:teal;">⊕</span></td>
<td class="org-left"><i>Loop sequentially with loop-bodies fused using <span style="color:teal;">⊕</span></i></td>
</tr>

<tr>
<td class="org-left"><i><span style="color:violet;">x</span></i></td>
<td class="org-left"><i>Use <span style="color:violet;">x</span> as the name of the current element</i></td>
</tr>

<tr>
<td class="org-left"><i><span style="color:red;">a</span></i></td>
<td class="org-left"><i>Start with <span style="color:violet;">x</span> being <span style="color:red;">a</span></i></td>
</tr>

<tr>
<td class="org-left"><i><span style="color:cyan;">b</span></i></td>
<td class="org-left"><i>End with <span style="color:violet;">x</span> being <span style="color:cyan;">b</span></i></td>
</tr>

<tr>
<td class="org-left"><i><span style="color:brown;">f x</span></i></td>
<td class="org-left"><i>At each <span style="color:violet;">x</span> value, compute <span style="color:brown;">f x</span></i></td>
</tr>
</tbody>
</table></li>
</ul>

<p>
( Markdown does not support MathJax; go look at the HTML or PDF! )
</p>

<p>
Unfortunately, MathJax does not easily support arbitrary HTML elements to occur
within the <code>$</code>-delimiters &#x2014;see <a href="https://stackoverflow.com/questions/58883048/mathjax-or-similar-render-arbitrary-html-element-inside-expression">this</a> and <a href="https://github.com/mathjax/MathJax/issues/1707">this</a> for ‘workarounds’.  As such, the
MathJax producing the Z-notation example is rather ugly whereas its subsequent
explanatory table is prettier on the writer's side.
</p>

<p>
<span style="color:orange;">Going forward,</span> it would be nice to easily have our colour links work within
a mathematical special block.
</p>

<p>
<span style="color:orange;">Moreover,</span> it would be nice to extend the <code>color</code> block type to take multiple
arguments, say, by a switch <code>:colors: c₁ c₂ … cₙ</code> such that:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right"><i>n</i></th>
<th scope="col" class="org-left">Behaviour</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-left">No colouring; likewise if <code>:colors:</code> is absent altogether</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">Colour all entries using the given colour c₁</td>
</tr>

<tr>
<td class="org-right"><i>n</i></td>
<td class="org-left">Paragraph &#x2013;region separated by a new line&#x2013; <code>i</code> is coloured by <code>cₖ</code> where <code>k = i mod n</code></td>
</tr>
</tbody>
</table>

<p>
Besides having a colourful article, another usage I envision for this
generalisation would be when rendering text in multiple languages; e.g., use red
and blue to interleave a Arabic poetry with its English translation.
</p>
</div>
</div>
</div>

<div id="outline-container-orga5ce6b1" class="outline-2">
<h2 id="Parallel"><span class="section-number-2">4</span> Parallel</h2>
<div class="outline-text-2" id="text-Parallel">
<p>
We want to be able to reduce the amount of whitespace noise in our articles, and
so use the <code>parallel</code> block to place ideas side-by-side &#x2014;with up to the chosen
limit of 5 columns.
</p>


<div class="figure">
<p><img src="images/parallel.png" alt="parallel.png" />
</p>
<p><span class="figure-number">Figure 15: </span>Displaying thoughts side-by-side ^_^ Top is browser, then Emacs, then PDF</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>#+LATEX_HEADER: \usepackage{multicol}</code></td>
</tr>
</tbody>
</table>

<p>
I initially used the names <code>parallel𝓃</code> but names ending with a number <code>𝓃</code> did not
inherit highlighting, so I shifted the number to being a prefix instead.
</p>
<ul class="org-ul">
<li>For LaTeX, new lines are used to suggest opportunities for column breaks
and are needed even if explicit columnbreaks are declared.</li>
<li>Use the nullary switch <code>:columnbreak:</code> to request a columnbreak; this has no
effect on HTML export since HTML describes how text should be formatted on a
browser, which can dynamically shrink and grow and thus it makes no sense to have
hard columnbreaks.</li>
<li>We also provide <code>𝓃parallelNB</code> for users who want ‘N’o ‘B’ar separator
between columns.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">cl-loop</span> for cols in '(<span style="color: #2aa198;">"1"</span> <span style="color: #2aa198;">"2"</span> <span style="color: #2aa198;">"3"</span> <span style="color: #2aa198;">"4"</span> <span style="color: #2aa198;">"5"</span>)
      <span style="color: #b58900;">do</span> (<span style="color: #859900; font-weight: bold;">cl-loop</span> for rule in '(<span style="color: #2aa198;">"solid"</span> <span style="color: #2aa198;">"none"</span>)
      <span style="color: #b58900;">do</span> (<span style="color: #b58900;">eval</span> (<span style="color: #b58900;">read</span> (<span style="color: #b58900;">concat</span>
<span style="color: #2aa198;">"(defun org-special-block-extras--"</span> cols <span style="color: #2aa198;">"parallel"</span>
(<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">equal</span> rule <span style="color: #2aa198;">"solid"</span>) <span style="color: #2aa198;">""</span> <span style="color: #2aa198;">"NB"</span>)
<span style="color: #2aa198;">"(backend contents)"</span>
<span style="color: #2aa198;">"(format (pcase backend"</span>
<span style="color: #2aa198;">"(`html \"&lt;div style=\\\"column-rule-style:"</span> rule <span style="color: #2aa198;">";column-count:"</span> cols <span style="color: #2aa198;">";\\\"%s&lt;/div&gt;\")"</span>
<span style="color: #2aa198;">"(`latex \"\\\\par \\\\setlength{\\\\columnseprule}{"</span> (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">equal</span> rule <span style="color: #2aa198;">"solid"</span>) <span style="color: #2aa198;">"2"</span> <span style="color: #2aa198;">"0"</span>) <span style="color: #2aa198;">"pt}"</span>
<span style="color: #2aa198;">"          \\\\begin{minipage}[t]{\\\\linewidth}"</span>
<span style="color: #2aa198;">"          \\\\begin{multicols}{"</span> cols <span style="color: #2aa198;">"}"</span>
<span style="color: #2aa198;">"          %s"</span>
<span style="color: #2aa198;">"          \\\\end{multicols}\\\\end{minipage}\"))"</span>
<span style="color: #2aa198;">"(s-replace \":columnbreak:\" (if (equal 'html backend) \"\" \"\\\\columnbreak\")</span>
<span style="color: #2aa198;">contents)))"</span>)))))
</pre>
</div>

<p>
We also use <code>parallel</code> as an alias for <code>2parallel</code>.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defalias</span> #'<span style="color: #b58900;">org-special-block-extras--parallel</span>
          #'<span style="color: #b58900;">org-special-block-extras--2parallel</span>)

(<span style="color: #859900; font-weight: bold;">defalias</span> #'<span style="color: #b58900;">org-special-block-extras--parallelNB</span>
          #'<span style="color: #b58900;">org-special-block-extras--2parallelNB</span>)
</pre>
</div>
</div>

<div id="outline-container-org1e4fc75" class="outline-3">
<h3 id="Example"><span class="section-number-3">4.1</span> Example</h3>
<div class="outline-text-3" id="text-Example">
<div style="column-rule-style:solid;column-count:2;"<p>
<span class="underline">Example:</span>
</p>
<pre class="example">
#+begin_3parallel org
one

#+latex: \columnbreak
two

#+latex: \columnbreak
three
#+end_3parallel
</pre>

<p>
<span class="underline">Yields:</span>
</p>
<div style="column-rule-style:solid;column-count:3;"<p>
one
</p>

<p>
two
</p>

<p>
three
</p>
</div>
</div>

<div class="org-center">
<p>
( The <a href="https://www.gnu.org/software/emacs/manual/html_mono/eww.html">Emacs Web Wowser</a>, <code>M-x eww</code>, does not display <code>parallel</code> environments as
desired. )
</p>
</div>
</div>
</div>

<div id="outline-container-org01db21c" class="outline-3">
<h3 id="Next-Steps-parallel"><span class="section-number-3">4.2</span> Next Steps</h3>
<div class="outline-text-3" id="text-Next-Steps-parallel">
<p>
<span style="color:orange;">Going forward,</span> it would be desirable to have the columns take a specified
percentage of the available width &#x2014;whereas currently it splits it uniformly.
Such a feature would be useful in cases where one column is wide and the others
are not.
</p>
</div>
</div>
</div>

<div id="outline-container-org9b25633" class="outline-2">
<h2 id="editor-comments"><span class="section-number-2">5</span> Editor Comments</h2>
<div class="outline-text-2" id="text-editor-comments">
<p>
“Editor Comments” are intended to be top-level first-class comments in an
article that are inline with the surrounding text and are delimited in such a
way that they are visible but drawing attention.  I first learned about this
idea from Wolfram Kahl &#x2014;who introduced me to Emacs many years ago.
</p>

<p>
In LaTeX, an <code>edcomm</code> appears inline with the text surrounding it.
</p>
<p> <span style="border-width:1px;border-style:solid;padding:5px"><strong>[ Bobert:&nbsp;<u>Replace:</u></strong></span>

org-mode is dope, yo!
 <span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>
Org-mode is essentially a path toward enlightenment.

 <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
<p>
Unfortunately, in the HTML rendition, the <code>edcomm</code> is its own paragraph and thus
separated by new lines from its surrounding text.
</p>


<div class="figure">
<p><img src="images/edcomm.png" alt="edcomm.png" />
</p>
<p><span class="figure-number">Figure 16: </span>In order: Chrome, Emacs Web Wowser, Org source, PDF</p>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><i>Any new &#x2014;possibly empty&#x2014; inner lines in the <code>edcomm</code> are desirably preserved</i></td>
</tr>
</tbody>
</table>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">org-special-block-extras-hide-editor-comments</span> nil
  <span style="color: #35a69c; font-style: italic;">"Should editor comments be shown in the output or not."</span>)

(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">org-special-block-extras--edcomm</span> (backend contents)
<span style="color: #35a69c; font-style: italic;">"Format CONTENTS as an first-class editor comment according to BACKEND.</span>

<span style="color: #35a69c; font-style: italic;">The CONTENTS string has two optional argument switches:</span>
<span style="color: #35a69c; font-style: italic;">1. :ed: &#8658; To declare an editor of the comment.</span>
<span style="color: #35a69c; font-style: italic;">2. :replacewith: &#8658; [Nullary] The text preceding this clause</span>
<span style="color: #35a69c; font-style: italic;">   should be replaced by the text after it."</span>
  (<span style="color: #859900; font-weight: bold;">-let*</span> (
           <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Get arguments</span>
           ((contents&#8321; . (<span style="color: #b58900; font-style: italic;">&amp;alist</span> 'ed))
            (<span style="color: #b58900;">org-special-block-extras--extract-arguments</span> contents 'ed))

           <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Strip out any &lt;p&gt; tags</span>
           (_ (<span style="color: #859900; font-weight: bold;">setq</span> contents&#8321; (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"&lt;p&gt;"</span> <span style="color: #2aa198;">""</span> contents&#8321;)))
           (_ (<span style="color: #859900; font-weight: bold;">setq</span> contents&#8321; (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"&lt;/p&gt;"</span> <span style="color: #2aa198;">""</span> contents&#8321;)))

           <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Are we in the html backend?</span>
           (html? (<span style="color: #b58900;">equal</span> backend 'html))

           <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">fancy display style</span>
           (boxed (<span style="color: #859900; font-weight: bold;">lambda</span> (x)
                    (<span style="color: #859900; font-weight: bold;">if</span> html?
                        (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"&lt;span style=\"border-width:1px"</span>
                                 <span style="color: #2aa198;">";border-style:solid;padding:5px\"&gt;"</span>
                                 <span style="color: #2aa198;">"&lt;strong&gt;"</span> x <span style="color: #2aa198;">"&lt;/strong&gt;&lt;/span&gt;"</span>)
                    (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"\\fbox{\\bf "</span> x <span style="color: #2aa198;">"}"</span>))))

           <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Is this a replacement clause?</span>
           ((this that) (<span style="color: #b58900;">s-split</span> <span style="color: #2aa198;">":replacewith:"</span> contents&#8321;))
           (replacement-clause? that) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">There is a &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">that</span><span style="color: #96A7A9; font-style: italic;">&#8217;</span>
           (replace-keyword (<span style="color: #859900; font-weight: bold;">if</span> html? <span style="color: #2aa198;">"&amp;nbsp;&lt;u&gt;Replace:&lt;/u&gt;"</span>
                              <span style="color: #2aa198;">"\\underline{Replace:}"</span>))
           (with-keyword    (<span style="color: #859900; font-weight: bold;">if</span> html? <span style="color: #2aa198;">"&lt;u&gt;With:&lt;/u&gt;"</span>
                              <span style="color: #2aa198;">"\\underline{With:}"</span>))
           (editor (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"[%s:%s"</span>
                           (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">s-blank?</span> ed) <span style="color: #2aa198;">"Editor Comment"</span> ed)
                           (<span style="color: #859900; font-weight: bold;">if</span> replacement-clause?
                               replace-keyword
                             <span style="color: #2aa198;">""</span>)))
           (contents&#8322; (<span style="color: #859900; font-weight: bold;">if</span> replacement-clause?
                          (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s %s %s"</span> this
                                  (<span style="color: #b58900;">funcall</span> boxed with-keyword)
                                  that)
                        contents&#8321;))

           <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">&#8220;[Editor Comment:&#8221;</span>
           (edcomm-begin (<span style="color: #b58900;">funcall</span> boxed editor))
           <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">&#8220;]&#8221;</span>
           (edcomm-end (<span style="color: #b58900;">funcall</span> boxed <span style="color: #2aa198;">"]"</span>)))

    (<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">org-export-allow-bind-keywords</span> <span style="color: #268bd2;">t</span>) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">So users can use &#8220;#+bind&#8221; immediately</span>
    (<span style="color: #859900; font-weight: bold;">if</span> <span style="color: #268bd2;">org-special-block-extras-hide-editor-comments</span>
        <span style="color: #2aa198;">""</span>
      (<span style="color: #b58900;">format</span> (<span style="color: #859900; font-weight: bold;">pcase</span> backend
                ('latex <span style="color: #2aa198;">"%s %s %s"</span>)
                (_ <span style="color: #2aa198;">"&lt;p&gt; %s %s %s&lt;/p&gt;"</span>))
              edcomm-begin contents&#8322; edcomm-end))))
</pre>
</div>

<p>
In the HTML export, the <code>edcomm</code> special block is <i>not</i> in-line with the text
surrounding it &#x2014;ideally, it would be inline so that existing paragraphs are
not split into multiple paragraphs but instead have an editor's comment
indicating suggested alterations.
</p>
</div>

<div id="outline-container-org75d2ce9" class="outline-3">
<h3 id="Examples"><span class="section-number-3">5.1</span> Block Examples</h3>
<div class="outline-text-3" id="text-Examples">
<p>
All editor comments are disabled by declaring, in your Org file:
</p>
<pre class="example">
#+bind: org-special-block-extras-hide-editor-comments t
</pre>
<p>
The <code>#+bind:</code> keyword makes Emacs variables buffer-local during export
&#x2014;it is evaluated <i>after</i> any <code>src</code> blocks. To use it, one must declare in
their Emacs init file the following line, which our mode
ensures is true.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">org-export-allow-bind-keywords</span> <span style="color: #268bd2;">t</span>)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">( Remember to <code>C-c C-c</code> the <code>#+bind</code> to activate it, the first time it is written. )</td>
</tr>
</tbody>
</table>
</div>

<div id="outline-container-org5f05378" class="outline-4">
<h4 id="No-optional-arguments"><span class="section-number-4">5.1.1</span> No optional arguments</h4>
<div class="outline-text-4" id="text-No-optional-arguments">
<p> <span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Comment:</strong></span>
<i>Please</i> <b>change</b> <span class="underline">this</span> section to be more, ya know, professional.

 <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
</div>
</div>

<div id="outline-container-org30458d5" class="outline-4">
<h4 id="Only-declaring-an-ed-editor"><span class="section-number-4">5.1.2</span> Only declaring an <code>:ed:</code> &#x2014;editor</h4>
<div class="outline-text-4" id="text-Only-declaring-an-ed-editor">
<p> <span style="border-width:1px;border-style:solid;padding:5px"><strong>[ Bobert:</strong></span>

<i>Please</i> <b>change</b> <span class="underline">this</span> section to be more, ya know, professional.

 <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>

<p>
Possibly with no contents:
</p>
<p> <span style="border-width:1px;border-style:solid;padding:5px"><strong>[ Bobert:</strong></span>


 <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
</div>
</div>

<div id="outline-container-orgd903fbc" class="outline-4">
<h4 id="Empty-contents-no-editor-nothing"><span class="section-number-4">5.1.3</span> Empty contents, no editor, nothing</h4>
<div class="outline-text-4" id="text-Empty-contents-no-editor-nothing">
<p> <span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Comment:</strong></span>  <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>

<p>
Possibly with an empty new line:
</p>
<p> <span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Comment:</strong></span>


 <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
</div>
</div>

<div id="outline-container-orgae2c6e4" class="outline-4">
<h4 id="With-a-replacewith-clause"><span class="section-number-4">5.1.4</span> With a <code>:replacewith:</code> clause</h4>
<div class="outline-text-4" id="text-With-a-replacewith-clause">
<p> <span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Comment:&nbsp;<u>Replace:</u></strong></span>
The two-dimensional notation; e.g., \(\sum_{i = 0}^n i^2\)
 <span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>
A linear one-dimensional notation; e.g.,
\((\Sigma i : 0..n \;\bullet\; i^2)\)

 <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>

<p>
Possibly “malformed” replacement clauses.
</p>

<ol class="org-ol">
<li><p>
Forget the thing to be replaced.
</p>
<p> <span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Comment:&nbsp;<u>Replace:</u></strong></span>
 <span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>
A linear one-dimensional notation; e.g.,
\((\Sigma i : 0..n \;\bullet\; i^2)\)

 <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p></li>

<li><p>
Forget the new replacement thing.
</p>
<p> <span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Comment:&nbsp;<u>Replace:</u></strong></span>
The two-dimensional notation; e.g., \(\sum_{i = 0}^n i^2\)
 <span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>

 <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p></li>

<li><p>
Completely lost one's train of thought.
</p>
<p> <span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Comment:&nbsp;<u>Replace:</u></strong></span>
 <span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>

 <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-org696c1dd" class="outline-3">
<h3 id="Link-Type"><span class="section-number-3">5.2</span> Link Type</h3>
<div class="outline-text-3" id="text-Link-Type">
<p>
A block to make an editorial comment could be overkill in some cases; so we
provide the <code>edcomm</code> link type.
</p>

<ul class="org-ul">
<li>Syntax: <code>[[edcomm:person_name][editorial remark]]</code>.</li>
<li>This link type exports the same as the <code>edcomm</code> block type;
however, in Emacs it is shown with an ‘angry’ &#x2014;bold&#x2014; red face.</li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="linenr"> 1: </span>(<span style="color: #b58900;">org-link-set-parameters</span>
<span class="linenr"> 2: </span> <span style="color: #2aa198;">"edcomm"</span>
<span class="linenr"> 3: </span>  <span style="color: #d33682; font-style: italic;">:follow</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (_))
<span class="linenr"> 4: </span>  <span style="color: #d33682; font-style: italic;">:export</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (label description backend)
<span class="linenr"> 5: </span>            (<span style="color: #b58900;">org-special-block-extras--edcomm</span>
<span class="linenr"> 6: </span>             backend
<span class="linenr"> 7: </span>             (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">":ed:%s\n%s"</span> label description)))
<span class="linenr"> 8: </span>  <span style="color: #d33682; font-style: italic;">:help-echo</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (window object <span style="color: #b58900;">position</span>)
<span class="linenr"> 9: </span>               (<span style="color: #859900; font-weight: bold;">save-excursion</span>
<span class="linenr">10: </span>                 (<span style="color: #b58900;">goto-char</span> <span style="color: #b58900;">position</span>)
<span class="linenr">11: </span>                 (<span style="color: #859900; font-weight: bold;">-let*</span> [(<span style="color: #b58900; font-style: italic;">&amp;plist</span> <span style="color: #d33682; font-style: italic;">:path</span>) (<span style="color: #b58900;">cadr</span> (<span style="color: #b58900;">org-element-context</span>))]
<span class="linenr">12: </span>                   (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"%s made this remark"</span> (<span style="color: #b58900;">s-upcase</span> path)))))
<span class="linenr">13: </span>  <span style="color: #d33682; font-style: italic;">:face</span> '(<span style="color: #d33682; font-style: italic;">:foreground</span> <span style="color: #2aa198;">"red"</span> <span style="color: #d33682; font-style: italic;">:weight</span> <span style="color: #556b72; background-color: #FDF6E3;">bold</span>))
</pre>
</div>

<p>
For example:
<p> <span style="border-width:1px;border-style:solid;padding:5px"><strong>[Jasim:</strong></span>
Hello, where are you? <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
</p>

<p>
The <code>:replacewith:</code> switch &#x2014;and usual Org markup&#x2014; also works with these links:
<p> <span style="border-width:1px;border-style:solid;padding:5px"><strong>[Qasim:&nbsp;<u>Replace:</u></strong></span>
<i>‘j’</i>  <span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>  <i>‘q’</i> <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
</p>
</div>
</div>
</div>

<div id="outline-container-orgabebe5d" class="outline-2">
<h2 id="Folded-Details"><span class="section-number-2">6</span> Folded Details</h2>
<div class="outline-text-2" id="text-Folded-Details">
<p>
Sometimes there is a remark or a code snippet that is useful to have, but not
relevant to the discussion at hand and so we want to <i>fold away such details</i>.
</p>

<ul class="org-ul">
<li>‘Conversation-style’ articles, where the author asks the reader questions
whose answers are “folded away” so the reader can think about the exercise
before seeing the answer.</li>

<li>Hiding boring but important code snippets, such as a list of import
declarations or a tedious implementation.</li>
</ul>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><code>#+LATEX_HEADER: \usepackage{tcolorbox}</code></td>
</tr>
</tbody>
</table>


<div class="figure">
<p><img src="images/details.png" alt="details.png" />
</p>
<p><span class="figure-number">Figure 17: </span>Visually hiding, folding away, details</p>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="linenr"> 1: </span>(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">org-special-block-extras--details</span> (backend contents)
<span class="linenr"> 2: </span><span style="color: #35a69c; font-style: italic;">"Format CONTENTS as a &#8216;folded region&#8217; according to BACKEND.</span>
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span><span style="color: #35a69c; font-style: italic;">CONTENTS may have a &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">:title</span><span style="color: #35a69c; font-style: italic;">&#8217; argument specifying a title for</span>
<span class="linenr"> 5: </span><span style="color: #35a69c; font-style: italic;">the folded region."</span>
<span class="linenr"> 6: </span>(<span style="color: #859900; font-weight: bold;">-let*</span> (<span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Get arguments</span>
<span class="linenr"> 7: </span>        ((contents&#8242; . (<span style="color: #b58900; font-style: italic;">&amp;alist</span> 'title))
<span class="linenr"> 8: </span>         (<span style="color: #b58900;">org-special-block-extras--extract-arguments</span> contents 'title)))
<span class="linenr"> 9: </span>  (<span style="color: #859900; font-weight: bold;">when</span> (<span style="color: #b58900;">s-blank?</span> title) (<span style="color: #859900; font-weight: bold;">setq</span> title <span style="color: #2aa198;">"Details"</span>))
<span class="linenr">10: </span>  (<span style="color: #859900; font-weight: bold;">setq</span> title (<span style="color: #b58900;">s-trim</span> title))
<span class="linenr">11: </span>  (<span style="color: #b58900;">format</span>
<span class="linenr">12: </span>   (<span style="color: #b58900;">s-collapse-whitespace</span> <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Remove the whitespace only in the nicely presented</span>
<span class="linenr">13: </span>                          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">strings below</span>
<span class="linenr">14: </span>    (<span style="color: #859900; font-weight: bold;">pcase</span> backend
<span class="linenr">15: </span>      (`html <span style="color: #2aa198;">"&lt;details class=\"code-details\"&gt;</span>
<span class="linenr">16: </span><span style="color: #2aa198;">                 &lt;summary&gt;</span>
<span class="linenr">17: </span><span style="color: #2aa198;">                   &lt;strong&gt;</span>
<span class="linenr">18: </span><span style="color: #2aa198;">                     &lt;font face=\"Courier\" size=\"3\" color=\"green\"&gt; %s</span>
<span class="linenr">19: </span><span style="color: #2aa198;">                     &lt;/font&gt;</span>
<span class="linenr">20: </span><span style="color: #2aa198;">                   &lt;/strong&gt;</span>
<span class="linenr">21: </span><span style="color: #2aa198;">                 &lt;/summary&gt;</span>
<span class="linenr">22: </span><span style="color: #2aa198;">                 %s</span>
<span class="linenr">23: </span><span style="color: #2aa198;">              &lt;/details&gt;"</span>)
<span class="linenr">24: </span>      (`latex <span style="color: #2aa198;">"\\begin{quote}</span>
<span class="linenr">25: </span><span style="color: #2aa198;">                 \\begin{tcolorbox}[colback=white,sharp corners,boxrule=0.4pt]</span>
<span class="linenr">26: </span><span style="color: #2aa198;">                   \\textbf{%s:}</span>
<span class="linenr">27: </span><span style="color: #2aa198;">                   %s</span>
<span class="linenr">28: </span><span style="color: #2aa198;">                 \\end{tcolorbox}</span>
<span class="linenr">29: </span><span style="color: #2aa198;">               \\end{quote}"</span>)))
<span class="linenr">30: </span>    title contents&#8242;)))
</pre>
</div>

<p>
We could use <code>\begin{quote}\fbox{\parbox{\linewidth}{\textbf{Details:}
...}}\end{quote}</code>; however, this does not work well with <a href="https://github.com/alhassy/emacs.d#bibliography--coloured-latex-using-minted">minted</a> for coloured
source blocks. Instead, we use <code>tcolorbox</code>.
</p>
</div>

<div id="outline-container-org68a1df1" class="outline-3">
<h3 id="Example"><span class="section-number-3">6.1</span> Example</h3>
<div class="outline-text-3" id="text-Example">
<p>
Reductions &#x2014;incidentally also called ‘folds’<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>&#x2014; embody primitive
recursion and thus computability. For example, what does the following compute
when given a whole number 𝓃?
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #b58900;">-reduce</span> #'<span style="color: #b58900;">/</span> (<span style="color: #b58900;">number-sequence</span> 1.0 &#120003;))
</pre>
</div>

<details class="code-details"> <summary> <strong> <font face="Courier" size="3" color="green"> Solution </font> </strong> </summary> <p>

Rather than guess-then-check, let's <i>calculate</i>!
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span style="color: #b58900;">-reduce</span> #'<span style="color: #b58900;">/</span> (<span style="color: #b58900;">number-sequence</span> 1.0 &#120003;))
<span style="color: #b58900;">=</span> <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Lisp is strict: Evaluate inner-most expression</span>
  (<span style="color: #b58900;">-reduce</span> #'<span style="color: #b58900;">/</span> '(1.0 2.0 3.0 &#8230; &#120003;))
<span style="color: #b58900;">=</span> <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Evaluate left-associating reduction</span>
  (<span style="color: #b58900;">/</span> (<span style="color: #b58900;">/</span> (<span style="color: #b58900;">/</span> 1.0 2.0) &#8943;) &#120003;)
<span style="color: #b58900;">=</span><span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Arithmetic: (/ (/ a b) c) = (* (/ a b) (/ 1 c)) = (/ a (* b c))</span>
  (<span style="color: #b58900;">/</span> 1.0 (<span style="color: #b58900;">*</span> 2.0 3.0 &#8230; &#120003;))
</pre>
</div>
<p>
We have thus found that Lisp program to compute the inverse factorial of 𝓃,
i.e., \(\frac{1}{𝓃!}\).
</p>
 </details>

<p>
Neato, let's do more super cool stuff ^_^
</p>

<div class="footnotesize">
<p>
( In the Emacs Web Wowser, folded regions are displayed unfolded similar to
LaTeX. )
</p>

</div>
</div>
</div>
</div>
<div id="outline-container-orgcf837e2" class="outline-2">
<h2 id="Link-Here-OctoIcons"><span class="section-number-2">7</span> <i>“Link Here!”</i> OctoIcon</h2>
<div class="outline-text-2" id="text-Link-Here-OctoIcons">
<p>
Use the syntax <code>link-here:name</code> to create an anchor link that alters the URL with
<code>#name</code> as in “<a class="anchor" aria-hidden="true" id="name" href="#name"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>”
&#x2014;it looks and behaves like the Github generated links for a heading.
Use case: Sometimes you want to explicitly point to a particular location in an
article, this is a possible way to do so.
</p>
<ul class="org-ul">
<li>Besides the HTML backend, such links are silently omitted.</li>
<li>SVGs obtained from: <a href="https://primer.style/octicons/">https://primer.style/octicons/</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #b58900;">org-link-set-parameters</span>
  <span style="color: #2aa198;">"link-here"</span>
  <span style="color: #d33682; font-style: italic;">:follow</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (path) (<span style="color: #b58900;">message</span> <span style="color: #2aa198;">"This is a local anchor link named &#8220;%s&#8221;"</span> path))
  <span style="color: #d33682; font-style: italic;">:export</span> #'<span style="color: #b58900;">org-special-block-extras--link-here</span>)

(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">org-special-block-extras--link-here</span> (label description backend)
  <span style="color: #35a69c; font-style: italic;">"Export a link to the current location in an Org file.</span>

<span style="color: #35a69c; font-style: italic;">The LABEL determines the name of the link.</span>

<span style="color: #35a69c; font-style: italic;">+ Only the syntax &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">link-here:label</span><span style="color: #35a69c; font-style: italic;">&#8217; is supported.</span>
<span style="color: #35a69c; font-style: italic;">+ Such links are displayed using an &#8220;octicon-link&#8221;</span>
<span style="color: #35a69c; font-style: italic;">  and so do not support the DESCRIPTION syntax</span>
<span style="color: #35a69c; font-style: italic;">  &#8216;[[link:label][description]]&#8217;.</span>
<span style="color: #35a69c; font-style: italic;">+ Besides the HTML BACKEND, such links are silently omitted."</span>
    (<span style="color: #859900; font-weight: bold;">pcase</span> backend
      (`html  (<span style="color: #b58900;">format</span> (<span style="color: #b58900;">s-collapse-whitespace</span>
          <span style="color: #2aa198;">"&lt;a class=\"anchor\" aria-hidden=\"true\" id=\"%s\"</span>
<span style="color: #2aa198;">          href=\"#%s\"&gt;&lt;svg class=\"octicon octicon-link\" viewBox=\"0 0 16</span>
<span style="color: #2aa198;">          16\" version=\"1.1\" width=\"16\" height=\"16\"</span>
<span style="color: #2aa198;">          aria-hidden=\"true\"&gt;&lt;path fill-rule=\"evenodd\" d=\"M4</span>
<span style="color: #2aa198;">          9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0</span>
<span style="color: #2aa198;">          1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8</span>
<span style="color: #2aa198;">          4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2</span>
<span style="color: #2aa198;">          2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64</span>
<span style="color: #2aa198;">          1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0</span>
<span style="color: #2aa198;">          3-1.69 3-3.5S14.5 6 13 6z\"&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;"</span>) label label))
      (_ <span style="color: #2aa198;">""</span>)))
</pre>
</div>

<p>
E.g., <a class="anchor" aria-hidden="true" id="example-location" href="#example-location"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> Neato ^_^
</p>

<p>
<span style="color:orange;">Going forward,</span> it would be desirable to provide a non-whitespace alternative for
the LaTeX rendition.  More usefully, before the HTML export hook, we could place
such ‘link-here’ links before every org-title produce clickable org-headings,
similar to Github's &#x2014;the necessary ingredients are likely <a href="https://github.com/alhassy/emacs.d#ensuring-useful-html-anchors">here</a>.
</p>
</div>
</div>

<div id="outline-container-org3f0bff9" class="outline-2">
<h2 id="Badge-Links"><span class="section-number-2">8</span> Badge Links</h2>
<div class="outline-text-2" id="text-Badge-Links">
<p>
Badges provide a quick and colourful summary of key features of a project,
such as whether it's maintained, its license, and if it's documented.
</p>


<div class="figure">
<p><img src="images/badges.png" alt="badges.png" />
</p>
<p><span class="figure-number">Figure 18: </span>An Emacs interface to <a href="https://shields.io/">https://shields.io/</a></p>
</div>

<blockquote>
<p>
As people who are passionate about writing great code we display "badges" in our
code repositories to signal to fellow developers that we set ourselves high
standards for the code we write, think of them as the software-equivalent of
the brand on your jeans or other reliable product. &#x2014; <a href="https://github.com/dwyl/repo-badges">repo-badges</a>
</p>
</blockquote>
</div>

<div id="outline-container-org2130c19" class="outline-3">
<h3 id="The-badge-Link"><span class="section-number-3">8.1</span> The <code>badge</code> Link and derived Reddit/Github/Twitter socials</h3>
<div class="outline-text-3" id="text-The-badge-Link">
<p>
The implementation is a bit lengthy since it attempts to capture a useful
portion of the shilelds.io badge interface.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #b58900;">org-link-set-parameters</span> <span style="color: #2aa198;">"badge"</span>
  <span style="color: #d33682; font-style: italic;">:follow</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (path) (<span style="color: #859900; font-weight: bold;">--&gt;</span> (<span style="color: #b58900;">s-split</span> <span style="color: #2aa198;">"|"</span> path)
                         (<span style="color: #859900; font-weight: bold;">or</span> (<span style="color: #b58900;">nth</span> 3 it) path)
                         (<span style="color: #b58900;">browse-url</span> it)))
  <span style="color: #d33682; font-style: italic;">:export</span> #'<span style="color: #b58900;">org-special-block-extras--link--badge</span>)

(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">org-special-block-extras--link--twitter-excitement</span>
  <span style="color: #2aa198;">"This looks super neat ^_^ :"</span>
  <span style="color: #35a69c; font-style: italic;">"The string prefixing the URL being shared."</span>)

(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">org-special-block-extras--link--badge</span>
  (label description backend <span style="color: #b58900; font-style: italic;">&amp;optional</span> social)
  <span style="color: #35a69c; font-style: italic;">"Export a link presented as an SVG badge.</span>

<span style="color: #35a69c; font-style: italic;">The LABEL should be of the shape &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">key|value|color|url|logo</span><span style="color: #35a69c; font-style: italic;">&#8217;</span>
<span style="color: #35a69c; font-style: italic;">resulting in a badge &#8220;|key|value|&#8221; where the &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">key</span><span style="color: #35a69c; font-style: italic;">&#8217;</span>
<span style="color: #35a69c; font-style: italic;">is coloured grey and the &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">value</span><span style="color: #35a69c; font-style: italic;">&#8217; is coloured &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">color</span><span style="color: #35a69c; font-style: italic;">&#8217;.</span>

<span style="color: #35a69c; font-style: italic;">The optional SOCIAL toggle indicates if we want an icon for</span>
<span style="color: #35a69c; font-style: italic;">Twitter, Reddit, Github, etc, instead of a badge.</span>
<span style="color: #35a69c; font-style: italic;">When SOCIAL is provided, we interpret LABEL as an atomic string.</span>

<span style="color: #35a69c; font-style: italic;">+ Only the syntax &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">badge:key|value|color|url</span><span style="color: #35a69c; font-style: italic;">&#8217; is supported.</span>
<span style="color: #35a69c; font-style: italic;">  - &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">key</span><span style="color: #35a69c; font-style: italic;">&#8217; and &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">value</span><span style="color: #35a69c; font-style: italic;">&#8217; have their underscores interpreted as spaces.</span>
<span style="color: #35a69c; font-style: italic;">     &#8658; Underscores are interpreted as spaces;</span>
<span style="color: #35a69c; font-style: italic;">     &#8658; &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">__</span><span style="color: #35a69c; font-style: italic;">&#8217; is interpreted as an underscore;</span>
<span style="color: #35a69c; font-style: italic;">     &#8658; &#8216;|&#8217; is not a valid substring, but &#8216;-, %, ?&#8217; are okay.</span>
<span style="color: #35a69c; font-style: italic;">  - &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">|color|url|logo</span><span style="color: #35a69c; font-style: italic;">&#8217; are optional;</span>
<span style="color: #35a69c; font-style: italic;">     if &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">url</span><span style="color: #35a69c; font-style: italic;">&#8217; is &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">|here</span><span style="color: #35a69c; font-style: italic;">&#8217; then the resulting badge behaves</span>
<span style="color: #35a69c; font-style: italic;">     like &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">link-here:key</span><span style="color: #35a69c; font-style: italic;">&#8217;.</span>
<span style="color: #35a69c; font-style: italic;">  - &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">color</span><span style="color: #35a69c; font-style: italic;">&#8217; may be: &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">brightgreen</span><span style="color: #35a69c; font-style: italic;">&#8217; or &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">success</span><span style="color: #35a69c; font-style: italic;">&#8217;,</span>
<span style="color: #35a69c; font-style: italic;">                    &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">red</span><span style="color: #35a69c; font-style: italic;">&#8217;         or &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">important</span><span style="color: #35a69c; font-style: italic;">&#8217;,</span>
<span style="color: #35a69c; font-style: italic;">                    &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">orange</span><span style="color: #35a69c; font-style: italic;">&#8217;      or &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">critical</span><span style="color: #35a69c; font-style: italic;">&#8217;,</span>
<span style="color: #35a69c; font-style: italic;">                    &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">lightgrey</span><span style="color: #35a69c; font-style: italic;">&#8217;   or &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">inactive</span><span style="color: #35a69c; font-style: italic;">&#8217;,</span>
<span style="color: #35a69c; font-style: italic;">                    &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">blue</span><span style="color: #35a69c; font-style: italic;">&#8217;        or &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">informational</span><span style="color: #35a69c; font-style: italic;">&#8217;,</span>
<span style="color: #35a69c; font-style: italic;">            or &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">green</span><span style="color: #35a69c; font-style: italic;">&#8217;, &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">yellowgreen</span><span style="color: #35a69c; font-style: italic;">&#8217;, &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">yellow</span><span style="color: #35a69c; font-style: italic;">&#8217;, &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">blueviolet</span><span style="color: #35a69c; font-style: italic;">&#8217;, &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">ff69b4</span><span style="color: #35a69c; font-style: italic;">&#8217;, etc.</span>
<span style="color: #35a69c; font-style: italic;">+ Such links are displayed using a SVG badges</span>
<span style="color: #35a69c; font-style: italic;">  and so do not support the DESCRIPTION syntax</span>
<span style="color: #35a69c; font-style: italic;">  &#8216;[[link:label][description]]&#8217;.</span>
<span style="color: #35a69c; font-style: italic;">+ Besides the HTML BACKEND, such links are silently omitted."</span>
  (<span style="color: #859900; font-weight: bold;">-let*</span> (((lbl msg clr url logo) (<span style="color: #b58900;">s-split</span> <span style="color: #2aa198;">"|"</span> label))
          (_ (<span style="color: #859900; font-weight: bold;">unless</span> (<span style="color: #859900; font-weight: bold;">or</span> (<span style="color: #859900; font-weight: bold;">and</span> lbl msg) social)
               (<span style="color: #b58900;">error</span> <span style="color: #2aa198;">"%s\t&#8658;\tBadges are at least &#8220;badge:key|value&#8221;!"</span> label)))
          <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Support dashes and other symbols</span>
          (_ (<span style="color: #859900; font-weight: bold;">unless</span> social
               (<span style="color: #859900; font-weight: bold;">setq</span> lbl (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"-"</span> <span style="color: #2aa198;">"--"</span> lbl)
                     msg (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"-"</span> <span style="color: #2aa198;">"--"</span> msg))
               (<span style="color: #859900; font-weight: bold;">setq</span> lbl (<span style="color: #b58900;">url-hexify-string</span> lbl)
                     msg (<span style="color: #b58900;">url-hexify-string</span> msg))))
          (img (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/badge/%s-%s-%s%s\"&gt;"</span>
                        lbl msg clr
                        (<span style="color: #859900; font-weight: bold;">if</span> logo (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"?logo="</span> logo) <span style="color: #2aa198;">""</span>))))
    (<span style="color: #859900; font-weight: bold;">when</span> social
      (<span style="color: #859900; font-weight: bold;">--&gt;</span>
          `((<span style="color: #2aa198;">"reddit"</span>            <span style="color: #2aa198;">"https://www.reddit.com/r/%s"</span>)
            (<span style="color: #2aa198;">"github/followers"</span>  <span style="color: #2aa198;">"https://www.github.com/%s?tab=followers"</span>)
            (<span style="color: #2aa198;">"github/forks"</span>      <span style="color: #2aa198;">"https://www.github.com/%s/fork"</span>)
            (<span style="color: #2aa198;">"github"</span>            <span style="color: #2aa198;">"https://www.github.com/%s"</span>)
            (<span style="color: #2aa198;">"twitter/follow"</span>    <span style="color: #2aa198;">"https://twitter.com/intent/follow?screen_name=%s"</span>)
            (<span style="color: #2aa198;">"twitter/url"</span>
             ,(<span style="color: #b58900;">format</span>
               <span style="color: #2aa198;">"https://twitter.com/intent/tweet?text=%s:&amp;url=%%s"</span>
               <span style="color: #268bd2;">org-special-block-extras--link--twitter-excitement</span>)
             ,(<span style="color: #b58900;">format</span>
               <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/twitter/url?url=%s\"&gt;"</span>
               label)))
        (<span style="color: #859900; font-weight: bold;">--filter</span> (<span style="color: #b58900;">s-starts-with?</span> (<span style="color: #b58900;">first</span> it) social) it)
        (<span style="color: #b58900;">car</span> it)
        (<span style="color: #859900; font-weight: bold;">or</span> it (<span style="color: #b58900;">error</span> <span style="color: #2aa198;">"Badge: Unsupported social type &#8220;%s&#8221;"</span> social))
        (<span style="color: #859900; font-weight: bold;">setq</span> url (<span style="color: #b58900;">format</span> (<span style="color: #b58900;">second</span> it) label)
              img (<span style="color: #859900; font-weight: bold;">or</span> (<span style="color: #b58900;">third</span> it)
                      (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;img src=\"https://img.shields.io/%s/%s?style=social\"&gt;"</span>
                      social label)))))
    (<span style="color: #859900; font-weight: bold;">pcase</span> backend
        (`html (<span style="color: #859900; font-weight: bold;">if</span> url
                 (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">equal</span> url <span style="color: #2aa198;">"here"</span>)
                     (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;a id=\"%s\" href=\"#%s\"&gt;%s&lt;/a&gt;"</span> lbl lbl img)
                   (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;a href=\"%s\"&gt;%s&lt;/a&gt;"</span> url img))
               img))
        (_ <span style="color: #2aa198;">""</span>))))
</pre>
</div>

<p>
We now form the specialised link types for social media.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">loop</span> for (social <span style="color: #556b72; background-color: #FDF6E3;">link</span>) in '((<span style="color: #2aa198;">"reddit/subreddit-subscribers"</span> <span style="color: #2aa198;">"reddit-subscribe-to"</span>)
                             (<span style="color: #2aa198;">"github/stars"</span>)
                             (<span style="color: #2aa198;">"github/watchers"</span>)
                             (<span style="color: #2aa198;">"github/followers"</span>)
                             (<span style="color: #2aa198;">"github/forks"</span>)
                             (<span style="color: #2aa198;">"twitter/follow"</span>)
                             (<span style="color: #2aa198;">"twitter/url?=url="</span> <span style="color: #2aa198;">"tweet"</span>))
      for <span style="color: #556b72; background-color: #FDF6E3;">link</span>&#8242; <span style="color: #b58900;">=</span> (<span style="color: #859900; font-weight: bold;">or</span> <span style="color: #556b72; background-color: #FDF6E3;">link</span> (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"/"</span> <span style="color: #2aa198;">"-"</span> social))
      <span style="color: #b58900;">do</span> (<span style="color: #b58900;">org-link-set-parameters</span> <span style="color: #556b72; background-color: #FDF6E3;">link</span>&#8242;
           <span style="color: #d33682; font-style: italic;">:export</span> (<span style="color: #b58900;">eval</span> `(<span style="color: #859900; font-weight: bold;">-cut</span> <span style="color: #b58900;">org-special-block-extras--link--badge</span>
                         &lt;&gt; &lt;&gt; &lt;&gt; ,social))))
</pre>
</div>
</div>
</div>


<div class="outline-text-2" id="text-Badge-Links">
</div>
<div id="outline-container-orge2f7756" class="outline-3">
<h3 id="Example-Social-Icons"><span class="section-number-3">8.2</span> Example Social Icons</h3>
<div class="outline-text-3" id="text-Example-Social-Icons">
<p>
Syntax:
</p>
<pre class="example">
reddit-subscribe-to:exact-name-of-a-subreddit

github-stars:user-name/repository-name

github-watchers:user-name/repository-name

github-forks:user-name/repository-name

github-followers:user-name

twitter-follow:user-name

tweet:url
</pre>

<p>
Here are some examples.
</p>

<ul class="org-ul">
<li>Things I like:
<a href="https://www.reddit.com/r/emacs"><img src="https://img.shields.io/reddit/subreddit-subscribers/emacs?style=social"></a>
<a href="https://www.reddit.com/r/common_lisp"><img src="https://img.shields.io/reddit/subreddit-subscribers/common_lisp?style=social"></a>
<a href="https://www.reddit.com/r/coolguides"><img src="https://img.shields.io/reddit/subreddit-subscribers/coolguides?style=social"></a>
<a href="https://www.reddit.com/r/shia"><img src="https://img.shields.io/reddit/subreddit-subscribers/shia?style=social"></a></li>

<li>Info about my cheatsheets:
<a href="https://www.github.com/alhassy/CheatSheet"><img src="https://img.shields.io/github/stars/alhassy/CheatSheet?style=social"></a>
<a href="https://www.github.com/alhassy/CheatSheet"><img src="https://img.shields.io/github/watchers/alhassy/CheatSheet?style=social"></a>
<a href="https://www.github.com/alhassy/CheatSheet/fork"><img src="https://img.shields.io/github/forks/alhassy/CheatSheet?style=social"></a>
<a href="https://twitter.com/intent/tweet?text=This looks super neat ^_^ ::&url=https://github.com/alhassy/org-special-block-extras"><img src="https://img.shields.io/twitter/url?url=https://github.com/alhassy/org-special-block-extras"></a></li>

<li>My profile:
<a href="https://www.github.com/alhassy?tab=followers"><img src="https://img.shields.io/github/followers/alhassy?style=social"></a>
<a href="https://twitter.com/intent/follow?screen_name=musa314"><img src="https://img.shields.io/twitter/follow/musa314?style=social"></a></li>
</ul>
</div>
</div>

<div id="outline-container-org535606a" class="outline-3">
<h3 id="Example-Badges"><span class="section-number-3">8.3</span> Example Badges</h3>
<div class="outline-text-3" id="text-Example-Badges">
<p>
The general syntax is as follows, with <b>only the first 2</b> are mandatory,
with the colour defaulting to green, and the url and logo both to nil.
We can thus have <code>badge:label|message</code>
</p>
<pre class="example">
# Standard template
badge:key|value|colour|url|logo

# Minimal template
badge:key|value

# Only show a coloured logo pointed to its location
badge:||colour|here|logo
</pre>

<ul class="org-ul">
<li><a href="Here"><img src="https://img.shields.io/badge/key-value-informational?logo=Elixir"></a>
<ul class="org-ul">
<li>Standard template; with URL pointing to current location which is named
<code>#key</code></li>
</ul></li>

<li><a id="example_with_spaces%2C_--%2C_and_%25" href="#example_with_spaces%2C_--%2C_and_%25"><img src="https://img.shields.io/badge/example_with_spaces%2C_--%2C_and_%25-points_right_here-orange"></a>
<ul class="org-ul">
<li>Use ‘_’ to denote spaces</li>
</ul></li>

<li><img src="https://img.shields.io/badge/no_colour-given-nil">
<ul class="org-ul">
<li>Only two items given: <code>badge:key|value</code>.</li>
</ul></li>

<li><img src="https://img.shields.io/badge/empty_value--informational">
<ul class="org-ul">
<li><code>badge:key||colour</code></li>
</ul></li>

<li><img src="https://img.shields.io/badge/-value-nil">
<ul class="org-ul">
<li>No key; <code>badge:|value</code></li>
</ul></li>

<li><img src="https://img.shields.io/badge/--green">
<ul class="org-ul">
<li>No key; nor value: <code>badge:||green</code></li>
</ul></li>
</ul>
</div>
</div>

<div id="outline-container-orgd77efb8" class="outline-3">
<h3 id="Example-Colours"><span class="section-number-3">8.4</span> Example Colours</h3>
<div class="outline-text-3" id="text-Example-Colours">
<ul class="org-ul">
<li><img src="https://img.shields.io/badge/-red-red"> <img src="https://img.shields.io/badge/-critical-critical"></li>
<li><img src="https://img.shields.io/badge/-blue-blue"> <img src="https://img.shields.io/badge/-informational-informational"></li>
<li><img src="https://img.shields.io/badge/-brightgreen-brightgreen"> <img src="https://img.shields.io/badge/-success-success"></li>
<li><img src="https://img.shields.io/badge/-orange-orange"> <img src="https://img.shields.io/badge/-important-important"></li>
<li><img src="https://img.shields.io/badge/-lightgrey-lightgrey"> <img src="https://img.shields.io/badge/-inactive-inactive"></li>
<li><img src="https://img.shields.io/badge/-green-green"></li>
<li><img src="https://img.shields.io/badge/-yellowgreen-yellowgreen"></li>
<li><img src="https://img.shields.io/badge/-yellow-yellow"></li>
<li><img src="https://img.shields.io/badge/-blueviolet-blueviolet"></li>
<li><img src="https://img.shields.io/badge/-ff69b4-ff69b4"></li>
<li><img src="https://img.shields.io/badge/-9cf-9cf"></li>
<li>&#x2026;</li>
</ul>

<p>
Consult <a href="https://htmlcolorcodes.com/">https://htmlcolorcodes.com/</a> to see the HEX code of any other colour you
wish to use; e.g., <img src="https://img.shields.io/badge/-1d8348-1d8348">
</p>
</div>
</div>

<div id="outline-container-org35ca241" class="outline-3">
<h3 id="Example-Badge-Icons"><span class="section-number-3">8.5</span> Example Badge Icons</h3>
<div class="outline-text-3" id="text-Example-Badge-Icons">
<p>
Here are a few free SVG icons for popular brands from <a href="https://simpleicons.org/">https://simpleicons.org/</a>.
</p>

<dl class="org-dl">
<dt>“Fire”</dt><dd><a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=Elixir"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=tinder"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=codeigniter"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=prometheus"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=sparkpost"></a></dd>
<dt>“Messaging”</dt><dd><a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=quip"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=WeChat"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=google-hangouts"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=hackhands"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=google-messages"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=Tor"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=Slack"></a></dd>
<dt>“Emacs”</dt><dd><a id="" href="#"><img src="https://img.shields.io/badge/--white?logo=gnu-emacs"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--white?logo=spacemacs"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=vim"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=neovim"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=gnu"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=github"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=acm"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=wikipedia"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=microsoft-excel"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=microsoft-word"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=dropbox"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=google-scholar"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=google"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=google-translate"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=ghost"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=helm"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=apache-openoffice"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=buffer"></a></dd>
<dt>“Social”</dt><dd><a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=google-cast"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=youtube"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=discord"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=facebook"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=google-hangouts"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=whatsapp"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=skype"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=arXiv"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=reddit"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=stack-overflow"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=stack-exchange"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=linkedin"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=twitter"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=jabber"></a></dd>
<dt>“Lightbulb”</dt><dd><a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=lighthouse"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=google-keep"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=minds"></a></dd>
<dt>“Programming”</dt><dd><a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=git"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=ruby"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=scala"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=OCaml"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=javascript"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=gnu-bash"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=powershell"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=LaTeX"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=java"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=kotlin"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=haskell"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=coffeescript"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=purescript"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=rust"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=typescript"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=css3"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=python"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=c"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=clojure"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=lua"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=adobe-acrobat-reader"></a></dd>
<dt>“Miscellaneous”</dt><dd><p>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=read-the-docs"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=buy-me-a-coffee"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=gimp"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=mega"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=nintendo-3ds"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=paypal"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=pinboard"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=mocha"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=Gitea"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=instacart"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=openStreetMap"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=amazon"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=svg"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=rss"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=swagger"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=pastebin"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=skyliner"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=iTunes"></a>   <a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=gulp"></a>
</p>

<p>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=GIMP"></a>
<a id="" href="#"><img src="https://img.shields.io/badge/--grey?logo=atom"></a>
</p></dd>
</dl>
</div>
</div>

<div id="outline-container-orgb9dd30d" class="outline-3">
<h3 id="Common-Project-Badges"><span class="section-number-3">8.6</span> Common Project Badges</h3>
<div class="outline-text-3" id="text-Common-Project-Badges">
<ul class="org-ul">
<li><a href="https://www.gnu.org/software/emacs"><img src="https://img.shields.io/badge/Emacs-23%2F26%2F28-green?logo=gnu-emacs"></a></li>

<li><a href="https://orgmode.org"><img src="https://img.shields.io/badge/Org-9.3.6-blue?logo=gnu"></a></li>

<li><a href="https://alhassy.github.io/org-special-block-extras/README.html"><img src="https://img.shields.io/badge/org--special--block--extras-1.0-informational?logo=Gnu-Emacs"></a></li>
<li><a href="https://github.com/alhassy/emacs.d#use-package-the-start-of-initel"><img src="https://img.shields.io/badge/melpa-pending-critical?logo=github"></a></li>

<li><a href="https://github.com/alhassy/emacs.d#what-does-literate-programming-look-like"><img src="https://img.shields.io/badge/docs-literate-success?logo=read-the-docs"></a>
<a id="wiki" href="#wiki"><img src="https://img.shields.io/badge/wiki-github-informational?logo=wikipedia"></a></li>

<li><a id="code_coverage" href="#code_coverage"><img src="https://img.shields.io/badge/code_coverage-88%25-green?logo=codecov"></a>
<a id="build" href="#build"><img src="https://img.shields.io/badge/build-passing-success?logo=azure-pipelines"></a></li>

<li><a href="https://alhassy.github.io/"><img src="https://img.shields.io/badge/author-musa_al--hassy-purple?logo=nintendo-3ds"></a></li>

<li><a href="https://alhassy.github.io/"><img src="https://img.shields.io/badge/author-musa_al--hassy-purple?logo=gimp"></a></li>

<li><a href="https://www.gnu.org/licenses/gpl-3.0.en.html"><img src="https://img.shields.io/badge/license-GNU_3-informational?logo=read-the-docs"></a></li>

<li><a id="issue_tracking" href="#issue_tracking"><img src="https://img.shields.io/badge/issue_tracking-github-informational?logo=github"></a></li>

<li><a id="help_forum" href="#help_forum"><img src="https://img.shields.io/badge/help_forum-discourse-informational?logo=discourse"></a></li>

<li><a href="https://gitter.im/explore"><img src="https://img.shields.io/badge/social_chat-gitter-informational?logo=gitter"></a></li>

<li><img src="https://img.shields.io/badge/Maintained%3F-yes-success">
<img src="https://img.shields.io/badge/Maintained%3F-no-critical">
<a href="http://unmaintained.tech/"><img src="https://img.shields.io/badge/No_Maintenance_Intended-%C3%97-critical"></a>
&#x2014;Interesting!</li>

<li><img src="https://img.shields.io/badge/website-up-success">
<img src="https://img.shields.io/badge/website-down-critical"></li>

<li><img src="https://img.shields.io/badge/Ask_me-anything-1abc9c">
<a href="https://github.com/alhassy/org-special-block-extras/issues"><img src="https://img.shields.io/badge/contributions-welcome-green"></a></li>
<li><img src="https://img.shields.io/badge/Made_with-Python%2C_LaTeX%2C_MathJax%2C_and_Emacs_Org--mode-1f425"></li>
</ul>
</div>
</div>
<div class="outline-text-2" id="text-Badge-Links">
</div>
<div id="outline-container-org129dea2" class="outline-3">
<h3 id="Next-Steps-badges"><span class="section-number-3">8.7</span> Next Steps</h3>
<div class="outline-text-3" id="text-Next-Steps-badges">
<p>
<span style="color:orange;">Going forward,</span> it would be desirable to provide non-whitespace alternatives
for the LaTeX backend.
<p> <span style="border-width:1px;border-style:solid;padding:5px"><strong>[Author:</strong></span>
That is why no examples are shown in the PDF <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p> It would
also be useful to have badges redirect to their URL, if any, upon a user's
click. Finally, it may be useful to colour the <code>|</code>-separated fields of a badge
link and provide a tooltip indicating which value corresponds to which
field. This would make the interface more welcoming to new users.
</p>
</div>
</div>
</div>

<div id="outline-container-org47f6867" class="outline-2">
<h2 id="Tooltips-for-Glossaries-Dictionaries-and-Documentation"><span class="section-number-2">9</span> Tooltips for Glossaries, Dictionaries, and Documentation</h2>
<div class="outline-text-2" id="text-Tooltips-for-Glossaries-Dictionaries-and-Documentation">
<p>
Let's make a link type <code>doc</code> that shows a tooltip documentation &#x2014;e.g., glossary
or abbreviation&#x2014; for a given label.
</p>

<p>
E.g., user-declared <abbr class="tooltip" title="A theory of typed&emsp;composition; e.g., typed monoids."> Category Theory</abbr> and Emacs-retrieved <abbr class="tooltip" title="The Common Lisp ‘loop’ macro.<br>Valid clauses include:<br>&emsp;For clauses:<br>&emsp;&emsp;for VAR from/upfrom/downfrom EXPR1 to/upto/downto/above/below EXPR2 [by EXPR3]<br>&emsp;&emsp;for VAR = EXPR1 then EXPR2<br>&emsp;&emsp;for VAR in/on/in-ref LIST [by FUNC]<br>&emsp;&emsp;for VAR across/across-ref ARRAY<br>&emsp;&emsp;for VAR being:<br>&emsp;&emsp;&emsp;the elements of/of-ref SEQUENCE [using (index VAR2)]<br>&emsp;&emsp;&emsp;the symbols [of OBARRAY]<br>&emsp;&emsp;&emsp;the hash-keys/hash-values of HASH-TABLE [using (hash-values/hash-keys V2)]<br>&emsp;&emsp;&emsp;the key-codes/key-bindings/key-seqs of KEYMAP [using (key-bindings VAR2)]<br>&emsp;&emsp;&emsp;the overlays/intervals [of BUFFER] [from POS1] [to POS2]<br>&emsp;&emsp;&emsp;the frames/buffers<br>&emsp;&emsp;&emsp;the windows [of FRAME]<br>&emsp;Iteration clauses:<br>&emsp;&emsp;repeat INTEGER<br>&emsp;&emsp;while/until/always/never/thereis CONDITION<br>&emsp;Accumulation clauses:<br>&emsp;&emsp;collect/append/nconc/concat/vconcat/count/sum/maximize/minimize FORM<br>&emsp;&emsp;&emsp;[into VAR]<br>&emsp;Miscellaneous clauses:<br>&emsp;&emsp;with VAR = INIT<br>&emsp;&emsp;if/when/unless COND CLAUSE [and CLAUSE]... else CLAUSE [and CLAUSE...]<br>&emsp;&emsp;named NAME<br>&emsp;&emsp;initially/finally [do] EXPRS...<br>&emsp;&emsp;do EXPRS...<br>&emsp;&emsp;[finally] return EXPR<br><br>For more details, see Info node ‘(cl)Loop Facility’.<br><br>(fn CLAUSE...)">loop</abbr> and <abbr class="tooltip" title="Thread FORMS elements as the last argument of their successor.<br>Example:<br>&emsp;&emsp;(thread-last<br>&emsp;&emsp;&emsp;5<br>&emsp;&emsp;&emsp;(+ 20)<br>&emsp;&emsp;&emsp;(/ 25)<br>&emsp;&emsp;&emsp;-<br>&emsp;&emsp;&emsp;(+ 40))<br>Is equivalent to:<br>&emsp;&emsp;(+ 40 (- (/ 25 (+ 20 5))))<br>Note how the single ‘-’ got converted into a list before<br>threading.<br><br>(fn &rest FORMS)">thread-last</abbr> ^_^
</p>


<div class="figure">
<p><img src="images/tooltips_browser.png" alt="tooltips_browser.png" />
</p>
<p><span class="figure-number">Figure 19: </span>Tooltips for documentation and glossary items &#x2013;in the browser!</p>
</div>


<div class="figure">
<p><img src="images/tooltips_emacs.png" alt="tooltips_emacs.png" />
</p>
<p><span class="figure-number">Figure 20: </span>Tooltips for documentation and glossary items &#x2013;in Emacs!</p>
</div>


<div class="figure">
<p><img src="images/tooltips_pdf.png" alt="tooltips_pdf.png" />
</p>
<p><span class="figure-number">Figure 21: </span>Tooltips for documentation and glossary items &#x2013;in the PDF!</p>
</div>


<div class="figure">
<p><img src="images/tooltips_declaration.png" alt="tooltips_declaration.png" />
</p>
<p><span class="figure-number">Figure 22: </span>Declaring documentation-glossary items</p>
</div>
</div>

<div id="outline-container-org8c4c963" class="outline-3">
<h3 id="The-doc-link-type"><span class="section-number-3">9.1</span> The <code>doc</code> link type</h3>
<div class="outline-text-3" id="text-The-doc-link-type">
<p>
We begin by making use of a list of documentation-glossary entries
&#x2014;a lightweight database of information, if you will.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">org-specical-blocks-extras--docs</span> nil
  <span style="color: #35a69c; font-style: italic;">"An alist of (label name description) entries; our glossary.</span>

<span style="color: #35a69c; font-style: italic;">Example use: (-let [(name description) (cdr (assoc 'label docs))] &#8943;)"</span>)
</pre>
</div>

<p>
For example, we may use <code>add-to-list</code> to add an entry only if it is not already in
the list.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #b58900;">add-to-list</span> '<span style="color: #268bd2;">org-specical-blocks-extras--docs</span>
  '(<span style="color: #2aa198;">"cat"</span> <span style="color: #2aa198;">"Category Theory"</span> <span style="color: #2aa198;">"A theory of typed  composition; e.g., typed monoids."</span>))
</pre>
</div>

<p>
We may wish to use Emacs' <code>documentation</code> command to retrieve entries &#x2014;this is
useful for an online article that refers to unfamiliar Emacs terms ;-) To avoid
copy-pasting documentation entries from one location to another, users may
declare a fallback method. Besides Emacs' <code>documentation</code>, the fallback can be
refer to a user's personal ‘global glossary’ variable &#x2014;which may live in their
Emacs' init file.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">org-specical-blocks-extras--docs-fallback</span>
  (<span style="color: #859900; font-weight: bold;">lambda</span> (label) (<span style="color: #b58900;">list</span> label label (<span style="color: #b58900;">documentation</span> (<span style="color: #b58900;">intern</span> label))))
  <span style="color: #35a69c; font-style: italic;">"The fallback method to retriving documentation or glossary entries."</span>)
</pre>
</div>

<p>
Let's keep track of where documentation comes from &#x2014;either the current
article or from the fallback&#x2014; so that we may process it later on.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">org-specical-blocks-extras--docs-GLOSSARY</span> nil
  <span style="color: #35a69c; font-style: italic;">"Which words are actually cited in the current article.</span>

<span style="color: #35a69c; font-style: italic;">We use this listing to actually print a glossary using</span>
<span style="color: #35a69c; font-style: italic;">&#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">show:GLOSSARY</span><span style="color: #35a69c; font-style: italic;">&#8217;."</span>)
</pre>
</div>

<p>
Now HTML exporting such links as tooltips and displaying them in Emacs as
tooltips happens in two stages: First we check the documentation, if there is no
entry, we try the fallback &#x2014;if that falls, an error is reported at export
time. E.g., upon export <code>doc:wombo</code> will produce a no-entry error.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">-let</span> [name&amp;doc
       (<span style="color: #859900; font-weight: bold;">lambda</span> (lbl)
         (<span style="color: #859900; font-weight: bold;">-let</span> [(_ name doc) (<span style="color: #b58900;">assoc</span> lbl <span style="color: #268bd2;">org-specical-blocks-extras--docs</span>)]
           <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">If there is no documentation, try the fallback.</span>
           (<span style="color: #859900; font-weight: bold;">unless</span> doc
             (<span style="color: #859900; font-weight: bold;">setq</span> doc
                   (<span style="color: #859900; font-weight: bold;">condition-case</span> nil
                       (<span style="color: #b58900;">funcall</span> <span style="color: #268bd2;">org-specical-blocks-extras--docs-fallback</span> lbl)
                     (<span style="color: #b58900;">error</span> (<span style="color: #b58900;">error</span>
                             <span style="color: #2aa198;">"Error: No documentation-glossary entry for &#8220;%s&#8221;!"</span>
                             lbl))))
             (<span style="color: #859900; font-weight: bold;">setq</span> name (<span style="color: #b58900;">nth</span> 1 doc))
             (<span style="color: #859900; font-weight: bold;">setq</span> doc (<span style="color: #b58900;">nth</span> 2 doc)))
           (<span style="color: #b58900;">list</span> name doc)))]

(<span style="color: #b58900;">org-link-set-parameters</span>
 <span style="color: #2aa198;">"doc"</span>
 <span style="color: #d33682; font-style: italic;">:follow</span> (<span style="color: #859900; font-weight: bold;">lambda</span> (_) ())
 <span style="color: #d33682; font-style: italic;">:export</span>
   `(<span style="color: #859900; font-weight: bold;">lambda</span> (label description backend)
     (<span style="color: #859900; font-weight: bold;">-let</span> [(name <span style="color: #268bd2;">docs</span>) (<span style="color: #b58900;">funcall</span> ,name&amp;doc label)]
       (<span style="color: #b58900;">add-to-list</span> '<span style="color: #268bd2;">org-specical-blocks-extras--docs-GLOSSARY</span>
                    (<span style="color: #b58900;">list</span> label name <span style="color: #268bd2;">docs</span>))
       (<span style="color: #859900; font-weight: bold;">setq</span> name (<span style="color: #859900; font-weight: bold;">or</span> description name))
       (<span style="color: #859900; font-weight: bold;">pcase</span> backend
         (`html  (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"&lt;abbr class=\"tooltip\" title=\"%s\"&gt;%s&lt;/abbr&gt;"</span>
                         <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Preserve newlines and preserve whitespace</span>
                         (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"  "</span> <span style="color: #2aa198;">"&amp;emsp;"</span> (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"\n"</span> <span style="color: #2aa198;">"&lt;br&gt;"</span> <span style="color: #268bd2;">docs</span>))
                         name))
         <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Make the current word refer to its glosary entry;</span>
         <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">also declare the location that the glossary should refer back to.</span>
         (`latex (<span style="color: #b58900;">format</span> (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"\\hyperref"</span>
                                 <span style="color: #2aa198;">"[org-special-block-extras-glossary-%s]{%s}"</span>
                                <span style="color: #2aa198;">"\\label{org-special-block-extras-glossary"</span>
                                <span style="color: #2aa198;">"-declaration-site-%s}"</span>)
                         label name label)))))
  <span style="color: #d33682; font-style: italic;">:help-echo</span>
  `(<span style="color: #859900; font-weight: bold;">lambda</span> (window object <span style="color: #b58900;">position</span>)
    (<span style="color: #859900; font-weight: bold;">save-excursion</span>
      (<span style="color: #b58900;">goto-char</span> <span style="color: #b58900;">position</span>)
      (<span style="color: #859900; font-weight: bold;">-let*</span> (((<span style="color: #b58900; font-style: italic;">&amp;plist</span> <span style="color: #d33682; font-style: italic;">:path</span>) (<span style="color: #b58900;">cadr</span> (<span style="color: #b58900;">org-element-context</span>)))
              ((name doc) (<span style="color: #b58900;">funcall</span> ,name&amp;doc path)))
        (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"[%s] %s :: %s"</span> path name doc))))))
</pre>
</div>

<p> <span style="border-width:1px;border-style:solid;padding:5px"><strong>[ Warning:</strong></span>

<code>-let*</code> may crash when there are macro calls involved;
 e.g., <code>(-let* [x (or 1 2)] x) ⇒ nil</code>! Woah! Not cool.

 <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
</div>
</div>

<div id="outline-container-org7ab6ba7" class="outline-3">
<h3 id="Documentation-Blocks"><span class="section-number-3">9.2</span> Documentation Blocks</h3>
<div class="outline-text-3" id="text-Documentation-Blocks">
<p>
Things look great at the HTML side and on the Emacs side for <b>consuming</b>
documented text.  Besides being inconvenient, we cannot with good conscious
force the average user to write Lisp as we did for the <abbr class="tooltip" title="A theory of typed&emsp;composition; e.g., typed monoids."> Category Theory</abbr> entry. We turn to
the problem of <b>producing</b> documentation entries with a block type interface:
</p>
<pre class="example">
#+begin_documentation
:name: Existential Angst
:label: ex-angst
A negative feeling arising from freedom and responsibility.

Also known as /Existential Dread/ and /Existential Anxiety/.
#+end_documentation
</pre>
<p>
Now <code>doc:ex-angst</code> gives us <abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>Also known as *Existential Dread* and *Existential Anxiety*."> Existential Angst</abbr>,
or using a description: <abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>Also known as *Existential Dread* and *Existential Anxiety*.">“existence is pain”?</abbr>
</p>

<blockquote>
<p>
As it stands, Emacs tooltips <b>only</b> appear after an export has happened:
The export updates the dictionary variable which is used for the tooltips
utility.
</p>

<p>
Moreover, a documentation block may have multiple entries &#x2014;the <code>:name:</code> argument
must appear first, then the <code>:label:</code>, and the remaining text is the
description-documentation of the given name.
</p>
</blockquote>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defun</span> <span style="color: #b58900;">org-special-block-extras--documentation</span> (_ contents)
  <span style="color: #35a69c; font-style: italic;">"Register the dictionary entries in CONTENTS to the dictionary variable.</span>

<span style="color: #35a69c; font-style: italic;">The dictionary variable is &#8216;</span><span style="color: #6c71c4; font-weight: bold; font-style: italic;">org-specical-blocks-extras--docs</span><span style="color: #35a69c; font-style: italic;">&#8217;.</span>

<span style="color: #35a69c; font-style: italic;">Documentation blocks are not shown upon export."</span>
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Strip out any &lt;p&gt; tags</span>
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Musa: Make these three lines part of the core utility?</span>
  (<span style="color: #859900; font-weight: bold;">setq</span> contents (<span style="color: #b58900;">substring-no-properties</span> contents))
  (<span style="color: #859900; font-weight: bold;">setq</span> contents (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"&lt;p&gt;"</span> <span style="color: #2aa198;">""</span> contents))
  (<span style="color: #859900; font-weight: bold;">setq</span> contents (<span style="color: #b58900;">s-replace-regexp</span> <span style="color: #2aa198;">"&lt;/p&gt;"</span> <span style="color: #2aa198;">""</span> contents))
  (<span style="color: #859900; font-weight: bold;">setq</span> contents (<span style="color: #b58900;">s-trim</span> contents))
  (<span style="color: #859900; font-weight: bold;">loop</span> for entry in (<span style="color: #b58900;">cdr</span> (<span style="color: #b58900;">s-split</span> <span style="color: #2aa198;">":name:"</span> contents))
        <span style="color: #b58900;">do</span>   (<span style="color: #859900; font-weight: bold;">-let</span> [(contents&#8242; . (<span style="color: #b58900; font-style: italic;">&amp;alist</span> 'label 'name))
                    (<span style="color: #b58900;">org-special-block-extras--extract-arguments</span>
                     (<span style="color: #b58900;">s-concat</span> <span style="color: #2aa198;">":name:"</span> entry) 'label 'name)]
               (<span style="color: #859900; font-weight: bold;">unless</span> (<span style="color: #859900; font-weight: bold;">and</span> label name)
                 (<span style="color: #b58900;">error</span> (<span style="color: #b58900;">message-box</span> (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"#+begin_documentation: "</span>
                           <span style="color: #2aa198;">"Ensure both :label: and :name: are in the entry. "</span>
                            <span style="color: #2aa198;">"\n\n "</span> contents))))
    (<span style="color: #b58900;">add-to-list</span> '<span style="color: #268bd2;">org-specical-blocks-extras--docs</span> (<span style="color: #b58900;">list</span> (<span style="color: #b58900;">s-trim</span> label) name
                                                         (<span style="color: #b58900;">s-trim</span> contents&#8242;)))))
  <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">The special block is not shown upon export.</span>
  <span style="color: #2aa198;">""</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb5ef480" class="outline-3">
<h3 id="Examples"><span class="section-number-3">9.3</span> Examples</h3>
<div class="outline-text-3" id="text-Examples">

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Supported</th>
<th scope="col" class="org-left">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">No description</td>
<td class="org-left"><abbr class="tooltip" title="A theory of typed&emsp;composition; e.g., typed monoids."> Category Theory</abbr></td>
</tr>

<tr>
<td class="org-left">With description and code font</td>
<td class="org-left"><abbr class="tooltip" title="Natural transformations are essentially polymorphic functions that make *no*<br>choices according to the input type; e.g., `reverse : List τ → List τ` makes no<br>choices depending on the type `τ`."><code>polymorphism</code></abbr></td>
</tr>

<tr>
<td class="org-left">Fallback; e.g., arbitrary ELisp Docs</td>
<td class="org-left"><abbr class="tooltip" title="Thread FORMS elements as the first argument of their successor.<br>Example:<br>&emsp;&emsp;(thread-first<br>&emsp;&emsp;&emsp;5<br>&emsp;&emsp;&emsp;(+ 20)<br>&emsp;&emsp;&emsp;(/ 25)<br>&emsp;&emsp;&emsp;-<br>&emsp;&emsp;&emsp;(+ 40))<br>Is equivalent to:<br>&emsp;&emsp;(+ (- (/ (+ 5 20) 25)) 40)<br>Note how the single ‘-’ got converted into a list before<br>threading.<br><br>(fn &rest FORMS)">thread-first</abbr></td>
</tr>
</tbody>
</table>

<p>
Notice how hovering over items makes them appear, but to make them disappear you
should click on them or scroll away.  This is ideal when one wants to have
multiple ‘definitions’ visible ;-)
</p>
</div>
</div>

<div id="outline-container-orgea7a9f6" class="outline-3">
<h3 id="tooltipster"><span class="section-number-3">9.4</span> <a href="https://iamceege.github.io/tooltipster/#triggers">Tooltipster</a> &#x2014;Fast, Sleek, &amp; Beautiful Tooltips</h3>
<div class="outline-text-3" id="text-tooltipster">
<p>
Thus far, Org entities are converted into HTML tags such as <code>&lt;i&gt;</code> for italicised
text. However, HTML's default tooltip utility &#x2014;using <code>title="⋯"</code> in a <code>div</code>&#x2014;
does not render arbitrary HTML elements. Moreover, the default tooltip utility
is rather slow. As such, we move to using <a href="https://iamceege.github.io/tooltipster/#triggers">tooltipster</a>.
The incantation below sets up the required magic to make this happen.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">defvar</span> <span style="color: #268bd2;">org-specical-block-extras--html-setup</span> nil
  <span style="color: #35a69c; font-style: italic;">"Has the necessary HTML beeen added?"</span>)

(<span style="color: #859900; font-weight: bold;">unless</span> <span style="color: #268bd2;">org-specical-block-extras--html-setup</span>
  (<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">org-specical-block-extras--html-setup</span> <span style="color: #268bd2;">t</span>)
(<span style="color: #859900; font-weight: bold;">setq</span> <span style="color: #268bd2;">org-html-head-extra</span>
 (<span style="color: #b58900;">concat</span> <span style="color: #268bd2;">org-html-head-extra</span>
<span style="color: #2aa198;">"</span>
<span style="color: #2aa198;">&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css\"/&gt;</span>

<span style="color: #2aa198;">&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css\" /&gt;</span>

<span style="color: #2aa198;">&lt;script type=\"text/javascript\" src=\"https://code.jquery.com/jquery-1.10.0.min.js\"&gt;&lt;/script&gt;</span>

<span style="color: #2aa198;"> &lt;script type=\"text/javascript\"            src=\"https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js\"&gt;&lt;/script&gt;</span>

<span style="color: #2aa198;">  &lt;script&gt;</span>
<span style="color: #2aa198;">         $(document).ready(function() {</span>
<span style="color: #2aa198;">             $('.tooltip').tooltipster({</span>
<span style="color: #2aa198;">                 theme: 'tooltipster-punk',</span>
<span style="color: #2aa198;">                 contentAsHTML: true,</span>
<span style="color: #2aa198;">                 animation: 'grow',</span>
<span style="color: #2aa198;">                 delay: [100,500],</span>
<span style="color: #2aa198;">                 // trigger: 'click'</span>
<span style="color: #2aa198;">                 trigger: 'custom',</span>
<span style="color: #2aa198;">                 triggerOpen: {</span>
<span style="color: #2aa198;">                     mouseenter: true</span>
<span style="color: #2aa198;">                 },</span>
<span style="color: #2aa198;">                 triggerClose: {</span>
<span style="color: #2aa198;">                     originClick: true,</span>
<span style="color: #2aa198;">                     scroll: true</span>
<span style="color: #2aa198;">                 }</span>
<span style="color: #2aa198;"> });</span>
<span style="color: #2aa198;">         });</span>
<span style="color: #2aa198;">     &lt;/script&gt;</span>

<span style="color: #2aa198;">&lt;style&gt;</span>
<span style="color: #2aa198;">   abbr {color: red;}</span>

<span style="color: #2aa198;">   .tooltip { border-bottom: 1px dotted #000;</span>
<span style="color: #2aa198;">              color:red;</span>
<span style="color: #2aa198;">              text-decoration: none;}</span>
<span style="color: #2aa198;">&lt;/style&gt;</span>
<span style="color: #2aa198;">"</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org6ce6b89" class="outline-3">
<h3 id="hola"><span class="section-number-3">9.5</span> Wait, what about the LaTeX?</h3>
<div class="outline-text-3" id="text-hola">
<p>
A PDF is essentially a fancy piece of paper, so tooltips will take on the
form of glossary entries: Using <code>doc:𝒳</code> will result in the word <code>𝒳</code> being printed
as a hyperlink to a glossary entry, which you the user will eventually
declare using <code>show:GLOSSARY</code>; moreover, the glossary entry will also have a
link back to where the <code>doc:𝒳</code> was declared.
E.g., <abbr class="tooltip" title="Define NAME as a macro.<br>When the macro is called, as in (NAME ARGS...),<br>the function (lambda ARGLIST BODY...) is applied to<br>the list ARGS... as it appears in the expression,<br>and the result should be a form to be evaluated instead of the original.<br>DECL is a declaration, optional, of the form (declare DECLS...) where<br>DECLS is a list of elements of the form (PROP . VALUES).&emsp;These are<br>interpreted according to ‘macro-declarations-alist’.<br>The return value is undefined.<br><br>(fn NAME ARGLIST &optional DOCSTRING DECL &rest BODY)">defmacro</abbr> and <abbr class="tooltip" title="Return an anonymous function.<br>Under dynamic binding, a call of the form (lambda ARGS DOCSTRING<br>INTERACTIVE BODY) is self-quoting; the result of evaluating the<br>lambda expression is the expression itself.&emsp;Under lexical<br>binding, the result is a closure.&emsp;Regardless, the result is a<br>function, i.e., it may be stored as the function value of a<br>symbol, passed to ‘funcall’ or ‘mapcar’, etc.<br><br>ARGS should take the same form as an argument list for a ‘defun’.<br>DOCSTRING is an optional documentation string.<br> If present, it should describe how to call the function.<br> But documentation strings are usually not useful in nameless functions.<br>INTERACTIVE should be a call to the function ‘interactive’, which see.<br>It may also be omitted.<br>BODY should be a list of Lisp expressions.<br><br>(fn ARGS [DOCSTRING] [INTERACTIVE] BODY)">lambda</abbr>.
</p>

<p>
We make a <code>show:𝒳</code> link type to print the value of the variable <code>𝒳</code>
as follows, with <code>GLOSSARY</code> being a reserved name.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #859900; font-weight: bold;">let</span> ((whatdo (<span style="color: #859900; font-weight: bold;">lambda</span> (x)
                (<span style="color: #b58900;">message</span> (<span style="color: #b58900;">format</span>
                          (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"The value of variable  %s  will be placed "</span>
                                  <span style="color: #2aa198;">"here literally upon export, "</span>
                                  <span style="color: #2aa198;">"which is: \n\n %s"</span>)
                          (<span style="color: #b58900;">s-upcase</span> x)
                          (<span style="color: #859900; font-weight: bold;">if</span> (<span style="color: #b58900;">equal</span> x <span style="color: #2aa198;">"GLOSSARY"</span>)
                              (<span style="color: #b58900;">format</span> <span style="color: #2aa198;">"A cleaned up presentation of ...\n%s"</span>
                                      <span style="color: #268bd2;">org-specical-blocks-extras--docs-GLOSSARY</span>)
                          (<span style="color: #b58900;">pp</span> (<span style="color: #b58900;">eval</span> (<span style="color: #b58900;">intern</span> x)))))))))
  (<span style="color: #b58900;">org-link-set-parameters</span>
    <span style="color: #2aa198;">"show"</span>
    <span style="color: #d33682; font-style: italic;">:face</span> '(<span style="color: #d33682; font-style: italic;">:underline</span> <span style="color: #2aa198;">"green"</span>)
    <span style="color: #d33682; font-style: italic;">:follow</span> whatdo
    <span style="color: #d33682; font-style: italic;">:help-echo</span> `(<span style="color: #859900; font-weight: bold;">lambda</span> (window object <span style="color: #b58900;">position</span>)
                  (<span style="color: #859900; font-weight: bold;">save-excursion</span>
                    (<span style="color: #b58900;">goto-char</span> <span style="color: #b58900;">position</span>)
                    (<span style="color: #859900; font-weight: bold;">-let</span> [(<span style="color: #b58900; font-style: italic;">&amp;plist</span> <span style="color: #d33682; font-style: italic;">:path</span>) (<span style="color: #b58900;">cadr</span> (<span style="color: #b58900;">org-element-context</span>))]
                      (<span style="color: #b58900;">funcall</span> ,whatdo path))))
    <span style="color: #d33682; font-style: italic;">:export</span>
    (<span style="color: #859900; font-weight: bold;">lambda</span> (label description backend)
      (<span style="color: #859900; font-weight: bold;">cond</span> ((<span style="color: #b58900;">not</span> (<span style="color: #b58900;">equal</span> label <span style="color: #2aa198;">"GLOSSARY"</span>)) (<span style="color: #b58900;">prin1</span> (<span style="color: #b58900;">eval</span> (<span style="color: #b58900;">intern</span> label))))
            ((<span style="color: #b58900;">equal</span> 'html backend) <span style="color: #2aa198;">""</span>) <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Do not print glossary in HTML</span>
            (_
             (<span style="color: #859900; font-weight: bold;">-let</span> ((fstr (<span style="color: #b58900;">concat</span> <span style="color: #2aa198;">"\\vspace{1em}\\phantomsection"</span>
                                 <span style="color: #2aa198;">"\\textbf{%s}\\quad"</span>
                                 <span style="color: #2aa198;">"\\label{org-special-block-extras-glossary-%s}"</span>
                                 <span style="color: #2aa198;">"%s See page "</span>
                                 <span style="color: #2aa198;">"\\pageref{org-special-block-extras"</span>
                                 <span style="color: #2aa198;">"-glossary-declaration-site-%s}"</span>))
                    (preserve <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">preserve whitespace</span>
                     (<span style="color: #859900; font-weight: bold;">lambda</span> (x)
                       (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"\n"</span> <span style="color: #2aa198;">" \\newline{\\color{white}.}"</span>
                                  (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"  "</span> <span style="color: #2aa198;">" \\quad "</span>
                                             <span style="color: #96A7A9; font-style: italic;">;; </span><span style="color: #96A7A9; font-style: italic;">Hack!</span>
                                             (<span style="color: #b58900;">s-replace</span> <span style="color: #2aa198;">"&amp;"</span> <span style="color: #2aa198;">"\\&amp;"</span> x))))))
               (<span style="color: #b58900;">s-join</span> <span style="color: #2aa198;">"\n\n"</span>
                       (<span style="color: #859900; font-weight: bold;">loop</span> for (label name doc)
                             in <span style="color: #268bd2;">org-specical-blocks-extras--docs-GLOSSARY</span>
                             collect (<span style="color: #b58900;">format</span> fstr name label
                                             (<span style="color: #b58900;">funcall</span> preserve doc)
                                             label)))))))))
</pre>
</div>



<p>
As an example, we know have generic sentences:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left"><code>My name is show:user-full-name and I am using Emacs show:emacs-version ^_^</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">My name is Musa Al-hassy and I am using Emacs 28.0.50 ^_^</td>
</tr>
</tbody>
</table>

<p>
For example, here is a word whose documentation is obtained from Emacs
rather than me being written: <abbr class="tooltip" title="Thread FORMS elements as the last argument of their successor.<br>Example:<br>&emsp;&emsp;(thread-last<br>&emsp;&emsp;&emsp;5<br>&emsp;&emsp;&emsp;(+ 20)<br>&emsp;&emsp;&emsp;(/ 25)<br>&emsp;&emsp;&emsp;-<br>&emsp;&emsp;&emsp;(+ 40))<br>Is equivalent to:<br>&emsp;&emsp;(+ 40 (- (/ 25 (+ 20 5))))<br>Note how the single ‘-’ got converted into a list before<br>threading.<br><br>(fn &rest FORMS)">thread-last</abbr>.
If you click on it, in the LaTeX output, you will be directed to the glossary
at the end of this article &#x2014;glossaries are not printed in HTML rendering.
</p>

<p>
<i>Neato! The whitespace in the documentation is preserved in the LaTeX output as
is the case for HTML.</i>
</p>
</div>
</div>

<div id="outline-container-org5d49e86" class="outline-3">
<h3 id="Next-Steps-tooltips"><span class="section-number-3">9.6</span> Next Steps</h3>
<div class="outline-text-3" id="text-Next-Steps-tooltips">
<p>
<span style="color:orange;">Going forward,</span> it'd be nice to have URLs work well upon export for <code>documentation</code>
block types; whereas they currently break the HTML export.
</p>
<ul class="org-ul">
<li>If an entry is referenced multiple times, such as <abbr class="tooltip" title="A theory of typed&emsp;composition; e.g., typed monoids."> Category Theory</abbr>, then it would be
nice if the glossary referred to the pages of all such locations rather than
just the final one.</li>
<li>The glossary current prints in order of appearance; we may want to have
the option to print it in a sorted fashion.</li>
<li>Perhaps use the line activation feature to provide link tooltips
immediately rather than rely on exportation.</li>
<li>The <code>show</code> link type could accept an arbitrary Lisp expression as
a bracketed link.</li>
<li>When one clicks on a <code>doc</code> documentation link, it would be nice to ‘jump’
to its associated <code>#+begin_documentation</code> declaration block in the current
buffer, if possible.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org2bf4bd7" class="outline-2">
<h2 id="Summary"><span class="section-number-2">10</span> Summary</h2>
<div class="outline-text-2" id="text-Summary">
<p>
Let <code>𝒞</code> be any of the following: <code>black</code>, <code>blue</code>, <code>brown</code>, <code>cyan</code>, <code>darkgray</code>, <code>gray</code>, <code>green</code>,
<code>lightgray</code>, <code>lime</code>, <code>magenta</code>, <code>olive orange</code>, <code>pink</code>, <code>purple</code>, <code>red</code>, <code>teal</code>, <code>violet</code>, <code>white</code>,
<code>yellow</code>. Let <code>𝓃</code> be any number from <code>1..5</code>.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Idea</th>
<th scope="col" class="org-left">Block</th>
<th scope="col" class="org-left">Link</th>
<th scope="col" class="org-left">Switches</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Colours</td>
<td class="org-left"><code>𝒞</code></td>
<td class="org-left"><code>𝒞</code>, <code>color:𝒞</code></td>
<td class="org-left"><code>:color:</code></td>
</tr>

<tr>
<td class="org-left">Parallel</td>
<td class="org-left"><code>𝓃parallel[NB]</code></td>
<td class="org-left">-</td>
<td class="org-left"><code>:columnbreak:</code></td>
</tr>

<tr>
<td class="org-left">Editorial Comments</td>
<td class="org-left"><code>edcomm</code></td>
<td class="org-left"><code>edcomm</code></td>
<td class="org-left"><code>:ed:</code>, <code>:replacewith:</code></td>
</tr>

<tr>
<td class="org-left">Folded Details</td>
<td class="org-left"><code>details</code></td>
<td class="org-left">-</td>
<td class="org-left"><code>:title:</code></td>
</tr>

<tr>
<td class="org-left">Link Here</td>
<td class="org-left">-</td>
<td class="org-left"><code>link-here</code></td>
<td class="org-left">-</td>
</tr>

<tr>
<td class="org-left">Badges</td>
<td class="org-left">-</td>
<td class="org-left"><code>badge</code></td>
<td class="org-left">-</td>
</tr>

<tr>
<td class="org-left">Documentation-Glossary</td>
<td class="org-left"><code>documentation</code></td>
<td class="org-left"><code>doc</code>, <code>show</code></td>
<td class="org-left"><code>:name:</code>, <code>:label:</code></td>
</tr>
</tbody>
</table>

<p>
There are also the social badge links:
<code>reddit-subscribe-to</code>, <code>github-followers</code>, <code>github-forks</code>, <code>github-stars,
github-watchers</code>, <code>twitter-follow</code>, and <code>tweet</code>.
</p>


<p>
<span style="color:orange;">Going forward,</span> it'd be nice to a centralised ‘user manual’ which may be
consulted rather than reading the literate implementation above.
</p>
</div>
</div>

<p>

</p>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
See <a href="http://www.cs.nott.ac.uk/~pszgmh/fold.pdf"><i>A tutorial on the universality and expressiveness of fold</i></a> and
<a href="http://www.cs.ox.ac.uk/people/jeremy.gibbons/publications/urs.pdf"><i>Unifying Structured Recursion Schemes</i></a>
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: Musa Al-hassy</p>
<p class="date">Created: 2020-04-24 Fri 00:52</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
